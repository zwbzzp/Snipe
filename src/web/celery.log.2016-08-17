2016-08-17 11:02:27,064 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:02:27,220 WARNING celery.redirected 2016-08-17 11:02:27,220 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 11:02:27,221 WARNING celery.redirected 2016-08-17 11:02:27,221 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:02:27,226 WARNING celery.redirected 2016-08-17 11:02:27,226 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 11:02:27,227 WARNING celery.redirected 2016-08-17 11:02:27,227 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:02:27,229 WARNING celery.redirected 2016-08-17 11:02:27,229 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 11:02:27,230 WARNING celery.redirected 2016-08-17 11:02:27,229 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:02:27,234 WARNING celery.redirected 2016-08-17 11:02:27,232 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 11:02:27,236 WARNING celery.redirected 2016-08-17 11:02:27,235 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:02:27,241 WARNING celery.redirected 2016-08-17 11:02:27,241 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 11:02:27,245 WARNING celery.redirected 2016-08-17 11:02:27,244 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:02:27,247 WARNING celery.redirected 2016-08-17 11:02:27,247 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 11:02:27,249 WARNING celery.redirected 2016-08-17 11:02:27,249 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:02:27,253 WARNING celery.redirected 2016-08-17 11:02:27,253 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:02:27,255 WARNING celery.redirected 2016-08-17 11:02:27,255 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:02:27,255 WARNING celery.redirected 2016-08-17 11:02:27,255 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:02:27,260 WARNING celery.redirected 2016-08-17 11:02:27,259 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:02:27,260 WARNING celery.redirected 2016-08-17 11:02:27,260 INFO sqlalchemy.engine.base.Engine {'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 1, 27, 97840), 'desktop_state_1': 'DELETING'}
2016-08-17 11:02:27,266 WARNING celery.redirected 2016-08-17 11:02:27,265 INFO sqlalchemy.engine.base.Engine INSERT INTO desktop_tasks (created_at, updated_at, action, state, result, stage, stage_chain, retries, enabled, context) VALUES (%(created_at)s, %(updated_at)s, %(action)s, %(state)s, %(result)s, %(stage)s, %(stage_chain)s, %(retries)s, %(enabled)s, %(context)s)
2016-08-17 11:02:27,267 WARNING celery.redirected 2016-08-17 11:02:27,267 INFO sqlalchemy.engine.base.Engine {'context': '{"course": 1, "vm": "2f7bcf55-cf5e-4c10-8717-6656af904651", "desktop": 1}', 'retries': 0, 'enabled': 1, 'stage_chain': '["DELETE"]', 'result': '', 'created_at': datetime.datetime(2016, 8, 17, 11, 2, 27, 265172), 'stage': 'DELETE', 'action': 'DELETE', 'state': 'PENDING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 2, 27, 265297)}
2016-08-17 11:02:27,272 WARNING celery.redirected 2016-08-17 11:02:27,272 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:02:27,273 WARNING celery.redirected 2016-08-17 11:02:27,272 INFO sqlalchemy.engine.base.Engine {'desktop_state': 'DELETING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 2, 27, 271892), 'desktops_id': 1}
2016-08-17 11:02:27,275 WARNING celery.redirected 2016-08-17 11:02:27,275 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:02:27,277 WARNING celery.redirected 2016-08-17 11:02:27,277 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:02:27,279 WARNING celery.redirected 2016-08-17 11:02:27,279 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:02:27,279 WARNING celery.redirected 2016-08-17 11:02:27,279 INFO sqlalchemy.engine.base.Engine {'param_1': 4}
2016-08-17 11:02:27,283 WARNING celery.redirected 2016-08-17 11:02:27,283 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:02:27,284 WARNING celery.redirected 2016-08-17 11:02:27,284 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'id_1': 4}
2016-08-17 11:02:27,408 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:02:27,408 WARNING celery.redirected 2016-08-17 11:02:27,408 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:03:33,230 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:03:33,231 INFO celery Scheduling start lesson tasks
2016-08-17 11:03:33,233 WARNING celery.redirected 2016-08-17 11:03:33,233 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:03:33,238 WARNING celery.redirected 2016-08-17 11:03:33,237 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:03:33,240 WARNING celery.redirected 2016-08-17 11:03:33,239 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:03:33,245 WARNING celery.redirected 2016-08-17 11:03:33,245 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:03:33,246 WARNING celery.redirected 2016-08-17 11:03:33,246 INFO sqlalchemy.engine.base.Engine {'start_date_1': datetime.date(2016, 8, 17), 'end_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(11, 3, 33, 241971), 'start_time_1': datetime.time(11, 13, 33, 241971)}
2016-08-17 11:03:33,252 WARNING celery.redirected 2016-08-17 11:03:33,252 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:03:33,254 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:04:38,338 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:04:38,341 WARNING celery.redirected 2016-08-17 11:04:38,340 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:04:38,343 WARNING celery.redirected 2016-08-17 11:04:38,342 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:04:38,343 WARNING celery.redirected 2016-08-17 11:04:38,343 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'id_1': 5}
2016-08-17 11:04:38,346 WARNING celery.redirected 2016-08-17 11:04:38,345 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:04:38,346 WARNING celery.redirected 2016-08-17 11:04:38,346 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:04:38,350 INFO celery Wait state for <DesktopTask 5>
2016-08-17 11:04:38,352 WARNING celery.redirected 2016-08-17 11:04:38,352 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:04:38,353 WARNING celery.redirected 2016-08-17 11:04:38,353 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 5, 'context': '{"flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "course_name": "teacher-lll", "subnet": null, "course": 2, "serial": 0, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "detect_timeout": 30, "wait_state": "ACTIVE", "port": null, "start_datetime": "2016-08-17T06:00:00", "desktop_type": "COURSE", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9", "wait_started_at": "2016-08-17T11:04:38.351308", "disk": null, "desktop": 2, "end_datetime": "2016-08-17T20:00:00", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "wait_timeout": 600, "detect_method": "PING", "floating_action": "ASSIGN"}', 'updated_at': datetime.datetime(2016, 8, 17, 11, 4, 38, 352495)}
2016-08-17 11:04:38,356 WARNING celery.redirected 2016-08-17 11:04:38,356 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:04:38,359 WARNING celery.redirected 2016-08-17 11:04:38,359 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:04:38,361 WARNING celery.redirected 2016-08-17 11:04:38,361 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:04:38,362 WARNING celery.redirected 2016-08-17 11:04:38,362 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:04:38,712 WARNING celery.redirected 2016-08-17 11:04:38,712 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:04:38,713 WARNING celery.redirected 2016-08-17 11:04:38,712 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'id_1': 2}
2016-08-17 11:04:38,716 WARNING celery.redirected 2016-08-17 11:04:38,716 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:04:38,717 WARNING celery.redirected 2016-08-17 11:04:38,717 INFO sqlalchemy.engine.base.Engine {'vm_state': 'BUILD', 'desktops_id': 2, 'updated_at': datetime.datetime(2016, 8, 17, 11, 4, 38, 716621)}
2016-08-17 11:04:38,719 WARNING celery.redirected 2016-08-17 11:04:38,718 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:04:38,721 WARNING celery.redirected 2016-08-17 11:04:38,721 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:04:38,722 WARNING celery.redirected 2016-08-17 11:04:38,722 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:04:38,723 WARNING celery.redirected 2016-08-17 11:04:38,723 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:04:38,798 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:04:38,799 WARNING celery.redirected 2016-08-17 11:04:38,799 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:05:14,689 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:05:14,691 WARNING celery.redirected 2016-08-17 11:05:14,691 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:05:14,694 WARNING celery.redirected 2016-08-17 11:05:14,694 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:05:14,695 WARNING celery.redirected 2016-08-17 11:05:14,695 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'id_1': 5}
2016-08-17 11:05:14,698 WARNING celery.redirected 2016-08-17 11:05:14,697 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:05:14,698 WARNING celery.redirected 2016-08-17 11:05:14,698 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:05:14,699 INFO celery Detect for <DesktopTask 5>
2016-08-17 11:05:14,700 WARNING celery.redirected 2016-08-17 11:05:14,700 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:05:14,702 WARNING celery.redirected 2016-08-17 11:05:14,702 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:05:14,703 WARNING celery.redirected 2016-08-17 11:05:14,703 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:05:14,704 WARNING celery.redirected 2016-08-17 11:05:14,704 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:05:15,712 ERROR celery Detect(ping) for <DesktopTask 5>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140']' timed out after 1 seconds
2016-08-17 11:05:15,722 WARNING celery.redirected 2016-08-17 11:05:15,722 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:05:15,723 WARNING celery.redirected 2016-08-17 11:05:15,723 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 5, 'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 11, 5, 15, 722591)}
2016-08-17 11:05:15,724 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:05:15,725 WARNING celery.redirected 2016-08-17 11:05:15,725 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:05:56,750 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:05:56,752 WARNING celery.redirected 2016-08-17 11:05:56,752 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:05:56,753 WARNING celery.redirected 2016-08-17 11:05:56,753 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:05:56,753 WARNING celery.redirected 2016-08-17 11:05:56,753 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'id_1': 5}
2016-08-17 11:05:56,756 WARNING celery.redirected 2016-08-17 11:05:56,756 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:05:56,757 WARNING celery.redirected 2016-08-17 11:05:56,757 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:05:56,759 INFO celery Detect for <DesktopTask 5>
2016-08-17 11:05:56,759 WARNING celery.redirected 2016-08-17 11:05:56,759 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:05:56,761 WARNING celery.redirected 2016-08-17 11:05:56,761 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:05:56,762 WARNING celery.redirected 2016-08-17 11:05:56,762 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:05:56,762 WARNING celery.redirected 2016-08-17 11:05:56,762 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:05:56,770 INFO celery Detect for <DesktopTask 5>, success
2016-08-17 11:05:56,774 WARNING celery.redirected 2016-08-17 11:05:56,774 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:05:56,775 WARNING celery.redirected 2016-08-17 11:05:56,775 INFO sqlalchemy.engine.base.Engine {'success': 1, 'context': '{"detect_timeout": 30, "course": 2, "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "port": null, "desktop_type": "COURSE", "subnet": null, "disk": null, "desktop": 2, "end_datetime": "2016-08-17T20:00:00", "wait_timeout": 600, "detect_method": "PING", "floating_action": "ASSIGN", "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_started_at": "2016-08-17T11:04:38.351308", "detect_started_at": "2016-08-17T11:04:53.658733", "wait_state": "ACTIVE", "serial": 0, "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9", "start_datetime": "2016-08-17T06:00:00", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}}', 'detail': '', 'updated_at': datetime.datetime(2016, 8, 17, 11, 5, 56, 774386), 'task_id': 5, 'created_at': datetime.datetime(2016, 8, 17, 11, 5, 56, 774309), 'stage': 'DETECT'}
2016-08-17 11:05:56,777 WARNING celery.redirected 2016-08-17 11:05:56,777 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:05:56,779 WARNING celery.redirected 2016-08-17 11:05:56,779 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:05:56,781 WARNING celery.redirected 2016-08-17 11:05:56,780 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:05:56,781 WARNING celery.redirected 2016-08-17 11:05:56,781 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:05:56,784 WARNING celery.redirected 2016-08-17 11:05:56,784 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:05:56,784 WARNING celery.redirected 2016-08-17 11:05:56,784 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 5, 'result': 'SUCCESS', 'updated_at': datetime.datetime(2016, 8, 17, 11, 5, 56, 784153), 'state': 'FINISHED'}
2016-08-17 11:05:56,786 WARNING celery.redirected 2016-08-17 11:05:56,786 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:05:56,788 WARNING celery.redirected 2016-08-17 11:05:56,787 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:05:56,789 WARNING celery.redirected 2016-08-17 11:05:56,789 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:05:56,789 WARNING celery.redirected 2016-08-17 11:05:56,789 INFO sqlalchemy.engine.base.Engine {'param_1': 5}
2016-08-17 11:05:56,792 WARNING celery.redirected 2016-08-17 11:05:56,792 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:05:56,793 WARNING celery.redirected 2016-08-17 11:05:56,793 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'id_1': 2}
2016-08-17 11:05:56,795 WARNING celery.redirected 2016-08-17 11:05:56,795 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:05:56,796 WARNING celery.redirected 2016-08-17 11:05:56,796 INFO sqlalchemy.engine.base.Engine {'desktop_state': 'ACTIVE', 'updated_at': datetime.datetime(2016, 8, 17, 11, 5, 56, 795554), 'desktops_id': 2}
2016-08-17 11:05:56,797 WARNING celery.redirected 2016-08-17 11:05:56,797 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:05:56,799 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:07:33,390 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:07:33,392 WARNING celery.redirected 2016-08-17 11:07:33,392 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:07:33,393 WARNING celery.redirected 2016-08-17 11:07:33,393 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:07:33,394 WARNING celery.redirected 2016-08-17 11:07:33,393 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:07:33,397 WARNING celery.redirected 2016-08-17 11:07:33,397 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:07:33,398 WARNING celery.redirected 2016-08-17 11:07:33,398 INFO sqlalchemy.engine.base.Engine {'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 6, 33, 391428), 'desktop_state_1': 'DELETING'}
2016-08-17 11:07:33,400 WARNING celery.redirected 2016-08-17 11:07:33,400 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:07:33,401 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:09:38,267 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:09:38,269 WARNING celery.redirected 2016-08-17 11:09:38,268 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:09:38,270 WARNING celery.redirected 2016-08-17 11:09:38,270 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:09:38,270 WARNING celery.redirected 2016-08-17 11:09:38,270 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:09:38,274 WARNING celery.redirected 2016-08-17 11:09:38,274 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:09:38,274 WARNING celery.redirected 2016-08-17 11:09:38,274 INFO sqlalchemy.engine.base.Engine {'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 8, 38, 267915), 'desktop_state_1': 'DELETING'}
2016-08-17 11:09:38,276 WARNING celery.redirected 2016-08-17 11:09:38,276 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:09:38,278 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:11:43,392 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:11:43,394 WARNING celery.redirected 2016-08-17 11:11:43,394 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:11:43,395 WARNING celery.redirected 2016-08-17 11:11:43,395 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:11:43,395 WARNING celery.redirected 2016-08-17 11:11:43,395 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:11:43,399 WARNING celery.redirected 2016-08-17 11:11:43,399 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:11:43,400 WARNING celery.redirected 2016-08-17 11:11:43,400 INFO sqlalchemy.engine.base.Engine {'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 10, 43, 393437), 'desktop_state_1': 'DELETING'}
2016-08-17 11:11:43,402 WARNING celery.redirected 2016-08-17 11:11:43,402 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:11:43,403 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:13:44,806 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:13:44,812 WARNING celery.redirected 2016-08-17 11:13:44,809 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:13:44,815 WARNING celery.redirected 2016-08-17 11:13:44,814 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:13:44,818 WARNING celery.redirected 2016-08-17 11:13:44,817 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:13:44,821 WARNING celery.redirected 2016-08-17 11:13:44,821 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:13:44,822 WARNING celery.redirected 2016-08-17 11:13:44,822 INFO sqlalchemy.engine.base.Engine {'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 12, 44, 808137), 'desktop_state_1': 'DELETING'}
2016-08-17 11:13:44,824 WARNING celery.redirected 2016-08-17 11:13:44,824 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:13:44,826 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:15:54,759 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:15:54,761 WARNING celery.redirected 2016-08-17 11:15:54,761 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:15:54,762 WARNING celery.redirected 2016-08-17 11:15:54,762 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:15:54,762 WARNING celery.redirected 2016-08-17 11:15:54,762 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:15:54,771 WARNING celery.redirected 2016-08-17 11:15:54,771 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:15:54,771 WARNING celery.redirected 2016-08-17 11:15:54,771 INFO sqlalchemy.engine.base.Engine {'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 14, 54, 760166), 'desktop_state_1': 'DELETING'}
2016-08-17 11:15:54,774 WARNING celery.redirected 2016-08-17 11:15:54,774 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:15:54,776 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:17:04,802 INFO celery.worker.consumer Connected to sqla+sqlite:///celery-broker.sqlite
2016-08-17 11:17:05,047 WARNING celery.redirected celery@wenbiaodeMacBook-Pro.local ready.
2016-08-17 11:17:09,777 INFO celery.worker.strategy Received task: schedule_start_lesson[93fc1ab0-1daf-4c26-bec4-9e678f146f86]
2016-08-17 11:17:09,779 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:17:09,812 INFO celery Scheduling start lesson tasks
2016-08-17 11:17:09,889 WARNING celery.redirected 2016-08-17 11:17:09,889 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 11:17:09,890 WARNING celery.redirected 2016-08-17 11:17:09,889 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:17:09,891 WARNING celery.redirected 2016-08-17 11:17:09,891 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 11:17:09,892 WARNING celery.redirected 2016-08-17 11:17:09,892 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:17:09,893 WARNING celery.redirected 2016-08-17 11:17:09,893 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 11:17:09,893 WARNING celery.redirected 2016-08-17 11:17:09,893 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:17:09,895 WARNING celery.redirected 2016-08-17 11:17:09,895 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 11:17:09,896 WARNING celery.redirected 2016-08-17 11:17:09,896 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:17:09,897 WARNING celery.redirected 2016-08-17 11:17:09,897 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 11:17:09,898 WARNING celery.redirected 2016-08-17 11:17:09,898 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:17:09,899 WARNING celery.redirected 2016-08-17 11:17:09,899 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 11:17:09,899 WARNING celery.redirected 2016-08-17 11:17:09,899 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:17:09,901 WARNING celery.redirected 2016-08-17 11:17:09,901 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:17:09,902 WARNING celery.redirected 2016-08-17 11:17:09,902 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:17:09,903 WARNING celery.redirected 2016-08-17 11:17:09,903 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:17:09,908 WARNING celery.redirected 2016-08-17 11:17:09,908 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:17:09,909 WARNING celery.redirected 2016-08-17 11:17:09,908 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 17, 9, 904935), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 27, 9, 904935), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:17:09,911 WARNING celery.redirected 2016-08-17 11:17:09,911 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:17:09,912 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:17:09,926 INFO celery.worker.job Task schedule_start_lesson[93fc1ab0-1daf-4c26-bec4-9e678f146f86] succeeded in 0.14740385900040565s: None
2016-08-17 11:18:03,955 INFO celery.worker.strategy Received task: schedule_clean_desktops[316d0523-3154-46c7-ac0c-e432b4e8994d]
2016-08-17 11:18:03,958 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:18:04,077 WARNING celery.redirected 2016-08-17 11:18:04,076 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 11:18:04,079 WARNING celery.redirected 2016-08-17 11:18:04,077 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:04,082 WARNING celery.redirected 2016-08-17 11:18:04,082 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 11:18:04,084 WARNING celery.redirected 2016-08-17 11:18:04,084 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:04,088 WARNING celery.redirected 2016-08-17 11:18:04,088 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 11:18:04,089 WARNING celery.redirected 2016-08-17 11:18:04,089 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:04,092 WARNING celery.redirected 2016-08-17 11:18:04,092 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 11:18:04,093 WARNING celery.redirected 2016-08-17 11:18:04,093 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:04,095 WARNING celery.redirected 2016-08-17 11:18:04,094 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 11:18:04,095 WARNING celery.redirected 2016-08-17 11:18:04,095 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:04,096 WARNING celery.redirected 2016-08-17 11:18:04,096 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 11:18:04,097 WARNING celery.redirected 2016-08-17 11:18:04,097 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:04,098 WARNING celery.redirected 2016-08-17 11:18:04,098 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:18:04,100 WARNING celery.redirected 2016-08-17 11:18:04,100 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:18:04,101 WARNING celery.redirected 2016-08-17 11:18:04,100 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:18:04,107 WARNING celery.redirected 2016-08-17 11:18:04,107 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:18:04,107 WARNING celery.redirected 2016-08-17 11:18:04,107 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 17, 3, 995416), 'desktop_state_2': 'DELETED'}
2016-08-17 11:18:04,110 WARNING celery.redirected 2016-08-17 11:18:04,110 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:18:04,111 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:18:04,125 INFO celery.worker.job Task schedule_clean_desktops[316d0523-3154-46c7-ac0c-e432b4e8994d] succeeded in 0.16832221900040167s: None
2016-08-17 11:18:15,002 INFO celery.worker.strategy Received task: schedule_start_lesson[8a48f250-8650-4b4f-8e52-9b451f80f899]
2016-08-17 11:18:15,004 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:18:15,042 INFO celery Scheduling start lesson tasks
2016-08-17 11:18:15,124 WARNING celery.redirected 2016-08-17 11:18:15,124 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 11:18:15,125 WARNING celery.redirected 2016-08-17 11:18:15,124 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:15,126 WARNING celery.redirected 2016-08-17 11:18:15,126 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 11:18:15,127 WARNING celery.redirected 2016-08-17 11:18:15,127 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:15,128 WARNING celery.redirected 2016-08-17 11:18:15,128 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 11:18:15,128 WARNING celery.redirected 2016-08-17 11:18:15,128 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:15,130 WARNING celery.redirected 2016-08-17 11:18:15,130 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 11:18:15,131 WARNING celery.redirected 2016-08-17 11:18:15,131 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:15,132 WARNING celery.redirected 2016-08-17 11:18:15,132 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 11:18:15,133 WARNING celery.redirected 2016-08-17 11:18:15,133 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:15,134 WARNING celery.redirected 2016-08-17 11:18:15,134 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 11:18:15,134 WARNING celery.redirected 2016-08-17 11:18:15,134 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:18:15,136 WARNING celery.redirected 2016-08-17 11:18:15,136 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:18:15,139 WARNING celery.redirected 2016-08-17 11:18:15,138 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:18:15,140 WARNING celery.redirected 2016-08-17 11:18:15,139 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:18:15,147 WARNING celery.redirected 2016-08-17 11:18:15,147 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:18:15,148 WARNING celery.redirected 2016-08-17 11:18:15,147 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 18, 15, 143990), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 28, 15, 143990), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:18:15,152 WARNING celery.redirected 2016-08-17 11:18:15,152 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:18:15,153 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:18:15,168 INFO celery.worker.job Task schedule_start_lesson[8a48f250-8650-4b4f-8e52-9b451f80f899] succeeded in 0.16457104799974331s: None
2016-08-17 11:19:09,565 INFO celery.worker.strategy Received task: schedule_clean_desktops[1c7f85c6-b6f5-4f8b-9ae7-643e7a77902a]
2016-08-17 11:19:09,567 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:19:09,684 WARNING celery.redirected 2016-08-17 11:19:09,684 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 11:19:09,685 WARNING celery.redirected 2016-08-17 11:19:09,684 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:19:09,687 WARNING celery.redirected 2016-08-17 11:19:09,687 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 11:19:09,687 WARNING celery.redirected 2016-08-17 11:19:09,687 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:19:09,689 WARNING celery.redirected 2016-08-17 11:19:09,688 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 11:19:09,689 WARNING celery.redirected 2016-08-17 11:19:09,689 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:19:09,691 WARNING celery.redirected 2016-08-17 11:19:09,691 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 11:19:09,692 WARNING celery.redirected 2016-08-17 11:19:09,691 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:19:09,693 WARNING celery.redirected 2016-08-17 11:19:09,693 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 11:19:09,694 WARNING celery.redirected 2016-08-17 11:19:09,693 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:19:09,695 WARNING celery.redirected 2016-08-17 11:19:09,695 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 11:19:09,695 WARNING celery.redirected 2016-08-17 11:19:09,695 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 11:19:09,697 WARNING celery.redirected 2016-08-17 11:19:09,696 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:19:09,698 WARNING celery.redirected 2016-08-17 11:19:09,698 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:19:09,699 WARNING celery.redirected 2016-08-17 11:19:09,698 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:19:09,703 WARNING celery.redirected 2016-08-17 11:19:09,703 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:19:09,704 WARNING celery.redirected 2016-08-17 11:19:09,704 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 18, 9, 600046), 'desktop_state_2': 'DELETED'}
2016-08-17 11:19:09,707 WARNING celery.redirected 2016-08-17 11:19:09,707 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:19:09,711 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:19:09,740 INFO celery.worker.job Task schedule_clean_desktops[1c7f85c6-b6f5-4f8b-9ae7-643e7a77902a] succeeded in 0.1740338839999822s: None
2016-08-17 11:19:14,394 INFO celery.worker.strategy Received task: schedule_start_lesson[098dddf5-734e-4dc8-a584-3ea9ee61fde2]
2016-08-17 11:19:14,396 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:19:14,397 INFO celery Scheduling start lesson tasks
2016-08-17 11:19:14,400 WARNING celery.redirected 2016-08-17 11:19:14,399 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:19:14,401 WARNING celery.redirected 2016-08-17 11:19:14,400 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:19:14,401 WARNING celery.redirected 2016-08-17 11:19:14,401 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:19:14,409 WARNING celery.redirected 2016-08-17 11:19:14,408 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:19:14,411 WARNING celery.redirected 2016-08-17 11:19:14,410 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 19, 14, 403733), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 29, 14, 403733), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:19:14,416 WARNING celery.redirected 2016-08-17 11:19:14,416 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:19:14,418 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:19:14,427 INFO celery.worker.job Task schedule_start_lesson[098dddf5-734e-4dc8-a584-3ea9ee61fde2] succeeded in 0.03099297700009629s: None
2016-08-17 11:20:09,784 INFO celery.worker.strategy Received task: schedule_clean_desktops[eaa785d2-4a71-4659-98cf-b74aa3377b2b]
2016-08-17 11:20:09,786 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:20:09,789 WARNING celery.redirected 2016-08-17 11:20:09,788 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:20:09,790 WARNING celery.redirected 2016-08-17 11:20:09,790 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:20:09,791 WARNING celery.redirected 2016-08-17 11:20:09,790 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:20:09,796 WARNING celery.redirected 2016-08-17 11:20:09,796 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:20:09,797 WARNING celery.redirected 2016-08-17 11:20:09,797 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 19, 9, 787237), 'desktop_state_2': 'DELETED'}
2016-08-17 11:20:09,800 WARNING celery.redirected 2016-08-17 11:20:09,800 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:20:09,801 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:20:09,811 INFO celery.worker.job Task schedule_clean_desktops[eaa785d2-4a71-4659-98cf-b74aa3377b2b] succeeded in 0.025410895999812055s: None
2016-08-17 11:20:14,681 INFO celery.worker.strategy Received task: schedule_start_lesson[2ed05db0-bc76-412a-bb84-b5a65f4cb98b]
2016-08-17 11:20:14,682 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:20:14,683 INFO celery Scheduling start lesson tasks
2016-08-17 11:20:14,685 WARNING celery.redirected 2016-08-17 11:20:14,685 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:20:14,686 WARNING celery.redirected 2016-08-17 11:20:14,686 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:20:14,687 WARNING celery.redirected 2016-08-17 11:20:14,687 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:20:14,692 WARNING celery.redirected 2016-08-17 11:20:14,691 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:20:14,692 WARNING celery.redirected 2016-08-17 11:20:14,692 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 20, 14, 689168), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 30, 14, 689168), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:20:14,694 WARNING celery.redirected 2016-08-17 11:20:14,694 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:20:14,696 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:20:14,704 INFO celery.worker.job Task schedule_start_lesson[2ed05db0-bc76-412a-bb84-b5a65f4cb98b] succeeded in 0.022125350999885995s: None
2016-08-17 11:21:09,153 INFO celery.worker.strategy Received task: schedule_clean_desktops[6365f8cc-3403-4073-8e5d-08d06fc94e75]
2016-08-17 11:21:09,155 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:21:09,158 WARNING celery.redirected 2016-08-17 11:21:09,158 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:21:09,159 WARNING celery.redirected 2016-08-17 11:21:09,159 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:21:09,160 WARNING celery.redirected 2016-08-17 11:21:09,159 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:21:09,163 WARNING celery.redirected 2016-08-17 11:21:09,163 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:21:09,164 WARNING celery.redirected 2016-08-17 11:21:09,164 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 20, 9, 156523), 'desktop_state_2': 'DELETED'}
2016-08-17 11:21:09,166 WARNING celery.redirected 2016-08-17 11:21:09,166 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:21:09,167 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:21:09,174 INFO celery.worker.job Task schedule_clean_desktops[6365f8cc-3403-4073-8e5d-08d06fc94e75] succeeded in 0.019031134999750066s: None
2016-08-17 11:21:15,213 INFO celery.worker.strategy Received task: schedule_start_lesson[010cea10-35c7-4f61-b740-a0f037a19f4b]
2016-08-17 11:21:15,214 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:21:15,214 INFO celery Scheduling start lesson tasks
2016-08-17 11:21:15,216 WARNING celery.redirected 2016-08-17 11:21:15,215 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:21:15,217 WARNING celery.redirected 2016-08-17 11:21:15,217 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:21:15,217 WARNING celery.redirected 2016-08-17 11:21:15,217 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:21:15,221 WARNING celery.redirected 2016-08-17 11:21:15,221 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:21:15,221 WARNING celery.redirected 2016-08-17 11:21:15,221 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 21, 15, 218978), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 31, 15, 218978), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:21:15,223 WARNING celery.redirected 2016-08-17 11:21:15,223 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:21:15,225 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:21:15,231 INFO celery.worker.job Task schedule_start_lesson[010cea10-35c7-4f61-b740-a0f037a19f4b] succeeded in 0.01757387700035906s: None
2016-08-17 11:22:09,439 INFO celery.worker.strategy Received task: schedule_clean_desktops[9b67b382-8a03-47d6-a2ec-58a53c13ad6d]
2016-08-17 11:22:09,440 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:22:09,442 WARNING celery.redirected 2016-08-17 11:22:09,441 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:22:09,443 WARNING celery.redirected 2016-08-17 11:22:09,442 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:22:09,443 WARNING celery.redirected 2016-08-17 11:22:09,443 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:22:09,446 WARNING celery.redirected 2016-08-17 11:22:09,446 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:22:09,447 WARNING celery.redirected 2016-08-17 11:22:09,447 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 21, 9, 441034), 'desktop_state_2': 'DELETED'}
2016-08-17 11:22:09,449 WARNING celery.redirected 2016-08-17 11:22:09,449 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:22:09,450 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:22:09,459 INFO celery.worker.job Task schedule_clean_desktops[9b67b382-8a03-47d6-a2ec-58a53c13ad6d] succeeded in 0.01949411300029169s: None
2016-08-17 11:22:15,495 INFO celery.worker.strategy Received task: schedule_start_lesson[b31bfff0-b948-4a8e-8732-1c53abb2fe1c]
2016-08-17 11:22:15,496 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:22:15,497 INFO celery Scheduling start lesson tasks
2016-08-17 11:22:15,498 WARNING celery.redirected 2016-08-17 11:22:15,497 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:22:15,499 WARNING celery.redirected 2016-08-17 11:22:15,498 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:22:15,499 WARNING celery.redirected 2016-08-17 11:22:15,499 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:22:15,503 WARNING celery.redirected 2016-08-17 11:22:15,502 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:22:15,503 WARNING celery.redirected 2016-08-17 11:22:15,503 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 22, 15, 500829), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 32, 15, 500829), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:22:15,506 WARNING celery.redirected 2016-08-17 11:22:15,506 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:22:15,508 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:22:15,515 INFO celery.worker.job Task schedule_start_lesson[b31bfff0-b948-4a8e-8732-1c53abb2fe1c] succeeded in 0.018986180999490898s: None
2016-08-17 11:23:09,999 INFO celery.worker.strategy Received task: schedule_clean_desktops[0e5cd9fa-feaa-44e2-b180-fa2b8d8f4649]
2016-08-17 11:23:10,001 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:23:10,003 WARNING celery.redirected 2016-08-17 11:23:10,003 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:23:10,004 WARNING celery.redirected 2016-08-17 11:23:10,004 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:23:10,004 WARNING celery.redirected 2016-08-17 11:23:10,004 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:23:10,008 WARNING celery.redirected 2016-08-17 11:23:10,007 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:23:10,008 WARNING celery.redirected 2016-08-17 11:23:10,008 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 22, 10, 2299), 'desktop_state_2': 'DELETED'}
2016-08-17 11:23:10,010 WARNING celery.redirected 2016-08-17 11:23:10,010 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:23:10,011 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:23:10,018 INFO celery.worker.job Task schedule_clean_desktops[0e5cd9fa-feaa-44e2-b180-fa2b8d8f4649] succeeded in 0.017612067000300158s: None
2016-08-17 11:23:14,785 INFO celery.worker.strategy Received task: schedule_start_lesson[8d1bfe28-c650-4b7c-acdc-423b425afdd3]
2016-08-17 11:23:14,787 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:23:14,787 INFO celery Scheduling start lesson tasks
2016-08-17 11:23:14,788 WARNING celery.redirected 2016-08-17 11:23:14,788 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:23:14,789 WARNING celery.redirected 2016-08-17 11:23:14,789 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:23:14,790 WARNING celery.redirected 2016-08-17 11:23:14,790 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:23:14,794 WARNING celery.redirected 2016-08-17 11:23:14,794 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:23:14,795 WARNING celery.redirected 2016-08-17 11:23:14,795 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 23, 14, 791986), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 33, 14, 791986), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:23:14,797 WARNING celery.redirected 2016-08-17 11:23:14,797 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:23:14,798 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:23:14,805 INFO celery.worker.job Task schedule_start_lesson[8d1bfe28-c650-4b7c-acdc-423b425afdd3] succeeded in 0.018167045000154758s: None
2016-08-17 11:24:10,098 INFO celery.worker.strategy Received task: schedule_clean_desktops[2902d973-3314-455d-8675-47e27aa32cb1]
2016-08-17 11:24:10,100 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:24:10,102 WARNING celery.redirected 2016-08-17 11:24:10,102 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:24:10,105 WARNING celery.redirected 2016-08-17 11:24:10,104 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:24:10,106 WARNING celery.redirected 2016-08-17 11:24:10,106 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:24:10,113 WARNING celery.redirected 2016-08-17 11:24:10,113 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:24:10,113 WARNING celery.redirected 2016-08-17 11:24:10,113 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 23, 10, 101657), 'desktop_state_2': 'DELETED'}
2016-08-17 11:24:10,115 WARNING celery.redirected 2016-08-17 11:24:10,115 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:24:10,117 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:24:10,129 INFO celery.worker.job Task schedule_clean_desktops[2902d973-3314-455d-8675-47e27aa32cb1] succeeded in 0.028572365999934846s: None
2016-08-17 11:24:15,053 INFO celery.worker.strategy Received task: schedule_start_lesson[c10beec8-7091-4ee8-abe2-8984776e9466]
2016-08-17 11:24:15,055 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:24:15,055 INFO celery Scheduling start lesson tasks
2016-08-17 11:24:15,056 WARNING celery.redirected 2016-08-17 11:24:15,056 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:24:15,057 WARNING celery.redirected 2016-08-17 11:24:15,057 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:24:15,057 WARNING celery.redirected 2016-08-17 11:24:15,057 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:24:15,062 WARNING celery.redirected 2016-08-17 11:24:15,062 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:24:15,063 WARNING celery.redirected 2016-08-17 11:24:15,063 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 24, 15, 59314), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 34, 15, 59314), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:24:15,066 WARNING celery.redirected 2016-08-17 11:24:15,066 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:24:15,067 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:24:15,074 INFO celery.worker.job Task schedule_start_lesson[c10beec8-7091-4ee8-abe2-8984776e9466] succeeded in 0.019198636000510305s: None
2016-08-17 11:25:10,553 INFO celery.worker.strategy Received task: schedule_clean_desktops[f0891811-7a61-4ece-91e3-19e5f78109c6]
2016-08-17 11:25:10,555 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:25:10,557 WARNING celery.redirected 2016-08-17 11:25:10,557 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:25:10,560 WARNING celery.redirected 2016-08-17 11:25:10,559 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:25:10,561 WARNING celery.redirected 2016-08-17 11:25:10,560 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:25:10,564 WARNING celery.redirected 2016-08-17 11:25:10,564 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:25:10,564 WARNING celery.redirected 2016-08-17 11:25:10,564 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 24, 10, 556392), 'desktop_state_2': 'DELETED'}
2016-08-17 11:25:10,568 WARNING celery.redirected 2016-08-17 11:25:10,567 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:25:10,571 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:25:10,581 INFO celery.worker.job Task schedule_clean_desktops[f0891811-7a61-4ece-91e3-19e5f78109c6] succeeded in 0.02601047899952391s: None
2016-08-17 11:25:15,418 INFO celery.worker.strategy Received task: schedule_start_lesson[bde663ad-f719-4792-bb19-fe4d9b998cd6]
2016-08-17 11:25:15,419 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:25:15,420 INFO celery Scheduling start lesson tasks
2016-08-17 11:25:15,421 WARNING celery.redirected 2016-08-17 11:25:15,421 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:25:15,422 WARNING celery.redirected 2016-08-17 11:25:15,422 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:25:15,422 WARNING celery.redirected 2016-08-17 11:25:15,422 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:25:15,428 WARNING celery.redirected 2016-08-17 11:25:15,428 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:25:15,429 WARNING celery.redirected 2016-08-17 11:25:15,428 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 25, 15, 424493), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 35, 15, 424493), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:25:15,431 WARNING celery.redirected 2016-08-17 11:25:15,431 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:25:15,434 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:25:15,442 INFO celery.worker.job Task schedule_start_lesson[bde663ad-f719-4792-bb19-fe4d9b998cd6] succeeded in 0.023048779000419017s: None
2016-08-17 11:26:10,744 INFO celery.worker.strategy Received task: schedule_clean_desktops[616ba8d3-e817-4698-bc16-f2276bc12237]
2016-08-17 11:26:10,747 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:26:10,749 WARNING celery.redirected 2016-08-17 11:26:10,749 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:26:10,751 WARNING celery.redirected 2016-08-17 11:26:10,751 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:26:10,752 WARNING celery.redirected 2016-08-17 11:26:10,752 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:26:10,762 WARNING celery.redirected 2016-08-17 11:26:10,762 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:26:10,763 WARNING celery.redirected 2016-08-17 11:26:10,763 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 25, 10, 748502), 'desktop_state_2': 'DELETED'}
2016-08-17 11:26:10,767 WARNING celery.redirected 2016-08-17 11:26:10,767 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:26:10,768 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:26:10,776 INFO celery.worker.job Task schedule_clean_desktops[616ba8d3-e817-4698-bc16-f2276bc12237] succeeded in 0.02953352399981668s: None
2016-08-17 11:26:20,428 INFO celery.worker.strategy Received task: schedule_start_lesson[bd5197ed-fd18-48ca-9fa0-4e9ab0e445f7]
2016-08-17 11:26:20,430 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:26:20,431 INFO celery Scheduling start lesson tasks
2016-08-17 11:26:20,433 WARNING celery.redirected 2016-08-17 11:26:20,433 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:26:20,435 WARNING celery.redirected 2016-08-17 11:26:20,435 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:26:20,436 WARNING celery.redirected 2016-08-17 11:26:20,436 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:26:20,442 WARNING celery.redirected 2016-08-17 11:26:20,441 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:26:20,442 WARNING celery.redirected 2016-08-17 11:26:20,442 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 26, 20, 438264), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 36, 20, 438264), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:26:20,445 WARNING celery.redirected 2016-08-17 11:26:20,445 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:26:20,446 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:26:20,453 INFO celery.worker.job Task schedule_start_lesson[bd5197ed-fd18-48ca-9fa0-4e9ab0e445f7] succeeded in 0.023309504000280867s: None
2016-08-17 11:27:14,888 INFO celery.worker.strategy Received task: schedule_clean_desktops[9aa34ec8-d4ac-41e7-8e54-d8acfb91b680]
2016-08-17 11:27:14,890 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:27:14,893 WARNING celery.redirected 2016-08-17 11:27:14,892 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:27:14,894 WARNING celery.redirected 2016-08-17 11:27:14,894 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:27:14,895 WARNING celery.redirected 2016-08-17 11:27:14,895 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:27:14,900 WARNING celery.redirected 2016-08-17 11:27:14,899 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:27:14,900 WARNING celery.redirected 2016-08-17 11:27:14,900 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 26, 14, 891755), 'desktop_state_2': 'DELETED'}
2016-08-17 11:27:14,902 WARNING celery.redirected 2016-08-17 11:27:14,902 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:27:14,903 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:27:14,912 INFO celery.worker.job Task schedule_clean_desktops[9aa34ec8-d4ac-41e7-8e54-d8acfb91b680] succeeded in 0.022180681999998342s: None
2016-08-17 11:27:26,096 INFO celery.worker.strategy Received task: schedule_start_lesson[d9158500-9e05-41f4-a5b7-b39a9a994c17]
2016-08-17 11:27:26,099 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:27:26,101 INFO celery Scheduling start lesson tasks
2016-08-17 11:27:26,107 WARNING celery.redirected 2016-08-17 11:27:26,106 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:27:26,110 WARNING celery.redirected 2016-08-17 11:27:26,110 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:27:26,111 WARNING celery.redirected 2016-08-17 11:27:26,110 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:27:26,126 WARNING celery.redirected 2016-08-17 11:27:26,126 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:27:26,127 WARNING celery.redirected 2016-08-17 11:27:26,127 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 27, 26, 112666), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 37, 26, 112666), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:27:26,130 WARNING celery.redirected 2016-08-17 11:27:26,130 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:27:26,131 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:27:26,148 INFO celery.worker.job Task schedule_start_lesson[d9158500-9e05-41f4-a5b7-b39a9a994c17] succeeded in 0.04903360699972836s: None
2016-08-17 11:28:15,228 INFO celery.worker.strategy Received task: schedule_clean_desktops[9f226027-8124-46cb-a904-f73b87154d96]
2016-08-17 11:28:15,229 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:28:15,231 WARNING celery.redirected 2016-08-17 11:28:15,231 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:28:15,232 WARNING celery.redirected 2016-08-17 11:28:15,232 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:28:15,233 WARNING celery.redirected 2016-08-17 11:28:15,233 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:28:15,236 WARNING celery.redirected 2016-08-17 11:28:15,236 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:28:15,237 WARNING celery.redirected 2016-08-17 11:28:15,237 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 27, 15, 230517), 'desktop_state_2': 'DELETED'}
2016-08-17 11:28:15,240 WARNING celery.redirected 2016-08-17 11:28:15,240 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:28:15,241 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:28:15,248 INFO celery.worker.job Task schedule_clean_desktops[9f226027-8124-46cb-a904-f73b87154d96] succeeded in 0.019077934999586432s: None
2016-08-17 11:28:26,186 INFO celery.worker.strategy Received task: schedule_start_lesson[32d4a997-9f46-4c98-bd43-39f96d3921d9]
2016-08-17 11:28:26,187 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:28:26,187 INFO celery Scheduling start lesson tasks
2016-08-17 11:28:26,189 WARNING celery.redirected 2016-08-17 11:28:26,189 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:28:26,190 WARNING celery.redirected 2016-08-17 11:28:26,190 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:28:26,191 WARNING celery.redirected 2016-08-17 11:28:26,191 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:28:26,198 WARNING celery.redirected 2016-08-17 11:28:26,198 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:28:26,199 WARNING celery.redirected 2016-08-17 11:28:26,199 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 28, 26, 193809), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 38, 26, 193809), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:28:26,201 WARNING celery.redirected 2016-08-17 11:28:26,201 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:28:26,202 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:28:26,209 INFO celery.worker.job Task schedule_start_lesson[32d4a997-9f46-4c98-bd43-39f96d3921d9] succeeded in 0.022159985000143934s: None
2016-08-17 11:29:16,236 INFO celery.worker.strategy Received task: schedule_clean_desktops[a4691855-97cf-49db-88cf-0d210f30a334]
2016-08-17 11:29:16,237 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:29:16,239 WARNING celery.redirected 2016-08-17 11:29:16,239 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:29:16,240 WARNING celery.redirected 2016-08-17 11:29:16,240 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:29:16,240 WARNING celery.redirected 2016-08-17 11:29:16,240 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:29:16,244 WARNING celery.redirected 2016-08-17 11:29:16,243 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:29:16,244 WARNING celery.redirected 2016-08-17 11:29:16,244 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 28, 16, 238653), 'desktop_state_2': 'DELETED'}
2016-08-17 11:29:16,249 WARNING celery.redirected 2016-08-17 11:29:16,249 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:29:16,251 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:29:16,257 INFO celery.worker.job Task schedule_clean_desktops[a4691855-97cf-49db-88cf-0d210f30a334] succeeded in 0.01935398499972507s: None
2016-08-17 11:29:25,964 INFO celery.worker.strategy Received task: schedule_start_lesson[ff697068-81e6-46b9-93b1-6e3f18c21726]
2016-08-17 11:29:25,966 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:29:25,966 INFO celery Scheduling start lesson tasks
2016-08-17 11:29:25,967 WARNING celery.redirected 2016-08-17 11:29:25,967 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:29:25,968 WARNING celery.redirected 2016-08-17 11:29:25,968 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:29:25,969 WARNING celery.redirected 2016-08-17 11:29:25,969 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:29:25,973 WARNING celery.redirected 2016-08-17 11:29:25,972 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:29:25,973 WARNING celery.redirected 2016-08-17 11:29:25,973 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 29, 25, 970823), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 39, 25, 970823), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:29:25,975 WARNING celery.redirected 2016-08-17 11:29:25,975 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:29:25,976 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:29:25,983 INFO celery.worker.job Task schedule_start_lesson[ff697068-81e6-46b9-93b1-6e3f18c21726] succeeded in 0.01743313300084992s: None
2016-08-17 11:30:15,974 INFO celery.worker.strategy Received task: schedule_clean_desktops[74094749-15fe-4ffe-85c9-bd9403c3b769]
2016-08-17 11:30:15,975 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:30:15,977 WARNING celery.redirected 2016-08-17 11:30:15,977 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:30:15,978 WARNING celery.redirected 2016-08-17 11:30:15,978 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:30:15,978 WARNING celery.redirected 2016-08-17 11:30:15,978 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:30:15,981 WARNING celery.redirected 2016-08-17 11:30:15,981 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:30:15,982 WARNING celery.redirected 2016-08-17 11:30:15,982 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 29, 15, 976336), 'desktop_state_2': 'DELETED'}
2016-08-17 11:30:15,984 WARNING celery.redirected 2016-08-17 11:30:15,984 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:30:15,985 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:30:15,992 INFO celery.worker.job Task schedule_clean_desktops[74094749-15fe-4ffe-85c9-bd9403c3b769] succeeded in 0.016839666000123543s: None
2016-08-17 11:30:25,609 INFO celery.worker.strategy Received task: schedule_start_lesson[78e576c0-ebcb-4fe4-95fa-d6ab74148f7c]
2016-08-17 11:30:25,610 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:30:25,611 INFO celery Scheduling start lesson tasks
2016-08-17 11:30:25,612 WARNING celery.redirected 2016-08-17 11:30:25,612 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:30:25,613 WARNING celery.redirected 2016-08-17 11:30:25,613 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:30:25,613 WARNING celery.redirected 2016-08-17 11:30:25,613 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:30:25,617 WARNING celery.redirected 2016-08-17 11:30:25,617 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:30:25,618 WARNING celery.redirected 2016-08-17 11:30:25,617 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 30, 25, 615257), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 40, 25, 615257), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:30:25,619 WARNING celery.redirected 2016-08-17 11:30:25,619 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:30:25,620 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:30:25,627 INFO celery.worker.job Task schedule_start_lesson[78e576c0-ebcb-4fe4-95fa-d6ab74148f7c] succeeded in 0.016998021000290464s: None
2016-08-17 11:31:15,463 INFO celery.worker.strategy Received task: schedule_clean_desktops[da29f47a-4477-4de0-8087-f7bb2a05f496]
2016-08-17 11:31:15,465 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:31:15,468 WARNING celery.redirected 2016-08-17 11:31:15,467 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:31:15,469 WARNING celery.redirected 2016-08-17 11:31:15,469 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:31:15,470 WARNING celery.redirected 2016-08-17 11:31:15,470 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:31:15,475 WARNING celery.redirected 2016-08-17 11:31:15,475 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:31:15,476 WARNING celery.redirected 2016-08-17 11:31:15,476 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 30, 15, 466519), 'desktop_state_2': 'DELETED'}
2016-08-17 11:31:15,478 WARNING celery.redirected 2016-08-17 11:31:15,478 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:31:15,480 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:31:15,490 INFO celery.worker.job Task schedule_clean_desktops[da29f47a-4477-4de0-8087-f7bb2a05f496] succeeded in 0.02576638800019282s: None
2016-08-17 11:31:25,639 INFO celery.worker.strategy Received task: schedule_start_lesson[eb29138a-5e49-4d6c-bc5c-83b91b9141e0]
2016-08-17 11:31:25,640 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:31:25,641 INFO celery Scheduling start lesson tasks
2016-08-17 11:31:25,643 WARNING celery.redirected 2016-08-17 11:31:25,642 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:31:25,644 WARNING celery.redirected 2016-08-17 11:31:25,644 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:31:25,645 WARNING celery.redirected 2016-08-17 11:31:25,645 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:31:25,651 WARNING celery.redirected 2016-08-17 11:31:25,651 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:31:25,652 WARNING celery.redirected 2016-08-17 11:31:25,652 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 31, 25, 647820), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 41, 25, 647820), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:31:25,654 WARNING celery.redirected 2016-08-17 11:31:25,654 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:31:25,656 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:31:25,669 INFO celery.worker.job Task schedule_start_lesson[eb29138a-5e49-4d6c-bc5c-83b91b9141e0] succeeded in 0.028737716000250657s: None
2016-08-17 11:32:16,581 INFO celery.worker.strategy Received task: schedule_clean_desktops[12ff546b-73f5-4591-bbaf-43a80854bb93]
2016-08-17 11:32:16,588 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:32:16,595 WARNING celery.redirected 2016-08-17 11:32:16,594 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:32:16,597 WARNING celery.redirected 2016-08-17 11:32:16,597 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:32:16,599 WARNING celery.redirected 2016-08-17 11:32:16,598 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:32:16,608 WARNING celery.redirected 2016-08-17 11:32:16,607 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:32:16,610 WARNING celery.redirected 2016-08-17 11:32:16,610 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 31, 16, 592214), 'desktop_state_2': 'DELETED'}
2016-08-17 11:32:16,616 WARNING celery.redirected 2016-08-17 11:32:16,616 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:32:16,619 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:32:16,629 INFO celery.worker.job Task schedule_clean_desktops[12ff546b-73f5-4591-bbaf-43a80854bb93] succeeded in 0.04163018300005206s: None
2016-08-17 11:32:26,583 INFO celery.worker.strategy Received task: schedule_start_lesson[70270f8a-5d1f-4d0c-9054-7d6fbd418946]
2016-08-17 11:32:26,585 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:32:26,586 INFO celery Scheduling start lesson tasks
2016-08-17 11:32:26,587 WARNING celery.redirected 2016-08-17 11:32:26,587 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:32:26,588 WARNING celery.redirected 2016-08-17 11:32:26,588 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:32:26,588 WARNING celery.redirected 2016-08-17 11:32:26,588 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:32:26,592 WARNING celery.redirected 2016-08-17 11:32:26,592 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:32:26,592 WARNING celery.redirected 2016-08-17 11:32:26,592 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 32, 26, 589882), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 42, 26, 589882), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:32:26,594 WARNING celery.redirected 2016-08-17 11:32:26,594 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:32:26,596 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:32:26,604 INFO celery.worker.job Task schedule_start_lesson[70270f8a-5d1f-4d0c-9054-7d6fbd418946] succeeded in 0.01864435900006356s: None
2016-08-17 11:33:16,568 INFO celery.worker.strategy Received task: schedule_clean_desktops[cb2ea3e1-90e0-497a-b547-16d1877c81e6]
2016-08-17 11:33:16,570 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:33:16,571 WARNING celery.redirected 2016-08-17 11:33:16,571 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:33:16,572 WARNING celery.redirected 2016-08-17 11:33:16,572 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:33:16,573 WARNING celery.redirected 2016-08-17 11:33:16,573 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:33:16,577 WARNING celery.redirected 2016-08-17 11:33:16,577 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:33:16,578 WARNING celery.redirected 2016-08-17 11:33:16,578 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 32, 16, 570948), 'desktop_state_2': 'DELETED'}
2016-08-17 11:33:16,581 WARNING celery.redirected 2016-08-17 11:33:16,581 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:33:16,583 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:33:16,603 INFO celery.worker.job Task schedule_clean_desktops[cb2ea3e1-90e0-497a-b547-16d1877c81e6] succeeded in 0.03331703200001357s: None
2016-08-17 11:33:31,270 INFO celery.worker.strategy Received task: schedule_start_lesson[ac51c082-33c7-48c5-bc44-87eda29ed484]
2016-08-17 11:33:31,272 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:33:31,273 INFO celery Scheduling start lesson tasks
2016-08-17 11:33:31,274 WARNING celery.redirected 2016-08-17 11:33:31,274 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:33:31,275 WARNING celery.redirected 2016-08-17 11:33:31,275 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:33:31,276 WARNING celery.redirected 2016-08-17 11:33:31,276 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:33:31,280 WARNING celery.redirected 2016-08-17 11:33:31,279 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:33:31,280 WARNING celery.redirected 2016-08-17 11:33:31,280 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 33, 31, 277712), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 43, 31, 277712), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:33:31,282 WARNING celery.redirected 2016-08-17 11:33:31,282 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:33:31,283 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:33:31,290 INFO celery.worker.job Task schedule_start_lesson[ac51c082-33c7-48c5-bc44-87eda29ed484] succeeded in 0.01812086999962048s: None
2016-08-17 11:34:21,053 INFO celery.worker.strategy Received task: schedule_clean_desktops[681acf3b-e35d-4556-ba43-52cd68a396b8]
2016-08-17 11:34:21,055 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:34:21,056 WARNING celery.redirected 2016-08-17 11:34:21,056 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:34:21,057 WARNING celery.redirected 2016-08-17 11:34:21,057 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:34:21,058 WARNING celery.redirected 2016-08-17 11:34:21,058 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:34:21,062 WARNING celery.redirected 2016-08-17 11:34:21,062 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:34:21,063 WARNING celery.redirected 2016-08-17 11:34:21,063 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 33, 21, 55786), 'desktop_state_2': 'DELETED'}
2016-08-17 11:34:21,065 WARNING celery.redirected 2016-08-17 11:34:21,065 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:34:21,066 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:34:21,073 INFO celery.worker.job Task schedule_clean_desktops[681acf3b-e35d-4556-ba43-52cd68a396b8] succeeded in 0.01815079500011052s: None
2016-08-17 11:34:36,832 INFO celery.worker.strategy Received task: schedule_start_lesson[31c85b9e-4491-46d0-9c73-ad0e8684d2e0]
2016-08-17 11:34:36,834 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:34:36,834 INFO celery Scheduling start lesson tasks
2016-08-17 11:34:36,835 WARNING celery.redirected 2016-08-17 11:34:36,835 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:34:36,836 WARNING celery.redirected 2016-08-17 11:34:36,836 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:34:36,836 WARNING celery.redirected 2016-08-17 11:34:36,836 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:34:36,840 WARNING celery.redirected 2016-08-17 11:34:36,840 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:34:36,840 WARNING celery.redirected 2016-08-17 11:34:36,840 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 34, 36, 838200), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 44, 36, 838200), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:34:36,843 WARNING celery.redirected 2016-08-17 11:34:36,843 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:34:36,844 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:34:36,851 INFO celery.worker.job Task schedule_start_lesson[31c85b9e-4491-46d0-9c73-ad0e8684d2e0] succeeded in 0.01721091699982935s: None
2016-08-17 11:35:26,236 INFO celery.worker.strategy Received task: schedule_clean_desktops[38c3f892-14b6-4140-aa59-a017f34dd892]
2016-08-17 11:35:26,238 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:35:26,240 WARNING celery.redirected 2016-08-17 11:35:26,239 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:35:26,241 WARNING celery.redirected 2016-08-17 11:35:26,241 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:35:26,242 WARNING celery.redirected 2016-08-17 11:35:26,242 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:35:26,248 WARNING celery.redirected 2016-08-17 11:35:26,247 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:35:26,249 WARNING celery.redirected 2016-08-17 11:35:26,248 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 34, 26, 239027), 'desktop_state_2': 'DELETED'}
2016-08-17 11:35:26,251 WARNING celery.redirected 2016-08-17 11:35:26,251 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:35:26,253 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:35:26,264 INFO celery.worker.job Task schedule_clean_desktops[38c3f892-14b6-4140-aa59-a017f34dd892] succeeded in 0.026432102000399027s: None
2016-08-17 11:35:40,905 INFO celery.worker.strategy Received task: schedule_start_lesson[8456cff5-89ea-4274-9f93-f0f8ba7ec8f0]
2016-08-17 11:35:40,906 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:35:40,907 INFO celery Scheduling start lesson tasks
2016-08-17 11:35:40,908 WARNING celery.redirected 2016-08-17 11:35:40,908 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:35:40,909 WARNING celery.redirected 2016-08-17 11:35:40,909 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:35:40,909 WARNING celery.redirected 2016-08-17 11:35:40,909 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:35:40,913 WARNING celery.redirected 2016-08-17 11:35:40,913 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:35:40,914 WARNING celery.redirected 2016-08-17 11:35:40,914 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 35, 40, 911195), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 45, 40, 911195), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:35:40,916 WARNING celery.redirected 2016-08-17 11:35:40,916 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:35:40,917 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:35:40,923 INFO celery.worker.job Task schedule_start_lesson[8456cff5-89ea-4274-9f93-f0f8ba7ec8f0] succeeded in 0.017158783999548177s: None
2016-08-17 11:36:31,655 INFO celery.worker.strategy Received task: schedule_clean_desktops[01b0e67f-a801-43b3-8cec-e29e588f1255]
2016-08-17 11:36:31,657 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:36:31,660 WARNING celery.redirected 2016-08-17 11:36:31,660 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:36:31,662 WARNING celery.redirected 2016-08-17 11:36:31,662 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:36:31,664 WARNING celery.redirected 2016-08-17 11:36:31,663 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:36:31,681 WARNING celery.redirected 2016-08-17 11:36:31,681 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:36:31,683 WARNING celery.redirected 2016-08-17 11:36:31,682 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 35, 31, 658927), 'desktop_state_2': 'DELETED'}
2016-08-17 11:36:31,690 WARNING celery.redirected 2016-08-17 11:36:31,689 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:36:31,691 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:36:31,719 INFO celery.worker.job Task schedule_clean_desktops[01b0e67f-a801-43b3-8cec-e29e588f1255] succeeded in 0.062347948999558866s: None
2016-08-17 11:36:46,565 INFO celery.worker.strategy Received task: schedule_start_lesson[eb7e7d50-0e8e-4ce7-b8ad-4573ca722f31]
2016-08-17 11:36:46,567 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:36:46,567 INFO celery Scheduling start lesson tasks
2016-08-17 11:36:46,568 WARNING celery.redirected 2016-08-17 11:36:46,568 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:36:46,569 WARNING celery.redirected 2016-08-17 11:36:46,569 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:36:46,570 WARNING celery.redirected 2016-08-17 11:36:46,570 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:36:46,574 WARNING celery.redirected 2016-08-17 11:36:46,573 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:36:46,575 WARNING celery.redirected 2016-08-17 11:36:46,574 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 36, 46, 571433), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 46, 46, 571433), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:36:46,576 WARNING celery.redirected 2016-08-17 11:36:46,576 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:36:46,577 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:36:46,586 INFO celery.worker.job Task schedule_start_lesson[eb7e7d50-0e8e-4ce7-b8ad-4573ca722f31] succeeded in 0.019729642000129388s: None
2016-08-17 11:37:36,236 INFO celery.worker.strategy Received task: schedule_clean_desktops[f56fdcc1-077a-45e4-b878-5cfb037b96a3]
2016-08-17 11:37:36,238 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:37:36,239 WARNING celery.redirected 2016-08-17 11:37:36,239 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:37:36,240 WARNING celery.redirected 2016-08-17 11:37:36,240 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:37:36,240 WARNING celery.redirected 2016-08-17 11:37:36,240 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:37:36,244 WARNING celery.redirected 2016-08-17 11:37:36,244 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:37:36,244 WARNING celery.redirected 2016-08-17 11:37:36,244 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 36, 36, 238684), 'desktop_state_2': 'DELETED'}
2016-08-17 11:37:36,246 WARNING celery.redirected 2016-08-17 11:37:36,246 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:37:36,248 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:37:36,254 INFO celery.worker.job Task schedule_clean_desktops[f56fdcc1-077a-45e4-b878-5cfb037b96a3] succeeded in 0.01695983000081469s: None
2016-08-17 11:37:51,974 INFO celery.worker.strategy Received task: schedule_start_lesson[3e0dc84a-3f80-42c7-a958-9fb1f66480d4]
2016-08-17 11:37:51,976 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:37:51,976 INFO celery Scheduling start lesson tasks
2016-08-17 11:37:51,977 WARNING celery.redirected 2016-08-17 11:37:51,977 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:37:51,978 WARNING celery.redirected 2016-08-17 11:37:51,978 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:37:51,979 WARNING celery.redirected 2016-08-17 11:37:51,979 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:37:51,984 WARNING celery.redirected 2016-08-17 11:37:51,984 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:37:51,985 WARNING celery.redirected 2016-08-17 11:37:51,985 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 37, 51, 980572), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 47, 51, 980572), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:37:51,987 WARNING celery.redirected 2016-08-17 11:37:51,987 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:37:51,988 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:37:51,999 INFO celery.worker.job Task schedule_start_lesson[3e0dc84a-3f80-42c7-a958-9fb1f66480d4] succeeded in 0.02316962499935471s: None
2016-08-17 11:38:41,077 INFO celery.worker.strategy Received task: schedule_clean_desktops[e47ebc21-0566-4777-84fc-ca60645386d6]
2016-08-17 11:38:41,080 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:38:41,083 WARNING celery.redirected 2016-08-17 11:38:41,082 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:38:41,084 WARNING celery.redirected 2016-08-17 11:38:41,084 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:38:41,085 WARNING celery.redirected 2016-08-17 11:38:41,085 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:38:41,089 WARNING celery.redirected 2016-08-17 11:38:41,089 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:38:41,090 WARNING celery.redirected 2016-08-17 11:38:41,089 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 37, 41, 81903), 'desktop_state_2': 'DELETED'}
2016-08-17 11:38:41,092 WARNING celery.redirected 2016-08-17 11:38:41,092 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:38:41,093 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:38:41,102 INFO celery.worker.job Task schedule_clean_desktops[e47ebc21-0566-4777-84fc-ca60645386d6] succeeded in 0.022885461000441865s: None
2016-08-17 11:38:52,119 INFO celery.worker.strategy Received task: schedule_start_lesson[7a589ea0-06ad-4a2f-aacf-818fec497079]
2016-08-17 11:38:52,121 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:38:52,122 INFO celery Scheduling start lesson tasks
2016-08-17 11:38:52,123 WARNING celery.redirected 2016-08-17 11:38:52,123 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:38:52,124 WARNING celery.redirected 2016-08-17 11:38:52,124 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:38:52,124 WARNING celery.redirected 2016-08-17 11:38:52,124 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:38:52,128 WARNING celery.redirected 2016-08-17 11:38:52,128 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:38:52,129 WARNING celery.redirected 2016-08-17 11:38:52,129 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 38, 52, 126035), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 48, 52, 126035), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:38:52,132 WARNING celery.redirected 2016-08-17 11:38:52,132 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:38:52,133 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:38:52,140 INFO celery.worker.job Task schedule_start_lesson[7a589ea0-06ad-4a2f-aacf-818fec497079] succeeded in 0.01876161600011983s: None
2016-08-17 11:39:41,991 INFO celery.worker.strategy Received task: schedule_clean_desktops[8779fcb2-8298-492e-8ccc-f566798bb72d]
2016-08-17 11:39:41,992 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:39:41,994 WARNING celery.redirected 2016-08-17 11:39:41,994 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:39:41,995 WARNING celery.redirected 2016-08-17 11:39:41,995 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:39:41,995 WARNING celery.redirected 2016-08-17 11:39:41,995 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:39:41,998 WARNING celery.redirected 2016-08-17 11:39:41,998 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:39:41,999 WARNING celery.redirected 2016-08-17 11:39:41,999 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 38, 41, 993411), 'desktop_state_2': 'DELETED'}
2016-08-17 11:39:42,001 WARNING celery.redirected 2016-08-17 11:39:42,001 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:39:42,002 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:39:42,011 INFO celery.worker.job Task schedule_clean_desktops[8779fcb2-8298-492e-8ccc-f566798bb72d] succeeded in 0.018526951000239933s: None
2016-08-17 11:39:51,596 INFO celery.worker.strategy Received task: schedule_start_lesson[41687eb6-c602-42b5-a65f-26d2bdf56101]
2016-08-17 11:39:51,598 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:39:51,598 INFO celery Scheduling start lesson tasks
2016-08-17 11:39:51,599 WARNING celery.redirected 2016-08-17 11:39:51,599 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:39:51,600 WARNING celery.redirected 2016-08-17 11:39:51,600 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:39:51,601 WARNING celery.redirected 2016-08-17 11:39:51,601 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:39:51,604 WARNING celery.redirected 2016-08-17 11:39:51,604 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:39:51,605 WARNING celery.redirected 2016-08-17 11:39:51,605 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 39, 51, 602554), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 49, 51, 602554), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:39:51,607 WARNING celery.redirected 2016-08-17 11:39:51,607 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:39:51,608 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:39:51,615 INFO celery.worker.job Task schedule_start_lesson[41687eb6-c602-42b5-a65f-26d2bdf56101] succeeded in 0.016963204000603582s: None
2016-08-17 11:40:41,371 INFO celery.worker.strategy Received task: schedule_clean_desktops[f52ecb6e-9e24-4b99-b1a1-c1ce9ef332db]
2016-08-17 11:40:41,380 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:40:41,384 WARNING celery.redirected 2016-08-17 11:40:41,384 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:40:41,385 WARNING celery.redirected 2016-08-17 11:40:41,385 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:40:41,386 WARNING celery.redirected 2016-08-17 11:40:41,386 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:40:41,391 WARNING celery.redirected 2016-08-17 11:40:41,391 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:40:41,392 WARNING celery.redirected 2016-08-17 11:40:41,392 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 39, 41, 381702), 'desktop_state_2': 'DELETED'}
2016-08-17 11:40:41,394 WARNING celery.redirected 2016-08-17 11:40:41,394 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:40:41,395 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:40:41,402 INFO celery.worker.job Task schedule_clean_desktops[f52ecb6e-9e24-4b99-b1a1-c1ce9ef332db] succeeded in 0.02246991300035006s: None
2016-08-17 11:40:51,175 INFO celery.worker.strategy Received task: schedule_start_lesson[850d29a1-f0bb-4a23-b6d8-ac3feb22dba1]
2016-08-17 11:40:51,176 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:40:51,177 INFO celery Scheduling start lesson tasks
2016-08-17 11:40:51,178 WARNING celery.redirected 2016-08-17 11:40:51,178 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:40:51,179 WARNING celery.redirected 2016-08-17 11:40:51,178 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:40:51,179 WARNING celery.redirected 2016-08-17 11:40:51,179 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:40:51,183 WARNING celery.redirected 2016-08-17 11:40:51,183 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:40:51,183 WARNING celery.redirected 2016-08-17 11:40:51,183 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 40, 51, 181092), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 50, 51, 181092), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:40:51,185 WARNING celery.redirected 2016-08-17 11:40:51,185 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:40:51,186 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:40:51,193 INFO celery.worker.job Task schedule_start_lesson[850d29a1-f0bb-4a23-b6d8-ac3feb22dba1] succeeded in 0.017100383999604674s: None
2016-08-17 11:41:42,208 INFO celery.worker.strategy Received task: schedule_clean_desktops[1aae9690-27ff-4142-9295-ef9a3d2fa222]
2016-08-17 11:41:42,210 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:41:42,218 WARNING celery.redirected 2016-08-17 11:41:42,217 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:41:42,226 WARNING celery.redirected 2016-08-17 11:41:42,224 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:41:42,232 WARNING celery.redirected 2016-08-17 11:41:42,231 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:41:42,299 WARNING celery.redirected 2016-08-17 11:41:42,298 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:41:42,305 WARNING celery.redirected 2016-08-17 11:41:42,304 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 40, 42, 213385), 'desktop_state_2': 'DELETED'}
2016-08-17 11:41:42,313 WARNING celery.redirected 2016-08-17 11:41:42,312 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:41:42,319 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:41:42,349 INFO celery.worker.job Task schedule_clean_desktops[1aae9690-27ff-4142-9295-ef9a3d2fa222] succeeded in 0.13923209399945335s: None
2016-08-17 11:41:52,018 INFO celery.worker.strategy Received task: schedule_start_lesson[f8d4fb1e-b74f-422c-9a3f-9bd704e7e954]
2016-08-17 11:41:52,020 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:41:52,020 INFO celery Scheduling start lesson tasks
2016-08-17 11:41:52,021 WARNING celery.redirected 2016-08-17 11:41:52,021 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:41:52,022 WARNING celery.redirected 2016-08-17 11:41:52,022 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:41:52,023 WARNING celery.redirected 2016-08-17 11:41:52,023 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:41:52,026 WARNING celery.redirected 2016-08-17 11:41:52,026 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:41:52,027 WARNING celery.redirected 2016-08-17 11:41:52,027 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 41, 52, 24410), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 51, 52, 24410), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:41:52,029 WARNING celery.redirected 2016-08-17 11:41:52,029 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:41:52,030 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:41:52,036 INFO celery.worker.job Task schedule_start_lesson[f8d4fb1e-b74f-422c-9a3f-9bd704e7e954] succeeded in 0.0167838479992497s: None
2016-08-17 11:42:41,651 INFO celery.worker.strategy Received task: schedule_clean_desktops[0c239c4c-084e-4a61-8df0-50765d86834b]
2016-08-17 11:42:41,652 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:42:41,653 WARNING celery.redirected 2016-08-17 11:42:41,653 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:42:41,654 WARNING celery.redirected 2016-08-17 11:42:41,654 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:42:41,655 WARNING celery.redirected 2016-08-17 11:42:41,655 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:42:41,658 WARNING celery.redirected 2016-08-17 11:42:41,658 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:42:41,659 WARNING celery.redirected 2016-08-17 11:42:41,659 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 41, 41, 653014), 'desktop_state_2': 'DELETED'}
2016-08-17 11:42:41,661 WARNING celery.redirected 2016-08-17 11:42:41,661 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:42:41,662 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:42:41,669 INFO celery.worker.job Task schedule_clean_desktops[0c239c4c-084e-4a61-8df0-50765d86834b] succeeded in 0.017315321999376465s: None
2016-08-17 11:42:51,286 INFO celery.worker.strategy Received task: schedule_start_lesson[39d92fd6-4b66-46ad-933c-5ba1b4d03b4d]
2016-08-17 11:42:51,288 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:42:51,288 INFO celery Scheduling start lesson tasks
2016-08-17 11:42:51,289 WARNING celery.redirected 2016-08-17 11:42:51,289 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:42:51,290 WARNING celery.redirected 2016-08-17 11:42:51,290 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:42:51,291 WARNING celery.redirected 2016-08-17 11:42:51,291 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:42:51,295 WARNING celery.redirected 2016-08-17 11:42:51,295 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:42:51,295 WARNING celery.redirected 2016-08-17 11:42:51,295 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 42, 51, 292815), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 52, 51, 292815), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:42:51,298 WARNING celery.redirected 2016-08-17 11:42:51,297 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:42:51,299 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:42:51,305 INFO celery.worker.job Task schedule_start_lesson[39d92fd6-4b66-46ad-933c-5ba1b4d03b4d] succeeded in 0.017576461999851745s: None
2016-08-17 11:43:42,296 INFO celery.worker.strategy Received task: schedule_clean_desktops[723ff21d-61ba-4c08-9d00-30b99215dd49]
2016-08-17 11:43:42,297 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:43:42,298 WARNING celery.redirected 2016-08-17 11:43:42,298 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:43:42,299 WARNING celery.redirected 2016-08-17 11:43:42,299 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:43:42,300 WARNING celery.redirected 2016-08-17 11:43:42,300 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:43:42,304 WARNING celery.redirected 2016-08-17 11:43:42,304 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:43:42,304 WARNING celery.redirected 2016-08-17 11:43:42,304 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 42, 42, 298065), 'desktop_state_2': 'DELETED'}
2016-08-17 11:43:42,307 WARNING celery.redirected 2016-08-17 11:43:42,307 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:43:42,308 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:43:42,316 INFO celery.worker.job Task schedule_clean_desktops[723ff21d-61ba-4c08-9d00-30b99215dd49] succeeded in 0.018843003999791108s: None
2016-08-17 11:43:51,895 INFO celery.worker.strategy Received task: schedule_start_lesson[b93d35cb-997a-40e7-85de-97115d1f809d]
2016-08-17 11:43:51,897 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:43:51,897 INFO celery Scheduling start lesson tasks
2016-08-17 11:43:51,899 WARNING celery.redirected 2016-08-17 11:43:51,898 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:43:51,901 WARNING celery.redirected 2016-08-17 11:43:51,900 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:43:51,901 WARNING celery.redirected 2016-08-17 11:43:51,901 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:43:51,908 WARNING celery.redirected 2016-08-17 11:43:51,908 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:43:51,909 WARNING celery.redirected 2016-08-17 11:43:51,909 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 43, 51, 904907), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 53, 51, 904907), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:43:51,911 WARNING celery.redirected 2016-08-17 11:43:51,911 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:43:51,912 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:43:51,919 INFO celery.worker.job Task schedule_start_lesson[b93d35cb-997a-40e7-85de-97115d1f809d] succeeded in 0.022695562999615504s: None
2016-08-17 11:44:41,819 INFO celery.worker.strategy Received task: schedule_clean_desktops[e2165286-d7f0-4bf8-a6b2-7fdf5e8a9bc6]
2016-08-17 11:44:41,820 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:44:41,822 WARNING celery.redirected 2016-08-17 11:44:41,822 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:44:41,823 WARNING celery.redirected 2016-08-17 11:44:41,823 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:44:41,823 WARNING celery.redirected 2016-08-17 11:44:41,823 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:44:41,826 WARNING celery.redirected 2016-08-17 11:44:41,826 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:44:41,827 WARNING celery.redirected 2016-08-17 11:44:41,827 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 43, 41, 821329), 'desktop_state_2': 'DELETED'}
2016-08-17 11:44:41,830 WARNING celery.redirected 2016-08-17 11:44:41,829 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:44:41,831 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:44:41,839 INFO celery.worker.job Task schedule_clean_desktops[e2165286-d7f0-4bf8-a6b2-7fdf5e8a9bc6] succeeded in 0.01853857300011441s: None
2016-08-17 11:44:51,460 INFO celery.worker.strategy Received task: schedule_start_lesson[f4d0c911-e171-4c4b-9649-cab6517d61a7]
2016-08-17 11:44:51,461 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:44:51,462 INFO celery Scheduling start lesson tasks
2016-08-17 11:44:51,463 WARNING celery.redirected 2016-08-17 11:44:51,462 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:44:51,464 WARNING celery.redirected 2016-08-17 11:44:51,463 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:44:51,464 WARNING celery.redirected 2016-08-17 11:44:51,464 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:44:51,468 WARNING celery.redirected 2016-08-17 11:44:51,468 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:44:51,469 WARNING celery.redirected 2016-08-17 11:44:51,468 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 44, 51, 466389), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 54, 51, 466389), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:44:51,471 WARNING celery.redirected 2016-08-17 11:44:51,471 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:44:51,472 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:44:51,479 INFO celery.worker.job Task schedule_start_lesson[f4d0c911-e171-4c4b-9649-cab6517d61a7] succeeded in 0.017579183000634657s: None
2016-08-17 11:45:42,549 INFO celery.worker.strategy Received task: schedule_clean_desktops[b11ee0d4-e96e-4ba9-bea1-bea0e425f284]
2016-08-17 11:45:42,552 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:45:42,555 WARNING celery.redirected 2016-08-17 11:45:42,555 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:45:42,557 WARNING celery.redirected 2016-08-17 11:45:42,557 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:45:42,558 WARNING celery.redirected 2016-08-17 11:45:42,558 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:45:42,562 WARNING celery.redirected 2016-08-17 11:45:42,562 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:45:42,564 WARNING celery.redirected 2016-08-17 11:45:42,564 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 44, 42, 553850), 'desktop_state_2': 'DELETED'}
2016-08-17 11:45:42,567 WARNING celery.redirected 2016-08-17 11:45:42,567 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:45:42,568 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:45:42,592 INFO celery.worker.job Task schedule_clean_desktops[b11ee0d4-e96e-4ba9-bea1-bea0e425f284] succeeded in 0.040288034000695916s: None
2016-08-17 11:45:52,209 INFO celery.worker.strategy Received task: schedule_start_lesson[a347de17-be34-4cf4-9007-7a5b90aa97b9]
2016-08-17 11:45:52,211 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:45:52,212 INFO celery Scheduling start lesson tasks
2016-08-17 11:45:52,212 WARNING celery.redirected 2016-08-17 11:45:52,212 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:45:52,213 WARNING celery.redirected 2016-08-17 11:45:52,213 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:45:52,214 WARNING celery.redirected 2016-08-17 11:45:52,214 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:45:52,219 WARNING celery.redirected 2016-08-17 11:45:52,219 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:45:52,220 WARNING celery.redirected 2016-08-17 11:45:52,220 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 45, 52, 216296), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 55, 52, 216296), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:45:52,221 WARNING celery.redirected 2016-08-17 11:45:52,221 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:45:52,223 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:45:52,229 INFO celery.worker.job Task schedule_start_lesson[a347de17-be34-4cf4-9007-7a5b90aa97b9] succeeded in 0.01866401900042547s: None
2016-08-17 11:46:41,615 INFO celery.worker.strategy Received task: schedule_clean_desktops[4f6217c3-6065-4cd8-8bcf-92f9cc117e76]
2016-08-17 11:46:41,617 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:46:41,618 WARNING celery.redirected 2016-08-17 11:46:41,618 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:46:41,619 WARNING celery.redirected 2016-08-17 11:46:41,619 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:46:41,619 WARNING celery.redirected 2016-08-17 11:46:41,619 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:46:41,623 WARNING celery.redirected 2016-08-17 11:46:41,623 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:46:41,624 WARNING celery.redirected 2016-08-17 11:46:41,624 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 45, 41, 617719), 'desktop_state_2': 'DELETED'}
2016-08-17 11:46:41,626 WARNING celery.redirected 2016-08-17 11:46:41,626 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:46:41,627 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:46:41,635 INFO celery.worker.job Task schedule_clean_desktops[4f6217c3-6065-4cd8-8bcf-92f9cc117e76] succeeded in 0.01857661899884988s: None
2016-08-17 11:46:52,645 INFO celery.worker.strategy Received task: schedule_start_lesson[6eb333e9-c153-4fd5-a575-c213790b2825]
2016-08-17 11:46:52,646 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:46:52,647 INFO celery Scheduling start lesson tasks
2016-08-17 11:46:52,648 WARNING celery.redirected 2016-08-17 11:46:52,648 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:46:52,649 WARNING celery.redirected 2016-08-17 11:46:52,648 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:46:52,649 WARNING celery.redirected 2016-08-17 11:46:52,649 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:46:52,653 WARNING celery.redirected 2016-08-17 11:46:52,653 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:46:52,654 WARNING celery.redirected 2016-08-17 11:46:52,653 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 46, 52, 650952), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 56, 52, 650952), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:46:52,656 WARNING celery.redirected 2016-08-17 11:46:52,656 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:46:52,658 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:46:52,664 INFO celery.worker.job Task schedule_start_lesson[6eb333e9-c153-4fd5-a575-c213790b2825] succeeded in 0.018354808000367484s: None
2016-08-17 11:47:42,598 INFO celery.worker.strategy Received task: schedule_clean_desktops[c8dd2e25-b5bb-4388-9f2f-2de4683f646d]
2016-08-17 11:47:42,599 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:47:42,601 WARNING celery.redirected 2016-08-17 11:47:42,600 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:47:42,601 WARNING celery.redirected 2016-08-17 11:47:42,601 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:47:42,602 WARNING celery.redirected 2016-08-17 11:47:42,602 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:47:42,606 WARNING celery.redirected 2016-08-17 11:47:42,606 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:47:42,607 WARNING celery.redirected 2016-08-17 11:47:42,607 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 46, 42, 600334), 'desktop_state_2': 'DELETED'}
2016-08-17 11:47:42,609 WARNING celery.redirected 2016-08-17 11:47:42,609 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:47:42,610 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:47:42,618 INFO celery.worker.job Task schedule_clean_desktops[c8dd2e25-b5bb-4388-9f2f-2de4683f646d] succeeded in 0.018526717998611275s: None
2016-08-17 11:47:52,362 INFO celery.worker.strategy Received task: schedule_start_lesson[2c04c46c-b60c-4b7e-8dd0-a0d32899de5c]
2016-08-17 11:47:52,363 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:47:52,364 INFO celery Scheduling start lesson tasks
2016-08-17 11:47:52,365 WARNING celery.redirected 2016-08-17 11:47:52,364 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:47:52,366 WARNING celery.redirected 2016-08-17 11:47:52,365 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:47:52,366 WARNING celery.redirected 2016-08-17 11:47:52,366 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:47:52,370 WARNING celery.redirected 2016-08-17 11:47:52,370 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:47:52,370 WARNING celery.redirected 2016-08-17 11:47:52,370 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 47, 52, 368046), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 57, 52, 368046), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:47:52,373 WARNING celery.redirected 2016-08-17 11:47:52,373 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:47:52,374 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:47:52,380 INFO celery.worker.job Task schedule_start_lesson[2c04c46c-b60c-4b7e-8dd0-a0d32899de5c] succeeded in 0.017458882999562775s: None
2016-08-17 11:48:42,554 INFO celery.worker.strategy Received task: schedule_clean_desktops[0b238e91-83c1-42dc-bc08-3d446ccb18f0]
2016-08-17 11:48:42,562 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:48:42,566 WARNING celery.redirected 2016-08-17 11:48:42,566 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:48:42,567 WARNING celery.redirected 2016-08-17 11:48:42,567 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:48:42,568 WARNING celery.redirected 2016-08-17 11:48:42,568 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:48:42,574 WARNING celery.redirected 2016-08-17 11:48:42,574 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:48:42,575 WARNING celery.redirected 2016-08-17 11:48:42,575 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 47, 42, 564174), 'desktop_state_2': 'DELETED'}
2016-08-17 11:48:42,580 WARNING celery.redirected 2016-08-17 11:48:42,580 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:48:42,594 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:48:42,621 INFO celery.worker.job Task schedule_clean_desktops[0b238e91-83c1-42dc-bc08-3d446ccb18f0] succeeded in 0.05970454899943434s: None
2016-08-17 11:48:57,303 INFO celery.worker.strategy Received task: schedule_start_lesson[f86b1c01-453d-4e4e-b626-77445a82a965]
2016-08-17 11:48:57,305 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:48:57,306 INFO celery Scheduling start lesson tasks
2016-08-17 11:48:57,307 WARNING celery.redirected 2016-08-17 11:48:57,307 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:48:57,308 WARNING celery.redirected 2016-08-17 11:48:57,308 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:48:57,309 WARNING celery.redirected 2016-08-17 11:48:57,308 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:48:57,312 WARNING celery.redirected 2016-08-17 11:48:57,312 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:48:57,313 WARNING celery.redirected 2016-08-17 11:48:57,313 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 48, 57, 310374), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(11, 58, 57, 310374), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:48:57,316 WARNING celery.redirected 2016-08-17 11:48:57,316 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:48:57,317 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:48:57,329 INFO celery.worker.job Task schedule_start_lesson[f86b1c01-453d-4e4e-b626-77445a82a965] succeeded in 0.023955553999257972s: None
2016-08-17 11:49:47,828 INFO celery.worker.strategy Received task: schedule_clean_desktops[7e8e1c64-497b-456f-943a-d4599b5b240d]
2016-08-17 11:49:47,829 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:49:47,831 WARNING celery.redirected 2016-08-17 11:49:47,831 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:49:47,832 WARNING celery.redirected 2016-08-17 11:49:47,832 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:49:47,832 WARNING celery.redirected 2016-08-17 11:49:47,832 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:49:47,836 WARNING celery.redirected 2016-08-17 11:49:47,836 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:49:47,837 WARNING celery.redirected 2016-08-17 11:49:47,837 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 48, 47, 830500), 'desktop_state_2': 'DELETED'}
2016-08-17 11:49:47,839 WARNING celery.redirected 2016-08-17 11:49:47,839 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:49:47,841 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:49:47,851 INFO celery.worker.job Task schedule_clean_desktops[7e8e1c64-497b-456f-943a-d4599b5b240d] succeeded in 0.02257405699856463s: None
2016-08-17 11:50:02,748 INFO celery.worker.strategy Received task: schedule_start_lesson[f9301d4f-113c-488c-8fc2-f36f6022497b]
2016-08-17 11:50:02,750 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:50:02,750 INFO celery Scheduling start lesson tasks
2016-08-17 11:50:02,751 WARNING celery.redirected 2016-08-17 11:50:02,751 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:50:02,752 WARNING celery.redirected 2016-08-17 11:50:02,752 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:50:02,753 WARNING celery.redirected 2016-08-17 11:50:02,753 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:50:02,756 WARNING celery.redirected 2016-08-17 11:50:02,756 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:50:02,757 WARNING celery.redirected 2016-08-17 11:50:02,757 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 50, 2, 754371), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 0, 2, 754371), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:50:02,759 WARNING celery.redirected 2016-08-17 11:50:02,759 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:50:02,760 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:50:02,767 INFO celery.worker.job Task schedule_start_lesson[f9301d4f-113c-488c-8fc2-f36f6022497b] succeeded in 0.017432382999686524s: None
2016-08-17 11:50:51,864 INFO celery.worker.strategy Received task: schedule_clean_desktops[87c73f3b-f04e-4620-907a-505627dea9f3]
2016-08-17 11:50:51,865 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:50:51,867 WARNING celery.redirected 2016-08-17 11:50:51,867 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:50:51,868 WARNING celery.redirected 2016-08-17 11:50:51,868 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:50:51,869 WARNING celery.redirected 2016-08-17 11:50:51,869 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:50:51,873 WARNING celery.redirected 2016-08-17 11:50:51,873 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:50:51,873 WARNING celery.redirected 2016-08-17 11:50:51,873 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 49, 51, 866640), 'desktop_state_2': 'DELETED'}
2016-08-17 11:50:51,875 WARNING celery.redirected 2016-08-17 11:50:51,875 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:50:51,877 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:50:51,884 INFO celery.worker.job Task schedule_clean_desktops[87c73f3b-f04e-4620-907a-505627dea9f3] succeeded in 0.018371660000411794s: None
2016-08-17 11:51:08,162 INFO celery.worker.strategy Received task: schedule_start_lesson[e5d2084c-9100-4d8e-9846-85891c624477]
2016-08-17 11:51:08,173 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:51:08,173 INFO celery Scheduling start lesson tasks
2016-08-17 11:51:08,175 WARNING celery.redirected 2016-08-17 11:51:08,175 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:08,177 WARNING celery.redirected 2016-08-17 11:51:08,176 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:08,177 WARNING celery.redirected 2016-08-17 11:51:08,177 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:51:08,185 WARNING celery.redirected 2016-08-17 11:51:08,185 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:51:08,186 WARNING celery.redirected 2016-08-17 11:51:08,186 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 51, 8, 180598), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 1, 8, 180598), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:51:08,190 WARNING celery.redirected 2016-08-17 11:51:08,190 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:08,192 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:51:08,208 INFO celery.worker.job Task schedule_start_lesson[e5d2084c-9100-4d8e-9846-85891c624477] succeeded in 0.03571063699928345s: None
2016-08-17 11:51:16,855 INFO celery.worker.strategy Received task: reboot_desktop[8ffe0815-7bb0-466d-b48d-1dba279d51ed] eta:[2016-08-17 03:51:16.953567+00:00]
2016-08-17 11:51:16,969 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:51:16,972 WARNING celery.redirected 2016-08-17 11:51:16,971 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:16,975 WARNING celery.redirected 2016-08-17 11:51:16,974 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:16,976 WARNING celery.redirected 2016-08-17 11:51:16,975 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:51:16,980 WARNING celery.redirected 2016-08-17 11:51:16,980 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:16,980 WARNING celery.redirected 2016-08-17 11:51:16,980 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:16,988 INFO celery Reboot desktop for <DesktopTask 6>
2016-08-17 11:51:16,992 WARNING celery.redirected 2016-08-17 11:51:16,992 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:16,993 WARNING celery.redirected 2016-08-17 11:51:16,993 INFO sqlalchemy.engine.base.Engine {'id_1': 2, 'param_1': 1}
2016-08-17 11:51:17,005 WARNING celery.redirected 2016-08-17 11:51:17,004 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:17,008 WARNING celery.redirected 2016-08-17 11:51:17,008 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:17,012 WARNING celery.redirected 2016-08-17 11:51:17,012 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:17,013 WARNING celery.redirected 2016-08-17 11:51:17,013 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:17,019 WARNING celery.redirected 2016-08-17 11:51:17,018 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:17,019 WARNING celery.redirected 2016-08-17 11:51:17,019 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'state': 'RUNNING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 17, 18590)}
2016-08-17 11:51:17,023 WARNING celery.redirected 2016-08-17 11:51:17,022 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:17,026 WARNING celery.redirected 2016-08-17 11:51:17,025 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:17,028 WARNING celery.redirected 2016-08-17 11:51:17,028 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(param_1)s
2016-08-17 11:51:17,029 WARNING celery.redirected 2016-08-17 11:51:17,029 INFO sqlalchemy.engine.base.Engine {'param_1': 2}
2016-08-17 11:51:17,381 WARNING celery.redirected 2016-08-17 11:51:17,381 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:17,382 WARNING celery.redirected 2016-08-17 11:51:17,382 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:17,386 WARNING celery.redirected 2016-08-17 11:51:17,385 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:17,386 WARNING celery.redirected 2016-08-17 11:51:17,386 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 17, 385702), 'context': '{"wait_timeout": 600, "detect_method": "PING", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "serial": "0", "detect_timeout": 30, "desktop": 2, "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9"}'}
2016-08-17 11:51:17,389 WARNING celery.redirected 2016-08-17 11:51:17,388 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:51:17,389 WARNING celery.redirected 2016-08-17 11:51:17,389 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 51, 17, 388613), 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 17, 388691), 'stage': 'REBOOT', 'task_id': 6, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "detect_method": "PING", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "serial": "0", "detect_timeout": 30, "desktop": 2, "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9"}'}
2016-08-17 11:51:17,391 WARNING celery.redirected 2016-08-17 11:51:17,391 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:17,393 WARNING celery.redirected 2016-08-17 11:51:17,393 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:17,394 WARNING celery.redirected 2016-08-17 11:51:17,394 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:17,395 WARNING celery.redirected 2016-08-17 11:51:17,394 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:17,397 WARNING celery.redirected 2016-08-17 11:51:17,397 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:17,398 WARNING celery.redirected 2016-08-17 11:51:17,398 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 17, 397184), 'stage': 'WAIT'}
2016-08-17 11:51:17,399 WARNING celery.redirected 2016-08-17 11:51:17,399 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:17,401 WARNING celery.redirected 2016-08-17 11:51:17,401 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:17,402 WARNING celery.redirected 2016-08-17 11:51:17,402 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:17,402 WARNING celery.redirected 2016-08-17 11:51:17,402 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:17,404 INFO celery Reboot desktop for <DesktopTask 6>, success
2016-08-17 11:51:17,404 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:51:17,405 WARNING celery.redirected 2016-08-17 11:51:17,405 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:17,546 INFO celery.worker.job Task reboot_desktop[8ffe0815-7bb0-466d-b48d-1dba279d51ed] succeeded in 0.5769078100001934s: None
2016-08-17 11:51:18,169 INFO celery.worker.strategy Received task: wait_desktop[72005141-ebae-44f4-a52e-dd9c8e31cba3] eta:[2016-08-17 03:51:20.418803+00:00]
2016-08-17 11:51:20,425 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:51:20,428 WARNING celery.redirected 2016-08-17 11:51:20,428 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:20,434 WARNING celery.redirected 2016-08-17 11:51:20,434 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:20,435 WARNING celery.redirected 2016-08-17 11:51:20,435 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:51:20,442 WARNING celery.redirected 2016-08-17 11:51:20,441 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:20,442 WARNING celery.redirected 2016-08-17 11:51:20,442 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:20,444 INFO celery Wait state for <DesktopTask 6>
2016-08-17 11:51:20,450 WARNING celery.redirected 2016-08-17 11:51:20,448 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:20,453 WARNING celery.redirected 2016-08-17 11:51:20,451 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 20, 448486), 'context': '{"wait_timeout": 600, "detect_method": "PING", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "serial": "0", "detect_timeout": 30, "desktop": 2, "wait_started_at": "2016-08-17T11:51:20.445759", "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9"}'}
2016-08-17 11:51:20,456 WARNING celery.redirected 2016-08-17 11:51:20,456 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:20,458 WARNING celery.redirected 2016-08-17 11:51:20,458 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:20,459 WARNING celery.redirected 2016-08-17 11:51:20,459 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:20,460 WARNING celery.redirected 2016-08-17 11:51:20,460 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:20,761 WARNING celery.redirected 2016-08-17 11:51:20,761 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:20,762 WARNING celery.redirected 2016-08-17 11:51:20,762 INFO sqlalchemy.engine.base.Engine {'id_1': 2, 'param_1': 1}
2016-08-17 11:51:20,766 WARNING celery.redirected 2016-08-17 11:51:20,766 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:20,768 WARNING celery.redirected 2016-08-17 11:51:20,768 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:20,769 WARNING celery.redirected 2016-08-17 11:51:20,769 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:20,770 WARNING celery.redirected 2016-08-17 11:51:20,770 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:20,771 INFO celery Wait state for <DesktopTask 6>, stage success
2016-08-17 11:51:20,774 WARNING celery.redirected 2016-08-17 11:51:20,773 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:51:20,774 WARNING celery.redirected 2016-08-17 11:51:20,774 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 51, 20, 773641), 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 20, 773714), 'stage': 'WAIT', 'task_id': 6, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "detect_method": "PING", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "serial": "0", "detect_timeout": 30, "desktop": 2, "wait_started_at": "2016-08-17T11:51:20.445759", "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9"}'}
2016-08-17 11:51:20,776 WARNING celery.redirected 2016-08-17 11:51:20,776 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:20,778 WARNING celery.redirected 2016-08-17 11:51:20,778 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:20,780 WARNING celery.redirected 2016-08-17 11:51:20,779 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:20,780 WARNING celery.redirected 2016-08-17 11:51:20,780 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:20,783 WARNING celery.redirected 2016-08-17 11:51:20,783 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:20,784 WARNING celery.redirected 2016-08-17 11:51:20,784 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 20, 783336), 'stage': 'DETECT'}
2016-08-17 11:51:20,785 WARNING celery.redirected 2016-08-17 11:51:20,785 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:20,786 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:51:20,908 INFO celery.worker.job Task wait_desktop[72005141-ebae-44f4-a52e-dd9c8e31cba3] succeeded in 0.4837926829986827s: None
2016-08-17 11:51:21,974 INFO celery.worker.strategy Received task: detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] eta:[2016-08-17 03:51:23.795951+00:00]
2016-08-17 11:51:23,802 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:51:23,804 WARNING celery.redirected 2016-08-17 11:51:23,804 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:23,805 WARNING celery.redirected 2016-08-17 11:51:23,805 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:23,806 WARNING celery.redirected 2016-08-17 11:51:23,806 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:51:23,809 WARNING celery.redirected 2016-08-17 11:51:23,809 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:23,810 WARNING celery.redirected 2016-08-17 11:51:23,810 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:23,811 INFO celery Detect for <DesktopTask 6>
2016-08-17 11:51:23,820 WARNING celery.redirected 2016-08-17 11:51:23,820 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:23,821 WARNING celery.redirected 2016-08-17 11:51:23,821 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 23, 820049), 'context': '{"wait_timeout": 600, "detect_method": "PING", "serial": "0", "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9", "detect_started_at": "2016-08-17T11:51:23.812344", "wait_started_at": "2016-08-17T11:51:20.445759", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "detect_timeout": 30, "desktop": 2}'}
2016-08-17 11:51:23,823 WARNING celery.redirected 2016-08-17 11:51:23,822 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:23,824 WARNING celery.redirected 2016-08-17 11:51:23,824 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:23,825 WARNING celery.redirected 2016-08-17 11:51:23,825 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:23,826 WARNING celery.redirected 2016-08-17 11:51:23,826 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:24,841 ERROR celery Detect(ping) for <DesktopTask 6>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140']' timed out after 1 seconds
2016-08-17 11:51:24,956 WARNING celery.redirected 2016-08-17 11:51:24,956 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:24,957 WARNING celery.redirected 2016-08-17 11:51:24,957 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 24, 956089), 'retries': 1}
2016-08-17 11:51:24,958 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:51:24,959 WARNING celery.redirected 2016-08-17 11:51:24,959 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:51:24,973 INFO celery.worker.job Task detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140'], 1)
2016-08-17 11:51:25,670 INFO celery.worker.strategy Received task: detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] eta:[2016-08-17 03:51:44.860659+00:00]
2016-08-17 11:51:44,864 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:51:44,866 WARNING celery.redirected 2016-08-17 11:51:44,866 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:44,868 WARNING celery.redirected 2016-08-17 11:51:44,868 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:44,869 WARNING celery.redirected 2016-08-17 11:51:44,869 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:51:44,873 WARNING celery.redirected 2016-08-17 11:51:44,872 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:44,873 WARNING celery.redirected 2016-08-17 11:51:44,873 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:44,875 INFO celery Detect for <DesktopTask 6>
2016-08-17 11:51:44,875 WARNING celery.redirected 2016-08-17 11:51:44,875 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:44,877 WARNING celery.redirected 2016-08-17 11:51:44,877 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:44,878 WARNING celery.redirected 2016-08-17 11:51:44,878 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:51:44,879 WARNING celery.redirected 2016-08-17 11:51:44,879 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:51:45,885 ERROR celery Detect(ping) for <DesktopTask 6>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140']' timed out after 1 seconds
2016-08-17 11:51:45,994 WARNING celery.redirected 2016-08-17 11:51:45,994 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:51:45,995 WARNING celery.redirected 2016-08-17 11:51:45,995 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 51, 45, 994459), 'retries': 1}
2016-08-17 11:51:45,997 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:51:45,997 WARNING celery.redirected 2016-08-17 11:51:45,997 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:51:46,006 INFO celery.worker.job Task detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140'], 1)
2016-08-17 11:51:46,394 INFO celery.worker.strategy Received task: detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] eta:[2016-08-17 03:52:05.899604+00:00]
2016-08-17 11:51:57,269 INFO celery.worker.strategy Received task: schedule_clean_desktops[901290a8-f6fc-4b3b-b6f8-85e6b86d8c89]
2016-08-17 11:51:57,271 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:51:57,272 WARNING celery.redirected 2016-08-17 11:51:57,272 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:51:57,273 WARNING celery.redirected 2016-08-17 11:51:57,273 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:51:57,274 WARNING celery.redirected 2016-08-17 11:51:57,274 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:51:57,277 WARNING celery.redirected 2016-08-17 11:51:57,277 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:51:57,278 WARNING celery.redirected 2016-08-17 11:51:57,277 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 50, 57, 272041), 'desktop_state_2': 'DELETED'}
2016-08-17 11:51:57,280 WARNING celery.redirected 2016-08-17 11:51:57,279 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:51:57,281 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:51:57,287 INFO celery.worker.job Task schedule_clean_desktops[901290a8-f6fc-4b3b-b6f8-85e6b86d8c89] succeeded in 0.01682549600081984s: None
2016-08-17 11:52:05,902 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:52:05,904 WARNING celery.redirected 2016-08-17 11:52:05,904 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:05,906 WARNING celery.redirected 2016-08-17 11:52:05,905 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:05,906 WARNING celery.redirected 2016-08-17 11:52:05,906 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:52:05,909 WARNING celery.redirected 2016-08-17 11:52:05,909 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:05,909 WARNING celery.redirected 2016-08-17 11:52:05,909 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:05,911 INFO celery Detect for <DesktopTask 6>
2016-08-17 11:52:05,912 WARNING celery.redirected 2016-08-17 11:52:05,912 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:05,913 WARNING celery.redirected 2016-08-17 11:52:05,913 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:05,915 WARNING celery.redirected 2016-08-17 11:52:05,914 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:05,915 WARNING celery.redirected 2016-08-17 11:52:05,915 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:06,922 ERROR celery Detect(ping) for <DesktopTask 6>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140']' timed out after 1 seconds
2016-08-17 11:52:07,015 WARNING celery.redirected 2016-08-17 11:52:07,015 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:52:07,016 WARNING celery.redirected 2016-08-17 11:52:07,016 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'updated_at': datetime.datetime(2016, 8, 17, 11, 52, 7, 15222), 'retries': 1}
2016-08-17 11:52:07,018 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:52:07,019 WARNING celery.redirected 2016-08-17 11:52:07,018 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:52:07,021 INFO celery.worker.strategy Received task: detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] eta:[2016-08-17 03:52:26.924818+00:00]
2016-08-17 11:52:07,029 INFO celery.worker.job Task detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.140'], 1)
2016-08-17 11:52:08,231 INFO celery.worker.strategy Received task: schedule_start_lesson[0feed573-a8c6-41d3-b71c-9fcd8e0f7cf0]
2016-08-17 11:52:08,232 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:52:08,233 INFO celery Scheduling start lesson tasks
2016-08-17 11:52:08,234 WARNING celery.redirected 2016-08-17 11:52:08,233 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:08,235 WARNING celery.redirected 2016-08-17 11:52:08,234 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:08,235 WARNING celery.redirected 2016-08-17 11:52:08,235 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:52:08,242 WARNING celery.redirected 2016-08-17 11:52:08,242 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:52:08,244 WARNING celery.redirected 2016-08-17 11:52:08,243 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 52, 8, 237071), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 2, 8, 237071), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:52:08,247 WARNING celery.redirected 2016-08-17 11:52:08,247 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:08,248 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:52:08,255 INFO celery.worker.job Task schedule_start_lesson[0feed573-a8c6-41d3-b71c-9fcd8e0f7cf0] succeeded in 0.02320570999836491s: None
2016-08-17 11:52:26,929 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:52:26,930 WARNING celery.redirected 2016-08-17 11:52:26,930 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:26,932 WARNING celery.redirected 2016-08-17 11:52:26,932 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:26,932 WARNING celery.redirected 2016-08-17 11:52:26,932 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:52:26,935 WARNING celery.redirected 2016-08-17 11:52:26,935 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:26,936 WARNING celery.redirected 2016-08-17 11:52:26,936 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:26,938 INFO celery Detect for <DesktopTask 6>
2016-08-17 11:52:26,939 WARNING celery.redirected 2016-08-17 11:52:26,939 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:26,941 WARNING celery.redirected 2016-08-17 11:52:26,940 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:26,942 WARNING celery.redirected 2016-08-17 11:52:26,942 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:26,942 WARNING celery.redirected 2016-08-17 11:52:26,942 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:26,951 INFO celery Detect for <DesktopTask 6>, success
2016-08-17 11:52:26,956 WARNING celery.redirected 2016-08-17 11:52:26,956 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:52:26,957 WARNING celery.redirected 2016-08-17 11:52:26,956 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 52, 26, 955675), 'updated_at': datetime.datetime(2016, 8, 17, 11, 52, 26, 955761), 'stage': 'DETECT', 'task_id': 6, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "detect_method": "PING", "serial": "0", "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9", "detect_started_at": "2016-08-17T11:51:23.812344", "wait_started_at": "2016-08-17T11:51:20.445759", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": "teacher-lll", "floating_ip": "172.18.231.140", "detect_timeout": 30, "desktop": 2}'}
2016-08-17 11:52:26,959 WARNING celery.redirected 2016-08-17 11:52:26,958 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:26,962 WARNING celery.redirected 2016-08-17 11:52:26,961 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:26,963 WARNING celery.redirected 2016-08-17 11:52:26,963 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:26,963 WARNING celery.redirected 2016-08-17 11:52:26,963 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:26,967 WARNING celery.redirected 2016-08-17 11:52:26,966 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:52:26,967 WARNING celery.redirected 2016-08-17 11:52:26,967 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 6, 'state': 'FINISHED', 'updated_at': datetime.datetime(2016, 8, 17, 11, 52, 26, 966801), 'result': 'SUCCESS'}
2016-08-17 11:52:26,969 WARNING celery.redirected 2016-08-17 11:52:26,969 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:26,971 WARNING celery.redirected 2016-08-17 11:52:26,971 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:26,972 WARNING celery.redirected 2016-08-17 11:52:26,972 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:26,973 WARNING celery.redirected 2016-08-17 11:52:26,973 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:26,978 WARNING celery.redirected 2016-08-17 11:52:26,978 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:26,978 WARNING celery.redirected 2016-08-17 11:52:26,978 INFO sqlalchemy.engine.base.Engine {'id_1': 2, 'param_1': 1}
2016-08-17 11:52:26,982 WARNING celery.redirected 2016-08-17 11:52:26,982 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:52:26,982 WARNING celery.redirected 2016-08-17 11:52:26,982 INFO sqlalchemy.engine.base.Engine {'desktops_id': 2, 'updated_at': datetime.datetime(2016, 8, 17, 11, 52, 26, 982118), 'desktop_state': 'ACTIVE'}
2016-08-17 11:52:26,984 WARNING celery.redirected 2016-08-17 11:52:26,984 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:26,986 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:52:27,001 INFO celery.worker.job Task detect_floating[ce3d852d-82dc-4ba4-b5ab-756ae3659990] succeeded in 0.07214055200165603s: None
2016-08-17 11:52:27,645 INFO celery.worker.strategy Received task: set_desktop_state[f3a80945-6586-4931-965e-7cb55307ee4e]
2016-08-17 11:52:27,646 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:52:27,648 WARNING celery.redirected 2016-08-17 11:52:27,648 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:27,649 WARNING celery.redirected 2016-08-17 11:52:27,649 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:27,650 WARNING celery.redirected 2016-08-17 11:52:27,650 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:52:27,653 WARNING celery.redirected 2016-08-17 11:52:27,653 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:52:27,654 WARNING celery.redirected 2016-08-17 11:52:27,653 INFO sqlalchemy.engine.base.Engine {'param_1': 6}
2016-08-17 11:52:27,657 WARNING celery.redirected 2016-08-17 11:52:27,656 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:27,657 WARNING celery.redirected 2016-08-17 11:52:27,657 INFO sqlalchemy.engine.base.Engine {'id_1': 2, 'param_1': 1}
2016-08-17 11:52:27,660 WARNING celery.redirected 2016-08-17 11:52:27,660 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:27,661 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:52:27,808 INFO celery.worker.job Task set_desktop_state[f3a80945-6586-4931-965e-7cb55307ee4e] succeeded in 0.16199199900074746s: None
2016-08-17 11:52:28,867 INFO celery.worker.strategy Received task: _create_desktop_detect[d9f94de7-17bb-4828-8aa9-aab42e1d65a7]
2016-08-17 11:52:28,869 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:52:28,871 WARNING celery.redirected 2016-08-17 11:52:28,870 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:28,872 WARNING celery.redirected 2016-08-17 11:52:28,872 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:28,873 WARNING celery.redirected 2016-08-17 11:52:28,873 INFO sqlalchemy.engine.base.Engine {'id_1': 6, 'param_1': 1}
2016-08-17 11:52:28,875 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:52:28,875 WARNING celery.redirected 2016-08-17 11:52:28,875 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:28,883 INFO celery.worker.job Task _create_desktop_detect[d9f94de7-17bb-4828-8aa9-aab42e1d65a7] succeeded in 0.014694655999846873s: None
2016-08-17 11:52:57,276 INFO celery.worker.strategy Received task: schedule_clean_desktops[bbd40624-d4a9-4b23-bd32-eff6c89fa9ff]
2016-08-17 11:52:57,278 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:52:57,279 WARNING celery.redirected 2016-08-17 11:52:57,279 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:52:57,280 WARNING celery.redirected 2016-08-17 11:52:57,280 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:52:57,281 WARNING celery.redirected 2016-08-17 11:52:57,281 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:52:57,284 WARNING celery.redirected 2016-08-17 11:52:57,284 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:52:57,285 WARNING celery.redirected 2016-08-17 11:52:57,285 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 51, 57, 278851), 'desktop_state_2': 'DELETED'}
2016-08-17 11:52:57,287 WARNING celery.redirected 2016-08-17 11:52:57,287 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:52:57,288 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:52:57,297 INFO celery.worker.job Task schedule_clean_desktops[bbd40624-d4a9-4b23-bd32-eff6c89fa9ff] succeeded in 0.019418118999965372s: None
2016-08-17 11:53:08,417 INFO celery.worker.strategy Received task: schedule_start_lesson[1ca7f30f-f149-4e24-90c1-71dcc47a3871]
2016-08-17 11:53:08,419 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:53:08,419 INFO celery Scheduling start lesson tasks
2016-08-17 11:53:08,421 WARNING celery.redirected 2016-08-17 11:53:08,420 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:53:08,422 WARNING celery.redirected 2016-08-17 11:53:08,422 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:53:08,422 WARNING celery.redirected 2016-08-17 11:53:08,422 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:53:08,427 WARNING celery.redirected 2016-08-17 11:53:08,426 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:53:08,428 WARNING celery.redirected 2016-08-17 11:53:08,427 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 53, 8, 424365), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 3, 8, 424365), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:53:08,430 WARNING celery.redirected 2016-08-17 11:53:08,430 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:53:08,431 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:53:08,439 INFO celery.worker.job Task schedule_start_lesson[1ca7f30f-f149-4e24-90c1-71dcc47a3871] succeeded in 0.019931183000153396s: None
2016-08-17 11:53:58,290 INFO celery.worker.strategy Received task: schedule_clean_desktops[57a2e790-99f4-48f2-b278-a82c6acf6560]
2016-08-17 11:53:58,293 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:53:58,295 WARNING celery.redirected 2016-08-17 11:53:58,294 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:53:58,296 WARNING celery.redirected 2016-08-17 11:53:58,295 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:53:58,296 WARNING celery.redirected 2016-08-17 11:53:58,296 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:53:58,299 WARNING celery.redirected 2016-08-17 11:53:58,299 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:53:58,300 WARNING celery.redirected 2016-08-17 11:53:58,300 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 52, 58, 293994), 'desktop_state_2': 'DELETED'}
2016-08-17 11:53:58,303 WARNING celery.redirected 2016-08-17 11:53:58,303 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:53:58,305 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:53:58,314 INFO celery.worker.job Task schedule_clean_desktops[57a2e790-99f4-48f2-b278-a82c6acf6560] succeeded in 0.021505089998754556s: None
2016-08-17 11:54:08,192 INFO celery.worker.strategy Received task: schedule_start_lesson[9a33fd2b-2b5a-44e7-be2d-36a3c9ca9063]
2016-08-17 11:54:08,194 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:54:08,194 INFO celery Scheduling start lesson tasks
2016-08-17 11:54:08,195 WARNING celery.redirected 2016-08-17 11:54:08,195 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:54:08,196 WARNING celery.redirected 2016-08-17 11:54:08,196 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:54:08,197 WARNING celery.redirected 2016-08-17 11:54:08,197 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:54:08,201 WARNING celery.redirected 2016-08-17 11:54:08,201 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:54:08,202 WARNING celery.redirected 2016-08-17 11:54:08,202 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 54, 8, 198527), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 4, 8, 198527), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:54:08,208 WARNING celery.redirected 2016-08-17 11:54:08,207 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:54:08,210 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:54:08,217 INFO celery.worker.job Task schedule_start_lesson[9a33fd2b-2b5a-44e7-be2d-36a3c9ca9063] succeeded in 0.0232830479999393s: None
2016-08-17 11:54:57,489 INFO celery.worker.strategy Received task: schedule_clean_desktops[a86f4c0c-6834-4e46-976c-ab1d857a6e3f]
2016-08-17 11:54:57,491 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:54:57,495 WARNING celery.redirected 2016-08-17 11:54:57,494 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:54:57,496 WARNING celery.redirected 2016-08-17 11:54:57,496 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:54:57,497 WARNING celery.redirected 2016-08-17 11:54:57,497 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:54:57,501 WARNING celery.redirected 2016-08-17 11:54:57,501 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:54:57,502 WARNING celery.redirected 2016-08-17 11:54:57,502 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 53, 57, 493946), 'desktop_state_2': 'DELETED'}
2016-08-17 11:54:57,505 WARNING celery.redirected 2016-08-17 11:54:57,505 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:54:57,506 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:54:57,518 INFO celery.worker.job Task schedule_clean_desktops[a86f4c0c-6834-4e46-976c-ab1d857a6e3f] succeeded in 0.026728613998784567s: None
2016-08-17 11:55:07,456 INFO celery.worker.strategy Received task: schedule_start_lesson[b2a52de8-6529-4479-a7d2-67ea17c49381]
2016-08-17 11:55:07,458 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:55:07,459 INFO celery Scheduling start lesson tasks
2016-08-17 11:55:07,460 WARNING celery.redirected 2016-08-17 11:55:07,460 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:07,463 WARNING celery.redirected 2016-08-17 11:55:07,462 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:07,463 WARNING celery.redirected 2016-08-17 11:55:07,463 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:55:07,468 WARNING celery.redirected 2016-08-17 11:55:07,468 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:55:07,469 WARNING celery.redirected 2016-08-17 11:55:07,469 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 55, 7, 466537), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 5, 7, 466537), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:55:07,471 WARNING celery.redirected 2016-08-17 11:55:07,471 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:07,472 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:55:07,479 INFO celery.worker.job Task schedule_start_lesson[b2a52de8-6529-4479-a7d2-67ea17c49381] succeeded in 0.02072464199954993s: None
2016-08-17 11:55:53,778 INFO celery.worker.strategy Received task: build_desktop[aa988df3-e491-4da4-b2e6-31c1a6935598] eta:[2016-08-17 03:55:53.985667+00:00]
2016-08-17 11:55:53,990 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:55:53,992 WARNING celery.redirected 2016-08-17 11:55:53,992 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:53,993 WARNING celery.redirected 2016-08-17 11:55:53,993 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:53,994 WARNING celery.redirected 2016-08-17 11:55:53,994 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:55:53,995 INFO celery Build desktop for <DesktopTask 7>
2016-08-17 11:55:53,998 WARNING celery.redirected 2016-08-17 11:55:53,997 INFO sqlalchemy.engine.base.Engine SELECT courses.id AS courses_id, courses.created_at AS courses_created_at, courses.updated_at AS courses_updated_at, courses.name AS courses_name, courses.start_date AS courses_start_date, courses.end_date AS courses_end_date, courses.capacity AS courses_capacity, courses.image_ref AS courses_image_ref, courses.flavor_ref AS courses_flavor_ref, courses.network_ref AS courses_network_ref, courses.protocol AS courses_protocol, courses.owner_id AS courses_owner_id 
FROM courses 
WHERE courses.id IS NULL 
 LIMIT %(param_1)s
2016-08-17 11:55:53,998 WARNING celery.redirected 2016-08-17 11:55:53,998 INFO sqlalchemy.engine.base.Engine {'param_1': 1}
2016-08-17 11:55:54,117 WARNING celery.redirected 2016-08-17 11:55:54,117 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:54,118 WARNING celery.redirected 2016-08-17 11:55:54,118 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:55:54,121 WARNING celery.redirected 2016-08-17 11:55:54,121 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:55:54,121 WARNING celery.redirected 2016-08-17 11:55:54,121 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'state': 'RUNNING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 54, 121095)}
2016-08-17 11:55:54,127 WARNING celery.redirected 2016-08-17 11:55:54,127 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:54,130 WARNING celery.redirected 2016-08-17 11:55:54,130 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:54,135 WARNING celery.redirected 2016-08-17 11:55:54,134 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:55:54,136 WARNING celery.redirected 2016-08-17 11:55:54,136 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:55:54,139 WARNING celery.redirected 2016-08-17 11:55:54,139 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(param_1)s
2016-08-17 11:55:54,140 WARNING celery.redirected 2016-08-17 11:55:54,139 INFO sqlalchemy.engine.base.Engine {'param_1': 3}
2016-08-17 11:55:54,145 WARNING celery.redirected 2016-08-17 11:55:54,145 INFO sqlalchemy.engine.base.Engine SELECT users.id AS users_id, users.username AS users_username, users.fullname AS users_fullname, users.email AS users_email, users.is_active AS users_is_active, users.is_device AS users_is_device, users.role_id AS users_role_id, users.password_hash AS users_password_hash, users.confirmed AS users_confirmed 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:54,146 WARNING celery.redirected 2016-08-17 11:55:54,146 INFO sqlalchemy.engine.base.Engine {'id_1': 1, 'param_1': 1}
2016-08-17 11:55:54,423 WARNING celery.redirected 2016-08-17 11:55:54,423 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_ref=%(vm_ref)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:55:54,424 WARNING celery.redirected 2016-08-17 11:55:54,424 INFO sqlalchemy.engine.base.Engine {'desktops_id': 3, 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 54, 423420), 'vm_ref': '7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc'}
2016-08-17 11:55:54,426 WARNING celery.redirected 2016-08-17 11:55:54,426 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:55:54,426 WARNING celery.redirected 2016-08-17 11:55:54,426 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 54, 425864), 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "detect_method": "PING", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:55:52.943232", "disk": null, "desktop_type": "STATIC", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "end_datetime": "3016-01-01T00:00:00.000001", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_timeout": 30, "desktop": 3, "subnet": null, "course": null, "owner": 1}'}
2016-08-17 11:55:54,429 WARNING celery.redirected 2016-08-17 11:55:54,429 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:55:54,429 WARNING celery.redirected 2016-08-17 11:55:54,429 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 55, 54, 428877), 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 54, 428951), 'stage': 'BUILD', 'task_id': 7, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "detect_method": "PING", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:55:52.943232", "disk": null, "desktop_type": "STATIC", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "end_datetime": "3016-01-01T00:00:00.000001", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_timeout": 30, "desktop": 3, "subnet": null, "course": null, "owner": 1}'}
2016-08-17 11:55:54,431 WARNING celery.redirected 2016-08-17 11:55:54,431 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:54,435 WARNING celery.redirected 2016-08-17 11:55:54,434 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:54,436 WARNING celery.redirected 2016-08-17 11:55:54,435 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:55:54,436 WARNING celery.redirected 2016-08-17 11:55:54,436 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:55:54,439 WARNING celery.redirected 2016-08-17 11:55:54,439 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:55:54,440 WARNING celery.redirected 2016-08-17 11:55:54,440 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 54, 439154), 'stage': 'WAIT'}
2016-08-17 11:55:54,443 WARNING celery.redirected 2016-08-17 11:55:54,442 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:54,447 WARNING celery.redirected 2016-08-17 11:55:54,446 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:54,449 WARNING celery.redirected 2016-08-17 11:55:54,449 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:55:54,450 WARNING celery.redirected 2016-08-17 11:55:54,450 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:55:54,451 INFO celery Build desktop for <DesktopTask 7>, success
2016-08-17 11:55:54,452 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:55:54,452 WARNING celery.redirected 2016-08-17 11:55:54,452 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:54,474 INFO celery.worker.job Task build_desktop[aa988df3-e491-4da4-b2e6-31c1a6935598] succeeded in 0.4838510090012278s: None
2016-08-17 11:55:55,052 INFO celery.worker.strategy Received task: wait_desktop[6faf838d-e395-448e-96b9-7309893dd530] eta:[2016-08-17 03:55:57.454439+00:00]
2016-08-17 11:55:57,460 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:55:57,462 WARNING celery.redirected 2016-08-17 11:55:57,461 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:57,463 WARNING celery.redirected 2016-08-17 11:55:57,463 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:57,464 WARNING celery.redirected 2016-08-17 11:55:57,464 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:55:57,467 WARNING celery.redirected 2016-08-17 11:55:57,466 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:55:57,467 WARNING celery.redirected 2016-08-17 11:55:57,467 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:55:57,470 INFO celery Wait state for <DesktopTask 7>
2016-08-17 11:55:57,472 WARNING celery.redirected 2016-08-17 11:55:57,472 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:55:57,472 WARNING celery.redirected 2016-08-17 11:55:57,472 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 57, 472113), 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_method": "PING", "subnet": null, "wait_started_at": "2016-08-17T11:55:57.471430", "detect_timeout": 30, "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:55:52.943232", "disk": null, "desktop_type": "STATIC", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "desktop": 3, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "owner": 1}'}
2016-08-17 11:55:57,474 WARNING celery.redirected 2016-08-17 11:55:57,474 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:57,476 WARNING celery.redirected 2016-08-17 11:55:57,475 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:57,477 WARNING celery.redirected 2016-08-17 11:55:57,476 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:55:57,477 WARNING celery.redirected 2016-08-17 11:55:57,477 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:55:57,667 WARNING celery.redirected 2016-08-17 11:55:57,667 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:57,668 WARNING celery.redirected 2016-08-17 11:55:57,667 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:55:57,671 WARNING celery.redirected 2016-08-17 11:55:57,671 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:55:57,671 WARNING celery.redirected 2016-08-17 11:55:57,671 INFO sqlalchemy.engine.base.Engine {'desktops_id': 3, 'vm_state': 'BUILD', 'updated_at': datetime.datetime(2016, 8, 17, 11, 55, 57, 670945)}
2016-08-17 11:55:57,673 WARNING celery.redirected 2016-08-17 11:55:57,673 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:57,676 WARNING celery.redirected 2016-08-17 11:55:57,676 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:57,678 WARNING celery.redirected 2016-08-17 11:55:57,677 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:55:57,678 WARNING celery.redirected 2016-08-17 11:55:57,678 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:55:57,685 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:55:57,686 WARNING celery.redirected 2016-08-17 11:55:57,686 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:55:57,696 INFO celery.worker.job Task wait_desktop[6faf838d-e395-448e-96b9-7309893dd530] retry: Retry in 10s
2016-08-17 11:55:58,721 INFO celery.worker.strategy Received task: schedule_clean_desktops[d0747d91-0172-4204-9bf1-877a8de8f828]
2016-08-17 11:55:58,723 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:55:58,725 WARNING celery.redirected 2016-08-17 11:55:58,724 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:55:58,727 WARNING celery.redirected 2016-08-17 11:55:58,726 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:55:58,727 WARNING celery.redirected 2016-08-17 11:55:58,727 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:55:58,731 WARNING celery.redirected 2016-08-17 11:55:58,731 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:55:58,732 WARNING celery.redirected 2016-08-17 11:55:58,731 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 54, 58, 723846), 'desktop_state_2': 'DELETED'}
2016-08-17 11:55:58,734 WARNING celery.redirected 2016-08-17 11:55:58,734 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:55:58,735 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:55:58,744 INFO celery.worker.job Task schedule_clean_desktops[d0747d91-0172-4204-9bf1-877a8de8f828] succeeded in 0.021918554999501794s: None
2016-08-17 11:55:58,798 INFO celery.worker.strategy Received task: wait_desktop[6faf838d-e395-448e-96b9-7309893dd530] eta:[2016-08-17 03:56:07.680907+00:00]
2016-08-17 11:56:07,685 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:07,687 WARNING celery.redirected 2016-08-17 11:56:07,687 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:07,690 WARNING celery.redirected 2016-08-17 11:56:07,689 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:07,690 WARNING celery.redirected 2016-08-17 11:56:07,690 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:56:07,696 WARNING celery.redirected 2016-08-17 11:56:07,695 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:07,697 WARNING celery.redirected 2016-08-17 11:56:07,697 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:07,700 INFO celery Wait state for <DesktopTask 7>
2016-08-17 11:56:07,702 WARNING celery.redirected 2016-08-17 11:56:07,701 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:07,708 WARNING celery.redirected 2016-08-17 11:56:07,708 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:07,710 WARNING celery.redirected 2016-08-17 11:56:07,710 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:07,711 WARNING celery.redirected 2016-08-17 11:56:07,711 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:08,171 WARNING celery.redirected 2016-08-17 11:56:08,171 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:08,171 WARNING celery.redirected 2016-08-17 11:56:08,171 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:56:08,174 WARNING celery.redirected 2016-08-17 11:56:08,174 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:56:08,175 WARNING celery.redirected 2016-08-17 11:56:08,175 INFO sqlalchemy.engine.base.Engine {'desktops_id': 3, 'vm_state': 'ACTIVE', 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 8, 174493)}
2016-08-17 11:56:08,176 WARNING celery.redirected 2016-08-17 11:56:08,176 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:08,179 WARNING celery.redirected 2016-08-17 11:56:08,179 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:08,180 WARNING celery.redirected 2016-08-17 11:56:08,180 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:08,181 WARNING celery.redirected 2016-08-17 11:56:08,181 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:08,183 INFO celery Wait state for <DesktopTask 7>, stage success
2016-08-17 11:56:08,188 WARNING celery.redirected 2016-08-17 11:56:08,188 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:56:08,189 WARNING celery.redirected 2016-08-17 11:56:08,189 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 56, 8, 188231), 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 8, 188352), 'stage': 'WAIT', 'task_id': 7, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_method": "PING", "subnet": null, "wait_started_at": "2016-08-17T11:55:57.471430", "detect_timeout": 30, "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:55:52.943232", "disk": null, "desktop_type": "STATIC", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "desktop": 3, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "owner": 1}'}
2016-08-17 11:56:08,193 WARNING celery.redirected 2016-08-17 11:56:08,192 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:08,196 WARNING celery.redirected 2016-08-17 11:56:08,195 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:08,199 WARNING celery.redirected 2016-08-17 11:56:08,199 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:08,201 WARNING celery.redirected 2016-08-17 11:56:08,200 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:08,203 WARNING celery.redirected 2016-08-17 11:56:08,203 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:08,204 WARNING celery.redirected 2016-08-17 11:56:08,203 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 8, 203324), 'stage': 'FLOATING'}
2016-08-17 11:56:08,205 WARNING celery.redirected 2016-08-17 11:56:08,205 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:08,206 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:08,218 INFO celery.worker.job Task wait_desktop[6faf838d-e395-448e-96b9-7309893dd530] succeeded in 0.5338473030005844s: None
2016-08-17 11:56:08,601 INFO celery.worker.strategy Received task: schedule_start_lesson[8ae009b2-04b1-4e1e-a64a-54cd32eb641d]
2016-08-17 11:56:08,603 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:08,604 INFO celery Scheduling start lesson tasks
2016-08-17 11:56:08,606 WARNING celery.redirected 2016-08-17 11:56:08,605 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:08,608 WARNING celery.redirected 2016-08-17 11:56:08,607 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:08,609 WARNING celery.redirected 2016-08-17 11:56:08,608 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:56:08,619 WARNING celery.redirected 2016-08-17 11:56:08,618 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:56:08,619 WARNING celery.redirected 2016-08-17 11:56:08,619 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 56, 8, 611366), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 6, 8, 611366), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:56:08,624 WARNING celery.redirected 2016-08-17 11:56:08,623 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:08,625 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:08,637 INFO celery.worker.job Task schedule_start_lesson[8ae009b2-04b1-4e1e-a64a-54cd32eb641d] succeeded in 0.033930249001059565s: None
2016-08-17 11:56:08,706 INFO celery.worker.strategy Received task: assign_floating[d5676a00-0738-4ebd-b0e7-aafa9431192e] eta:[2016-08-17 03:56:09.207340+00:00]
2016-08-17 11:56:09,210 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:09,212 WARNING celery.redirected 2016-08-17 11:56:09,212 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:09,213 WARNING celery.redirected 2016-08-17 11:56:09,213 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:09,214 WARNING celery.redirected 2016-08-17 11:56:09,213 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:56:09,216 WARNING celery.redirected 2016-08-17 11:56:09,216 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:09,217 WARNING celery.redirected 2016-08-17 11:56:09,217 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:09,218 INFO celery Floating for <DesktopTask 7>
2016-08-17 11:56:09,960 INFO celery.worker.strategy Received task: build_desktop[519f7bcd-541e-402f-aae6-7f58624610cb] eta:[2016-08-17 03:56:10.346146+00:00]
2016-08-17 11:56:09,976 WARNING celery.redirected 2016-08-17 11:56:09,976 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:09,977 WARNING celery.redirected 2016-08-17 11:56:09,976 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 9, 975832), 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.137", "detect_timeout": 30, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:55:57.471430", "start_datetime": "2016-08-17T11:55:52.943232", "wait_state": "ACTIVE", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "desktop": 3, "subnet": null, "owner": 1}'}
2016-08-17 11:56:09,979 WARNING celery.redirected 2016-08-17 11:56:09,978 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:56:09,979 WARNING celery.redirected 2016-08-17 11:56:09,979 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 56, 9, 978501), 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 9, 978617), 'stage': 'FLOATING', 'task_id': 7, 'detail': '', 'success': 1, 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.137", "detect_timeout": 30, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:55:57.471430", "start_datetime": "2016-08-17T11:55:52.943232", "wait_state": "ACTIVE", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "desktop": 3, "subnet": null, "owner": 1}'}
2016-08-17 11:56:09,981 WARNING celery.redirected 2016-08-17 11:56:09,981 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:09,985 WARNING celery.redirected 2016-08-17 11:56:09,985 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:09,986 WARNING celery.redirected 2016-08-17 11:56:09,986 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:09,987 WARNING celery.redirected 2016-08-17 11:56:09,987 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:09,992 WARNING celery.redirected 2016-08-17 11:56:09,992 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:09,993 WARNING celery.redirected 2016-08-17 11:56:09,993 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 9, 992446), 'stage': 'DETECT'}
2016-08-17 11:56:09,994 WARNING celery.redirected 2016-08-17 11:56:09,994 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:09,996 WARNING celery.redirected 2016-08-17 11:56:09,996 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:09,997 WARNING celery.redirected 2016-08-17 11:56:09,997 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:09,999 WARNING celery.redirected 2016-08-17 11:56:09,998 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:10,002 WARNING celery.redirected 2016-08-17 11:56:10,002 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:10,003 WARNING celery.redirected 2016-08-17 11:56:10,002 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:56:10,010 WARNING celery.redirected 2016-08-17 11:56:10,009 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, floating_ip=%(floating_ip)s, need_floating=%(need_floating)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:56:10,010 WARNING celery.redirected 2016-08-17 11:56:10,010 INFO sqlalchemy.engine.base.Engine {'desktops_id': 3, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 9620), 'need_floating': 0, 'floating_ip': '172.18.231.137'}
2016-08-17 11:56:10,012 WARNING celery.redirected 2016-08-17 11:56:10,011 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:10,013 INFO celery Associate floating ip success, instance id: 7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc
2016-08-17 11:56:10,014 WARNING celery.redirected 2016-08-17 11:56:10,014 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:10,015 WARNING celery.redirected 2016-08-17 11:56:10,015 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:10,016 WARNING celery.redirected 2016-08-17 11:56:10,016 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:10,018 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:10,019 WARNING celery.redirected 2016-08-17 11:56:10,018 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:10,143 INFO celery.worker.job Task assign_floating[d5676a00-0738-4ebd-b0e7-aafa9431192e] succeeded in 0.9331729890000133s: None
2016-08-17 11:56:10,351 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:10,352 WARNING celery.redirected 2016-08-17 11:56:10,352 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:10,353 WARNING celery.redirected 2016-08-17 11:56:10,353 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:10,354 WARNING celery.redirected 2016-08-17 11:56:10,354 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:56:10,355 INFO celery Build desktop for <DesktopTask 8>
2016-08-17 11:56:10,358 WARNING celery.redirected 2016-08-17 11:56:10,358 INFO sqlalchemy.engine.base.Engine SELECT courses.id AS courses_id, courses.created_at AS courses_created_at, courses.updated_at AS courses_updated_at, courses.name AS courses_name, courses.start_date AS courses_start_date, courses.end_date AS courses_end_date, courses.capacity AS courses_capacity, courses.image_ref AS courses_image_ref, courses.flavor_ref AS courses_flavor_ref, courses.network_ref AS courses_network_ref, courses.protocol AS courses_protocol, courses.owner_id AS courses_owner_id 
FROM courses 
WHERE courses.id IS NULL 
 LIMIT %(param_1)s
2016-08-17 11:56:10,359 WARNING celery.redirected 2016-08-17 11:56:10,359 INFO sqlalchemy.engine.base.Engine {'param_1': 1}
2016-08-17 11:56:10,428 WARNING celery.redirected 2016-08-17 11:56:10,428 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:10,429 WARNING celery.redirected 2016-08-17 11:56:10,429 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:56:10,434 WARNING celery.redirected 2016-08-17 11:56:10,434 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:10,434 WARNING celery.redirected 2016-08-17 11:56:10,434 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'state': 'RUNNING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 433882)}
2016-08-17 11:56:10,438 WARNING celery.redirected 2016-08-17 11:56:10,437 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:10,440 WARNING celery.redirected 2016-08-17 11:56:10,439 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:10,441 WARNING celery.redirected 2016-08-17 11:56:10,441 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:10,441 WARNING celery.redirected 2016-08-17 11:56:10,441 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:10,445 WARNING celery.redirected 2016-08-17 11:56:10,445 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(param_1)s
2016-08-17 11:56:10,446 WARNING celery.redirected 2016-08-17 11:56:10,446 INFO sqlalchemy.engine.base.Engine {'param_1': 4}
2016-08-17 11:56:10,455 WARNING celery.redirected 2016-08-17 11:56:10,455 INFO sqlalchemy.engine.base.Engine SELECT users.id AS users_id, users.username AS users_username, users.fullname AS users_fullname, users.email AS users_email, users.is_active AS users_is_active, users.is_device AS users_is_device, users.role_id AS users_role_id, users.password_hash AS users_password_hash, users.confirmed AS users_confirmed 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:10,456 WARNING celery.redirected 2016-08-17 11:56:10,456 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:56:10,956 WARNING celery.redirected 2016-08-17 11:56:10,956 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_ref=%(vm_ref)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:56:10,957 WARNING celery.redirected 2016-08-17 11:56:10,956 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 956128), 'vm_ref': 'bbe05795-86c1-4af3-8704-f8c9aacf3be6'}
2016-08-17 11:56:10,958 WARNING celery.redirected 2016-08-17 11:56:10,958 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:10,959 WARNING celery.redirected 2016-08-17 11:56:10,958 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 958213), 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "detect_method": "PING", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:56:09.335319", "disk": null, "desktop_type": "STATIC", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "end_datetime": "3016-01-01T00:00:00.000001", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_timeout": 30, "desktop": 4, "subnet": null, "course": null, "owner": 3}'}
2016-08-17 11:56:10,963 WARNING celery.redirected 2016-08-17 11:56:10,963 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:56:10,965 WARNING celery.redirected 2016-08-17 11:56:10,964 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 961071), 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 961158), 'stage': 'BUILD', 'task_id': 8, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "detect_method": "PING", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:56:09.335319", "disk": null, "desktop_type": "STATIC", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "end_datetime": "3016-01-01T00:00:00.000001", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_timeout": 30, "desktop": 4, "subnet": null, "course": null, "owner": 3}'}
2016-08-17 11:56:10,966 WARNING celery.redirected 2016-08-17 11:56:10,966 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:10,969 WARNING celery.redirected 2016-08-17 11:56:10,969 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:10,970 WARNING celery.redirected 2016-08-17 11:56:10,970 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:10,971 WARNING celery.redirected 2016-08-17 11:56:10,971 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:10,974 WARNING celery.redirected 2016-08-17 11:56:10,974 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:10,975 WARNING celery.redirected 2016-08-17 11:56:10,975 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 10, 974188), 'stage': 'WAIT'}
2016-08-17 11:56:10,976 WARNING celery.redirected 2016-08-17 11:56:10,976 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:10,978 WARNING celery.redirected 2016-08-17 11:56:10,978 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:10,979 WARNING celery.redirected 2016-08-17 11:56:10,979 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:10,980 WARNING celery.redirected 2016-08-17 11:56:10,980 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:10,982 INFO celery Build desktop for <DesktopTask 8>, success
2016-08-17 11:56:10,982 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:10,983 WARNING celery.redirected 2016-08-17 11:56:10,983 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:11,001 INFO celery.worker.job Task build_desktop[519f7bcd-541e-402f-aae6-7f58624610cb] succeeded in 0.6499921310005448s: None
2016-08-17 11:56:11,222 INFO celery.worker.strategy Received task: detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] eta:[2016-08-17 03:56:13.020701+00:00]
2016-08-17 11:56:11,327 INFO celery.worker.strategy Received task: wait_desktop[0111473c-5e62-4977-983d-2636197fef17] eta:[2016-08-17 03:56:13.984707+00:00]
2016-08-17 11:56:13,024 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:13,025 WARNING celery.redirected 2016-08-17 11:56:13,025 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:13,026 WARNING celery.redirected 2016-08-17 11:56:13,026 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:13,027 WARNING celery.redirected 2016-08-17 11:56:13,027 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:56:13,030 WARNING celery.redirected 2016-08-17 11:56:13,029 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:13,030 WARNING celery.redirected 2016-08-17 11:56:13,030 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:13,032 INFO celery Detect for <DesktopTask 7>
2016-08-17 11:56:13,034 WARNING celery.redirected 2016-08-17 11:56:13,034 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:13,035 WARNING celery.redirected 2016-08-17 11:56:13,035 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 13, 34365), 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "detect_started_at": "2016-08-17T11:56:13.033208", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.137", "detect_timeout": 30, "start_datetime": "2016-08-17T11:55:52.943232", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:55:57.471430", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "desktop": 3, "subnet": null, "owner": 1}'}
2016-08-17 11:56:13,036 WARNING celery.redirected 2016-08-17 11:56:13,036 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:13,039 WARNING celery.redirected 2016-08-17 11:56:13,039 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:13,041 WARNING celery.redirected 2016-08-17 11:56:13,041 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:13,041 WARNING celery.redirected 2016-08-17 11:56:13,041 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:13,986 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:13,988 WARNING celery.redirected 2016-08-17 11:56:13,987 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:13,989 WARNING celery.redirected 2016-08-17 11:56:13,989 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:13,989 WARNING celery.redirected 2016-08-17 11:56:13,989 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:56:13,994 WARNING celery.redirected 2016-08-17 11:56:13,994 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:13,995 WARNING celery.redirected 2016-08-17 11:56:13,995 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:13,996 INFO celery Wait state for <DesktopTask 8>
2016-08-17 11:56:13,997 WARNING celery.redirected 2016-08-17 11:56:13,997 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:13,998 WARNING celery.redirected 2016-08-17 11:56:13,998 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 13, 997520), 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_method": "PING", "subnet": null, "wait_started_at": "2016-08-17T11:56:13.996857", "detect_timeout": 30, "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:56:09.335319", "disk": null, "desktop_type": "STATIC", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "owner": 3}'}
2016-08-17 11:56:14,000 WARNING celery.redirected 2016-08-17 11:56:13,999 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:14,003 WARNING celery.redirected 2016-08-17 11:56:14,003 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:14,005 WARNING celery.redirected 2016-08-17 11:56:14,004 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:14,005 WARNING celery.redirected 2016-08-17 11:56:14,005 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:14,049 ERROR celery Detect(ping) for <DesktopTask 7>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.137']' timed out after 1 seconds
2016-08-17 11:56:14,109 WARNING celery.redirected 2016-08-17 11:56:14,109 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:14,110 WARNING celery.redirected 2016-08-17 11:56:14,110 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:56:14,113 WARNING celery.redirected 2016-08-17 11:56:14,113 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:56:14,113 WARNING celery.redirected 2016-08-17 11:56:14,113 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 14, 112851), 'vm_state': 'BUILD'}
2016-08-17 11:56:14,115 WARNING celery.redirected 2016-08-17 11:56:14,115 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:14,117 WARNING celery.redirected 2016-08-17 11:56:14,117 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:14,119 WARNING celery.redirected 2016-08-17 11:56:14,118 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 14, 117193), 'retries': 1}
2016-08-17 11:56:14,119 WARNING celery.redirected 2016-08-17 11:56:14,119 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:14,120 WARNING celery.redirected 2016-08-17 11:56:14,120 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:14,121 WARNING celery.redirected 2016-08-17 11:56:14,121 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:14,121 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:14,122 WARNING celery.redirected 2016-08-17 11:56:14,122 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:56:14,129 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:14,130 WARNING celery.redirected 2016-08-17 11:56:14,130 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:56:14,135 INFO celery.worker.job Task detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.137'], 1)
2016-08-17 11:56:14,144 INFO celery.worker.job Task wait_desktop[0111473c-5e62-4977-983d-2636197fef17] retry: Retry in 10s
2016-08-17 11:56:15,183 INFO celery.worker.strategy Received task: detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] eta:[2016-08-17 03:56:34.051928+00:00]
2016-08-17 11:56:15,256 INFO celery.worker.strategy Received task: wait_desktop[0111473c-5e62-4977-983d-2636197fef17] eta:[2016-08-17 03:56:24.124473+00:00]
2016-08-17 11:56:24,131 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:24,133 WARNING celery.redirected 2016-08-17 11:56:24,132 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:24,134 WARNING celery.redirected 2016-08-17 11:56:24,133 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:24,134 WARNING celery.redirected 2016-08-17 11:56:24,134 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:56:24,137 WARNING celery.redirected 2016-08-17 11:56:24,137 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:24,137 WARNING celery.redirected 2016-08-17 11:56:24,137 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:24,139 INFO celery Wait state for <DesktopTask 8>
2016-08-17 11:56:24,140 WARNING celery.redirected 2016-08-17 11:56:24,140 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:24,141 WARNING celery.redirected 2016-08-17 11:56:24,141 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:24,142 WARNING celery.redirected 2016-08-17 11:56:24,142 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:24,143 WARNING celery.redirected 2016-08-17 11:56:24,143 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:24,293 WARNING celery.redirected 2016-08-17 11:56:24,293 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:24,294 WARNING celery.redirected 2016-08-17 11:56:24,294 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:56:24,297 WARNING celery.redirected 2016-08-17 11:56:24,296 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:56:24,297 WARNING celery.redirected 2016-08-17 11:56:24,297 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'vm_state': 'ACTIVE', 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 24, 296740)}
2016-08-17 11:56:24,298 WARNING celery.redirected 2016-08-17 11:56:24,298 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:24,300 WARNING celery.redirected 2016-08-17 11:56:24,300 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:24,301 WARNING celery.redirected 2016-08-17 11:56:24,301 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:24,302 WARNING celery.redirected 2016-08-17 11:56:24,302 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:24,303 INFO celery Wait state for <DesktopTask 8>, stage success
2016-08-17 11:56:24,305 WARNING celery.redirected 2016-08-17 11:56:24,305 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:56:24,305 WARNING celery.redirected 2016-08-17 11:56:24,305 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 56, 24, 305159), 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 24, 305215), 'stage': 'WAIT', 'task_id': 8, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "floating_action": "ASSIGN", "port": null, "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "detect_method": "PING", "subnet": null, "wait_started_at": "2016-08-17T11:56:13.996857", "detect_timeout": 30, "wait_state": "ACTIVE", "start_datetime": "2016-08-17T11:56:09.335319", "disk": null, "desktop_type": "STATIC", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "owner": 3}'}
2016-08-17 11:56:24,307 WARNING celery.redirected 2016-08-17 11:56:24,307 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:24,309 WARNING celery.redirected 2016-08-17 11:56:24,308 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:24,310 WARNING celery.redirected 2016-08-17 11:56:24,310 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:24,310 WARNING celery.redirected 2016-08-17 11:56:24,310 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:24,313 WARNING celery.redirected 2016-08-17 11:56:24,312 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:24,313 WARNING celery.redirected 2016-08-17 11:56:24,313 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 24, 312794), 'stage': 'FLOATING'}
2016-08-17 11:56:24,314 WARNING celery.redirected 2016-08-17 11:56:24,314 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:24,316 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:24,326 INFO celery.worker.job Task wait_desktop[0111473c-5e62-4977-983d-2636197fef17] succeeded in 0.19532412599983218s: None
2016-08-17 11:56:24,890 INFO celery.worker.strategy Received task: assign_floating[be13556d-e668-4d59-ad01-2a3916684fc4] eta:[2016-08-17 03:56:25.316727+00:00]
2016-08-17 11:56:25,320 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:25,322 WARNING celery.redirected 2016-08-17 11:56:25,322 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:25,324 WARNING celery.redirected 2016-08-17 11:56:25,324 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:25,325 WARNING celery.redirected 2016-08-17 11:56:25,325 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:56:25,327 WARNING celery.redirected 2016-08-17 11:56:25,327 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:25,328 WARNING celery.redirected 2016-08-17 11:56:25,328 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:25,329 INFO celery Floating for <DesktopTask 8>
2016-08-17 11:56:25,939 WARNING celery.redirected 2016-08-17 11:56:25,939 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:25,940 WARNING celery.redirected 2016-08-17 11:56:25,940 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 25, 939027), 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.157", "detect_timeout": 30, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:56:13.996857", "start_datetime": "2016-08-17T11:56:09.335319", "wait_state": "ACTIVE", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "subnet": null, "owner": 3}'}
2016-08-17 11:56:25,942 WARNING celery.redirected 2016-08-17 11:56:25,942 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:56:25,942 WARNING celery.redirected 2016-08-17 11:56:25,942 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 56, 25, 942119), 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 25, 942179), 'stage': 'FLOATING', 'task_id': 8, 'detail': '', 'success': 1, 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.157", "detect_timeout": 30, "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:56:13.996857", "start_datetime": "2016-08-17T11:56:09.335319", "wait_state": "ACTIVE", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "subnet": null, "owner": 3}'}
2016-08-17 11:56:25,944 WARNING celery.redirected 2016-08-17 11:56:25,944 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:25,946 WARNING celery.redirected 2016-08-17 11:56:25,946 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:25,947 WARNING celery.redirected 2016-08-17 11:56:25,947 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:25,948 WARNING celery.redirected 2016-08-17 11:56:25,948 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:25,950 WARNING celery.redirected 2016-08-17 11:56:25,950 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:25,951 WARNING celery.redirected 2016-08-17 11:56:25,950 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 25, 950181), 'stage': 'DETECT'}
2016-08-17 11:56:25,952 WARNING celery.redirected 2016-08-17 11:56:25,952 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:25,954 WARNING celery.redirected 2016-08-17 11:56:25,954 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:25,955 WARNING celery.redirected 2016-08-17 11:56:25,955 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:25,955 WARNING celery.redirected 2016-08-17 11:56:25,955 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:25,958 WARNING celery.redirected 2016-08-17 11:56:25,958 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:25,959 WARNING celery.redirected 2016-08-17 11:56:25,958 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:56:25,962 WARNING celery.redirected 2016-08-17 11:56:25,962 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, floating_ip=%(floating_ip)s, need_floating=%(need_floating)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:56:25,962 WARNING celery.redirected 2016-08-17 11:56:25,962 INFO sqlalchemy.engine.base.Engine {'floating_ip': '172.18.231.157', 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 25, 962056), 'need_floating': 0, 'desktops_id': 4}
2016-08-17 11:56:25,964 WARNING celery.redirected 2016-08-17 11:56:25,964 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:25,965 INFO celery Associate floating ip success, instance id: bbe05795-86c1-4af3-8704-f8c9aacf3be6
2016-08-17 11:56:25,966 WARNING celery.redirected 2016-08-17 11:56:25,966 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:25,967 WARNING celery.redirected 2016-08-17 11:56:25,966 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:25,967 WARNING celery.redirected 2016-08-17 11:56:25,967 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:25,969 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:25,969 WARNING celery.redirected 2016-08-17 11:56:25,969 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:25,981 INFO celery.worker.job Task assign_floating[be13556d-e668-4d59-ad01-2a3916684fc4] succeeded in 0.6608812989998114s: None
2016-08-17 11:56:26,107 INFO celery.worker.strategy Received task: detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] eta:[2016-08-17 03:56:28.970626+00:00]
2016-08-17 11:56:28,976 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:28,978 WARNING celery.redirected 2016-08-17 11:56:28,978 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:28,979 WARNING celery.redirected 2016-08-17 11:56:28,979 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:28,980 WARNING celery.redirected 2016-08-17 11:56:28,980 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:56:28,983 WARNING celery.redirected 2016-08-17 11:56:28,983 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:28,983 WARNING celery.redirected 2016-08-17 11:56:28,983 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:28,985 INFO celery Detect for <DesktopTask 8>
2016-08-17 11:56:28,986 WARNING celery.redirected 2016-08-17 11:56:28,986 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:28,987 WARNING celery.redirected 2016-08-17 11:56:28,987 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 28, 986722), 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "detect_started_at": "2016-08-17T11:56:28.986043", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.157", "detect_timeout": 30, "start_datetime": "2016-08-17T11:56:09.335319", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:56:13.996857", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "subnet": null, "owner": 3}'}
2016-08-17 11:56:28,988 WARNING celery.redirected 2016-08-17 11:56:28,988 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:28,991 WARNING celery.redirected 2016-08-17 11:56:28,991 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:28,992 WARNING celery.redirected 2016-08-17 11:56:28,992 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:28,993 WARNING celery.redirected 2016-08-17 11:56:28,993 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:30,003 ERROR celery Detect(ping) for <DesktopTask 8>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 11:56:30,015 WARNING celery.redirected 2016-08-17 11:56:30,015 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:30,016 WARNING celery.redirected 2016-08-17 11:56:30,016 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 30, 15296), 'retries': 1}
2016-08-17 11:56:30,017 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:30,018 WARNING celery.redirected 2016-08-17 11:56:30,017 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:56:30,027 INFO celery.worker.job Task detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 11:56:30,885 INFO celery.worker.strategy Received task: detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] eta:[2016-08-17 03:56:50.006500+00:00]
2016-08-17 11:56:34,054 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:34,056 WARNING celery.redirected 2016-08-17 11:56:34,055 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:34,057 WARNING celery.redirected 2016-08-17 11:56:34,057 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:34,058 WARNING celery.redirected 2016-08-17 11:56:34,057 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:56:34,063 WARNING celery.redirected 2016-08-17 11:56:34,063 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:34,063 WARNING celery.redirected 2016-08-17 11:56:34,063 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:34,065 INFO celery Detect for <DesktopTask 7>
2016-08-17 11:56:34,066 WARNING celery.redirected 2016-08-17 11:56:34,065 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:34,067 WARNING celery.redirected 2016-08-17 11:56:34,067 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:34,068 WARNING celery.redirected 2016-08-17 11:56:34,068 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:34,069 WARNING celery.redirected 2016-08-17 11:56:34,069 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:35,079 ERROR celery Detect(ping) for <DesktopTask 7>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.137']' timed out after 1 seconds
2016-08-17 11:56:35,095 WARNING celery.redirected 2016-08-17 11:56:35,094 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:35,095 WARNING celery.redirected 2016-08-17 11:56:35,095 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 35, 94406), 'retries': 1}
2016-08-17 11:56:35,097 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:35,098 WARNING celery.redirected 2016-08-17 11:56:35,098 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:56:35,114 INFO celery.worker.job Task detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.137'], 1)
2016-08-17 11:56:35,760 INFO celery.worker.strategy Received task: detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] eta:[2016-08-17 03:56:55.084375+00:00]
2016-08-17 11:56:50,009 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:50,011 WARNING celery.redirected 2016-08-17 11:56:50,011 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:50,013 WARNING celery.redirected 2016-08-17 11:56:50,013 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:50,014 WARNING celery.redirected 2016-08-17 11:56:50,014 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:56:50,018 WARNING celery.redirected 2016-08-17 11:56:50,018 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:50,019 WARNING celery.redirected 2016-08-17 11:56:50,018 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:50,022 INFO celery Detect for <DesktopTask 8>
2016-08-17 11:56:50,023 WARNING celery.redirected 2016-08-17 11:56:50,023 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:50,025 WARNING celery.redirected 2016-08-17 11:56:50,025 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:50,026 WARNING celery.redirected 2016-08-17 11:56:50,026 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:50,027 WARNING celery.redirected 2016-08-17 11:56:50,027 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:56:51,036 ERROR celery Detect(ping) for <DesktopTask 8>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 11:56:51,048 WARNING celery.redirected 2016-08-17 11:56:51,048 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:51,049 WARNING celery.redirected 2016-08-17 11:56:51,049 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 51, 48483), 'retries': 1}
2016-08-17 11:56:51,051 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:51,051 WARNING celery.redirected 2016-08-17 11:56:51,051 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:56:51,062 INFO celery.worker.job Task detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 11:56:51,694 INFO celery.worker.strategy Received task: detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] eta:[2016-08-17 03:57:11.039456+00:00]
2016-08-17 11:56:55,088 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:55,090 WARNING celery.redirected 2016-08-17 11:56:55,090 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:55,092 WARNING celery.redirected 2016-08-17 11:56:55,091 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:55,092 WARNING celery.redirected 2016-08-17 11:56:55,092 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:56:55,095 WARNING celery.redirected 2016-08-17 11:56:55,095 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:55,095 WARNING celery.redirected 2016-08-17 11:56:55,095 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:55,097 INFO celery Detect for <DesktopTask 7>
2016-08-17 11:56:55,098 WARNING celery.redirected 2016-08-17 11:56:55,097 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:55,099 WARNING celery.redirected 2016-08-17 11:56:55,099 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:55,100 WARNING celery.redirected 2016-08-17 11:56:55,100 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:56:55,101 WARNING celery.redirected 2016-08-17 11:56:55,101 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:56:56,110 ERROR celery Detect(ping) for <DesktopTask 7>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.137']' timed out after 1 seconds
2016-08-17 11:56:56,124 WARNING celery.redirected 2016-08-17 11:56:56,124 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:56:56,125 WARNING celery.redirected 2016-08-17 11:56:56,124 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'updated_at': datetime.datetime(2016, 8, 17, 11, 56, 56, 123622), 'retries': 1}
2016-08-17 11:56:56,126 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:56,127 WARNING celery.redirected 2016-08-17 11:56:56,127 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:56:56,135 INFO celery.worker.job Task detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.137'], 1)
2016-08-17 11:56:56,483 INFO celery.worker.strategy Received task: detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] eta:[2016-08-17 03:57:16.113212+00:00]
2016-08-17 11:56:58,837 INFO celery.worker.strategy Received task: schedule_clean_desktops[b7b51e75-5ec7-4732-97e2-0e688411ef13]
2016-08-17 11:56:58,839 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:56:58,840 WARNING celery.redirected 2016-08-17 11:56:58,840 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:56:58,842 WARNING celery.redirected 2016-08-17 11:56:58,841 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:56:58,842 WARNING celery.redirected 2016-08-17 11:56:58,842 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:56:58,846 WARNING celery.redirected 2016-08-17 11:56:58,846 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:56:58,847 WARNING celery.redirected 2016-08-17 11:56:58,847 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 55, 58, 840029), 'desktop_state_2': 'DELETED'}
2016-08-17 11:56:58,849 WARNING celery.redirected 2016-08-17 11:56:58,849 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:56:58,850 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:56:58,858 INFO celery.worker.job Task schedule_clean_desktops[b7b51e75-5ec7-4732-97e2-0e688411ef13] succeeded in 0.019412121999266674s: None
2016-08-17 11:57:11,042 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:11,044 WARNING celery.redirected 2016-08-17 11:57:11,044 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:11,046 WARNING celery.redirected 2016-08-17 11:57:11,045 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:11,047 WARNING celery.redirected 2016-08-17 11:57:11,046 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:57:11,049 WARNING celery.redirected 2016-08-17 11:57:11,049 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:11,050 WARNING celery.redirected 2016-08-17 11:57:11,050 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:11,051 INFO celery Detect for <DesktopTask 8>
2016-08-17 11:57:11,052 WARNING celery.redirected 2016-08-17 11:57:11,052 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:11,054 WARNING celery.redirected 2016-08-17 11:57:11,054 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:11,055 WARNING celery.redirected 2016-08-17 11:57:11,055 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:11,055 WARNING celery.redirected 2016-08-17 11:57:11,055 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:12,065 ERROR celery Detect(ping) for <DesktopTask 8>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 11:57:12,077 WARNING celery.redirected 2016-08-17 11:57:12,076 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:57:12,081 WARNING celery.redirected 2016-08-17 11:57:12,080 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 12, 75620), 'retries': 1}
2016-08-17 11:57:12,084 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:12,085 WARNING celery.redirected 2016-08-17 11:57:12,085 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 11:57:12,093 INFO celery.worker.job Task detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 11:57:12,400 INFO celery.worker.strategy Received task: detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] eta:[2016-08-17 03:57:32.067297+00:00]
2016-08-17 11:57:13,612 INFO celery.worker.strategy Received task: schedule_start_lesson[4341b460-55a3-4112-b451-36fc49e808f0]
2016-08-17 11:57:13,614 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:13,614 INFO celery Scheduling start lesson tasks
2016-08-17 11:57:13,616 WARNING celery.redirected 2016-08-17 11:57:13,616 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:13,617 WARNING celery.redirected 2016-08-17 11:57:13,617 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:13,618 WARNING celery.redirected 2016-08-17 11:57:13,618 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:57:13,624 WARNING celery.redirected 2016-08-17 11:57:13,624 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:57:13,625 WARNING celery.redirected 2016-08-17 11:57:13,624 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 57, 13, 621192), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 7, 13, 621192), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:57:13,627 WARNING celery.redirected 2016-08-17 11:57:13,626 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:13,628 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:13,635 INFO celery.worker.job Task schedule_start_lesson[4341b460-55a3-4112-b451-36fc49e808f0] succeeded in 0.02201254400097241s: None
2016-08-17 11:57:16,118 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:16,119 WARNING celery.redirected 2016-08-17 11:57:16,119 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:16,120 WARNING celery.redirected 2016-08-17 11:57:16,120 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:16,121 WARNING celery.redirected 2016-08-17 11:57:16,121 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:57:16,124 WARNING celery.redirected 2016-08-17 11:57:16,123 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:16,124 WARNING celery.redirected 2016-08-17 11:57:16,124 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:57:16,126 INFO celery Detect for <DesktopTask 7>
2016-08-17 11:57:16,127 WARNING celery.redirected 2016-08-17 11:57:16,127 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:16,129 WARNING celery.redirected 2016-08-17 11:57:16,129 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:16,130 WARNING celery.redirected 2016-08-17 11:57:16,130 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:16,131 WARNING celery.redirected 2016-08-17 11:57:16,131 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:57:16,140 INFO celery Detect for <DesktopTask 7>, success
2016-08-17 11:57:16,143 WARNING celery.redirected 2016-08-17 11:57:16,143 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:57:16,144 WARNING celery.redirected 2016-08-17 11:57:16,144 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 57, 16, 143544), 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 16, 143618), 'stage': 'DETECT', 'task_id': 7, 'detail': '', 'success': 1, 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "detect_started_at": "2016-08-17T11:56:13.033208", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.137", "detect_timeout": 30, "start_datetime": "2016-08-17T11:55:52.943232", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:55:57.471430", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "desktop_name": "student_cirros-x86_2016-08-17 11:55:52", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "7f4cd07a-11bd-4ba9-bab1-32b12e7b91dc", "desktop": 3, "subnet": null, "owner": 1}'}
2016-08-17 11:57:16,146 WARNING celery.redirected 2016-08-17 11:57:16,146 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:16,150 WARNING celery.redirected 2016-08-17 11:57:16,150 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:16,152 WARNING celery.redirected 2016-08-17 11:57:16,151 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:16,152 WARNING celery.redirected 2016-08-17 11:57:16,152 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:57:16,155 WARNING celery.redirected 2016-08-17 11:57:16,155 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:57:16,156 WARNING celery.redirected 2016-08-17 11:57:16,156 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 7, 'state': 'FINISHED', 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 16, 155327), 'result': 'SUCCESS'}
2016-08-17 11:57:16,157 WARNING celery.redirected 2016-08-17 11:57:16,157 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:16,159 WARNING celery.redirected 2016-08-17 11:57:16,159 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:16,161 WARNING celery.redirected 2016-08-17 11:57:16,161 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:16,162 WARNING celery.redirected 2016-08-17 11:57:16,162 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:57:16,166 WARNING celery.redirected 2016-08-17 11:57:16,166 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:16,167 WARNING celery.redirected 2016-08-17 11:57:16,167 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:57:16,171 WARNING celery.redirected 2016-08-17 11:57:16,171 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:57:16,172 WARNING celery.redirected 2016-08-17 11:57:16,172 INFO sqlalchemy.engine.base.Engine {'desktops_id': 3, 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 16, 171319), 'desktop_state': 'ACTIVE'}
2016-08-17 11:57:16,173 WARNING celery.redirected 2016-08-17 11:57:16,173 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:16,174 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:16,228 INFO celery.worker.job Task detect_floating[e88f1728-0e6f-445f-9734-7125f84a7ba3] succeeded in 0.11021267100113619s: None
2016-08-17 11:57:17,298 INFO celery.worker.strategy Received task: set_desktop_state[9ef7f7d6-9d46-4a3c-867f-a58365cc4537]
2016-08-17 11:57:17,300 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:17,302 WARNING celery.redirected 2016-08-17 11:57:17,302 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:17,304 WARNING celery.redirected 2016-08-17 11:57:17,304 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:17,305 WARNING celery.redirected 2016-08-17 11:57:17,305 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:57:17,310 WARNING celery.redirected 2016-08-17 11:57:17,310 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:17,311 WARNING celery.redirected 2016-08-17 11:57:17,311 INFO sqlalchemy.engine.base.Engine {'param_1': 7}
2016-08-17 11:57:17,316 WARNING celery.redirected 2016-08-17 11:57:17,315 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:17,317 WARNING celery.redirected 2016-08-17 11:57:17,316 INFO sqlalchemy.engine.base.Engine {'id_1': 3, 'param_1': 1}
2016-08-17 11:57:17,320 WARNING celery.redirected 2016-08-17 11:57:17,320 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:17,322 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:17,469 INFO celery.worker.job Task set_desktop_state[9ef7f7d6-9d46-4a3c-867f-a58365cc4537] succeeded in 0.16958666000027733s: None
2016-08-17 11:57:18,531 INFO celery.worker.strategy Received task: _create_desktop_detect[13265973-a78e-48bc-a2d4-9a32f5c7c5c2]
2016-08-17 11:57:18,534 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:18,536 WARNING celery.redirected 2016-08-17 11:57:18,536 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:18,538 WARNING celery.redirected 2016-08-17 11:57:18,537 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:18,538 WARNING celery.redirected 2016-08-17 11:57:18,538 INFO sqlalchemy.engine.base.Engine {'id_1': 7, 'param_1': 1}
2016-08-17 11:57:18,540 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:18,541 WARNING celery.redirected 2016-08-17 11:57:18,540 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:18,554 INFO celery.worker.job Task _create_desktop_detect[13265973-a78e-48bc-a2d4-9a32f5c7c5c2] succeeded in 0.01977190999969025s: None
2016-08-17 11:57:32,070 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:32,071 WARNING celery.redirected 2016-08-17 11:57:32,071 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:32,073 WARNING celery.redirected 2016-08-17 11:57:32,072 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:32,074 WARNING celery.redirected 2016-08-17 11:57:32,073 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:57:32,077 WARNING celery.redirected 2016-08-17 11:57:32,077 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:32,077 WARNING celery.redirected 2016-08-17 11:57:32,077 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:32,079 INFO celery Detect for <DesktopTask 8>
2016-08-17 11:57:32,080 WARNING celery.redirected 2016-08-17 11:57:32,080 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:32,081 WARNING celery.redirected 2016-08-17 11:57:32,081 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:32,082 WARNING celery.redirected 2016-08-17 11:57:32,082 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:32,083 WARNING celery.redirected 2016-08-17 11:57:32,083 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:32,091 INFO celery Detect for <DesktopTask 8>, success
2016-08-17 11:57:32,103 WARNING celery.redirected 2016-08-17 11:57:32,102 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:57:32,103 WARNING celery.redirected 2016-08-17 11:57:32,103 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 57, 32, 101460), 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 32, 101757), 'stage': 'DETECT', 'task_id': 8, 'detail': '', 'success': 1, 'context': '{"serial": null, "detect_method": "PING", "floating_action": "ASSIGN", "port": null, "disk": null, "detect_started_at": "2016-08-17T11:56:28.986043", "image": "8f5f2a12-c078-4be2-b75c-a27bace232ef", "end_datetime": "3016-01-01T00:00:00.000001", "floating_ip": "172.18.231.157", "detect_timeout": 30, "start_datetime": "2016-08-17T11:56:09.335319", "course": null, "wait_timeout": 600, "desktop_type": "STATIC", "wait_started_at": "2016-08-17T11:56:13.996857", "network": "3f7ff60f-cbb5-4972-bf64-f84c01ae9a6e", "wait_state": "ACTIVE", "desktop_name": "teacher_cirros-x86_2016-08-17 11:56:09", "flavor": "f4cb92aa-65f4-450b-a7ed-50c85f5bfc68", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "subnet": null, "owner": 3}'}
2016-08-17 11:57:32,107 WARNING celery.redirected 2016-08-17 11:57:32,107 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:32,109 WARNING celery.redirected 2016-08-17 11:57:32,109 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:32,110 WARNING celery.redirected 2016-08-17 11:57:32,110 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:32,111 WARNING celery.redirected 2016-08-17 11:57:32,111 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:32,116 WARNING celery.redirected 2016-08-17 11:57:32,116 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:57:32,117 WARNING celery.redirected 2016-08-17 11:57:32,117 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 8, 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 32, 116583), 'state': 'FINISHED', 'result': 'SUCCESS'}
2016-08-17 11:57:32,118 WARNING celery.redirected 2016-08-17 11:57:32,118 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:32,120 WARNING celery.redirected 2016-08-17 11:57:32,120 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:32,121 WARNING celery.redirected 2016-08-17 11:57:32,121 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:32,122 WARNING celery.redirected 2016-08-17 11:57:32,122 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:32,125 WARNING celery.redirected 2016-08-17 11:57:32,125 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:32,126 WARNING celery.redirected 2016-08-17 11:57:32,125 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:57:32,129 WARNING celery.redirected 2016-08-17 11:57:32,128 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:57:32,129 WARNING celery.redirected 2016-08-17 11:57:32,129 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'updated_at': datetime.datetime(2016, 8, 17, 11, 57, 32, 128838), 'desktop_state': 'ACTIVE'}
2016-08-17 11:57:32,131 WARNING celery.redirected 2016-08-17 11:57:32,130 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:32,132 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:32,203 INFO celery.worker.job Task detect_floating[845d29fc-fb2b-42f4-85b7-cef60db22e81] succeeded in 0.1331945080000878s: None
2016-08-17 11:57:33,260 INFO celery.worker.strategy Received task: set_desktop_state[f2d19c3e-4c2c-4bba-8d46-413dec1912c5]
2016-08-17 11:57:33,262 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:33,265 WARNING celery.redirected 2016-08-17 11:57:33,264 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:33,266 WARNING celery.redirected 2016-08-17 11:57:33,266 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:33,267 WARNING celery.redirected 2016-08-17 11:57:33,266 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:57:33,269 WARNING celery.redirected 2016-08-17 11:57:33,269 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:57:33,270 WARNING celery.redirected 2016-08-17 11:57:33,270 INFO sqlalchemy.engine.base.Engine {'param_1': 8}
2016-08-17 11:57:33,276 WARNING celery.redirected 2016-08-17 11:57:33,275 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:33,277 WARNING celery.redirected 2016-08-17 11:57:33,277 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:57:33,280 WARNING celery.redirected 2016-08-17 11:57:33,280 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:33,282 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:33,433 INFO celery.worker.job Task set_desktop_state[f2d19c3e-4c2c-4bba-8d46-413dec1912c5] succeeded in 0.17094614000052388s: None
2016-08-17 11:57:34,507 INFO celery.worker.strategy Received task: _create_desktop_detect[b71c6a00-cf18-4ea1-a534-758edb4543dd]
2016-08-17 11:57:34,509 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:57:34,511 WARNING celery.redirected 2016-08-17 11:57:34,510 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:57:34,512 WARNING celery.redirected 2016-08-17 11:57:34,511 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:57:34,512 WARNING celery.redirected 2016-08-17 11:57:34,512 INFO sqlalchemy.engine.base.Engine {'id_1': 8, 'param_1': 1}
2016-08-17 11:57:34,514 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:57:34,514 WARNING celery.redirected 2016-08-17 11:57:34,514 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:57:34,522 INFO celery.worker.job Task _create_desktop_detect[b71c6a00-cf18-4ea1-a534-758edb4543dd] succeeded in 0.012809042000299087s: None
2016-08-17 11:58:03,836 INFO celery.worker.strategy Received task: schedule_clean_desktops[7afc01fa-de08-4202-9cae-0c72af4a11da]
2016-08-17 11:58:03,839 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:03,840 WARNING celery.redirected 2016-08-17 11:58:03,840 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:03,842 WARNING celery.redirected 2016-08-17 11:58:03,841 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:03,842 WARNING celery.redirected 2016-08-17 11:58:03,842 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:58:03,847 WARNING celery.redirected 2016-08-17 11:58:03,847 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:58:03,848 WARNING celery.redirected 2016-08-17 11:58:03,848 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 57, 3, 840002), 'desktop_state_2': 'DELETED'}
2016-08-17 11:58:03,851 WARNING celery.redirected 2016-08-17 11:58:03,851 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:03,853 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:03,863 INFO celery.worker.job Task schedule_clean_desktops[7afc01fa-de08-4202-9cae-0c72af4a11da] succeeded in 0.02475571399918408s: None
2016-08-17 11:58:07,625 INFO celery.worker.strategy Received task: suspend_desktop[7e0374c4-0892-4d31-9ce4-ba9ae843b0fa] eta:[2016-08-17 03:58:08.064671+00:00]
2016-08-17 11:58:08,069 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:08,070 WARNING celery.redirected 2016-08-17 11:58:08,070 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:08,071 WARNING celery.redirected 2016-08-17 11:58:08,071 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:08,072 WARNING celery.redirected 2016-08-17 11:58:08,072 INFO sqlalchemy.engine.base.Engine {'id_1': 9, 'param_1': 1}
2016-08-17 11:58:08,076 WARNING celery.redirected 2016-08-17 11:58:08,075 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:08,076 WARNING celery.redirected 2016-08-17 11:58:08,076 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:08,078 INFO celery Suspend desktop for <DesktopTask 9>
2016-08-17 11:58:08,080 WARNING celery.redirected 2016-08-17 11:58:08,080 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:08,081 WARNING celery.redirected 2016-08-17 11:58:08,081 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:08,084 WARNING celery.redirected 2016-08-17 11:58:08,083 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:08,085 WARNING celery.redirected 2016-08-17 11:58:08,085 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:08,087 WARNING celery.redirected 2016-08-17 11:58:08,086 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:08,087 WARNING celery.redirected 2016-08-17 11:58:08,087 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:08,090 WARNING celery.redirected 2016-08-17 11:58:08,090 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:08,091 WARNING celery.redirected 2016-08-17 11:58:08,091 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 9, 'state': 'RUNNING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 8, 90309)}
2016-08-17 11:58:08,093 WARNING celery.redirected 2016-08-17 11:58:08,093 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:08,096 WARNING celery.redirected 2016-08-17 11:58:08,096 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:08,097 WARNING celery.redirected 2016-08-17 11:58:08,097 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(param_1)s
2016-08-17 11:58:08,098 WARNING celery.redirected 2016-08-17 11:58:08,098 INFO sqlalchemy.engine.base.Engine {'param_1': 4}
2016-08-17 11:58:08,225 WARNING celery.redirected 2016-08-17 11:58:08,225 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:08,226 WARNING celery.redirected 2016-08-17 11:58:08,226 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:08,230 WARNING celery.redirected 2016-08-17 11:58:08,229 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:08,230 WARNING celery.redirected 2016-08-17 11:58:08,230 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 9, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 8, 229700), 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "SUSPENDED", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "SUSPENDED"}, "course_name": null, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4}'}
2016-08-17 11:58:08,233 WARNING celery.redirected 2016-08-17 11:58:08,233 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:58:08,233 WARNING celery.redirected 2016-08-17 11:58:08,233 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 58, 8, 232887), 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 8, 232961), 'stage': 'SUSPEND', 'task_id': 9, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "SUSPENDED", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "SUSPENDED"}, "course_name": null, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4}'}
2016-08-17 11:58:08,235 WARNING celery.redirected 2016-08-17 11:58:08,235 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:08,237 WARNING celery.redirected 2016-08-17 11:58:08,237 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:08,238 WARNING celery.redirected 2016-08-17 11:58:08,238 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:08,239 WARNING celery.redirected 2016-08-17 11:58:08,239 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:08,241 WARNING celery.redirected 2016-08-17 11:58:08,241 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:08,242 WARNING celery.redirected 2016-08-17 11:58:08,242 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 9, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 8, 241406), 'stage': 'WAIT'}
2016-08-17 11:58:08,243 WARNING celery.redirected 2016-08-17 11:58:08,243 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:08,245 WARNING celery.redirected 2016-08-17 11:58:08,245 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:08,247 WARNING celery.redirected 2016-08-17 11:58:08,246 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:08,247 WARNING celery.redirected 2016-08-17 11:58:08,247 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:08,248 INFO celery Suspend desktop for <DesktopTask 9>, success
2016-08-17 11:58:08,249 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:08,249 WARNING celery.redirected 2016-08-17 11:58:08,249 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:08,263 INFO celery.worker.job Task suspend_desktop[7e0374c4-0892-4d31-9ce4-ba9ae843b0fa] succeeded in 0.1942437189991324s: None
2016-08-17 11:58:08,910 INFO celery.worker.strategy Received task: wait_desktop[f6e85c61-be25-4622-a9b8-296646c94143] eta:[2016-08-17 03:58:11.251010+00:00]
2016-08-17 11:58:11,256 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:11,258 WARNING celery.redirected 2016-08-17 11:58:11,257 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:11,259 WARNING celery.redirected 2016-08-17 11:58:11,259 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:11,260 WARNING celery.redirected 2016-08-17 11:58:11,260 INFO sqlalchemy.engine.base.Engine {'id_1': 9, 'param_1': 1}
2016-08-17 11:58:11,264 WARNING celery.redirected 2016-08-17 11:58:11,263 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:11,264 WARNING celery.redirected 2016-08-17 11:58:11,264 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:11,266 INFO celery Wait state for <DesktopTask 9>
2016-08-17 11:58:11,267 WARNING celery.redirected 2016-08-17 11:58:11,267 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:11,268 WARNING celery.redirected 2016-08-17 11:58:11,268 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 9, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 11, 267491), 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "SUSPENDED", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "SUSPENDED"}, "course_name": null, "wait_started_at": "2016-08-17T11:58:11.266741", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4}'}
2016-08-17 11:58:11,269 WARNING celery.redirected 2016-08-17 11:58:11,269 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:11,272 WARNING celery.redirected 2016-08-17 11:58:11,271 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:11,273 WARNING celery.redirected 2016-08-17 11:58:11,273 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:11,273 WARNING celery.redirected 2016-08-17 11:58:11,273 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:11,381 WARNING celery.redirected 2016-08-17 11:58:11,381 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:11,382 WARNING celery.redirected 2016-08-17 11:58:11,382 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:11,384 WARNING celery.redirected 2016-08-17 11:58:11,384 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:58:11,385 WARNING celery.redirected 2016-08-17 11:58:11,385 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'vm_state': 'SUSPENDED', 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 11, 384580)}
2016-08-17 11:58:11,386 WARNING celery.redirected 2016-08-17 11:58:11,386 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:11,389 WARNING celery.redirected 2016-08-17 11:58:11,388 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:11,390 WARNING celery.redirected 2016-08-17 11:58:11,390 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:11,390 WARNING celery.redirected 2016-08-17 11:58:11,390 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:11,392 INFO celery Wait state for <DesktopTask 9>, stage success
2016-08-17 11:58:11,394 WARNING celery.redirected 2016-08-17 11:58:11,394 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:58:11,395 WARNING celery.redirected 2016-08-17 11:58:11,395 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 58, 11, 394405), 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 11, 394552), 'stage': 'WAIT', 'task_id': 9, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "SUSPENDED", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "SUSPENDED"}, "course_name": null, "wait_started_at": "2016-08-17T11:58:11.266741", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4}'}
2016-08-17 11:58:11,397 WARNING celery.redirected 2016-08-17 11:58:11,396 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:11,398 WARNING celery.redirected 2016-08-17 11:58:11,398 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:11,399 WARNING celery.redirected 2016-08-17 11:58:11,399 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:11,400 WARNING celery.redirected 2016-08-17 11:58:11,400 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:11,402 WARNING celery.redirected 2016-08-17 11:58:11,402 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:11,403 WARNING celery.redirected 2016-08-17 11:58:11,403 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 9, 'state': 'FINISHED', 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 11, 402342), 'result': 'SUCCESS'}
2016-08-17 11:58:11,404 WARNING celery.redirected 2016-08-17 11:58:11,404 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:11,405 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:11,530 INFO celery.worker.job Task wait_desktop[f6e85c61-be25-4622-a9b8-296646c94143] succeeded in 0.273895109001387s: None
2016-08-17 11:58:12,622 INFO celery.worker.strategy Received task: set_desktop_state[7d489ca8-3eee-4daa-85fa-1f4f63d3f64c]
2016-08-17 11:58:12,624 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:12,626 WARNING celery.redirected 2016-08-17 11:58:12,626 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:12,629 WARNING celery.redirected 2016-08-17 11:58:12,629 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:12,630 WARNING celery.redirected 2016-08-17 11:58:12,630 INFO sqlalchemy.engine.base.Engine {'id_1': 9, 'param_1': 1}
2016-08-17 11:58:12,636 WARNING celery.redirected 2016-08-17 11:58:12,636 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:12,637 WARNING celery.redirected 2016-08-17 11:58:12,637 INFO sqlalchemy.engine.base.Engine {'param_1': 9}
2016-08-17 11:58:12,642 WARNING celery.redirected 2016-08-17 11:58:12,642 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:12,643 WARNING celery.redirected 2016-08-17 11:58:12,643 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:12,646 WARNING celery.redirected 2016-08-17 11:58:12,645 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:58:12,646 WARNING celery.redirected 2016-08-17 11:58:12,646 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 12, 645725), 'desktop_state': 'SUSPENDED'}
2016-08-17 11:58:12,648 WARNING celery.redirected 2016-08-17 11:58:12,648 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:12,651 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:12,663 INFO celery.worker.job Task set_desktop_state[7d489ca8-3eee-4daa-85fa-1f4f63d3f64c] succeeded in 0.0391019740000047s: None
2016-08-17 11:58:17,570 INFO celery.worker.strategy Received task: resume_desktop[786ac5a2-66b4-401c-9f39-a9327acd4e77] eta:[2016-08-17 03:58:18.435642+00:00]
2016-08-17 11:58:18,440 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:18,441 WARNING celery.redirected 2016-08-17 11:58:18,441 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:18,442 WARNING celery.redirected 2016-08-17 11:58:18,442 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:18,443 WARNING celery.redirected 2016-08-17 11:58:18,442 INFO sqlalchemy.engine.base.Engine {'id_1': 10, 'param_1': 1}
2016-08-17 11:58:18,447 WARNING celery.redirected 2016-08-17 11:58:18,446 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:18,448 WARNING celery.redirected 2016-08-17 11:58:18,448 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:18,450 INFO celery Resume desktop for <DesktopTask 10>
2016-08-17 11:58:18,454 WARNING celery.redirected 2016-08-17 11:58:18,454 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:18,455 WARNING celery.redirected 2016-08-17 11:58:18,455 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:18,458 WARNING celery.redirected 2016-08-17 11:58:18,457 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:18,459 WARNING celery.redirected 2016-08-17 11:58:18,459 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:18,461 WARNING celery.redirected 2016-08-17 11:58:18,461 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:18,461 WARNING celery.redirected 2016-08-17 11:58:18,461 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:18,464 WARNING celery.redirected 2016-08-17 11:58:18,464 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:18,465 WARNING celery.redirected 2016-08-17 11:58:18,464 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'state': 'RUNNING', 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 18, 463832)}
2016-08-17 11:58:18,466 WARNING celery.redirected 2016-08-17 11:58:18,466 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:18,470 WARNING celery.redirected 2016-08-17 11:58:18,469 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:18,472 WARNING celery.redirected 2016-08-17 11:58:18,472 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(param_1)s
2016-08-17 11:58:18,473 WARNING celery.redirected 2016-08-17 11:58:18,472 INFO sqlalchemy.engine.base.Engine {'param_1': 4}
2016-08-17 11:58:18,697 WARNING celery.redirected 2016-08-17 11:58:18,697 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:18,699 WARNING celery.redirected 2016-08-17 11:58:18,698 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:18,706 WARNING celery.redirected 2016-08-17 11:58:18,705 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:18,709 WARNING celery.redirected 2016-08-17 11:58:18,708 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 18, 705060), 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": null, "detect_method": "PING", "floating_ip": "172.18.231.157", "detect_timeout": 30, "desktop": 4, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6"}'}
2016-08-17 11:58:18,713 WARNING celery.redirected 2016-08-17 11:58:18,713 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:58:18,714 WARNING celery.redirected 2016-08-17 11:58:18,714 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 58, 18, 713500), 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 18, 713587), 'stage': 'RESUME', 'task_id': 10, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": null, "detect_method": "PING", "floating_ip": "172.18.231.157", "detect_timeout": 30, "desktop": 4, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6"}'}
2016-08-17 11:58:18,715 WARNING celery.redirected 2016-08-17 11:58:18,715 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:18,722 WARNING celery.redirected 2016-08-17 11:58:18,720 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:18,724 WARNING celery.redirected 2016-08-17 11:58:18,724 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:18,725 WARNING celery.redirected 2016-08-17 11:58:18,725 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:18,727 WARNING celery.redirected 2016-08-17 11:58:18,727 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:18,728 WARNING celery.redirected 2016-08-17 11:58:18,728 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 18, 727364), 'stage': 'WAIT'}
2016-08-17 11:58:18,733 WARNING celery.redirected 2016-08-17 11:58:18,732 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:18,735 WARNING celery.redirected 2016-08-17 11:58:18,734 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:18,736 WARNING celery.redirected 2016-08-17 11:58:18,736 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:18,736 WARNING celery.redirected 2016-08-17 11:58:18,736 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:18,740 INFO celery Resume desktop for <DesktopTask 10>, success
2016-08-17 11:58:18,742 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:18,742 WARNING celery.redirected 2016-08-17 11:58:18,742 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:18,762 INFO celery.worker.job Task resume_desktop[786ac5a2-66b4-401c-9f39-a9327acd4e77] succeeded in 0.3216668010009016s: None
2016-08-17 11:58:18,845 INFO celery.worker.strategy Received task: schedule_start_lesson[ee294d73-f149-49ab-ac22-f8ea91d63da8]
2016-08-17 11:58:18,848 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:18,848 INFO celery Scheduling start lesson tasks
2016-08-17 11:58:18,850 WARNING celery.redirected 2016-08-17 11:58:18,850 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:18,852 WARNING celery.redirected 2016-08-17 11:58:18,851 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:18,852 WARNING celery.redirected 2016-08-17 11:58:18,852 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:58:18,858 WARNING celery.redirected 2016-08-17 11:58:18,858 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:58:18,859 WARNING celery.redirected 2016-08-17 11:58:18,859 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 58, 18, 854759), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 8, 18, 854759), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:58:18,862 WARNING celery.redirected 2016-08-17 11:58:18,862 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:18,864 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:18,875 INFO celery.worker.job Task schedule_start_lesson[ee294d73-f149-49ab-ac22-f8ea91d63da8] succeeded in 0.027663161999953445s: None
2016-08-17 11:58:18,942 INFO celery.worker.strategy Received task: wait_desktop[d0e69899-6fa8-4d91-a2e0-d2a2e93fe823] eta:[2016-08-17 03:58:21.744833+00:00]
2016-08-17 11:58:21,749 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:21,751 WARNING celery.redirected 2016-08-17 11:58:21,751 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:21,752 WARNING celery.redirected 2016-08-17 11:58:21,752 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:21,753 WARNING celery.redirected 2016-08-17 11:58:21,753 INFO sqlalchemy.engine.base.Engine {'id_1': 10, 'param_1': 1}
2016-08-17 11:58:21,756 WARNING celery.redirected 2016-08-17 11:58:21,756 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:21,756 WARNING celery.redirected 2016-08-17 11:58:21,756 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:21,758 INFO celery Wait state for <DesktopTask 10>
2016-08-17 11:58:21,759 WARNING celery.redirected 2016-08-17 11:58:21,759 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:21,760 WARNING celery.redirected 2016-08-17 11:58:21,760 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 21, 759405), 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": null, "detect_method": "PING", "floating_ip": "172.18.231.157", "detect_timeout": 30, "desktop": 4, "wait_started_at": "2016-08-17T11:58:21.758723", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6"}'}
2016-08-17 11:58:21,761 WARNING celery.redirected 2016-08-17 11:58:21,761 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:21,764 WARNING celery.redirected 2016-08-17 11:58:21,763 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:21,765 WARNING celery.redirected 2016-08-17 11:58:21,765 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:21,765 WARNING celery.redirected 2016-08-17 11:58:21,765 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:21,879 WARNING celery.redirected 2016-08-17 11:58:21,879 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:21,880 WARNING celery.redirected 2016-08-17 11:58:21,880 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:21,883 WARNING celery.redirected 2016-08-17 11:58:21,883 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, vm_state=%(vm_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:58:21,883 WARNING celery.redirected 2016-08-17 11:58:21,883 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'vm_state': 'ACTIVE', 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 21, 882952)}
2016-08-17 11:58:21,885 WARNING celery.redirected 2016-08-17 11:58:21,885 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:21,887 WARNING celery.redirected 2016-08-17 11:58:21,887 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:21,888 WARNING celery.redirected 2016-08-17 11:58:21,888 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:21,889 WARNING celery.redirected 2016-08-17 11:58:21,889 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:21,890 INFO celery Wait state for <DesktopTask 10>, stage success
2016-08-17 11:58:21,892 WARNING celery.redirected 2016-08-17 11:58:21,892 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:58:21,892 WARNING celery.redirected 2016-08-17 11:58:21,892 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 58, 21, 892032), 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 21, 892074), 'stage': 'WAIT', 'task_id': 10, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": null, "detect_method": "PING", "floating_ip": "172.18.231.157", "detect_timeout": 30, "desktop": 4, "wait_started_at": "2016-08-17T11:58:21.758723", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6"}'}
2016-08-17 11:58:21,893 WARNING celery.redirected 2016-08-17 11:58:21,893 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:21,896 WARNING celery.redirected 2016-08-17 11:58:21,895 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:21,897 WARNING celery.redirected 2016-08-17 11:58:21,897 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:21,897 WARNING celery.redirected 2016-08-17 11:58:21,897 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:21,900 WARNING celery.redirected 2016-08-17 11:58:21,899 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:21,900 WARNING celery.redirected 2016-08-17 11:58:21,900 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 21, 899844), 'stage': 'DETECT'}
2016-08-17 11:58:21,902 WARNING celery.redirected 2016-08-17 11:58:21,902 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:21,903 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:21,915 INFO celery.worker.job Task wait_desktop[d0e69899-6fa8-4d91-a2e0-d2a2e93fe823] succeeded in 0.1658036089993402s: None
2016-08-17 11:58:22,592 INFO celery.worker.strategy Received task: detect_floating[7ba7ac77-f3ca-4c20-a833-0fec05c8d80e] eta:[2016-08-17 03:58:24.904119+00:00]
2016-08-17 11:58:24,907 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:24,908 WARNING celery.redirected 2016-08-17 11:58:24,908 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:24,909 WARNING celery.redirected 2016-08-17 11:58:24,909 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:24,910 WARNING celery.redirected 2016-08-17 11:58:24,910 INFO sqlalchemy.engine.base.Engine {'id_1': 10, 'param_1': 1}
2016-08-17 11:58:24,912 WARNING celery.redirected 2016-08-17 11:58:24,912 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:24,913 WARNING celery.redirected 2016-08-17 11:58:24,913 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:24,915 INFO celery Detect for <DesktopTask 10>
2016-08-17 11:58:24,916 WARNING celery.redirected 2016-08-17 11:58:24,916 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:24,917 WARNING celery.redirected 2016-08-17 11:58:24,917 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 24, 916245), 'context': '{"wait_timeout": 600, "serial": null, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "detect_method": "PING", "detect_started_at": "2016-08-17T11:58:24.915559", "wait_started_at": "2016-08-17T11:58:21.758723", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": null, "floating_ip": "172.18.231.157", "detect_timeout": 30, "desktop": 4}'}
2016-08-17 11:58:24,918 WARNING celery.redirected 2016-08-17 11:58:24,918 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:24,921 WARNING celery.redirected 2016-08-17 11:58:24,920 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:24,922 WARNING celery.redirected 2016-08-17 11:58:24,922 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:24,922 WARNING celery.redirected 2016-08-17 11:58:24,922 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:24,931 INFO celery Detect for <DesktopTask 10>, success
2016-08-17 11:58:24,934 WARNING celery.redirected 2016-08-17 11:58:24,934 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 11:58:24,935 WARNING celery.redirected 2016-08-17 11:58:24,934 INFO sqlalchemy.engine.base.Engine {'created_at': datetime.datetime(2016, 8, 17, 11, 58, 24, 933753), 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 24, 933834), 'stage': 'DETECT', 'task_id': 10, 'detail': '', 'success': 1, 'context': '{"wait_timeout": 600, "serial": null, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "detect_method": "PING", "detect_started_at": "2016-08-17T11:58:24.915559", "wait_started_at": "2016-08-17T11:58:21.758723", "wait_state": "ACTIVE", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "course_name": null, "floating_ip": "172.18.231.157", "detect_timeout": 30, "desktop": 4}'}
2016-08-17 11:58:24,936 WARNING celery.redirected 2016-08-17 11:58:24,936 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:24,938 WARNING celery.redirected 2016-08-17 11:58:24,938 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:24,940 WARNING celery.redirected 2016-08-17 11:58:24,939 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:24,940 WARNING celery.redirected 2016-08-17 11:58:24,940 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:24,943 WARNING celery.redirected 2016-08-17 11:58:24,942 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 11:58:24,943 WARNING celery.redirected 2016-08-17 11:58:24,943 INFO sqlalchemy.engine.base.Engine {'desktop_tasks_id': 10, 'state': 'FINISHED', 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 24, 942845), 'result': 'SUCCESS'}
2016-08-17 11:58:24,945 WARNING celery.redirected 2016-08-17 11:58:24,944 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:24,947 WARNING celery.redirected 2016-08-17 11:58:24,947 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:24,948 WARNING celery.redirected 2016-08-17 11:58:24,948 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:24,949 WARNING celery.redirected 2016-08-17 11:58:24,948 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:24,952 WARNING celery.redirected 2016-08-17 11:58:24,952 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:24,952 WARNING celery.redirected 2016-08-17 11:58:24,952 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:24,955 WARNING celery.redirected 2016-08-17 11:58:24,955 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 11:58:24,955 WARNING celery.redirected 2016-08-17 11:58:24,955 INFO sqlalchemy.engine.base.Engine {'desktops_id': 4, 'updated_at': datetime.datetime(2016, 8, 17, 11, 58, 24, 954974), 'desktop_state': 'ACTIVE'}
2016-08-17 11:58:24,957 WARNING celery.redirected 2016-08-17 11:58:24,956 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:24,958 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:25,159 INFO celery.worker.job Task detect_floating[7ba7ac77-f3ca-4c20-a833-0fec05c8d80e] succeeded in 0.25189606200001435s: None
2016-08-17 11:58:26,210 INFO celery.worker.strategy Received task: set_desktop_state[b5c8f520-edde-406c-9a48-b606cd86942f]
2016-08-17 11:58:26,212 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:58:26,213 WARNING celery.redirected 2016-08-17 11:58:26,213 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:58:26,214 WARNING celery.redirected 2016-08-17 11:58:26,214 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:26,215 WARNING celery.redirected 2016-08-17 11:58:26,215 INFO sqlalchemy.engine.base.Engine {'id_1': 10, 'param_1': 1}
2016-08-17 11:58:26,218 WARNING celery.redirected 2016-08-17 11:58:26,218 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 11:58:26,219 WARNING celery.redirected 2016-08-17 11:58:26,219 INFO sqlalchemy.engine.base.Engine {'param_1': 10}
2016-08-17 11:58:26,223 WARNING celery.redirected 2016-08-17 11:58:26,223 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 11:58:26,223 WARNING celery.redirected 2016-08-17 11:58:26,223 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 11:58:26,226 WARNING celery.redirected 2016-08-17 11:58:26,226 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:58:26,227 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:58:26,235 INFO celery.worker.job Task set_desktop_state[b5c8f520-edde-406c-9a48-b606cd86942f] succeeded in 0.023321026999838068s: None
2016-08-17 11:59:08,600 INFO celery.worker.strategy Received task: schedule_clean_desktops[1de79972-fc3e-4075-b661-387ecf934136]
2016-08-17 11:59:08,601 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:59:08,603 WARNING celery.redirected 2016-08-17 11:59:08,603 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:59:08,604 WARNING celery.redirected 2016-08-17 11:59:08,604 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:59:08,604 WARNING celery.redirected 2016-08-17 11:59:08,604 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 11:59:08,608 WARNING celery.redirected 2016-08-17 11:59:08,608 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 11:59:08,608 WARNING celery.redirected 2016-08-17 11:59:08,608 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 58, 8, 602273), 'desktop_state_2': 'DELETED'}
2016-08-17 11:59:08,612 WARNING celery.redirected 2016-08-17 11:59:08,611 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:59:08,613 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:59:08,621 INFO celery.worker.job Task schedule_clean_desktops[1de79972-fc3e-4075-b661-387ecf934136] succeeded in 0.019890960998964147s: None
2016-08-17 11:59:23,063 INFO celery.worker.strategy Received task: schedule_start_lesson[a96fabef-b715-4bf1-9c7a-c2dc493331a6]
2016-08-17 11:59:23,065 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 11:59:23,065 INFO celery Scheduling start lesson tasks
2016-08-17 11:59:23,066 WARNING celery.redirected 2016-08-17 11:59:23,066 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 11:59:23,067 WARNING celery.redirected 2016-08-17 11:59:23,067 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 11:59:23,067 WARNING celery.redirected 2016-08-17 11:59:23,067 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 11:59:23,071 WARNING celery.redirected 2016-08-17 11:59:23,071 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 11:59:23,072 WARNING celery.redirected 2016-08-17 11:59:23,072 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(11, 59, 23, 69236), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 9, 23, 69236), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 11:59:23,074 WARNING celery.redirected 2016-08-17 11:59:23,074 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 11:59:23,075 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 11:59:23,082 INFO celery.worker.job Task schedule_start_lesson[a96fabef-b715-4bf1-9c7a-c2dc493331a6] succeeded in 0.01733530900128244s: None
2016-08-17 12:00:03,343 INFO celery.worker.strategy Received task: celery.backend_cleanup[c5429051-40bc-4b7c-a3d4-ef4cd9f4e496]
2016-08-17 12:00:03,344 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:00:03,360 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:00:03,368 INFO celery.worker.job Task celery.backend_cleanup[c5429051-40bc-4b7c-a3d4-ef4cd9f4e496] succeeded in 0.023636308000277495s: None
2016-08-17 12:00:13,057 INFO celery.worker.strategy Received task: schedule_clean_desktops[c77ab52d-7c00-48e2-ae2b-d44a9c777093]
2016-08-17 12:00:13,058 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:00:13,060 WARNING celery.redirected 2016-08-17 12:00:13,060 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:00:13,061 WARNING celery.redirected 2016-08-17 12:00:13,061 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:00:13,062 WARNING celery.redirected 2016-08-17 12:00:13,062 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:00:13,066 WARNING celery.redirected 2016-08-17 12:00:13,066 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:00:13,067 WARNING celery.redirected 2016-08-17 12:00:13,067 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 11, 59, 13, 59551), 'desktop_state_2': 'DELETED'}
2016-08-17 12:00:13,070 WARNING celery.redirected 2016-08-17 12:00:13,070 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:00:13,071 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:00:13,079 INFO celery.worker.job Task schedule_clean_desktops[c77ab52d-7c00-48e2-ae2b-d44a9c777093] succeeded in 0.020554394999635406s: None
2016-08-17 12:00:28,850 INFO celery.worker.strategy Received task: schedule_start_lesson[ab94a62d-621f-4cb5-861f-570507afba37]
2016-08-17 12:00:28,851 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:00:28,851 INFO celery Scheduling start lesson tasks
2016-08-17 12:00:28,852 WARNING celery.redirected 2016-08-17 12:00:28,852 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:00:28,853 WARNING celery.redirected 2016-08-17 12:00:28,853 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:00:28,854 WARNING celery.redirected 2016-08-17 12:00:28,854 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:00:28,857 WARNING celery.redirected 2016-08-17 12:00:28,857 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:00:28,858 WARNING celery.redirected 2016-08-17 12:00:28,858 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 0, 28, 855720), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 10, 28, 855720), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:00:28,861 WARNING celery.redirected 2016-08-17 12:00:28,861 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:00:28,862 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:00:28,869 INFO celery.worker.job Task schedule_start_lesson[ab94a62d-621f-4cb5-861f-570507afba37] succeeded in 0.018592801001432235s: None
2016-08-17 12:01:18,994 INFO celery.worker.strategy Received task: schedule_clean_desktops[072a3632-defa-4733-9a2c-22c258566107]
2016-08-17 12:01:18,996 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:01:18,998 WARNING celery.redirected 2016-08-17 12:01:18,997 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:01:18,999 WARNING celery.redirected 2016-08-17 12:01:18,998 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:01:18,999 WARNING celery.redirected 2016-08-17 12:01:18,999 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:01:19,002 WARNING celery.redirected 2016-08-17 12:01:19,002 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:01:19,003 WARNING celery.redirected 2016-08-17 12:01:19,003 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 0, 18, 997189), 'desktop_state_2': 'DELETED'}
2016-08-17 12:01:19,006 WARNING celery.redirected 2016-08-17 12:01:19,006 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:01:19,008 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:01:19,016 INFO celery.worker.job Task schedule_clean_desktops[072a3632-defa-4733-9a2c-22c258566107] succeeded in 0.02005992000158585s: None
2016-08-17 12:01:33,487 INFO celery.worker.strategy Received task: schedule_start_lesson[bc70d866-df97-4fbe-9a99-21f32ed40441]
2016-08-17 12:01:33,489 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:01:33,489 INFO celery Scheduling start lesson tasks
2016-08-17 12:01:33,490 WARNING celery.redirected 2016-08-17 12:01:33,490 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:01:33,491 WARNING celery.redirected 2016-08-17 12:01:33,491 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:01:33,492 WARNING celery.redirected 2016-08-17 12:01:33,492 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:01:33,497 WARNING celery.redirected 2016-08-17 12:01:33,496 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:01:33,497 WARNING celery.redirected 2016-08-17 12:01:33,497 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 1, 33, 493899), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 11, 33, 493899), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:01:33,499 WARNING celery.redirected 2016-08-17 12:01:33,499 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:01:33,500 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:01:33,508 INFO celery.worker.job Task schedule_start_lesson[bc70d866-df97-4fbe-9a99-21f32ed40441] succeeded in 0.019544632001270656s: None
2016-08-17 12:02:23,071 INFO celery.worker.strategy Received task: schedule_clean_desktops[ca517342-fe91-413e-809d-4cdee0bb4871]
2016-08-17 12:02:23,074 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:02:23,076 WARNING celery.redirected 2016-08-17 12:02:23,075 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:02:23,077 WARNING celery.redirected 2016-08-17 12:02:23,077 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:02:23,077 WARNING celery.redirected 2016-08-17 12:02:23,077 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:02:23,082 WARNING celery.redirected 2016-08-17 12:02:23,081 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:02:23,082 WARNING celery.redirected 2016-08-17 12:02:23,082 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 1, 23, 75156), 'desktop_state_2': 'DELETED'}
2016-08-17 12:02:23,088 WARNING celery.redirected 2016-08-17 12:02:23,088 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:02:23,090 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:02:23,101 INFO celery.worker.job Task schedule_clean_desktops[ca517342-fe91-413e-809d-4cdee0bb4871] succeeded in 0.027407248000599793s: None
2016-08-17 12:02:38,930 INFO celery.worker.strategy Received task: schedule_start_lesson[2b8a1ccd-3dc7-4519-ae3a-a2ac201dba05]
2016-08-17 12:02:38,933 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:02:38,934 INFO celery Scheduling start lesson tasks
2016-08-17 12:02:38,935 WARNING celery.redirected 2016-08-17 12:02:38,935 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:02:38,936 WARNING celery.redirected 2016-08-17 12:02:38,936 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:02:38,937 WARNING celery.redirected 2016-08-17 12:02:38,937 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:02:38,944 WARNING celery.redirected 2016-08-17 12:02:38,943 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:02:38,944 WARNING celery.redirected 2016-08-17 12:02:38,944 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 2, 38, 941459), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 12, 38, 941459), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:02:38,946 WARNING celery.redirected 2016-08-17 12:02:38,946 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:02:38,947 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:02:38,955 INFO celery.worker.job Task schedule_start_lesson[2b8a1ccd-3dc7-4519-ae3a-a2ac201dba05] succeeded in 0.022696324000207824s: None
2016-08-17 12:03:28,978 INFO celery.worker.strategy Received task: schedule_clean_desktops[366d55bc-778b-4c21-b311-f863930fbc52]
2016-08-17 12:03:28,980 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:03:28,983 WARNING celery.redirected 2016-08-17 12:03:28,983 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:03:28,984 WARNING celery.redirected 2016-08-17 12:03:28,984 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:03:28,984 WARNING celery.redirected 2016-08-17 12:03:28,984 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:03:28,988 WARNING celery.redirected 2016-08-17 12:03:28,988 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:03:28,989 WARNING celery.redirected 2016-08-17 12:03:28,989 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 2, 28, 982385), 'desktop_state_2': 'DELETED'}
2016-08-17 12:03:28,991 WARNING celery.redirected 2016-08-17 12:03:28,991 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:03:28,992 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:03:29,002 INFO celery.worker.job Task schedule_clean_desktops[366d55bc-778b-4c21-b311-f863930fbc52] succeeded in 0.02260487100102182s: None
2016-08-17 12:03:38,665 INFO celery.worker.strategy Received task: schedule_start_lesson[c797e462-b557-4eab-8d15-44e6b63df3fd]
2016-08-17 12:03:38,666 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:03:38,667 INFO celery Scheduling start lesson tasks
2016-08-17 12:03:38,668 WARNING celery.redirected 2016-08-17 12:03:38,668 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:03:38,670 WARNING celery.redirected 2016-08-17 12:03:38,669 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:03:38,670 WARNING celery.redirected 2016-08-17 12:03:38,670 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:03:38,676 WARNING celery.redirected 2016-08-17 12:03:38,676 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:03:38,677 WARNING celery.redirected 2016-08-17 12:03:38,677 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 3, 38, 672255), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 13, 38, 672255), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:03:38,681 WARNING celery.redirected 2016-08-17 12:03:38,681 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:03:38,683 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:03:38,698 INFO celery.worker.job Task schedule_start_lesson[c797e462-b557-4eab-8d15-44e6b63df3fd] succeeded in 0.03180316100042546s: None
2016-08-17 12:04:28,667 INFO celery.worker.strategy Received task: schedule_clean_desktops[301875e0-dae5-4904-b478-60e83822a361]
2016-08-17 12:04:28,668 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:04:28,670 WARNING celery.redirected 2016-08-17 12:04:28,670 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:04:28,671 WARNING celery.redirected 2016-08-17 12:04:28,671 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:04:28,671 WARNING celery.redirected 2016-08-17 12:04:28,671 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:04:28,675 WARNING celery.redirected 2016-08-17 12:04:28,675 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:04:28,675 WARNING celery.redirected 2016-08-17 12:04:28,675 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 3, 28, 669293), 'desktop_state_2': 'DELETED'}
2016-08-17 12:04:28,678 WARNING celery.redirected 2016-08-17 12:04:28,678 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:04:28,679 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:04:28,689 INFO celery.worker.job Task schedule_clean_desktops[301875e0-dae5-4904-b478-60e83822a361] succeeded in 0.02071277100003499s: None
2016-08-17 12:04:38,314 INFO celery.worker.strategy Received task: schedule_start_lesson[b8f6981a-71f9-4bb3-885f-ef9e7c2e8e3e]
2016-08-17 12:04:38,316 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:04:38,316 INFO celery Scheduling start lesson tasks
2016-08-17 12:04:38,317 WARNING celery.redirected 2016-08-17 12:04:38,317 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:04:38,318 WARNING celery.redirected 2016-08-17 12:04:38,318 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:04:38,319 WARNING celery.redirected 2016-08-17 12:04:38,319 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:04:38,322 WARNING celery.redirected 2016-08-17 12:04:38,322 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:04:38,323 WARNING celery.redirected 2016-08-17 12:04:38,323 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 4, 38, 320382), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 14, 38, 320382), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:04:38,326 WARNING celery.redirected 2016-08-17 12:04:38,325 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:04:38,327 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:04:38,335 INFO celery.worker.job Task schedule_start_lesson[b8f6981a-71f9-4bb3-885f-ef9e7c2e8e3e] succeeded in 0.01952211299976625s: None
2016-08-17 12:05:29,078 INFO celery.worker.strategy Received task: schedule_clean_desktops[0c7c07c4-1897-4ace-9c66-700d921ca656]
2016-08-17 12:05:29,080 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:05:29,081 WARNING celery.redirected 2016-08-17 12:05:29,081 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:05:29,083 WARNING celery.redirected 2016-08-17 12:05:29,083 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:05:29,084 WARNING celery.redirected 2016-08-17 12:05:29,084 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:05:29,087 WARNING celery.redirected 2016-08-17 12:05:29,087 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:05:29,088 WARNING celery.redirected 2016-08-17 12:05:29,088 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 4, 29, 81132), 'desktop_state_2': 'DELETED'}
2016-08-17 12:05:29,091 WARNING celery.redirected 2016-08-17 12:05:29,091 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:05:29,092 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:05:29,101 INFO celery.worker.job Task schedule_clean_desktops[0c7c07c4-1897-4ace-9c66-700d921ca656] succeeded in 0.021459919998960686s: None
2016-08-17 12:05:38,720 INFO celery.worker.strategy Received task: schedule_start_lesson[e5701032-1efd-4a21-ab07-d69e7f13f76d]
2016-08-17 12:05:38,722 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:05:38,722 INFO celery Scheduling start lesson tasks
2016-08-17 12:05:38,723 WARNING celery.redirected 2016-08-17 12:05:38,723 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:05:38,724 WARNING celery.redirected 2016-08-17 12:05:38,724 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:05:38,725 WARNING celery.redirected 2016-08-17 12:05:38,725 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:05:38,729 WARNING celery.redirected 2016-08-17 12:05:38,729 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:05:38,730 WARNING celery.redirected 2016-08-17 12:05:38,729 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 5, 38, 727034), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 15, 38, 727034), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:05:38,732 WARNING celery.redirected 2016-08-17 12:05:38,732 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:05:38,733 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:05:38,739 INFO celery.worker.job Task schedule_start_lesson[e5701032-1efd-4a21-ab07-d69e7f13f76d] succeeded in 0.017788245999327046s: None
2016-08-17 12:06:28,783 INFO celery.worker.strategy Received task: schedule_clean_desktops[acf002bb-86dd-4081-9a3a-26fbdad901b0]
2016-08-17 12:06:28,784 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:06:28,787 WARNING celery.redirected 2016-08-17 12:06:28,786 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:06:28,788 WARNING celery.redirected 2016-08-17 12:06:28,788 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:06:28,789 WARNING celery.redirected 2016-08-17 12:06:28,789 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:06:28,795 WARNING celery.redirected 2016-08-17 12:06:28,794 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:06:28,795 WARNING celery.redirected 2016-08-17 12:06:28,795 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 5, 28, 785766), 'desktop_state_2': 'DELETED'}
2016-08-17 12:06:28,798 WARNING celery.redirected 2016-08-17 12:06:28,798 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:06:28,800 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:06:28,809 INFO celery.worker.job Task schedule_clean_desktops[acf002bb-86dd-4081-9a3a-26fbdad901b0] succeeded in 0.02517422799974156s: None
2016-08-17 12:06:38,543 INFO celery.worker.strategy Received task: schedule_start_lesson[bfa237a9-13b3-48c1-a7f3-247d5521bcf3]
2016-08-17 12:06:38,545 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:06:38,545 INFO celery Scheduling start lesson tasks
2016-08-17 12:06:38,546 WARNING celery.redirected 2016-08-17 12:06:38,546 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:06:38,547 WARNING celery.redirected 2016-08-17 12:06:38,547 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:06:38,548 WARNING celery.redirected 2016-08-17 12:06:38,548 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:06:38,552 WARNING celery.redirected 2016-08-17 12:06:38,552 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:06:38,553 WARNING celery.redirected 2016-08-17 12:06:38,553 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 6, 38, 549844), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 16, 38, 549844), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:06:38,556 WARNING celery.redirected 2016-08-17 12:06:38,555 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:06:38,558 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:06:38,565 INFO celery.worker.job Task schedule_start_lesson[bfa237a9-13b3-48c1-a7f3-247d5521bcf3] succeeded in 0.020180457999231294s: None
2016-08-17 12:07:28,953 INFO celery.worker.strategy Received task: schedule_clean_desktops[8ae48859-04d6-4502-9f90-fca6d956f9ea]
2016-08-17 12:07:28,955 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:07:28,957 WARNING celery.redirected 2016-08-17 12:07:28,957 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:07:28,958 WARNING celery.redirected 2016-08-17 12:07:28,958 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:07:28,958 WARNING celery.redirected 2016-08-17 12:07:28,958 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:07:28,962 WARNING celery.redirected 2016-08-17 12:07:28,962 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:07:28,962 WARNING celery.redirected 2016-08-17 12:07:28,962 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 6, 28, 956184), 'desktop_state_2': 'DELETED'}
2016-08-17 12:07:28,966 WARNING celery.redirected 2016-08-17 12:07:28,966 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:07:28,968 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:07:28,977 INFO celery.worker.job Task schedule_clean_desktops[8ae48859-04d6-4502-9f90-fca6d956f9ea] succeeded in 0.02284870800031058s: None
2016-08-17 12:07:38,687 INFO celery.worker.strategy Received task: schedule_start_lesson[ce1dd04f-cdd5-4a42-b0e8-3f3c747bdcc2]
2016-08-17 12:07:38,692 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:07:38,694 INFO celery Scheduling start lesson tasks
2016-08-17 12:07:38,695 WARNING celery.redirected 2016-08-17 12:07:38,695 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:07:38,696 WARNING celery.redirected 2016-08-17 12:07:38,696 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:07:38,697 WARNING celery.redirected 2016-08-17 12:07:38,697 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:07:38,701 WARNING celery.redirected 2016-08-17 12:07:38,701 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:07:38,702 WARNING celery.redirected 2016-08-17 12:07:38,702 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 7, 38, 698803), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 17, 38, 698803), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:07:38,704 WARNING celery.redirected 2016-08-17 12:07:38,704 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:07:38,705 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:07:38,713 INFO celery.worker.job Task schedule_start_lesson[ce1dd04f-cdd5-4a42-b0e8-3f3c747bdcc2] succeeded in 0.021681747000911855s: None
2016-08-17 12:08:29,051 INFO celery.worker.strategy Received task: schedule_clean_desktops[88256b90-4914-439f-8b3a-b41d1f7801d5]
2016-08-17 12:08:29,052 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:08:29,054 WARNING celery.redirected 2016-08-17 12:08:29,054 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:08:29,056 WARNING celery.redirected 2016-08-17 12:08:29,055 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:08:29,056 WARNING celery.redirected 2016-08-17 12:08:29,056 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 12:08:29,061 WARNING celery.redirected 2016-08-17 12:08:29,060 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 12:08:29,061 WARNING celery.redirected 2016-08-17 12:08:29,061 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 12, 7, 29, 53559), 'desktop_state_2': 'DELETED'}
2016-08-17 12:08:29,064 WARNING celery.redirected 2016-08-17 12:08:29,064 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:08:29,065 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:08:29,075 INFO celery.worker.job Task schedule_clean_desktops[88256b90-4914-439f-8b3a-b41d1f7801d5] succeeded in 0.02282367199950386s: None
2016-08-17 12:08:38,816 INFO celery.worker.strategy Received task: schedule_start_lesson[7c09f9b8-d717-4c25-bf8f-4babd39ff1d8]
2016-08-17 12:08:38,817 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 12:08:38,818 INFO celery Scheduling start lesson tasks
2016-08-17 12:08:38,819 WARNING celery.redirected 2016-08-17 12:08:38,819 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 12:08:38,820 WARNING celery.redirected 2016-08-17 12:08:38,820 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 12:08:38,820 WARNING celery.redirected 2016-08-17 12:08:38,820 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 12:08:38,824 WARNING celery.redirected 2016-08-17 12:08:38,824 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 12:08:38,825 WARNING celery.redirected 2016-08-17 12:08:38,824 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(12, 8, 38, 822326), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(12, 18, 38, 822326), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 12:08:38,827 WARNING celery.redirected 2016-08-17 12:08:38,827 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 12:08:38,828 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 12:08:38,835 INFO celery.worker.job Task schedule_start_lesson[7c09f9b8-d717-4c25-bf8f-4babd39ff1d8] succeeded in 0.01764919400011422s: None
2016-08-17 13:17:51,200 INFO celery.worker.strategy Received task: schedule_clean_desktops[3d15a9ab-381c-4149-8560-57eda94a63f3]
2016-08-17 13:17:51,202 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:17:51,204 WARNING celery.redirected 2016-08-17 13:17:51,204 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:17:51,205 WARNING celery.redirected 2016-08-17 13:17:51,205 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:17:51,206 WARNING celery.redirected 2016-08-17 13:17:51,206 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:17:51,210 WARNING celery.redirected 2016-08-17 13:17:51,209 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:17:51,210 WARNING celery.redirected 2016-08-17 13:17:51,210 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 16, 51, 203340), 'desktop_state_2': 'DELETED'}
2016-08-17 13:17:51,212 WARNING celery.redirected 2016-08-17 13:17:51,212 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:17:51,213 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:17:51,223 INFO celery.worker.job Task schedule_clean_desktops[3d15a9ab-381c-4149-8560-57eda94a63f3] succeeded in 0.021051592999356217s: None
2016-08-17 13:17:51,273 INFO celery.worker.strategy Received task: schedule_start_lesson[f7bf8765-bfc3-45a1-9454-f882562528c7]
2016-08-17 13:17:51,274 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:17:51,275 INFO celery Scheduling start lesson tasks
2016-08-17 13:17:51,276 WARNING celery.redirected 2016-08-17 13:17:51,276 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:17:51,277 WARNING celery.redirected 2016-08-17 13:17:51,277 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:17:51,278 WARNING celery.redirected 2016-08-17 13:17:51,278 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:17:51,281 WARNING celery.redirected 2016-08-17 13:17:51,281 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:17:51,282 WARNING celery.redirected 2016-08-17 13:17:51,282 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 17, 51, 279446), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 27, 51, 279446), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:17:51,284 WARNING celery.redirected 2016-08-17 13:17:51,284 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:17:51,285 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:17:51,294 INFO celery.worker.job Task schedule_start_lesson[f7bf8765-bfc3-45a1-9454-f882562528c7] succeeded in 0.019987440000477363s: None
2016-08-17 13:18:51,143 INFO celery.worker.strategy Received task: schedule_clean_desktops[d1f6bb4b-0e38-4c05-a77a-f85f56946398]
2016-08-17 13:18:51,145 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:18:51,146 WARNING celery.redirected 2016-08-17 13:18:51,146 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:18:51,147 WARNING celery.redirected 2016-08-17 13:18:51,147 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:18:51,148 WARNING celery.redirected 2016-08-17 13:18:51,148 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:18:51,151 WARNING celery.redirected 2016-08-17 13:18:51,151 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:18:51,152 WARNING celery.redirected 2016-08-17 13:18:51,151 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 17, 51, 146040), 'desktop_state_2': 'DELETED'}
2016-08-17 13:18:51,154 WARNING celery.redirected 2016-08-17 13:18:51,154 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:18:51,155 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:18:51,163 INFO celery.worker.job Task schedule_clean_desktops[d1f6bb4b-0e38-4c05-a77a-f85f56946398] succeeded in 0.01858736900067015s: None
2016-08-17 13:18:51,217 INFO celery.worker.strategy Received task: schedule_start_lesson[b3b81572-d1a3-493b-aefa-e048c60c05b9]
2016-08-17 13:18:51,218 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:18:51,219 INFO celery Scheduling start lesson tasks
2016-08-17 13:18:51,223 WARNING celery.redirected 2016-08-17 13:18:51,223 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:18:51,225 WARNING celery.redirected 2016-08-17 13:18:51,224 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:18:51,225 WARNING celery.redirected 2016-08-17 13:18:51,225 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:18:51,229 WARNING celery.redirected 2016-08-17 13:18:51,229 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:18:51,229 WARNING celery.redirected 2016-08-17 13:18:51,229 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 18, 51, 227161), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 28, 51, 227161), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:18:51,231 WARNING celery.redirected 2016-08-17 13:18:51,231 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:18:51,232 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:18:51,240 INFO celery.worker.job Task schedule_start_lesson[b3b81572-d1a3-493b-aefa-e048c60c05b9] succeeded in 0.02176317700104846s: None
2016-08-17 13:19:50,255 INFO celery.worker.strategy Received task: schedule_clean_desktops[6d40b397-8b3f-4f38-830f-2309bc8854d7]
2016-08-17 13:19:50,257 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:19:50,262 WARNING celery.redirected 2016-08-17 13:19:50,262 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:19:50,263 WARNING celery.redirected 2016-08-17 13:19:50,263 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:19:50,264 WARNING celery.redirected 2016-08-17 13:19:50,263 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:19:50,267 WARNING celery.redirected 2016-08-17 13:19:50,267 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:19:50,268 WARNING celery.redirected 2016-08-17 13:19:50,268 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 18, 50, 259196), 'desktop_state_2': 'DELETED'}
2016-08-17 13:19:50,270 WARNING celery.redirected 2016-08-17 13:19:50,269 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:19:50,271 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:19:50,282 INFO celery.worker.job Task schedule_clean_desktops[6d40b397-8b3f-4f38-830f-2309bc8854d7] succeeded in 0.024544523999793455s: None
2016-08-17 13:19:50,335 INFO celery.worker.strategy Received task: schedule_start_lesson[85575b79-7194-4195-a043-a0ec7c52688d]
2016-08-17 13:19:50,336 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:19:50,336 INFO celery Scheduling start lesson tasks
2016-08-17 13:19:50,340 WARNING celery.redirected 2016-08-17 13:19:50,340 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:19:50,341 WARNING celery.redirected 2016-08-17 13:19:50,341 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:19:50,341 WARNING celery.redirected 2016-08-17 13:19:50,341 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:19:50,345 WARNING celery.redirected 2016-08-17 13:19:50,345 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:19:50,346 WARNING celery.redirected 2016-08-17 13:19:50,346 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 19, 50, 343200), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 29, 50, 343200), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:19:50,348 WARNING celery.redirected 2016-08-17 13:19:50,348 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:19:50,349 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:19:50,357 INFO celery.worker.job Task schedule_start_lesson[85575b79-7194-4195-a043-a0ec7c52688d] succeeded in 0.02111930799947004s: None
2016-08-17 13:20:54,851 INFO celery.worker.strategy Received task: schedule_clean_desktops[b02b562d-873c-4d5c-8574-bac3a0b11c37]
2016-08-17 13:20:54,852 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:20:54,856 WARNING celery.redirected 2016-08-17 13:20:54,855 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:20:54,857 WARNING celery.redirected 2016-08-17 13:20:54,857 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:20:54,857 WARNING celery.redirected 2016-08-17 13:20:54,857 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:20:54,860 WARNING celery.redirected 2016-08-17 13:20:54,860 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:20:54,861 WARNING celery.redirected 2016-08-17 13:20:54,861 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 19, 54, 853277), 'desktop_state_2': 'DELETED'}
2016-08-17 13:20:54,863 WARNING celery.redirected 2016-08-17 13:20:54,863 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:20:54,864 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:20:54,871 INFO celery.worker.job Task schedule_clean_desktops[b02b562d-873c-4d5c-8574-bac3a0b11c37] succeeded in 0.0188016569991305s: None
2016-08-17 13:20:54,927 INFO celery.worker.strategy Received task: schedule_start_lesson[1c5446fd-6961-4306-b85a-91d05bdabfa3]
2016-08-17 13:20:54,929 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:20:54,930 INFO celery Scheduling start lesson tasks
2016-08-17 13:20:54,931 WARNING celery.redirected 2016-08-17 13:20:54,931 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:20:54,932 WARNING celery.redirected 2016-08-17 13:20:54,931 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:20:54,932 WARNING celery.redirected 2016-08-17 13:20:54,932 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:20:54,936 WARNING celery.redirected 2016-08-17 13:20:54,936 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:20:54,936 WARNING celery.redirected 2016-08-17 13:20:54,936 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 20, 54, 933838), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 30, 54, 933838), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:20:54,939 WARNING celery.redirected 2016-08-17 13:20:54,939 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:20:54,940 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:20:54,946 INFO celery.worker.job Task schedule_start_lesson[1c5446fd-6961-4306-b85a-91d05bdabfa3] succeeded in 0.017077236001568963s: None
2016-08-17 13:21:54,357 INFO celery.worker.strategy Received task: schedule_clean_desktops[a1bd0cfc-ce74-44b9-9293-daa51884b5b3]
2016-08-17 13:21:54,358 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:21:54,360 WARNING celery.redirected 2016-08-17 13:21:54,359 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:21:54,361 WARNING celery.redirected 2016-08-17 13:21:54,360 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:21:54,361 WARNING celery.redirected 2016-08-17 13:21:54,361 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:21:54,365 WARNING celery.redirected 2016-08-17 13:21:54,364 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:21:54,365 WARNING celery.redirected 2016-08-17 13:21:54,365 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 20, 54, 359312), 'desktop_state_2': 'DELETED'}
2016-08-17 13:21:54,367 WARNING celery.redirected 2016-08-17 13:21:54,367 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:21:54,368 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:21:54,374 INFO celery.worker.job Task schedule_clean_desktops[a1bd0cfc-ce74-44b9-9293-daa51884b5b3] succeeded in 0.01636635400063824s: None
2016-08-17 13:21:54,426 INFO celery.worker.strategy Received task: schedule_start_lesson[d6c00fa3-85a6-40f0-8135-b5649d3d4a91]
2016-08-17 13:21:54,428 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:21:54,428 INFO celery Scheduling start lesson tasks
2016-08-17 13:21:54,429 WARNING celery.redirected 2016-08-17 13:21:54,429 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:21:54,430 WARNING celery.redirected 2016-08-17 13:21:54,430 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:21:54,431 WARNING celery.redirected 2016-08-17 13:21:54,431 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:21:54,435 WARNING celery.redirected 2016-08-17 13:21:54,434 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:21:54,435 WARNING celery.redirected 2016-08-17 13:21:54,435 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 21, 54, 432815), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 31, 54, 432815), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:21:54,437 WARNING celery.redirected 2016-08-17 13:21:54,437 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:21:54,438 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:21:54,444 INFO celery.worker.job Task schedule_start_lesson[d6c00fa3-85a6-40f0-8135-b5649d3d4a91] succeeded in 0.016942582000410766s: None
2016-08-17 13:22:55,422 INFO celery.worker.strategy Received task: schedule_clean_desktops[38f26064-e5c4-4840-8b12-b694b1e8d485]
2016-08-17 13:22:55,424 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:22:55,427 WARNING celery.redirected 2016-08-17 13:22:55,426 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:22:55,434 WARNING celery.redirected 2016-08-17 13:22:55,433 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:22:55,436 WARNING celery.redirected 2016-08-17 13:22:55,435 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:22:55,441 WARNING celery.redirected 2016-08-17 13:22:55,441 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:22:55,442 WARNING celery.redirected 2016-08-17 13:22:55,442 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 21, 55, 425161), 'desktop_state_2': 'DELETED'}
2016-08-17 13:22:55,444 WARNING celery.redirected 2016-08-17 13:22:55,444 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:22:55,445 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:22:55,459 INFO celery.worker.job Task schedule_clean_desktops[38f26064-e5c4-4840-8b12-b694b1e8d485] succeeded in 0.034975621001649415s: None
2016-08-17 13:22:55,511 INFO celery.worker.strategy Received task: schedule_start_lesson[03d8d899-530d-447b-a407-fe9a31dfbd0c]
2016-08-17 13:22:55,512 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:22:55,512 INFO celery Scheduling start lesson tasks
2016-08-17 13:22:55,513 WARNING celery.redirected 2016-08-17 13:22:55,513 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:22:55,514 WARNING celery.redirected 2016-08-17 13:22:55,514 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:22:55,515 WARNING celery.redirected 2016-08-17 13:22:55,515 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:22:55,519 WARNING celery.redirected 2016-08-17 13:22:55,519 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:22:55,520 WARNING celery.redirected 2016-08-17 13:22:55,520 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 22, 55, 517104), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 32, 55, 517104), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:22:55,522 WARNING celery.redirected 2016-08-17 13:22:55,522 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:22:55,523 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:22:55,530 INFO celery.worker.job Task schedule_start_lesson[03d8d899-530d-447b-a407-fe9a31dfbd0c] succeeded in 0.01865931999964232s: None
2016-08-17 13:23:54,654 INFO celery.worker.strategy Received task: schedule_clean_desktops[6bbe9d22-6799-4d6f-9ee6-e41c8d27c9f4]
2016-08-17 13:23:54,656 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:23:54,658 WARNING celery.redirected 2016-08-17 13:23:54,658 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:23:54,660 WARNING celery.redirected 2016-08-17 13:23:54,659 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:23:54,660 WARNING celery.redirected 2016-08-17 13:23:54,660 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:23:54,664 WARNING celery.redirected 2016-08-17 13:23:54,664 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:23:54,666 WARNING celery.redirected 2016-08-17 13:23:54,666 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 22, 54, 657574), 'desktop_state_2': 'DELETED'}
2016-08-17 13:23:54,668 WARNING celery.redirected 2016-08-17 13:23:54,668 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:23:54,669 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:23:54,678 INFO celery.worker.job Task schedule_clean_desktops[6bbe9d22-6799-4d6f-9ee6-e41c8d27c9f4] succeeded in 0.022544088000358897s: None
2016-08-17 13:23:54,754 INFO celery.worker.strategy Received task: schedule_start_lesson[1e7825a8-b6c5-4242-b08b-b92345814cc4]
2016-08-17 13:23:54,755 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:23:54,756 INFO celery Scheduling start lesson tasks
2016-08-17 13:23:54,757 WARNING celery.redirected 2016-08-17 13:23:54,757 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:23:54,758 WARNING celery.redirected 2016-08-17 13:23:54,758 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:23:54,759 WARNING celery.redirected 2016-08-17 13:23:54,758 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:23:54,764 WARNING celery.redirected 2016-08-17 13:23:54,764 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:23:54,765 WARNING celery.redirected 2016-08-17 13:23:54,765 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 23, 54, 760862), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 33, 54, 760862), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:23:54,768 WARNING celery.redirected 2016-08-17 13:23:54,768 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:23:54,769 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:23:54,777 INFO celery.worker.job Task schedule_start_lesson[1e7825a8-b6c5-4242-b08b-b92345814cc4] succeeded in 0.02182790300139459s: None
2016-08-17 13:24:55,707 INFO celery.worker.strategy Received task: schedule_clean_desktops[d8191141-022a-4c6a-9060-a3e72b93a9ac]
2016-08-17 13:24:55,709 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:24:55,712 WARNING celery.redirected 2016-08-17 13:24:55,711 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:24:55,713 WARNING celery.redirected 2016-08-17 13:24:55,713 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:24:55,714 WARNING celery.redirected 2016-08-17 13:24:55,713 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:24:55,720 WARNING celery.redirected 2016-08-17 13:24:55,719 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:24:55,721 WARNING celery.redirected 2016-08-17 13:24:55,720 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 23, 55, 710894), 'desktop_state_2': 'DELETED'}
2016-08-17 13:24:55,724 WARNING celery.redirected 2016-08-17 13:24:55,723 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:24:55,725 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:24:55,742 INFO celery.worker.job Task schedule_clean_desktops[d8191141-022a-4c6a-9060-a3e72b93a9ac] succeeded in 0.03319245199963916s: None
2016-08-17 13:24:55,811 INFO celery.worker.strategy Received task: schedule_start_lesson[b6c457de-b8f4-4f04-a4f1-17cc63fef8e9]
2016-08-17 13:24:55,812 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:24:55,813 INFO celery Scheduling start lesson tasks
2016-08-17 13:24:55,814 WARNING celery.redirected 2016-08-17 13:24:55,814 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:24:55,816 WARNING celery.redirected 2016-08-17 13:24:55,815 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:24:55,816 WARNING celery.redirected 2016-08-17 13:24:55,816 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:24:55,821 WARNING celery.redirected 2016-08-17 13:24:55,821 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:24:55,822 WARNING celery.redirected 2016-08-17 13:24:55,821 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 24, 55, 818243), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 34, 55, 818243), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:24:55,824 WARNING celery.redirected 2016-08-17 13:24:55,824 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:24:55,825 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:24:55,835 INFO celery.worker.job Task schedule_start_lesson[b6c457de-b8f4-4f04-a4f1-17cc63fef8e9] succeeded in 0.02268864100005885s: None
2016-08-17 13:25:55,269 INFO celery.worker.strategy Received task: schedule_clean_desktops[94f4ff80-262c-4ee7-ae47-03b5b88bff9c]
2016-08-17 13:25:55,271 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:25:55,272 WARNING celery.redirected 2016-08-17 13:25:55,272 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:25:55,273 WARNING celery.redirected 2016-08-17 13:25:55,273 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:25:55,274 WARNING celery.redirected 2016-08-17 13:25:55,274 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:25:55,277 WARNING celery.redirected 2016-08-17 13:25:55,277 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:25:55,277 WARNING celery.redirected 2016-08-17 13:25:55,277 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 24, 55, 271914), 'desktop_state_2': 'DELETED'}
2016-08-17 13:25:55,280 WARNING celery.redirected 2016-08-17 13:25:55,280 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:25:55,281 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:25:55,289 INFO celery.worker.job Task schedule_clean_desktops[94f4ff80-262c-4ee7-ae47-03b5b88bff9c] succeeded in 0.01839594000011857s: None
2016-08-17 13:26:00,067 INFO celery.worker.strategy Received task: schedule_start_lesson[df63a4a9-7f6a-415e-9d30-d77ed4dbdc6c]
2016-08-17 13:26:00,068 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:26:00,069 INFO celery Scheduling start lesson tasks
2016-08-17 13:26:00,070 WARNING celery.redirected 2016-08-17 13:26:00,070 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:26:00,071 WARNING celery.redirected 2016-08-17 13:26:00,071 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:26:00,072 WARNING celery.redirected 2016-08-17 13:26:00,072 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:26:00,076 WARNING celery.redirected 2016-08-17 13:26:00,075 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:26:00,077 WARNING celery.redirected 2016-08-17 13:26:00,076 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 26, 0, 73824), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 36, 0, 73824), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:26:00,079 WARNING celery.redirected 2016-08-17 13:26:00,079 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:26:00,081 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:26:00,091 INFO celery.worker.job Task schedule_start_lesson[df63a4a9-7f6a-415e-9d30-d77ed4dbdc6c] succeeded in 0.022406930000215652s: None
2016-08-17 13:26:59,901 INFO celery.worker.strategy Received task: schedule_clean_desktops[d78a22fe-0ef3-421c-af68-3ed1759a410d]
2016-08-17 13:26:59,903 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:26:59,905 WARNING celery.redirected 2016-08-17 13:26:59,905 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:26:59,907 WARNING celery.redirected 2016-08-17 13:26:59,907 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:26:59,908 WARNING celery.redirected 2016-08-17 13:26:59,908 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:26:59,915 WARNING celery.redirected 2016-08-17 13:26:59,914 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:26:59,916 WARNING celery.redirected 2016-08-17 13:26:59,916 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 25, 59, 904731), 'desktop_state_2': 'DELETED'}
2016-08-17 13:26:59,920 WARNING celery.redirected 2016-08-17 13:26:59,920 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:26:59,921 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:26:59,930 INFO celery.worker.job Task schedule_clean_desktops[d78a22fe-0ef3-421c-af68-3ed1759a410d] succeeded in 0.02686751299916068s: None
2016-08-17 13:27:04,793 INFO celery.worker.strategy Received task: schedule_start_lesson[f124fc41-d1b8-4a85-aca2-cfd10d355ef8]
2016-08-17 13:27:04,795 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:27:04,796 INFO celery Scheduling start lesson tasks
2016-08-17 13:27:04,797 WARNING celery.redirected 2016-08-17 13:27:04,797 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:27:04,799 WARNING celery.redirected 2016-08-17 13:27:04,799 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:27:04,800 WARNING celery.redirected 2016-08-17 13:27:04,799 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:27:04,806 WARNING celery.redirected 2016-08-17 13:27:04,806 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:27:04,807 WARNING celery.redirected 2016-08-17 13:27:04,807 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 27, 4, 802385), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 37, 4, 802385), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:27:04,810 WARNING celery.redirected 2016-08-17 13:27:04,810 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:27:04,812 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:27:04,823 INFO celery.worker.job Task schedule_start_lesson[f124fc41-d1b8-4a85-aca2-cfd10d355ef8] succeeded in 0.027894541999557987s: None
2016-08-17 13:28:05,891 INFO celery.worker.strategy Received task: schedule_clean_desktops[74afa683-8595-4536-a582-05c3bf77344f]
2016-08-17 13:28:05,892 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:28:05,894 WARNING celery.redirected 2016-08-17 13:28:05,894 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:28:05,896 WARNING celery.redirected 2016-08-17 13:28:05,895 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:28:05,896 WARNING celery.redirected 2016-08-17 13:28:05,896 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:28:05,899 WARNING celery.redirected 2016-08-17 13:28:05,899 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:28:05,901 WARNING celery.redirected 2016-08-17 13:28:05,900 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 27, 5, 893809), 'desktop_state_2': 'DELETED'}
2016-08-17 13:28:05,904 WARNING celery.redirected 2016-08-17 13:28:05,903 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:28:05,905 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:28:05,915 INFO celery.worker.job Task schedule_clean_desktops[74afa683-8595-4536-a582-05c3bf77344f] succeeded in 0.022243352001169114s: None
2016-08-17 13:28:10,724 INFO celery.worker.strategy Received task: schedule_start_lesson[f067ea2a-96e9-44a9-a70b-c052e3369862]
2016-08-17 13:28:10,725 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:28:10,725 INFO celery Scheduling start lesson tasks
2016-08-17 13:28:10,726 WARNING celery.redirected 2016-08-17 13:28:10,726 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:28:10,728 WARNING celery.redirected 2016-08-17 13:28:10,728 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:28:10,729 WARNING celery.redirected 2016-08-17 13:28:10,728 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:28:10,733 WARNING celery.redirected 2016-08-17 13:28:10,732 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:28:10,733 WARNING celery.redirected 2016-08-17 13:28:10,733 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 28, 10, 730520), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 38, 10, 730520), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:28:10,735 WARNING celery.redirected 2016-08-17 13:28:10,735 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:28:10,736 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:28:10,749 INFO celery.worker.job Task schedule_start_lesson[f067ea2a-96e9-44a9-a70b-c052e3369862] succeeded in 0.024722239999391604s: None
2016-08-17 13:29:10,682 INFO celery.worker.strategy Received task: schedule_clean_desktops[6eb79ede-4d6b-4e2e-bd11-5b963e8639a1]
2016-08-17 13:29:10,683 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:29:10,685 WARNING celery.redirected 2016-08-17 13:29:10,685 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:29:10,686 WARNING celery.redirected 2016-08-17 13:29:10,686 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:29:10,688 WARNING celery.redirected 2016-08-17 13:29:10,687 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:29:10,692 WARNING celery.redirected 2016-08-17 13:29:10,692 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:29:10,692 WARNING celery.redirected 2016-08-17 13:29:10,692 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 28, 10, 684544), 'desktop_state_2': 'DELETED'}
2016-08-17 13:29:10,694 WARNING celery.redirected 2016-08-17 13:29:10,694 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:29:10,695 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:29:10,702 INFO celery.worker.job Task schedule_clean_desktops[6eb79ede-4d6b-4e2e-bd11-5b963e8639a1] succeeded in 0.018595134999486618s: None
2016-08-17 13:29:15,487 INFO celery.worker.strategy Received task: schedule_start_lesson[c3a5f224-0adb-434f-9b75-99cb54dd45a9]
2016-08-17 13:29:15,489 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:29:15,489 INFO celery Scheduling start lesson tasks
2016-08-17 13:29:15,490 WARNING celery.redirected 2016-08-17 13:29:15,490 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:29:15,491 WARNING celery.redirected 2016-08-17 13:29:15,491 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:29:15,492 WARNING celery.redirected 2016-08-17 13:29:15,492 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:29:15,496 WARNING celery.redirected 2016-08-17 13:29:15,496 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:29:15,497 WARNING celery.redirected 2016-08-17 13:29:15,497 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 29, 15, 494193), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 39, 15, 494193), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:29:15,499 WARNING celery.redirected 2016-08-17 13:29:15,499 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:29:15,500 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:29:15,506 INFO celery.worker.job Task schedule_start_lesson[c3a5f224-0adb-434f-9b75-99cb54dd45a9] succeeded in 0.018030576000455767s: None
2016-08-17 13:30:15,684 INFO celery.worker.strategy Received task: schedule_clean_desktops[85fdf16b-90a7-40ab-a860-50e5d3ac4185]
2016-08-17 13:30:15,692 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:30:15,695 WARNING celery.redirected 2016-08-17 13:30:15,695 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:30:15,697 WARNING celery.redirected 2016-08-17 13:30:15,697 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:30:15,698 WARNING celery.redirected 2016-08-17 13:30:15,698 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:30:15,704 WARNING celery.redirected 2016-08-17 13:30:15,703 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:30:15,706 WARNING celery.redirected 2016-08-17 13:30:15,706 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 29, 15, 694065), 'desktop_state_2': 'DELETED'}
2016-08-17 13:30:15,709 WARNING celery.redirected 2016-08-17 13:30:15,709 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:30:15,710 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:30:15,717 INFO celery.worker.job Task schedule_clean_desktops[85fdf16b-90a7-40ab-a860-50e5d3ac4185] succeeded in 0.024852309999914723s: None
2016-08-17 13:30:20,558 INFO celery.worker.strategy Received task: schedule_start_lesson[0ad25883-4e56-4d86-b818-41db5116a663]
2016-08-17 13:30:20,560 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:30:20,561 INFO celery Scheduling start lesson tasks
2016-08-17 13:30:20,564 WARNING celery.redirected 2016-08-17 13:30:20,563 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:30:20,565 WARNING celery.redirected 2016-08-17 13:30:20,565 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:30:20,565 WARNING celery.redirected 2016-08-17 13:30:20,565 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:30:20,570 WARNING celery.redirected 2016-08-17 13:30:20,570 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:30:20,571 WARNING celery.redirected 2016-08-17 13:30:20,571 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 30, 20, 567472), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 40, 20, 567472), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:30:20,573 WARNING celery.redirected 2016-08-17 13:30:20,573 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:30:20,574 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:30:20,583 INFO celery.worker.job Task schedule_start_lesson[0ad25883-4e56-4d86-b818-41db5116a663] succeeded in 0.02323170000090613s: None
2016-08-17 13:31:20,141 INFO celery.worker.strategy Received task: schedule_clean_desktops[1bb6b6b4-0395-472a-99f4-3105041dc8fd]
2016-08-17 13:31:20,144 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:31:20,145 WARNING celery.redirected 2016-08-17 13:31:20,145 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:31:20,146 WARNING celery.redirected 2016-08-17 13:31:20,146 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:31:20,147 WARNING celery.redirected 2016-08-17 13:31:20,147 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:31:20,151 WARNING celery.redirected 2016-08-17 13:31:20,151 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:31:20,152 WARNING celery.redirected 2016-08-17 13:31:20,152 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 30, 20, 144835), 'desktop_state_2': 'DELETED'}
2016-08-17 13:31:20,155 WARNING celery.redirected 2016-08-17 13:31:20,155 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:31:20,157 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:31:20,167 INFO celery.worker.job Task schedule_clean_desktops[1bb6b6b4-0395-472a-99f4-3105041dc8fd] succeeded in 0.02329333499983477s: None
2016-08-17 13:31:26,336 INFO celery.worker.strategy Received task: schedule_start_lesson[753f16ea-db51-4852-abd7-f2b0e31653d7]
2016-08-17 13:31:26,338 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:31:26,338 INFO celery Scheduling start lesson tasks
2016-08-17 13:31:26,339 WARNING celery.redirected 2016-08-17 13:31:26,339 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:31:26,341 WARNING celery.redirected 2016-08-17 13:31:26,340 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:31:26,341 WARNING celery.redirected 2016-08-17 13:31:26,341 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:31:26,347 WARNING celery.redirected 2016-08-17 13:31:26,347 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:31:26,348 WARNING celery.redirected 2016-08-17 13:31:26,347 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 31, 26, 343964), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 41, 26, 343964), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:31:26,351 WARNING celery.redirected 2016-08-17 13:31:26,351 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:31:26,352 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:31:26,359 INFO celery.worker.job Task schedule_start_lesson[753f16ea-db51-4852-abd7-f2b0e31653d7] succeeded in 0.02187567799956014s: None
2016-08-17 13:32:21,352 INFO celery.worker.strategy Received task: schedule_clean_desktops[abe4a695-d4f7-409b-9efd-f5ff2b8a364a]
2016-08-17 13:32:21,355 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:32:21,357 WARNING celery.redirected 2016-08-17 13:32:21,357 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:32:21,358 WARNING celery.redirected 2016-08-17 13:32:21,358 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:32:21,359 WARNING celery.redirected 2016-08-17 13:32:21,359 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:32:21,364 WARNING celery.redirected 2016-08-17 13:32:21,363 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:32:21,365 WARNING celery.redirected 2016-08-17 13:32:21,365 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 31, 21, 356380), 'desktop_state_2': 'DELETED'}
2016-08-17 13:32:21,368 WARNING celery.redirected 2016-08-17 13:32:21,368 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:32:21,369 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:32:21,381 INFO celery.worker.job Task schedule_clean_desktops[abe4a695-d4f7-409b-9efd-f5ff2b8a364a] succeeded in 0.025965822000216576s: None
2016-08-17 13:32:26,402 INFO celery.worker.strategy Received task: schedule_start_lesson[17191781-587e-4f01-9553-5e4c73e0a5ec]
2016-08-17 13:32:26,404 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:32:26,404 INFO celery Scheduling start lesson tasks
2016-08-17 13:32:26,406 WARNING celery.redirected 2016-08-17 13:32:26,406 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:32:26,408 WARNING celery.redirected 2016-08-17 13:32:26,408 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:32:26,409 WARNING celery.redirected 2016-08-17 13:32:26,409 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:32:26,414 WARNING celery.redirected 2016-08-17 13:32:26,414 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:32:26,414 WARNING celery.redirected 2016-08-17 13:32:26,414 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 32, 26, 410993), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 42, 26, 410993), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:32:26,416 WARNING celery.redirected 2016-08-17 13:32:26,416 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:32:26,418 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:32:26,425 INFO celery.worker.job Task schedule_start_lesson[17191781-587e-4f01-9553-5e4c73e0a5ec] succeeded in 0.021699676999560324s: None
2016-08-17 13:33:20,661 INFO celery.worker.strategy Received task: schedule_clean_desktops[e7bd7e04-4efc-4941-bbe4-5390a7ba4776]
2016-08-17 13:33:20,662 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:33:20,665 WARNING celery.redirected 2016-08-17 13:33:20,665 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:33:20,667 WARNING celery.redirected 2016-08-17 13:33:20,667 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:33:20,667 WARNING celery.redirected 2016-08-17 13:33:20,667 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:33:20,671 WARNING celery.redirected 2016-08-17 13:33:20,671 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:33:20,671 WARNING celery.redirected 2016-08-17 13:33:20,671 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 32, 20, 663956), 'desktop_state_2': 'DELETED'}
2016-08-17 13:33:20,673 WARNING celery.redirected 2016-08-17 13:33:20,673 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:33:20,674 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:33:20,683 INFO celery.worker.job Task schedule_clean_desktops[e7bd7e04-4efc-4941-bbe4-5390a7ba4776] succeeded in 0.020213210000292747s: None
2016-08-17 13:33:25,548 INFO celery.worker.strategy Received task: schedule_start_lesson[b588b8c9-e38a-40c3-bee0-2dbbe4a38d6c]
2016-08-17 13:33:25,549 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:33:25,550 INFO celery Scheduling start lesson tasks
2016-08-17 13:33:25,551 WARNING celery.redirected 2016-08-17 13:33:25,551 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:33:25,552 WARNING celery.redirected 2016-08-17 13:33:25,552 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:33:25,553 WARNING celery.redirected 2016-08-17 13:33:25,553 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:33:25,557 WARNING celery.redirected 2016-08-17 13:33:25,557 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:33:25,558 WARNING celery.redirected 2016-08-17 13:33:25,557 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 33, 25, 554806), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 43, 25, 554806), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:33:25,560 WARNING celery.redirected 2016-08-17 13:33:25,560 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:33:25,561 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:33:25,568 INFO celery.worker.job Task schedule_start_lesson[b588b8c9-e38a-40c3-bee0-2dbbe4a38d6c] succeeded in 0.01858941999853414s: None
2016-08-17 13:34:21,178 INFO celery.worker.strategy Received task: schedule_clean_desktops[bd7f5d9d-652f-442f-a76c-7d5ccce500c6]
2016-08-17 13:34:21,180 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:34:21,182 WARNING celery.redirected 2016-08-17 13:34:21,182 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:34:21,183 WARNING celery.redirected 2016-08-17 13:34:21,183 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:34:21,184 WARNING celery.redirected 2016-08-17 13:34:21,184 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:34:21,188 WARNING celery.redirected 2016-08-17 13:34:21,187 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:34:21,189 WARNING celery.redirected 2016-08-17 13:34:21,189 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 33, 21, 181498), 'desktop_state_2': 'DELETED'}
2016-08-17 13:34:21,191 WARNING celery.redirected 2016-08-17 13:34:21,191 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:34:21,192 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:34:21,201 INFO celery.worker.job Task schedule_clean_desktops[bd7f5d9d-652f-442f-a76c-7d5ccce500c6] succeeded in 0.020565655999234878s: None
2016-08-17 13:34:26,054 INFO celery.worker.strategy Received task: schedule_start_lesson[2c2c633e-8cf6-4e0b-a4de-bd135bc49144]
2016-08-17 13:34:26,056 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:34:26,056 INFO celery Scheduling start lesson tasks
2016-08-17 13:34:26,057 WARNING celery.redirected 2016-08-17 13:34:26,057 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:34:26,058 WARNING celery.redirected 2016-08-17 13:34:26,058 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:34:26,058 WARNING celery.redirected 2016-08-17 13:34:26,058 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:34:26,063 WARNING celery.redirected 2016-08-17 13:34:26,063 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:34:26,064 WARNING celery.redirected 2016-08-17 13:34:26,064 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 34, 26, 60362), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 44, 26, 60362), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:34:26,068 WARNING celery.redirected 2016-08-17 13:34:26,067 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:34:26,069 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:34:26,077 INFO celery.worker.job Task schedule_start_lesson[2c2c633e-8cf6-4e0b-a4de-bd135bc49144] succeeded in 0.02130411500002083s: None
2016-08-17 13:35:21,606 INFO celery.worker.strategy Received task: schedule_clean_desktops[e72fc1ca-3aca-43cc-b779-2f467a3a6b36]
2016-08-17 13:35:21,608 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:35:21,610 WARNING celery.redirected 2016-08-17 13:35:21,610 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:35:21,613 WARNING celery.redirected 2016-08-17 13:35:21,612 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:35:21,613 WARNING celery.redirected 2016-08-17 13:35:21,613 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:35:21,620 WARNING celery.redirected 2016-08-17 13:35:21,620 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:35:21,620 WARNING celery.redirected 2016-08-17 13:35:21,620 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 34, 21, 609367), 'desktop_state_2': 'DELETED'}
2016-08-17 13:35:21,622 WARNING celery.redirected 2016-08-17 13:35:21,622 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:35:21,623 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:35:21,632 INFO celery.worker.job Task schedule_clean_desktops[e72fc1ca-3aca-43cc-b779-2f467a3a6b36] succeeded in 0.024379184000281384s: None
2016-08-17 13:35:26,473 INFO celery.worker.strategy Received task: schedule_start_lesson[80b01a9e-13e0-4e46-87db-51ce6963d2af]
2016-08-17 13:35:26,475 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:35:26,475 INFO celery Scheduling start lesson tasks
2016-08-17 13:35:26,476 WARNING celery.redirected 2016-08-17 13:35:26,476 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:35:26,478 WARNING celery.redirected 2016-08-17 13:35:26,477 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:35:26,478 WARNING celery.redirected 2016-08-17 13:35:26,478 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:35:26,485 WARNING celery.redirected 2016-08-17 13:35:26,484 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:35:26,485 WARNING celery.redirected 2016-08-17 13:35:26,485 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 35, 26, 480181), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 45, 26, 480181), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:35:26,488 WARNING celery.redirected 2016-08-17 13:35:26,488 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:35:26,489 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:35:26,496 INFO celery.worker.job Task schedule_start_lesson[80b01a9e-13e0-4e46-87db-51ce6963d2af] succeeded in 0.021531757000047946s: None
2016-08-17 13:36:21,498 INFO celery.worker.strategy Received task: schedule_clean_desktops[765f0941-bdfa-444e-b399-a97325836f6c]
2016-08-17 13:36:21,500 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:36:21,502 WARNING celery.redirected 2016-08-17 13:36:21,501 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:36:21,503 WARNING celery.redirected 2016-08-17 13:36:21,502 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:36:21,503 WARNING celery.redirected 2016-08-17 13:36:21,503 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:36:21,509 WARNING celery.redirected 2016-08-17 13:36:21,509 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:36:21,510 WARNING celery.redirected 2016-08-17 13:36:21,510 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 35, 21, 501154), 'desktop_state_2': 'DELETED'}
2016-08-17 13:36:21,512 WARNING celery.redirected 2016-08-17 13:36:21,512 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:36:21,513 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:36:21,520 INFO celery.worker.job Task schedule_clean_desktops[765f0941-bdfa-444e-b399-a97325836f6c] succeeded in 0.020044133998453617s: None
2016-08-17 13:36:31,123 INFO celery.worker.strategy Received task: schedule_start_lesson[09a18148-45d0-485a-8257-7c53c0239ae5]
2016-08-17 13:36:31,124 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:36:31,124 INFO celery Scheduling start lesson tasks
2016-08-17 13:36:31,125 WARNING celery.redirected 2016-08-17 13:36:31,125 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:36:31,126 WARNING celery.redirected 2016-08-17 13:36:31,126 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:36:31,127 WARNING celery.redirected 2016-08-17 13:36:31,127 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:36:31,130 WARNING celery.redirected 2016-08-17 13:36:31,130 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:36:31,131 WARNING celery.redirected 2016-08-17 13:36:31,131 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 36, 31, 128576), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 46, 31, 128576), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:36:31,134 WARNING celery.redirected 2016-08-17 13:36:31,134 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:36:31,135 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:36:31,143 INFO celery.worker.job Task schedule_start_lesson[09a18148-45d0-485a-8257-7c53c0239ae5] succeeded in 0.018939040000987006s: None
2016-08-17 13:37:26,706 INFO celery.worker.strategy Received task: schedule_clean_desktops[b8a81e66-9129-4f46-932d-0f310f45191a]
2016-08-17 13:37:26,707 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:37:26,709 WARNING celery.redirected 2016-08-17 13:37:26,709 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:37:26,711 WARNING celery.redirected 2016-08-17 13:37:26,711 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:37:26,712 WARNING celery.redirected 2016-08-17 13:37:26,711 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:37:26,715 WARNING celery.redirected 2016-08-17 13:37:26,715 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:37:26,716 WARNING celery.redirected 2016-08-17 13:37:26,716 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 36, 26, 708694), 'desktop_state_2': 'DELETED'}
2016-08-17 13:37:26,719 WARNING celery.redirected 2016-08-17 13:37:26,719 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:37:26,721 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:37:26,728 INFO celery.worker.job Task schedule_clean_desktops[b8a81e66-9129-4f46-932d-0f310f45191a] succeeded in 0.0210795640014112s: None
2016-08-17 13:37:36,319 INFO celery.worker.strategy Received task: schedule_start_lesson[c1a1fb39-2570-4673-8175-0789f0ebdf82]
2016-08-17 13:37:36,320 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:37:36,321 INFO celery Scheduling start lesson tasks
2016-08-17 13:37:36,322 WARNING celery.redirected 2016-08-17 13:37:36,322 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:37:36,323 WARNING celery.redirected 2016-08-17 13:37:36,323 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:37:36,324 WARNING celery.redirected 2016-08-17 13:37:36,323 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:37:36,328 WARNING celery.redirected 2016-08-17 13:37:36,328 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:37:36,328 WARNING celery.redirected 2016-08-17 13:37:36,328 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 37, 36, 325664), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 47, 36, 325664), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:37:36,331 WARNING celery.redirected 2016-08-17 13:37:36,331 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:37:36,332 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:37:36,340 INFO celery.worker.job Task schedule_start_lesson[c1a1fb39-2570-4673-8175-0789f0ebdf82] succeeded in 0.01996422999945935s: None
2016-08-17 13:38:31,850 INFO celery.worker.strategy Received task: schedule_clean_desktops[5a17df5e-3ad0-4ab5-ac2a-d6f647b5f4dd]
2016-08-17 13:38:31,852 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:38:31,853 WARNING celery.redirected 2016-08-17 13:38:31,853 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:38:31,854 WARNING celery.redirected 2016-08-17 13:38:31,854 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:38:31,855 WARNING celery.redirected 2016-08-17 13:38:31,855 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:38:31,858 WARNING celery.redirected 2016-08-17 13:38:31,858 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:38:31,859 WARNING celery.redirected 2016-08-17 13:38:31,858 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 37, 31, 852986), 'desktop_state_2': 'DELETED'}
2016-08-17 13:38:31,861 WARNING celery.redirected 2016-08-17 13:38:31,861 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:38:31,862 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:38:31,968 INFO celery.worker.job Task schedule_clean_desktops[5a17df5e-3ad0-4ab5-ac2a-d6f647b5f4dd] succeeded in 0.1164243909988727s: None
2016-08-17 13:38:41,481 INFO celery.worker.strategy Received task: schedule_start_lesson[df5e0b22-6a3a-484d-b1d1-6316ba002798]
2016-08-17 13:38:41,483 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:38:41,484 INFO celery Scheduling start lesson tasks
2016-08-17 13:38:41,484 WARNING celery.redirected 2016-08-17 13:38:41,484 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:38:41,485 WARNING celery.redirected 2016-08-17 13:38:41,485 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:38:41,486 WARNING celery.redirected 2016-08-17 13:38:41,486 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:38:41,489 WARNING celery.redirected 2016-08-17 13:38:41,489 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:38:41,490 WARNING celery.redirected 2016-08-17 13:38:41,490 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 38, 41, 487690), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 48, 41, 487690), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:38:41,492 WARNING celery.redirected 2016-08-17 13:38:41,492 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:38:41,493 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:38:41,499 INFO celery.worker.job Task schedule_start_lesson[df5e0b22-6a3a-484d-b1d1-6316ba002798] succeeded in 0.016631185999358422s: None
2016-08-17 13:39:36,974 INFO celery.worker.strategy Received task: schedule_clean_desktops[2bbeb316-5bae-4784-a233-5d788b0fab1d]
2016-08-17 13:39:36,975 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:39:36,977 WARNING celery.redirected 2016-08-17 13:39:36,977 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:39:36,978 WARNING celery.redirected 2016-08-17 13:39:36,978 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:39:36,979 WARNING celery.redirected 2016-08-17 13:39:36,978 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:39:36,982 WARNING celery.redirected 2016-08-17 13:39:36,982 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:39:36,983 WARNING celery.redirected 2016-08-17 13:39:36,983 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 38, 36, 976530), 'desktop_state_2': 'DELETED'}
2016-08-17 13:39:36,986 WARNING celery.redirected 2016-08-17 13:39:36,986 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:39:36,988 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:39:36,994 INFO celery.worker.job Task schedule_clean_desktops[2bbeb316-5bae-4784-a233-5d788b0fab1d] succeeded in 0.01920505500129366s: None
2016-08-17 13:39:46,566 INFO celery.worker.strategy Received task: schedule_start_lesson[77e25e93-e9cd-4f67-aec7-1166ff1840b3]
2016-08-17 13:39:46,567 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:39:46,568 INFO celery Scheduling start lesson tasks
2016-08-17 13:39:46,569 WARNING celery.redirected 2016-08-17 13:39:46,569 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:39:46,570 WARNING celery.redirected 2016-08-17 13:39:46,570 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:39:46,570 WARNING celery.redirected 2016-08-17 13:39:46,570 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:39:46,574 WARNING celery.redirected 2016-08-17 13:39:46,574 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:39:46,575 WARNING celery.redirected 2016-08-17 13:39:46,575 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 39, 46, 572761), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 49, 46, 572761), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:39:46,578 WARNING celery.redirected 2016-08-17 13:39:46,578 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:39:46,579 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:39:46,586 INFO celery.worker.job Task schedule_start_lesson[77e25e93-e9cd-4f67-aec7-1166ff1840b3] succeeded in 0.01865515499957837s: None
2016-08-17 13:40:41,003 INFO celery.worker.strategy Received task: schedule_clean_desktops[010fcc92-5723-425f-bed1-4226d4a83fba]
2016-08-17 13:40:41,004 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:40:41,006 WARNING celery.redirected 2016-08-17 13:40:41,006 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:40:41,007 WARNING celery.redirected 2016-08-17 13:40:41,007 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:40:41,008 WARNING celery.redirected 2016-08-17 13:40:41,007 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:40:41,011 WARNING celery.redirected 2016-08-17 13:40:41,011 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:40:41,011 WARNING celery.redirected 2016-08-17 13:40:41,011 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 39, 41, 5763), 'desktop_state_2': 'DELETED'}
2016-08-17 13:40:41,014 WARNING celery.redirected 2016-08-17 13:40:41,013 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:40:41,015 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:40:41,021 INFO celery.worker.job Task schedule_clean_desktops[010fcc92-5723-425f-bed1-4226d4a83fba] succeeded in 0.01674695600013365s: None
2016-08-17 13:40:51,878 INFO celery.worker.strategy Received task: schedule_start_lesson[5ac8b1b5-a5d4-4721-94d4-29748bb4a833]
2016-08-17 13:40:51,879 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:40:51,879 INFO celery Scheduling start lesson tasks
2016-08-17 13:40:51,881 WARNING celery.redirected 2016-08-17 13:40:51,880 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:40:51,882 WARNING celery.redirected 2016-08-17 13:40:51,882 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:40:51,882 WARNING celery.redirected 2016-08-17 13:40:51,882 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:40:51,886 WARNING celery.redirected 2016-08-17 13:40:51,886 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:40:51,887 WARNING celery.redirected 2016-08-17 13:40:51,887 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 40, 51, 884538), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 50, 51, 884538), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:40:51,889 WARNING celery.redirected 2016-08-17 13:40:51,889 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:40:51,890 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:40:51,897 INFO celery.worker.job Task schedule_start_lesson[5ac8b1b5-a5d4-4721-94d4-29748bb4a833] succeeded in 0.017984674999752315s: None
2016-08-17 13:41:46,547 INFO celery.worker.strategy Received task: schedule_clean_desktops[94977539-495a-49e3-a454-676876b12b6b]
2016-08-17 13:41:46,548 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:41:46,550 WARNING celery.redirected 2016-08-17 13:41:46,550 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:41:46,551 WARNING celery.redirected 2016-08-17 13:41:46,551 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:41:46,551 WARNING celery.redirected 2016-08-17 13:41:46,551 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:41:46,555 WARNING celery.redirected 2016-08-17 13:41:46,555 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:41:46,555 WARNING celery.redirected 2016-08-17 13:41:46,555 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 40, 46, 549537), 'desktop_state_2': 'DELETED'}
2016-08-17 13:41:46,558 WARNING celery.redirected 2016-08-17 13:41:46,558 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:41:46,559 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:41:46,567 INFO celery.worker.job Task schedule_clean_desktops[94977539-495a-49e3-a454-676876b12b6b] succeeded in 0.01853598699926806s: None
2016-08-17 13:41:56,168 INFO celery.worker.strategy Received task: schedule_start_lesson[f245cbac-4bcd-45b2-ba8d-2198898fe0e0]
2016-08-17 13:41:56,169 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:41:56,169 INFO celery Scheduling start lesson tasks
2016-08-17 13:41:56,170 WARNING celery.redirected 2016-08-17 13:41:56,170 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:41:56,171 WARNING celery.redirected 2016-08-17 13:41:56,171 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:41:56,172 WARNING celery.redirected 2016-08-17 13:41:56,172 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:41:56,177 WARNING celery.redirected 2016-08-17 13:41:56,177 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:41:56,177 WARNING celery.redirected 2016-08-17 13:41:56,177 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 41, 56, 173687), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 51, 56, 173687), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:41:56,179 WARNING celery.redirected 2016-08-17 13:41:56,179 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:41:56,180 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:41:56,186 INFO celery.worker.job Task schedule_start_lesson[f245cbac-4bcd-45b2-ba8d-2198898fe0e0] succeeded in 0.017709437999656075s: None
2016-08-17 13:42:47,049 INFO celery.worker.strategy Received task: schedule_clean_desktops[17a74804-7247-4942-8614-bf73c1f94cba]
2016-08-17 13:42:47,050 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:42:47,052 WARNING celery.redirected 2016-08-17 13:42:47,052 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:42:47,053 WARNING celery.redirected 2016-08-17 13:42:47,053 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:42:47,053 WARNING celery.redirected 2016-08-17 13:42:47,053 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:42:47,056 WARNING celery.redirected 2016-08-17 13:42:47,056 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:42:47,057 WARNING celery.redirected 2016-08-17 13:42:47,057 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 41, 47, 51650), 'desktop_state_2': 'DELETED'}
2016-08-17 13:42:47,060 WARNING celery.redirected 2016-08-17 13:42:47,060 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:42:47,061 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:42:47,069 INFO celery.worker.job Task schedule_clean_desktops[17a74804-7247-4942-8614-bf73c1f94cba] succeeded in 0.01872315499895194s: None
2016-08-17 13:42:56,664 INFO celery.worker.strategy Received task: schedule_start_lesson[38d3d5ad-514b-4021-9b94-0a15004c5e2d]
2016-08-17 13:42:56,665 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:42:56,665 INFO celery Scheduling start lesson tasks
2016-08-17 13:42:56,666 WARNING celery.redirected 2016-08-17 13:42:56,666 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:42:56,667 WARNING celery.redirected 2016-08-17 13:42:56,667 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:42:56,668 WARNING celery.redirected 2016-08-17 13:42:56,668 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:42:56,672 WARNING celery.redirected 2016-08-17 13:42:56,672 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:42:56,673 WARNING celery.redirected 2016-08-17 13:42:56,673 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 42, 56, 669772), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 52, 56, 669772), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:42:56,675 WARNING celery.redirected 2016-08-17 13:42:56,675 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:42:56,677 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:42:56,684 INFO celery.worker.job Task schedule_start_lesson[38d3d5ad-514b-4021-9b94-0a15004c5e2d] succeeded in 0.018993050000062794s: None
2016-08-17 13:43:46,388 INFO celery.worker.strategy Received task: schedule_clean_desktops[73cb43ac-c98a-4b40-9928-afa8955bc4b8]
2016-08-17 13:43:46,389 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:43:46,390 WARNING celery.redirected 2016-08-17 13:43:46,390 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:43:46,391 WARNING celery.redirected 2016-08-17 13:43:46,391 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:43:46,392 WARNING celery.redirected 2016-08-17 13:43:46,392 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:43:46,395 WARNING celery.redirected 2016-08-17 13:43:46,395 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:43:46,396 WARNING celery.redirected 2016-08-17 13:43:46,396 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 42, 46, 390124), 'desktop_state_2': 'DELETED'}
2016-08-17 13:43:46,398 WARNING celery.redirected 2016-08-17 13:43:46,398 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:43:46,399 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:43:46,407 INFO celery.worker.job Task schedule_clean_desktops[73cb43ac-c98a-4b40-9928-afa8955bc4b8] succeeded in 0.017875303999971948s: None
2016-08-17 13:43:57,287 INFO celery.worker.strategy Received task: schedule_start_lesson[78cbc4cd-b33b-41e6-abc0-b46d01d6a4cd]
2016-08-17 13:43:57,288 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:43:57,289 INFO celery Scheduling start lesson tasks
2016-08-17 13:43:57,290 WARNING celery.redirected 2016-08-17 13:43:57,290 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:43:57,291 WARNING celery.redirected 2016-08-17 13:43:57,291 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:43:57,291 WARNING celery.redirected 2016-08-17 13:43:57,291 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:43:57,295 WARNING celery.redirected 2016-08-17 13:43:57,295 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:43:57,295 WARNING celery.redirected 2016-08-17 13:43:57,295 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 43, 57, 293074), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 53, 57, 293074), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:43:57,298 WARNING celery.redirected 2016-08-17 13:43:57,298 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:43:57,299 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:43:57,391 INFO celery.worker.job Task schedule_start_lesson[78cbc4cd-b33b-41e6-abc0-b46d01d6a4cd] succeeded in 0.10245642799964116s: None
2016-08-17 13:44:47,055 INFO celery.worker.strategy Received task: schedule_clean_desktops[e6ae9887-4b27-48bd-977c-08e572e9dbec]
2016-08-17 13:44:47,057 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:44:47,058 WARNING celery.redirected 2016-08-17 13:44:47,058 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:44:47,059 WARNING celery.redirected 2016-08-17 13:44:47,059 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:44:47,060 WARNING celery.redirected 2016-08-17 13:44:47,060 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:44:47,063 WARNING celery.redirected 2016-08-17 13:44:47,063 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:44:47,064 WARNING celery.redirected 2016-08-17 13:44:47,064 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 43, 47, 57899), 'desktop_state_2': 'DELETED'}
2016-08-17 13:44:47,067 WARNING celery.redirected 2016-08-17 13:44:47,067 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:44:47,069 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:44:47,075 INFO celery.worker.job Task schedule_clean_desktops[e6ae9887-4b27-48bd-977c-08e572e9dbec] succeeded in 0.01852725000026112s: None
2016-08-17 13:44:56,693 INFO celery.worker.strategy Received task: schedule_start_lesson[ed0a6422-f31b-4278-803b-bbaf7786e99a]
2016-08-17 13:44:56,694 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:44:56,695 INFO celery Scheduling start lesson tasks
2016-08-17 13:44:56,696 WARNING celery.redirected 2016-08-17 13:44:56,696 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:44:56,697 WARNING celery.redirected 2016-08-17 13:44:56,697 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:44:56,697 WARNING celery.redirected 2016-08-17 13:44:56,697 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:44:56,701 WARNING celery.redirected 2016-08-17 13:44:56,701 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:44:56,701 WARNING celery.redirected 2016-08-17 13:44:56,701 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 44, 56, 699107), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 54, 56, 699107), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:44:56,703 WARNING celery.redirected 2016-08-17 13:44:56,703 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:44:56,704 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:44:56,711 INFO celery.worker.job Task schedule_start_lesson[ed0a6422-f31b-4278-803b-bbaf7786e99a] succeeded in 0.016829391001010663s: None
2016-08-17 13:45:46,442 INFO celery.worker.strategy Received task: schedule_clean_desktops[09d0dd3c-f24e-449f-8da9-ade7aa851244]
2016-08-17 13:45:46,444 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:45:46,445 WARNING celery.redirected 2016-08-17 13:45:46,445 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:45:46,446 WARNING celery.redirected 2016-08-17 13:45:46,446 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:45:46,446 WARNING celery.redirected 2016-08-17 13:45:46,446 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:45:46,450 WARNING celery.redirected 2016-08-17 13:45:46,450 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:45:46,450 WARNING celery.redirected 2016-08-17 13:45:46,450 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 44, 46, 444837), 'desktop_state_2': 'DELETED'}
2016-08-17 13:45:46,452 WARNING celery.redirected 2016-08-17 13:45:46,452 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:45:46,453 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:45:46,460 INFO celery.worker.job Task schedule_clean_desktops[09d0dd3c-f24e-449f-8da9-ade7aa851244] succeeded in 0.016611778999504168s: None
2016-08-17 13:45:57,319 INFO celery.worker.strategy Received task: schedule_start_lesson[fbd173af-cbb3-4acf-a812-fa96beee4129]
2016-08-17 13:45:57,321 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:45:57,321 INFO celery Scheduling start lesson tasks
2016-08-17 13:45:57,322 WARNING celery.redirected 2016-08-17 13:45:57,322 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:45:57,323 WARNING celery.redirected 2016-08-17 13:45:57,323 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:45:57,323 WARNING celery.redirected 2016-08-17 13:45:57,323 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:45:57,327 WARNING celery.redirected 2016-08-17 13:45:57,327 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:45:57,328 WARNING celery.redirected 2016-08-17 13:45:57,328 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 45, 57, 325256), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 55, 57, 325256), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:45:57,330 WARNING celery.redirected 2016-08-17 13:45:57,330 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:45:57,331 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:45:57,338 INFO celery.worker.job Task schedule_start_lesson[fbd173af-cbb3-4acf-a812-fa96beee4129] succeeded in 0.01769201099887141s: None
2016-08-17 13:46:47,006 INFO celery.worker.strategy Received task: schedule_clean_desktops[99a41907-8597-44ad-a2ed-74993ab50c4b]
2016-08-17 13:46:47,008 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:46:47,009 WARNING celery.redirected 2016-08-17 13:46:47,009 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:46:47,010 WARNING celery.redirected 2016-08-17 13:46:47,010 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:46:47,011 WARNING celery.redirected 2016-08-17 13:46:47,011 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:46:47,014 WARNING celery.redirected 2016-08-17 13:46:47,014 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:46:47,014 WARNING celery.redirected 2016-08-17 13:46:47,014 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 45, 47, 8833), 'desktop_state_2': 'DELETED'}
2016-08-17 13:46:47,017 WARNING celery.redirected 2016-08-17 13:46:47,017 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:46:47,018 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:46:47,026 INFO celery.worker.job Task schedule_clean_desktops[99a41907-8597-44ad-a2ed-74993ab50c4b] succeeded in 0.018277446000865893s: None
2016-08-17 13:46:56,662 INFO celery.worker.strategy Received task: schedule_start_lesson[e91a5663-964c-450d-ae3d-783291c250b5]
2016-08-17 13:46:56,664 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:46:56,664 INFO celery Scheduling start lesson tasks
2016-08-17 13:46:56,666 WARNING celery.redirected 2016-08-17 13:46:56,665 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:46:56,667 WARNING celery.redirected 2016-08-17 13:46:56,666 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:46:56,667 WARNING celery.redirected 2016-08-17 13:46:56,667 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:46:56,671 WARNING celery.redirected 2016-08-17 13:46:56,671 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:46:56,671 WARNING celery.redirected 2016-08-17 13:46:56,671 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 46, 56, 668993), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 56, 56, 668993), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:46:56,673 WARNING celery.redirected 2016-08-17 13:46:56,673 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:46:56,674 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:46:56,681 INFO celery.worker.job Task schedule_start_lesson[e91a5663-964c-450d-ae3d-783291c250b5] succeeded in 0.017542174999107374s: None
2016-08-17 13:47:47,548 INFO celery.worker.strategy Received task: schedule_clean_desktops[1dd1231b-57d8-4437-8c03-ef543608c9ee]
2016-08-17 13:47:47,549 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:47:47,551 WARNING celery.redirected 2016-08-17 13:47:47,551 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:47:47,552 WARNING celery.redirected 2016-08-17 13:47:47,552 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:47:47,553 WARNING celery.redirected 2016-08-17 13:47:47,552 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:47:47,642 WARNING celery.redirected 2016-08-17 13:47:47,642 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:47:47,643 WARNING celery.redirected 2016-08-17 13:47:47,642 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 46, 47, 550498), 'desktop_state_2': 'DELETED'}
2016-08-17 13:47:47,645 WARNING celery.redirected 2016-08-17 13:47:47,644 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:47:47,646 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:47:47,652 INFO celery.worker.job Task schedule_clean_desktops[1dd1231b-57d8-4437-8c03-ef543608c9ee] succeeded in 0.10308975500083761s: None
2016-08-17 13:47:57,176 INFO celery.worker.strategy Received task: schedule_start_lesson[c02a038a-ac0d-4bfd-b190-f8a92a829ba5]
2016-08-17 13:47:57,177 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:47:57,178 INFO celery Scheduling start lesson tasks
2016-08-17 13:47:57,179 WARNING celery.redirected 2016-08-17 13:47:57,179 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:47:57,180 WARNING celery.redirected 2016-08-17 13:47:57,180 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:47:57,181 WARNING celery.redirected 2016-08-17 13:47:57,180 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:47:57,185 WARNING celery.redirected 2016-08-17 13:47:57,185 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:47:57,186 WARNING celery.redirected 2016-08-17 13:47:57,186 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 47, 57, 182437), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 57, 57, 182437), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:47:57,189 WARNING celery.redirected 2016-08-17 13:47:57,189 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:47:57,190 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:47:57,196 INFO celery.worker.job Task schedule_start_lesson[c02a038a-ac0d-4bfd-b190-f8a92a829ba5] succeeded in 0.019098835000477266s: None
2016-08-17 13:48:46,927 INFO celery.worker.strategy Received task: schedule_clean_desktops[c561f7b9-a522-4d89-8990-23e217ddc30d]
2016-08-17 13:48:46,929 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:48:46,930 WARNING celery.redirected 2016-08-17 13:48:46,930 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:48:46,931 WARNING celery.redirected 2016-08-17 13:48:46,931 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:48:46,932 WARNING celery.redirected 2016-08-17 13:48:46,932 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:48:46,935 WARNING celery.redirected 2016-08-17 13:48:46,935 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:48:46,935 WARNING celery.redirected 2016-08-17 13:48:46,935 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 47, 46, 929759), 'desktop_state_2': 'DELETED'}
2016-08-17 13:48:46,938 WARNING celery.redirected 2016-08-17 13:48:46,938 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:48:46,939 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:48:46,945 INFO celery.worker.job Task schedule_clean_desktops[c561f7b9-a522-4d89-8990-23e217ddc30d] succeeded in 0.0167386829998577s: None
2016-08-17 13:48:57,841 INFO celery.worker.strategy Received task: schedule_start_lesson[4422c11c-509f-4256-ae5f-27f187ea2995]
2016-08-17 13:48:57,842 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:48:57,843 INFO celery Scheduling start lesson tasks
2016-08-17 13:48:57,844 WARNING celery.redirected 2016-08-17 13:48:57,844 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:48:57,845 WARNING celery.redirected 2016-08-17 13:48:57,845 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:48:57,845 WARNING celery.redirected 2016-08-17 13:48:57,845 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:48:57,849 WARNING celery.redirected 2016-08-17 13:48:57,849 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:48:57,850 WARNING celery.redirected 2016-08-17 13:48:57,850 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 48, 57, 847336), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(13, 58, 57, 847336), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:48:57,852 WARNING celery.redirected 2016-08-17 13:48:57,852 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:48:57,853 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:48:57,861 INFO celery.worker.job Task schedule_start_lesson[4422c11c-509f-4256-ae5f-27f187ea2995] succeeded in 0.018768773999909172s: None
2016-08-17 13:49:52,320 INFO celery.worker.strategy Received task: schedule_clean_desktops[3f67d5ed-c0b0-4e8b-8fa9-00e2ce5320e2]
2016-08-17 13:49:52,322 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:49:52,324 WARNING celery.redirected 2016-08-17 13:49:52,324 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:49:52,325 WARNING celery.redirected 2016-08-17 13:49:52,325 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:49:52,326 WARNING celery.redirected 2016-08-17 13:49:52,326 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:49:52,329 WARNING celery.redirected 2016-08-17 13:49:52,329 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:49:52,330 WARNING celery.redirected 2016-08-17 13:49:52,330 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 48, 52, 323135), 'desktop_state_2': 'DELETED'}
2016-08-17 13:49:52,333 WARNING celery.redirected 2016-08-17 13:49:52,333 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:49:52,334 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:49:52,344 INFO celery.worker.job Task schedule_clean_desktops[3f67d5ed-c0b0-4e8b-8fa9-00e2ce5320e2] succeeded in 0.022379162999641267s: None
2016-08-17 13:50:01,950 INFO celery.worker.strategy Received task: schedule_start_lesson[f474241e-5603-47c1-9e4d-c0fc63624364]
2016-08-17 13:50:01,952 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:50:01,953 INFO celery Scheduling start lesson tasks
2016-08-17 13:50:01,954 WARNING celery.redirected 2016-08-17 13:50:01,954 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:50:01,956 WARNING celery.redirected 2016-08-17 13:50:01,955 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:50:01,957 WARNING celery.redirected 2016-08-17 13:50:01,956 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:50:01,961 WARNING celery.redirected 2016-08-17 13:50:01,961 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:50:01,961 WARNING celery.redirected 2016-08-17 13:50:01,961 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 50, 1, 958654), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 0, 1, 958654), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:50:01,963 WARNING celery.redirected 2016-08-17 13:50:01,963 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:50:01,964 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:50:01,971 INFO celery.worker.job Task schedule_start_lesson[f474241e-5603-47c1-9e4d-c0fc63624364] succeeded in 0.018587909000416403s: None
2016-08-17 13:50:57,717 INFO celery.worker.strategy Received task: schedule_clean_desktops[e2436494-6763-44bd-ab55-aa6b1c03ae01]
2016-08-17 13:50:57,718 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:50:57,720 WARNING celery.redirected 2016-08-17 13:50:57,720 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:50:57,721 WARNING celery.redirected 2016-08-17 13:50:57,721 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:50:57,721 WARNING celery.redirected 2016-08-17 13:50:57,721 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:50:57,725 WARNING celery.redirected 2016-08-17 13:50:57,724 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:50:57,725 WARNING celery.redirected 2016-08-17 13:50:57,725 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 49, 57, 719496), 'desktop_state_2': 'DELETED'}
2016-08-17 13:50:57,728 WARNING celery.redirected 2016-08-17 13:50:57,728 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:50:57,729 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:50:57,737 INFO celery.worker.job Task schedule_clean_desktops[e2436494-6763-44bd-ab55-aa6b1c03ae01] succeeded in 0.0184814499989443s: None
2016-08-17 13:51:07,367 INFO celery.worker.strategy Received task: schedule_start_lesson[029a08af-d67b-4559-8de1-74feb98af001]
2016-08-17 13:51:07,368 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:51:07,369 INFO celery Scheduling start lesson tasks
2016-08-17 13:51:07,370 WARNING celery.redirected 2016-08-17 13:51:07,370 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:51:07,371 WARNING celery.redirected 2016-08-17 13:51:07,371 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:51:07,371 WARNING celery.redirected 2016-08-17 13:51:07,371 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:51:07,376 WARNING celery.redirected 2016-08-17 13:51:07,376 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:51:07,377 WARNING celery.redirected 2016-08-17 13:51:07,377 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 51, 7, 374358), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 1, 7, 374358), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:51:07,379 WARNING celery.redirected 2016-08-17 13:51:07,379 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:51:07,380 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:51:07,386 INFO celery.worker.job Task schedule_start_lesson[029a08af-d67b-4559-8de1-74feb98af001] succeeded in 0.017877944999781903s: None
2016-08-17 13:52:03,066 INFO celery.worker.strategy Received task: schedule_clean_desktops[5adafbfd-4490-4cc3-a3a9-70d3fc7fc9d0]
2016-08-17 13:52:03,068 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:52:03,069 WARNING celery.redirected 2016-08-17 13:52:03,069 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:52:03,070 WARNING celery.redirected 2016-08-17 13:52:03,070 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:52:03,071 WARNING celery.redirected 2016-08-17 13:52:03,070 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:52:03,074 WARNING celery.redirected 2016-08-17 13:52:03,074 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:52:03,075 WARNING celery.redirected 2016-08-17 13:52:03,075 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 51, 3, 68941), 'desktop_state_2': 'DELETED'}
2016-08-17 13:52:03,077 WARNING celery.redirected 2016-08-17 13:52:03,077 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:52:03,078 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:52:03,085 INFO celery.worker.job Task schedule_clean_desktops[5adafbfd-4490-4cc3-a3a9-70d3fc7fc9d0] succeeded in 0.016903691999687s: None
2016-08-17 13:52:12,702 INFO celery.worker.strategy Received task: schedule_start_lesson[6831af3c-5db7-41c1-9e82-48a24905a73b]
2016-08-17 13:52:12,703 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:52:12,704 INFO celery Scheduling start lesson tasks
2016-08-17 13:52:12,705 WARNING celery.redirected 2016-08-17 13:52:12,705 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:52:12,706 WARNING celery.redirected 2016-08-17 13:52:12,706 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:52:12,706 WARNING celery.redirected 2016-08-17 13:52:12,706 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:52:12,710 WARNING celery.redirected 2016-08-17 13:52:12,710 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:52:12,711 WARNING celery.redirected 2016-08-17 13:52:12,711 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 52, 12, 708086), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 2, 12, 708086), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:52:12,713 WARNING celery.redirected 2016-08-17 13:52:12,713 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:52:12,714 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:52:12,721 INFO celery.worker.job Task schedule_start_lesson[6831af3c-5db7-41c1-9e82-48a24905a73b] succeeded in 0.01716668699918955s: None
2016-08-17 13:53:02,508 INFO celery.worker.strategy Received task: schedule_clean_desktops[741012ab-bc4e-447d-91d6-16ad40dd9ce2]
2016-08-17 13:53:02,510 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:53:02,511 WARNING celery.redirected 2016-08-17 13:53:02,511 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:53:02,512 WARNING celery.redirected 2016-08-17 13:53:02,512 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:53:02,513 WARNING celery.redirected 2016-08-17 13:53:02,513 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:53:02,516 WARNING celery.redirected 2016-08-17 13:53:02,516 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:53:02,516 WARNING celery.redirected 2016-08-17 13:53:02,516 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 52, 2, 510952), 'desktop_state_2': 'DELETED'}
2016-08-17 13:53:02,519 WARNING celery.redirected 2016-08-17 13:53:02,519 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:53:02,520 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:53:02,526 INFO celery.worker.job Task schedule_clean_desktops[741012ab-bc4e-447d-91d6-16ad40dd9ce2] succeeded in 0.0164784469998267s: None
2016-08-17 13:53:12,159 INFO celery.worker.strategy Received task: schedule_start_lesson[2b21266b-305a-4abc-97bd-cda36afd86b7]
2016-08-17 13:53:12,160 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:53:12,161 INFO celery Scheduling start lesson tasks
2016-08-17 13:53:12,162 WARNING celery.redirected 2016-08-17 13:53:12,162 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:53:12,163 WARNING celery.redirected 2016-08-17 13:53:12,163 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:53:12,163 WARNING celery.redirected 2016-08-17 13:53:12,163 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:53:12,167 WARNING celery.redirected 2016-08-17 13:53:12,166 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:53:12,167 WARNING celery.redirected 2016-08-17 13:53:12,167 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 53, 12, 164937), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 3, 12, 164937), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:53:12,257 WARNING celery.redirected 2016-08-17 13:53:12,257 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:53:12,258 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:53:12,266 INFO celery.worker.job Task schedule_start_lesson[2b21266b-305a-4abc-97bd-cda36afd86b7] succeeded in 0.10584707000089111s: None
2016-08-17 13:54:03,050 INFO celery.worker.strategy Received task: schedule_clean_desktops[52aec586-3ef9-4595-936b-145d9f3cae32]
2016-08-17 13:54:03,051 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:54:03,052 WARNING celery.redirected 2016-08-17 13:54:03,052 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:54:03,053 WARNING celery.redirected 2016-08-17 13:54:03,053 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:54:03,054 WARNING celery.redirected 2016-08-17 13:54:03,054 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:54:03,057 WARNING celery.redirected 2016-08-17 13:54:03,057 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:54:03,058 WARNING celery.redirected 2016-08-17 13:54:03,058 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 53, 3, 52079), 'desktop_state_2': 'DELETED'}
2016-08-17 13:54:03,061 WARNING celery.redirected 2016-08-17 13:54:03,061 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:54:03,062 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:54:03,072 INFO celery.worker.job Task schedule_clean_desktops[52aec586-3ef9-4595-936b-145d9f3cae32] succeeded in 0.02096716599953652s: None
2016-08-17 13:54:12,656 INFO celery.worker.strategy Received task: schedule_start_lesson[05e9a1e6-406f-4ce8-baae-2225b521e2b7]
2016-08-17 13:54:12,658 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:54:12,658 INFO celery Scheduling start lesson tasks
2016-08-17 13:54:12,659 WARNING celery.redirected 2016-08-17 13:54:12,659 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:54:12,660 WARNING celery.redirected 2016-08-17 13:54:12,660 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:54:12,661 WARNING celery.redirected 2016-08-17 13:54:12,661 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:54:12,665 WARNING celery.redirected 2016-08-17 13:54:12,665 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:54:12,665 WARNING celery.redirected 2016-08-17 13:54:12,665 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 54, 12, 662794), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 4, 12, 662794), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:54:12,668 WARNING celery.redirected 2016-08-17 13:54:12,668 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:54:12,669 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:54:12,676 INFO celery.worker.job Task schedule_start_lesson[05e9a1e6-406f-4ce8-baae-2225b521e2b7] succeeded in 0.01818213300066418s: None
2016-08-17 13:55:02,410 INFO celery.worker.strategy Received task: schedule_clean_desktops[90227647-8549-4ebd-9add-39220488edc5]
2016-08-17 13:55:02,412 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:55:02,414 WARNING celery.redirected 2016-08-17 13:55:02,413 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:55:02,415 WARNING celery.redirected 2016-08-17 13:55:02,415 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:55:02,415 WARNING celery.redirected 2016-08-17 13:55:02,415 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:55:02,419 WARNING celery.redirected 2016-08-17 13:55:02,419 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:55:02,419 WARNING celery.redirected 2016-08-17 13:55:02,419 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 54, 2, 413261), 'desktop_state_2': 'DELETED'}
2016-08-17 13:55:02,422 WARNING celery.redirected 2016-08-17 13:55:02,422 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:55:02,423 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:55:02,429 INFO celery.worker.job Task schedule_clean_desktops[90227647-8549-4ebd-9add-39220488edc5] succeeded in 0.017424658999516396s: None
2016-08-17 13:55:13,345 INFO celery.worker.strategy Received task: schedule_start_lesson[62723b31-e3be-47e1-a1b9-c5815bb86aa1]
2016-08-17 13:55:13,348 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:55:13,348 INFO celery Scheduling start lesson tasks
2016-08-17 13:55:13,349 WARNING celery.redirected 2016-08-17 13:55:13,349 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:55:13,350 WARNING celery.redirected 2016-08-17 13:55:13,350 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:55:13,351 WARNING celery.redirected 2016-08-17 13:55:13,351 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:55:13,355 WARNING celery.redirected 2016-08-17 13:55:13,354 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:55:13,355 WARNING celery.redirected 2016-08-17 13:55:13,355 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 55, 13, 352613), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 5, 13, 352613), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:55:13,357 WARNING celery.redirected 2016-08-17 13:55:13,357 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:55:13,358 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:55:13,365 INFO celery.worker.job Task schedule_start_lesson[62723b31-e3be-47e1-a1b9-c5815bb86aa1] succeeded in 0.017191427999932785s: None
2016-08-17 13:56:03,173 INFO celery.worker.strategy Received task: schedule_clean_desktops[e6d2b19d-7e20-4dc9-9b0d-cc770a27af6d]
2016-08-17 13:56:03,174 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:56:03,175 WARNING celery.redirected 2016-08-17 13:56:03,175 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:56:03,176 WARNING celery.redirected 2016-08-17 13:56:03,176 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:56:03,177 WARNING celery.redirected 2016-08-17 13:56:03,177 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:56:03,180 WARNING celery.redirected 2016-08-17 13:56:03,180 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:56:03,181 WARNING celery.redirected 2016-08-17 13:56:03,180 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 55, 3, 175110), 'desktop_state_2': 'DELETED'}
2016-08-17 13:56:03,183 WARNING celery.redirected 2016-08-17 13:56:03,183 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:56:03,184 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:56:03,191 INFO celery.worker.job Task schedule_clean_desktops[e6d2b19d-7e20-4dc9-9b0d-cc770a27af6d] succeeded in 0.016642960001263418s: None
2016-08-17 13:56:12,792 INFO celery.worker.strategy Received task: schedule_start_lesson[fc72786a-f6ca-41a8-802c-b3d576c13bf2]
2016-08-17 13:56:12,794 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:56:12,794 INFO celery Scheduling start lesson tasks
2016-08-17 13:56:12,795 WARNING celery.redirected 2016-08-17 13:56:12,795 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:56:12,796 WARNING celery.redirected 2016-08-17 13:56:12,796 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:56:12,797 WARNING celery.redirected 2016-08-17 13:56:12,797 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:56:12,801 WARNING celery.redirected 2016-08-17 13:56:12,801 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:56:12,801 WARNING celery.redirected 2016-08-17 13:56:12,801 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 56, 12, 798603), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 6, 12, 798603), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:56:12,804 WARNING celery.redirected 2016-08-17 13:56:12,803 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:56:12,805 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:56:12,811 INFO celery.worker.job Task schedule_start_lesson[fc72786a-f6ca-41a8-802c-b3d576c13bf2] succeeded in 0.01792214899978717s: None
2016-08-17 13:57:03,582 INFO celery.worker.strategy Received task: schedule_clean_desktops[27acba14-72de-4742-be11-a52ac8156b8d]
2016-08-17 13:57:03,583 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:57:03,584 WARNING celery.redirected 2016-08-17 13:57:03,584 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:57:03,585 WARNING celery.redirected 2016-08-17 13:57:03,585 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:57:03,586 WARNING celery.redirected 2016-08-17 13:57:03,586 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:57:03,589 WARNING celery.redirected 2016-08-17 13:57:03,589 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:57:03,589 WARNING celery.redirected 2016-08-17 13:57:03,589 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 56, 3, 584017), 'desktop_state_2': 'DELETED'}
2016-08-17 13:57:03,592 WARNING celery.redirected 2016-08-17 13:57:03,592 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:57:03,593 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:57:03,600 INFO celery.worker.job Task schedule_clean_desktops[27acba14-72de-4742-be11-a52ac8156b8d] succeeded in 0.01695727000151237s: None
2016-08-17 13:57:13,144 INFO celery.worker.strategy Received task: schedule_start_lesson[1f0d3802-2d96-48bd-abf4-9d5379b81a7a]
2016-08-17 13:57:13,146 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:57:13,147 INFO celery Scheduling start lesson tasks
2016-08-17 13:57:13,148 WARNING celery.redirected 2016-08-17 13:57:13,148 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:57:13,149 WARNING celery.redirected 2016-08-17 13:57:13,149 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:57:13,150 WARNING celery.redirected 2016-08-17 13:57:13,150 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:57:13,155 WARNING celery.redirected 2016-08-17 13:57:13,154 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:57:13,155 WARNING celery.redirected 2016-08-17 13:57:13,155 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 57, 13, 151695), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 7, 13, 151695), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:57:13,157 WARNING celery.redirected 2016-08-17 13:57:13,157 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:57:13,158 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:57:13,166 INFO celery.worker.job Task schedule_start_lesson[1f0d3802-2d96-48bd-abf4-9d5379b81a7a] succeeded in 0.019807645001492347s: None
2016-08-17 13:58:03,528 INFO celery.worker.strategy Received task: schedule_clean_desktops[cabe4797-8a79-4a70-989e-aaf02d3c38fd]
2016-08-17 13:58:03,530 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:58:03,531 WARNING celery.redirected 2016-08-17 13:58:03,531 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:58:03,532 WARNING celery.redirected 2016-08-17 13:58:03,532 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:58:03,533 WARNING celery.redirected 2016-08-17 13:58:03,532 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:58:03,536 WARNING celery.redirected 2016-08-17 13:58:03,535 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:58:03,536 WARNING celery.redirected 2016-08-17 13:58:03,536 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 57, 3, 530908), 'desktop_state_2': 'DELETED'}
2016-08-17 13:58:03,539 WARNING celery.redirected 2016-08-17 13:58:03,539 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:58:03,540 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:58:03,546 INFO celery.worker.job Task schedule_clean_desktops[cabe4797-8a79-4a70-989e-aaf02d3c38fd] succeeded in 0.0165443329988193s: None
2016-08-17 13:58:17,833 INFO celery.worker.strategy Received task: schedule_start_lesson[94c2b36b-04b2-434e-a279-c33d249a03fc]
2016-08-17 13:58:17,835 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:58:17,835 INFO celery Scheduling start lesson tasks
2016-08-17 13:58:17,837 WARNING celery.redirected 2016-08-17 13:58:17,837 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:58:17,838 WARNING celery.redirected 2016-08-17 13:58:17,838 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:58:17,838 WARNING celery.redirected 2016-08-17 13:58:17,838 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:58:17,843 WARNING celery.redirected 2016-08-17 13:58:17,843 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:58:17,843 WARNING celery.redirected 2016-08-17 13:58:17,843 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 58, 17, 840341), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 8, 17, 840341), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:58:17,845 WARNING celery.redirected 2016-08-17 13:58:17,845 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:58:17,846 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:58:17,852 INFO celery.worker.job Task schedule_start_lesson[94c2b36b-04b2-434e-a279-c33d249a03fc] succeeded in 0.017733734001012635s: None
2016-08-17 13:59:08,062 INFO celery.worker.strategy Received task: schedule_clean_desktops[371e64ba-999a-43d5-ba15-039e2bbed675]
2016-08-17 13:59:08,063 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:59:08,065 WARNING celery.redirected 2016-08-17 13:59:08,065 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:59:08,066 WARNING celery.redirected 2016-08-17 13:59:08,065 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:59:08,066 WARNING celery.redirected 2016-08-17 13:59:08,066 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 13:59:08,069 WARNING celery.redirected 2016-08-17 13:59:08,069 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 13:59:08,070 WARNING celery.redirected 2016-08-17 13:59:08,070 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 58, 8, 64371), 'desktop_state_2': 'DELETED'}
2016-08-17 13:59:08,072 WARNING celery.redirected 2016-08-17 13:59:08,072 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:59:08,074 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:59:08,080 INFO celery.worker.job Task schedule_clean_desktops[371e64ba-999a-43d5-ba15-039e2bbed675] succeeded in 0.017302932999882614s: None
2016-08-17 13:59:23,619 INFO celery.worker.strategy Received task: schedule_start_lesson[db6d1946-1312-4404-b23b-3ee55624c7bf]
2016-08-17 13:59:23,621 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 13:59:23,621 INFO celery Scheduling start lesson tasks
2016-08-17 13:59:23,622 WARNING celery.redirected 2016-08-17 13:59:23,622 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 13:59:23,623 WARNING celery.redirected 2016-08-17 13:59:23,623 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 13:59:23,623 WARNING celery.redirected 2016-08-17 13:59:23,623 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 13:59:23,627 WARNING celery.redirected 2016-08-17 13:59:23,627 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 13:59:23,628 WARNING celery.redirected 2016-08-17 13:59:23,628 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(13, 59, 23, 625146), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 9, 23, 625146), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 13:59:23,630 WARNING celery.redirected 2016-08-17 13:59:23,630 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 13:59:23,631 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 13:59:23,638 INFO celery.worker.job Task schedule_start_lesson[db6d1946-1312-4404-b23b-3ee55624c7bf] succeeded in 0.017414304000340053s: None
2016-08-17 14:00:12,706 INFO celery.worker.strategy Received task: schedule_clean_desktops[bdfd8d97-e892-4aad-9fc5-faff2253a598]
2016-08-17 14:00:12,708 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:00:12,709 WARNING celery.redirected 2016-08-17 14:00:12,709 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:00:12,710 WARNING celery.redirected 2016-08-17 14:00:12,710 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:00:12,711 WARNING celery.redirected 2016-08-17 14:00:12,711 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:00:12,714 WARNING celery.redirected 2016-08-17 14:00:12,714 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:00:12,714 WARNING celery.redirected 2016-08-17 14:00:12,714 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 13, 59, 12, 708962), 'desktop_state_2': 'DELETED'}
2016-08-17 14:00:12,717 WARNING celery.redirected 2016-08-17 14:00:12,717 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:00:12,718 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:00:12,725 INFO celery.worker.job Task schedule_clean_desktops[bdfd8d97-e892-4aad-9fc5-faff2253a598] succeeded in 0.01760181400095462s: None
2016-08-17 14:00:28,227 INFO celery.worker.strategy Received task: schedule_start_lesson[c1149af8-ce4a-4ef4-82c6-4188cbda5638]
2016-08-17 14:00:28,228 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:00:28,229 INFO celery Scheduling start lesson tasks
2016-08-17 14:00:28,230 WARNING celery.redirected 2016-08-17 14:00:28,230 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:00:28,231 WARNING celery.redirected 2016-08-17 14:00:28,231 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:00:28,231 WARNING celery.redirected 2016-08-17 14:00:28,231 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:00:28,235 WARNING celery.redirected 2016-08-17 14:00:28,235 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:00:28,236 WARNING celery.redirected 2016-08-17 14:00:28,236 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 0, 28, 233097), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 10, 28, 233097), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:00:28,239 WARNING celery.redirected 2016-08-17 14:00:28,239 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:00:28,240 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:00:28,248 INFO celery.worker.job Task schedule_start_lesson[c1149af8-ce4a-4ef4-82c6-4188cbda5638] succeeded in 0.019220464999307296s: None
2016-08-17 14:01:18,427 INFO celery.worker.strategy Received task: schedule_clean_desktops[63ed11e9-6a6f-4ff8-9943-33a59df44c74]
2016-08-17 14:01:18,428 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:01:18,430 WARNING celery.redirected 2016-08-17 14:01:18,430 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:01:18,431 WARNING celery.redirected 2016-08-17 14:01:18,431 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:01:18,431 WARNING celery.redirected 2016-08-17 14:01:18,431 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:01:18,434 WARNING celery.redirected 2016-08-17 14:01:18,434 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:01:18,435 WARNING celery.redirected 2016-08-17 14:01:18,435 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 0, 18, 429341), 'desktop_state_2': 'DELETED'}
2016-08-17 14:01:18,438 WARNING celery.redirected 2016-08-17 14:01:18,438 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:01:18,439 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:01:18,446 INFO celery.worker.job Task schedule_clean_desktops[63ed11e9-6a6f-4ff8-9943-33a59df44c74] succeeded in 0.018475111999578075s: None
2016-08-17 14:01:32,846 INFO celery.worker.strategy Received task: schedule_start_lesson[e154b7e1-4a89-40c6-8786-bbed366b8e3a]
2016-08-17 14:01:32,848 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:01:32,848 INFO celery Scheduling start lesson tasks
2016-08-17 14:01:32,849 WARNING celery.redirected 2016-08-17 14:01:32,849 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:01:32,850 WARNING celery.redirected 2016-08-17 14:01:32,850 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:01:32,850 WARNING celery.redirected 2016-08-17 14:01:32,850 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:01:32,855 WARNING celery.redirected 2016-08-17 14:01:32,854 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:01:32,855 WARNING celery.redirected 2016-08-17 14:01:32,855 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 1, 32, 852426), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 11, 32, 852426), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:01:32,857 WARNING celery.redirected 2016-08-17 14:01:32,857 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:01:32,858 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:01:32,864 INFO celery.worker.job Task schedule_start_lesson[e154b7e1-4a89-40c6-8786-bbed366b8e3a] succeeded in 0.016681588000210468s: None
2016-08-17 14:02:23,144 INFO celery.worker.strategy Received task: schedule_clean_desktops[8b0f0e3a-2b37-49a4-a937-8facede1fb90]
2016-08-17 14:02:23,145 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:02:23,147 WARNING celery.redirected 2016-08-17 14:02:23,147 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:02:23,148 WARNING celery.redirected 2016-08-17 14:02:23,147 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:02:23,148 WARNING celery.redirected 2016-08-17 14:02:23,148 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:02:23,151 WARNING celery.redirected 2016-08-17 14:02:23,151 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:02:23,152 WARNING celery.redirected 2016-08-17 14:02:23,152 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 1, 23, 146400), 'desktop_state_2': 'DELETED'}
2016-08-17 14:02:23,154 WARNING celery.redirected 2016-08-17 14:02:23,154 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:02:23,155 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:02:23,162 INFO celery.worker.job Task schedule_clean_desktops[8b0f0e3a-2b37-49a4-a937-8facede1fb90] succeeded in 0.016595131999565638s: None
2016-08-17 14:02:38,719 INFO celery.worker.strategy Received task: schedule_start_lesson[a9060503-8045-4458-ad03-bb99fcbbabc0]
2016-08-17 14:02:38,721 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:02:38,721 INFO celery Scheduling start lesson tasks
2016-08-17 14:02:38,722 WARNING celery.redirected 2016-08-17 14:02:38,722 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:02:38,723 WARNING celery.redirected 2016-08-17 14:02:38,723 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:02:38,724 WARNING celery.redirected 2016-08-17 14:02:38,724 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:02:38,728 WARNING celery.redirected 2016-08-17 14:02:38,727 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:02:38,728 WARNING celery.redirected 2016-08-17 14:02:38,728 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 2, 38, 725538), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 12, 38, 725538), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:02:38,730 WARNING celery.redirected 2016-08-17 14:02:38,730 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:02:38,731 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:02:38,739 INFO celery.worker.job Task schedule_start_lesson[a9060503-8045-4458-ad03-bb99fcbbabc0] succeeded in 0.0180249469995033s: None
2016-08-17 14:03:28,993 INFO celery.worker.strategy Received task: schedule_clean_desktops[09c7afbc-f9f2-4020-89fb-9ec2ca48b479]
2016-08-17 14:03:28,995 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:03:28,996 WARNING celery.redirected 2016-08-17 14:03:28,996 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:03:28,997 WARNING celery.redirected 2016-08-17 14:03:28,997 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:03:28,998 WARNING celery.redirected 2016-08-17 14:03:28,997 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:03:29,001 WARNING celery.redirected 2016-08-17 14:03:29,000 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:03:29,001 WARNING celery.redirected 2016-08-17 14:03:29,001 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 2, 28, 995806), 'desktop_state_2': 'DELETED'}
2016-08-17 14:03:29,005 WARNING celery.redirected 2016-08-17 14:03:29,004 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:03:29,006 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:03:29,014 INFO celery.worker.job Task schedule_clean_desktops[09c7afbc-f9f2-4020-89fb-9ec2ca48b479] succeeded in 0.019511651000357233s: None
2016-08-17 14:03:43,298 INFO celery.worker.strategy Received task: schedule_start_lesson[3abedbad-5a0c-427f-bf0d-c4af2f3a740e]
2016-08-17 14:03:43,299 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:03:43,300 INFO celery Scheduling start lesson tasks
2016-08-17 14:03:43,301 WARNING celery.redirected 2016-08-17 14:03:43,301 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:03:43,302 WARNING celery.redirected 2016-08-17 14:03:43,302 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:03:43,303 WARNING celery.redirected 2016-08-17 14:03:43,303 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:03:43,307 WARNING celery.redirected 2016-08-17 14:03:43,307 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:03:43,308 WARNING celery.redirected 2016-08-17 14:03:43,308 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 3, 43, 304603), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 13, 43, 304603), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:03:43,310 WARNING celery.redirected 2016-08-17 14:03:43,310 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:03:43,311 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:03:43,318 INFO celery.worker.job Task schedule_start_lesson[3abedbad-5a0c-427f-bf0d-c4af2f3a740e] succeeded in 0.018647631999556324s: None
2016-08-17 14:04:33,443 INFO celery.worker.strategy Received task: schedule_clean_desktops[c24385df-e021-4368-92a5-1ec3a611566a]
2016-08-17 14:04:33,445 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:04:33,446 WARNING celery.redirected 2016-08-17 14:04:33,446 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:04:33,447 WARNING celery.redirected 2016-08-17 14:04:33,447 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:04:33,448 WARNING celery.redirected 2016-08-17 14:04:33,447 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:04:33,451 WARNING celery.redirected 2016-08-17 14:04:33,450 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:04:33,451 WARNING celery.redirected 2016-08-17 14:04:33,451 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 3, 33, 445891), 'desktop_state_2': 'DELETED'}
2016-08-17 14:04:33,454 WARNING celery.redirected 2016-08-17 14:04:33,454 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:04:33,455 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:04:33,461 INFO celery.worker.job Task schedule_clean_desktops[c24385df-e021-4368-92a5-1ec3a611566a] succeeded in 0.016816504999951576s: None
2016-08-17 14:04:49,021 INFO celery.worker.strategy Received task: schedule_start_lesson[edc444d6-98f6-4375-9ed4-cd85d8a3c794]
2016-08-17 14:04:49,022 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:04:49,023 INFO celery Scheduling start lesson tasks
2016-08-17 14:04:49,024 WARNING celery.redirected 2016-08-17 14:04:49,024 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:04:49,025 WARNING celery.redirected 2016-08-17 14:04:49,025 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:04:49,025 WARNING celery.redirected 2016-08-17 14:04:49,025 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:04:49,029 WARNING celery.redirected 2016-08-17 14:04:49,029 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:04:49,029 WARNING celery.redirected 2016-08-17 14:04:49,029 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 4, 49, 26924), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 14, 49, 26924), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:04:49,032 WARNING celery.redirected 2016-08-17 14:04:49,032 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:04:49,033 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:04:49,040 INFO celery.worker.job Task schedule_start_lesson[edc444d6-98f6-4375-9ed4-cd85d8a3c794] succeeded in 0.01822049000111292s: None
2016-08-17 14:05:38,141 INFO celery.worker.strategy Received task: schedule_clean_desktops[92849f21-3dc6-47c2-a2d3-371f7f8f278e]
2016-08-17 14:05:38,142 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:05:38,144 WARNING celery.redirected 2016-08-17 14:05:38,144 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:05:38,145 WARNING celery.redirected 2016-08-17 14:05:38,145 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:05:38,146 WARNING celery.redirected 2016-08-17 14:05:38,146 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:05:38,149 WARNING celery.redirected 2016-08-17 14:05:38,149 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:05:38,150 WARNING celery.redirected 2016-08-17 14:05:38,149 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 4, 38, 143700), 'desktop_state_2': 'DELETED'}
2016-08-17 14:05:38,152 WARNING celery.redirected 2016-08-17 14:05:38,152 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:05:38,153 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:05:38,159 INFO celery.worker.job Task schedule_clean_desktops[92849f21-3dc6-47c2-a2d3-371f7f8f278e] succeeded in 0.016945129998930497s: None
2016-08-17 14:05:48,917 INFO celery.worker.strategy Received task: schedule_start_lesson[17df9d54-3779-4dd6-bb13-d4fe1bdbd422]
2016-08-17 14:05:48,919 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:05:48,919 INFO celery Scheduling start lesson tasks
2016-08-17 14:05:48,920 WARNING celery.redirected 2016-08-17 14:05:48,920 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:05:48,921 WARNING celery.redirected 2016-08-17 14:05:48,921 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:05:48,921 WARNING celery.redirected 2016-08-17 14:05:48,921 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:05:48,925 WARNING celery.redirected 2016-08-17 14:05:48,925 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:05:48,926 WARNING celery.redirected 2016-08-17 14:05:48,925 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 5, 48, 923145), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 15, 48, 923145), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:05:48,928 WARNING celery.redirected 2016-08-17 14:05:48,928 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:05:48,930 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:05:48,937 INFO celery.worker.job Task schedule_start_lesson[17df9d54-3779-4dd6-bb13-d4fe1bdbd422] succeeded in 0.018629596001119353s: None
2016-08-17 14:06:38,061 INFO celery.worker.strategy Received task: schedule_clean_desktops[69883fd7-eb7a-4756-9c15-20a25ff86e68]
2016-08-17 14:06:38,063 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:06:38,065 WARNING celery.redirected 2016-08-17 14:06:38,065 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:06:38,067 WARNING celery.redirected 2016-08-17 14:06:38,066 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:06:38,068 WARNING celery.redirected 2016-08-17 14:06:38,067 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:06:38,071 WARNING celery.redirected 2016-08-17 14:06:38,071 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:06:38,072 WARNING celery.redirected 2016-08-17 14:06:38,072 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 5, 38, 64350), 'desktop_state_2': 'DELETED'}
2016-08-17 14:06:38,074 WARNING celery.redirected 2016-08-17 14:06:38,074 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:06:38,075 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:06:38,081 INFO celery.worker.job Task schedule_clean_desktops[69883fd7-eb7a-4756-9c15-20a25ff86e68] succeeded in 0.018642036000528606s: None
2016-08-17 14:06:48,857 INFO celery.worker.strategy Received task: schedule_start_lesson[43c856ae-2e1d-42ae-a643-2a46d4302bfb]
2016-08-17 14:06:48,859 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:06:48,859 INFO celery Scheduling start lesson tasks
2016-08-17 14:06:48,860 WARNING celery.redirected 2016-08-17 14:06:48,860 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:06:48,861 WARNING celery.redirected 2016-08-17 14:06:48,861 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:06:48,861 WARNING celery.redirected 2016-08-17 14:06:48,861 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:06:48,866 WARNING celery.redirected 2016-08-17 14:06:48,865 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:06:48,866 WARNING celery.redirected 2016-08-17 14:06:48,866 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 6, 48, 863412), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 16, 48, 863412), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:06:48,868 WARNING celery.redirected 2016-08-17 14:06:48,868 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:06:48,869 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:06:48,876 INFO celery.worker.job Task schedule_start_lesson[43c856ae-2e1d-42ae-a643-2a46d4302bfb] succeeded in 0.017551537999679567s: None
2016-08-17 14:07:39,090 INFO celery.worker.strategy Received task: schedule_clean_desktops[0f3d8c6c-6ce9-411d-9199-fa3410f3b0dd]
2016-08-17 14:07:39,092 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:07:39,093 WARNING celery.redirected 2016-08-17 14:07:39,093 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:07:39,094 WARNING celery.redirected 2016-08-17 14:07:39,094 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:07:39,095 WARNING celery.redirected 2016-08-17 14:07:39,095 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:07:39,098 WARNING celery.redirected 2016-08-17 14:07:39,098 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:07:39,099 WARNING celery.redirected 2016-08-17 14:07:39,098 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 6, 39, 93072), 'desktop_state_2': 'DELETED'}
2016-08-17 14:07:39,101 WARNING celery.redirected 2016-08-17 14:07:39,101 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:07:39,103 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:07:39,110 INFO celery.worker.job Task schedule_clean_desktops[0f3d8c6c-6ce9-411d-9199-fa3410f3b0dd] succeeded in 0.018306742998902337s: None
2016-08-17 14:07:48,646 INFO celery.worker.strategy Received task: schedule_start_lesson[cb5b5098-fb8d-4533-89db-cf3ff7a167f6]
2016-08-17 14:07:48,647 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:07:48,647 INFO celery Scheduling start lesson tasks
2016-08-17 14:07:48,648 WARNING celery.redirected 2016-08-17 14:07:48,648 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:07:48,649 WARNING celery.redirected 2016-08-17 14:07:48,649 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:07:48,650 WARNING celery.redirected 2016-08-17 14:07:48,650 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:07:48,653 WARNING celery.redirected 2016-08-17 14:07:48,653 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:07:48,654 WARNING celery.redirected 2016-08-17 14:07:48,654 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 7, 48, 651450), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 17, 48, 651450), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:07:48,656 WARNING celery.redirected 2016-08-17 14:07:48,656 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:07:48,657 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:07:48,665 INFO celery.worker.job Task schedule_start_lesson[cb5b5098-fb8d-4533-89db-cf3ff7a167f6] succeeded in 0.0178472170009627s: None
2016-08-17 14:08:38,912 INFO celery.worker.strategy Received task: schedule_clean_desktops[df148572-b28a-4fde-87c2-e5476363a583]
2016-08-17 14:08:38,913 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:08:38,915 WARNING celery.redirected 2016-08-17 14:08:38,915 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:08:38,916 WARNING celery.redirected 2016-08-17 14:08:38,915 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:08:38,916 WARNING celery.redirected 2016-08-17 14:08:38,916 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:08:38,919 WARNING celery.redirected 2016-08-17 14:08:38,919 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:08:38,920 WARNING celery.redirected 2016-08-17 14:08:38,919 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 7, 38, 914418), 'desktop_state_2': 'DELETED'}
2016-08-17 14:08:38,923 WARNING celery.redirected 2016-08-17 14:08:38,923 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:08:38,924 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:08:38,931 INFO celery.worker.job Task schedule_clean_desktops[df148572-b28a-4fde-87c2-e5476363a583] succeeded in 0.017337367000436643s: None
2016-08-17 14:08:48,424 INFO celery.worker.strategy Received task: schedule_start_lesson[6e97857f-e8e6-4b09-aa37-74a6baaf796e]
2016-08-17 14:08:48,425 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:08:48,426 INFO celery Scheduling start lesson tasks
2016-08-17 14:08:48,427 WARNING celery.redirected 2016-08-17 14:08:48,427 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:08:48,428 WARNING celery.redirected 2016-08-17 14:08:48,428 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:08:48,429 WARNING celery.redirected 2016-08-17 14:08:48,428 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:08:48,433 WARNING celery.redirected 2016-08-17 14:08:48,433 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:08:48,434 WARNING celery.redirected 2016-08-17 14:08:48,434 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 8, 48, 430307), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 18, 48, 430307), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:08:48,436 WARNING celery.redirected 2016-08-17 14:08:48,436 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:08:48,437 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:08:48,443 INFO celery.worker.job Task schedule_start_lesson[6e97857f-e8e6-4b09-aa37-74a6baaf796e] succeeded in 0.0179653920004057s: None
2016-08-17 14:09:38,648 INFO celery.worker.strategy Received task: schedule_clean_desktops[7c3e86ac-ad8e-44a9-a778-e28f6b9c26ba]
2016-08-17 14:09:38,649 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:09:38,650 WARNING celery.redirected 2016-08-17 14:09:38,650 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:09:38,652 WARNING celery.redirected 2016-08-17 14:09:38,652 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:09:38,652 WARNING celery.redirected 2016-08-17 14:09:38,652 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:09:38,655 WARNING celery.redirected 2016-08-17 14:09:38,655 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:09:38,656 WARNING celery.redirected 2016-08-17 14:09:38,656 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 8, 38, 650244), 'desktop_state_2': 'DELETED'}
2016-08-17 14:09:38,658 WARNING celery.redirected 2016-08-17 14:09:38,658 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:09:38,659 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:09:38,665 INFO celery.worker.job Task schedule_clean_desktops[7c3e86ac-ad8e-44a9-a778-e28f6b9c26ba] succeeded in 0.016497480999532854s: None
2016-08-17 14:09:49,424 INFO celery.worker.strategy Received task: schedule_start_lesson[5c8f58b9-bd18-4ef1-b643-3272d28fafbc]
2016-08-17 14:09:49,425 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:09:49,426 INFO celery Scheduling start lesson tasks
2016-08-17 14:09:49,427 WARNING celery.redirected 2016-08-17 14:09:49,426 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:09:49,427 WARNING celery.redirected 2016-08-17 14:09:49,427 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:09:49,428 WARNING celery.redirected 2016-08-17 14:09:49,428 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:09:49,432 WARNING celery.redirected 2016-08-17 14:09:49,431 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:09:49,432 WARNING celery.redirected 2016-08-17 14:09:49,432 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 9, 49, 429636), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 19, 49, 429636), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:09:49,435 WARNING celery.redirected 2016-08-17 14:09:49,435 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:09:49,436 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:09:49,443 INFO celery.worker.job Task schedule_start_lesson[5c8f58b9-bd18-4ef1-b643-3272d28fafbc] succeeded in 0.01821324199954688s: None
2016-08-17 14:10:38,544 INFO celery.worker.strategy Received task: schedule_clean_desktops[80a30737-2656-436b-851e-24842c7061a9]
2016-08-17 14:10:38,545 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:10:38,546 WARNING celery.redirected 2016-08-17 14:10:38,546 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:10:38,547 WARNING celery.redirected 2016-08-17 14:10:38,547 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:10:38,548 WARNING celery.redirected 2016-08-17 14:10:38,548 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:10:38,551 WARNING celery.redirected 2016-08-17 14:10:38,551 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:10:38,552 WARNING celery.redirected 2016-08-17 14:10:38,551 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 9, 38, 546146), 'desktop_state_2': 'DELETED'}
2016-08-17 14:10:38,554 WARNING celery.redirected 2016-08-17 14:10:38,554 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:10:38,555 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:10:38,561 INFO celery.worker.job Task schedule_clean_desktops[80a30737-2656-436b-851e-24842c7061a9] succeeded in 0.01629655899887439s: None
2016-08-17 14:10:49,345 INFO celery.worker.strategy Received task: schedule_start_lesson[e599966b-92db-4573-b6d0-897bdb734161]
2016-08-17 14:10:49,346 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:10:49,347 INFO celery Scheduling start lesson tasks
2016-08-17 14:10:49,348 WARNING celery.redirected 2016-08-17 14:10:49,347 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:10:49,348 WARNING celery.redirected 2016-08-17 14:10:49,348 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:10:49,349 WARNING celery.redirected 2016-08-17 14:10:49,349 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:10:49,353 WARNING celery.redirected 2016-08-17 14:10:49,353 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:10:49,354 WARNING celery.redirected 2016-08-17 14:10:49,354 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 10, 49, 350764), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 20, 49, 350764), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:10:49,357 WARNING celery.redirected 2016-08-17 14:10:49,356 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:10:49,358 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:10:49,365 INFO celery.worker.job Task schedule_start_lesson[e599966b-92db-4573-b6d0-897bdb734161] succeeded in 0.018694506999963778s: None
2016-08-17 14:11:39,594 INFO celery.worker.strategy Received task: schedule_clean_desktops[7095d7c7-46c7-463d-937a-31c58cd9f90a]
2016-08-17 14:11:39,595 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:11:39,597 WARNING celery.redirected 2016-08-17 14:11:39,597 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:11:39,598 WARNING celery.redirected 2016-08-17 14:11:39,598 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:11:39,598 WARNING celery.redirected 2016-08-17 14:11:39,598 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:11:39,601 WARNING celery.redirected 2016-08-17 14:11:39,601 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:11:39,602 WARNING celery.redirected 2016-08-17 14:11:39,602 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 10, 39, 596462), 'desktop_state_2': 'DELETED'}
2016-08-17 14:11:39,604 WARNING celery.redirected 2016-08-17 14:11:39,604 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:11:39,606 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:11:39,613 INFO celery.worker.job Task schedule_clean_desktops[7095d7c7-46c7-463d-937a-31c58cd9f90a] succeeded in 0.01779977599835547s: None
2016-08-17 14:11:49,133 INFO celery.worker.strategy Received task: schedule_start_lesson[3af51cac-8efb-4d22-8762-a68e8b5a8d2b]
2016-08-17 14:11:49,134 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:11:49,135 INFO celery Scheduling start lesson tasks
2016-08-17 14:11:49,136 WARNING celery.redirected 2016-08-17 14:11:49,136 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:11:49,137 WARNING celery.redirected 2016-08-17 14:11:49,136 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:11:49,137 WARNING celery.redirected 2016-08-17 14:11:49,137 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:11:49,141 WARNING celery.redirected 2016-08-17 14:11:49,141 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:11:49,142 WARNING celery.redirected 2016-08-17 14:11:49,141 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 11, 49, 138746), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 21, 49, 138746), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:11:49,144 WARNING celery.redirected 2016-08-17 14:11:49,144 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:11:49,145 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:11:49,152 INFO celery.worker.job Task schedule_start_lesson[3af51cac-8efb-4d22-8762-a68e8b5a8d2b] succeeded in 0.018000920999838854s: None
2016-08-17 14:12:39,346 INFO celery.worker.strategy Received task: schedule_clean_desktops[f8b44d57-2721-4818-b3f3-151874cd07bd]
2016-08-17 14:12:39,348 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:12:39,349 WARNING celery.redirected 2016-08-17 14:12:39,349 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:12:39,350 WARNING celery.redirected 2016-08-17 14:12:39,350 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:12:39,350 WARNING celery.redirected 2016-08-17 14:12:39,350 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:12:39,354 WARNING celery.redirected 2016-08-17 14:12:39,354 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:12:39,354 WARNING celery.redirected 2016-08-17 14:12:39,354 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 11, 39, 348856), 'desktop_state_2': 'DELETED'}
2016-08-17 14:12:39,358 WARNING celery.redirected 2016-08-17 14:12:39,358 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:12:39,359 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:12:39,365 INFO celery.worker.job Task schedule_clean_desktops[f8b44d57-2721-4818-b3f3-151874cd07bd] succeeded in 0.01766031500119425s: None
2016-08-17 14:12:54,866 INFO celery.worker.strategy Received task: schedule_start_lesson[8d6d7c96-dd36-44f4-871e-d4dbead0dcb2]
2016-08-17 14:12:54,867 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:12:54,868 INFO celery Scheduling start lesson tasks
2016-08-17 14:12:54,869 WARNING celery.redirected 2016-08-17 14:12:54,869 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:12:54,870 WARNING celery.redirected 2016-08-17 14:12:54,869 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:12:54,870 WARNING celery.redirected 2016-08-17 14:12:54,870 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:12:54,873 WARNING celery.redirected 2016-08-17 14:12:54,873 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:12:54,874 WARNING celery.redirected 2016-08-17 14:12:54,874 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 12, 54, 871798), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 22, 54, 871798), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:12:54,876 WARNING celery.redirected 2016-08-17 14:12:54,876 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:12:54,877 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:12:54,884 INFO celery.worker.job Task schedule_start_lesson[8d6d7c96-dd36-44f4-871e-d4dbead0dcb2] succeeded in 0.017169656000987743s: None
2016-08-17 14:13:44,998 INFO celery.worker.strategy Received task: schedule_clean_desktops[a7368f98-e2c7-43cb-a31a-6ae2ad0aca8a]
2016-08-17 14:13:44,999 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:13:45,001 WARNING celery.redirected 2016-08-17 14:13:45,001 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:13:45,002 WARNING celery.redirected 2016-08-17 14:13:45,002 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:13:45,003 WARNING celery.redirected 2016-08-17 14:13:45,003 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:13:45,006 WARNING celery.redirected 2016-08-17 14:13:45,006 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:13:45,007 WARNING celery.redirected 2016-08-17 14:13:45,006 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 12, 45, 690), 'desktop_state_2': 'DELETED'}
2016-08-17 14:13:45,009 WARNING celery.redirected 2016-08-17 14:13:45,009 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:13:45,010 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:13:45,016 INFO celery.worker.job Task schedule_clean_desktops[a7368f98-e2c7-43cb-a31a-6ae2ad0aca8a] succeeded in 0.01642913000068802s: None
2016-08-17 14:13:59,284 INFO celery.worker.strategy Received task: schedule_start_lesson[42b7ae35-ac9c-423b-9d95-93ffb0712cc8]
2016-08-17 14:13:59,286 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:13:59,286 INFO celery Scheduling start lesson tasks
2016-08-17 14:13:59,287 WARNING celery.redirected 2016-08-17 14:13:59,287 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:13:59,288 WARNING celery.redirected 2016-08-17 14:13:59,288 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:13:59,289 WARNING celery.redirected 2016-08-17 14:13:59,289 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:13:59,293 WARNING celery.redirected 2016-08-17 14:13:59,293 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:13:59,294 WARNING celery.redirected 2016-08-17 14:13:59,294 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 13, 59, 290837), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 23, 59, 290837), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:13:59,295 WARNING celery.redirected 2016-08-17 14:13:59,295 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:13:59,296 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:13:59,303 INFO celery.worker.job Task schedule_start_lesson[42b7ae35-ac9c-423b-9d95-93ffb0712cc8] succeeded in 0.017291216001467546s: None
2016-08-17 14:14:49,449 INFO celery.worker.strategy Received task: schedule_clean_desktops[6045b44d-9cbb-49b5-818f-2ff3886c7620]
2016-08-17 14:14:49,450 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:14:49,452 WARNING celery.redirected 2016-08-17 14:14:49,452 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:14:49,453 WARNING celery.redirected 2016-08-17 14:14:49,453 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:14:49,453 WARNING celery.redirected 2016-08-17 14:14:49,453 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:14:49,457 WARNING celery.redirected 2016-08-17 14:14:49,456 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:14:49,457 WARNING celery.redirected 2016-08-17 14:14:49,457 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 13, 49, 451428), 'desktop_state_2': 'DELETED'}
2016-08-17 14:14:49,459 WARNING celery.redirected 2016-08-17 14:14:49,459 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:14:49,460 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:14:49,467 INFO celery.worker.job Task schedule_clean_desktops[6045b44d-9cbb-49b5-818f-2ff3886c7620] succeeded in 0.01672669199979282s: None
2016-08-17 14:15:00,227 INFO celery.worker.strategy Received task: schedule_start_lesson[b1fd5042-0b8f-4d9b-904a-3bce624e34dd]
2016-08-17 14:15:00,228 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:15:00,229 INFO celery Scheduling start lesson tasks
2016-08-17 14:15:00,230 WARNING celery.redirected 2016-08-17 14:15:00,230 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:15:00,231 WARNING celery.redirected 2016-08-17 14:15:00,230 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:15:00,231 WARNING celery.redirected 2016-08-17 14:15:00,231 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:15:00,234 WARNING celery.redirected 2016-08-17 14:15:00,234 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:15:00,235 WARNING celery.redirected 2016-08-17 14:15:00,235 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 15, 0, 232782), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 25, 0, 232782), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:15:00,237 WARNING celery.redirected 2016-08-17 14:15:00,237 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:15:00,238 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:15:00,244 INFO celery.worker.job Task schedule_start_lesson[b1fd5042-0b8f-4d9b-904a-3bce624e34dd] succeeded in 0.015970098998877802s: None
2016-08-17 14:15:50,327 INFO celery.worker.strategy Received task: schedule_clean_desktops[f3090784-bd08-413f-956e-c0b933ba6643]
2016-08-17 14:15:50,328 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:15:50,329 WARNING celery.redirected 2016-08-17 14:15:50,329 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:15:50,331 WARNING celery.redirected 2016-08-17 14:15:50,331 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:15:50,332 WARNING celery.redirected 2016-08-17 14:15:50,331 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:15:50,335 WARNING celery.redirected 2016-08-17 14:15:50,335 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:15:50,336 WARNING celery.redirected 2016-08-17 14:15:50,335 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 14, 50, 329125), 'desktop_state_2': 'DELETED'}
2016-08-17 14:15:50,338 WARNING celery.redirected 2016-08-17 14:15:50,338 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:15:50,339 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:15:50,346 INFO celery.worker.job Task schedule_clean_desktops[f3090784-bd08-413f-956e-c0b933ba6643] succeeded in 0.018286921000253642s: None
2016-08-17 14:15:59,827 INFO celery.worker.strategy Received task: schedule_start_lesson[a0fae7ff-2a3c-4394-aa86-755603d0177a]
2016-08-17 14:15:59,829 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:15:59,829 INFO celery Scheduling start lesson tasks
2016-08-17 14:15:59,830 WARNING celery.redirected 2016-08-17 14:15:59,830 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:15:59,831 WARNING celery.redirected 2016-08-17 14:15:59,831 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:15:59,832 WARNING celery.redirected 2016-08-17 14:15:59,832 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:15:59,836 WARNING celery.redirected 2016-08-17 14:15:59,835 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:15:59,836 WARNING celery.redirected 2016-08-17 14:15:59,836 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 15, 59, 833560), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 25, 59, 833560), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:15:59,839 WARNING celery.redirected 2016-08-17 14:15:59,839 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:15:59,840 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:15:59,848 INFO celery.worker.job Task schedule_start_lesson[a0fae7ff-2a3c-4394-aa86-755603d0177a] succeeded in 0.019038726000871975s: None
2016-08-17 14:16:49,884 INFO celery.worker.strategy Received task: schedule_clean_desktops[dc7966b3-b647-445f-be63-c04df02c3317]
2016-08-17 14:16:49,886 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:16:49,887 WARNING celery.redirected 2016-08-17 14:16:49,887 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:16:49,888 WARNING celery.redirected 2016-08-17 14:16:49,888 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:16:49,889 WARNING celery.redirected 2016-08-17 14:16:49,889 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:16:49,892 WARNING celery.redirected 2016-08-17 14:16:49,892 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:16:49,892 WARNING celery.redirected 2016-08-17 14:16:49,892 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 15, 49, 886932), 'desktop_state_2': 'DELETED'}
2016-08-17 14:16:49,895 WARNING celery.redirected 2016-08-17 14:16:49,895 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:16:49,897 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:16:49,904 INFO celery.worker.job Task schedule_clean_desktops[dc7966b3-b647-445f-be63-c04df02c3317] succeeded in 0.018225777999759885s: None
2016-08-17 14:17:00,642 INFO celery.worker.strategy Received task: schedule_start_lesson[a444f8c9-2a42-4136-9f7f-69303908ac66]
2016-08-17 14:17:00,644 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:17:00,644 INFO celery Scheduling start lesson tasks
2016-08-17 14:17:00,646 WARNING celery.redirected 2016-08-17 14:17:00,646 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:17:00,647 WARNING celery.redirected 2016-08-17 14:17:00,647 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:17:00,647 WARNING celery.redirected 2016-08-17 14:17:00,647 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:17:00,652 WARNING celery.redirected 2016-08-17 14:17:00,652 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:17:00,653 WARNING celery.redirected 2016-08-17 14:17:00,652 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 17, 0, 649188), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 27, 0, 649188), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:17:00,654 WARNING celery.redirected 2016-08-17 14:17:00,654 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:17:00,655 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:17:00,662 INFO celery.worker.job Task schedule_start_lesson[a444f8c9-2a42-4136-9f7f-69303908ac66] succeeded in 0.018653833998541813s: None
2016-08-17 14:17:50,750 INFO celery.worker.strategy Received task: schedule_clean_desktops[9417c5f9-e128-4e0c-9203-faa27e77fb93]
2016-08-17 14:17:50,751 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:17:50,753 WARNING celery.redirected 2016-08-17 14:17:50,753 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:17:50,754 WARNING celery.redirected 2016-08-17 14:17:50,754 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:17:50,754 WARNING celery.redirected 2016-08-17 14:17:50,754 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:17:50,757 WARNING celery.redirected 2016-08-17 14:17:50,757 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:17:50,758 WARNING celery.redirected 2016-08-17 14:17:50,758 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 16, 50, 752406), 'desktop_state_2': 'DELETED'}
2016-08-17 14:17:50,761 WARNING celery.redirected 2016-08-17 14:17:50,760 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:17:50,762 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:17:50,770 INFO celery.worker.job Task schedule_clean_desktops[9417c5f9-e128-4e0c-9203-faa27e77fb93] succeeded in 0.01887272000021767s: None
2016-08-17 14:18:00,241 INFO celery.worker.strategy Received task: schedule_start_lesson[bd7f95f3-636c-49b2-a6c7-8c6cf37a4633]
2016-08-17 14:18:00,243 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:18:00,243 INFO celery Scheduling start lesson tasks
2016-08-17 14:18:00,244 WARNING celery.redirected 2016-08-17 14:18:00,244 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:18:00,245 WARNING celery.redirected 2016-08-17 14:18:00,245 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:18:00,246 WARNING celery.redirected 2016-08-17 14:18:00,245 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:18:00,251 WARNING celery.redirected 2016-08-17 14:18:00,251 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:18:00,252 WARNING celery.redirected 2016-08-17 14:18:00,252 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 18, 0, 247330), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 28, 0, 247330), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:18:00,255 WARNING celery.redirected 2016-08-17 14:18:00,255 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:18:00,256 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:18:00,262 INFO celery.worker.job Task schedule_start_lesson[bd7f95f3-636c-49b2-a6c7-8c6cf37a4633] succeeded in 0.01930437000009988s: None
2016-08-17 14:18:55,195 INFO celery.worker.strategy Received task: schedule_clean_desktops[6af30bf0-0270-4e8a-af51-5cf782ee79f0]
2016-08-17 14:18:55,196 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:18:55,198 WARNING celery.redirected 2016-08-17 14:18:55,197 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:18:55,199 WARNING celery.redirected 2016-08-17 14:18:55,199 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:18:55,200 WARNING celery.redirected 2016-08-17 14:18:55,200 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:18:55,203 WARNING celery.redirected 2016-08-17 14:18:55,203 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:18:55,203 WARNING celery.redirected 2016-08-17 14:18:55,203 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 17, 55, 197319), 'desktop_state_2': 'DELETED'}
2016-08-17 14:18:55,205 WARNING celery.redirected 2016-08-17 14:18:55,205 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:18:55,206 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:18:55,213 INFO celery.worker.job Task schedule_clean_desktops[6af30bf0-0270-4e8a-af51-5cf782ee79f0] succeeded in 0.017156841000542045s: None
2016-08-17 14:19:05,951 INFO celery.worker.strategy Received task: schedule_start_lesson[d61a59b8-ea6b-4e11-a8e3-b7373a5356a0]
2016-08-17 14:19:05,952 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:19:05,953 INFO celery Scheduling start lesson tasks
2016-08-17 14:19:05,954 WARNING celery.redirected 2016-08-17 14:19:05,954 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:19:05,955 WARNING celery.redirected 2016-08-17 14:19:05,955 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:19:05,955 WARNING celery.redirected 2016-08-17 14:19:05,955 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:19:05,959 WARNING celery.redirected 2016-08-17 14:19:05,959 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:19:05,959 WARNING celery.redirected 2016-08-17 14:19:05,959 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 19, 5, 957168), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 29, 5, 957168), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:19:05,962 WARNING celery.redirected 2016-08-17 14:19:05,962 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:19:05,963 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:19:05,971 INFO celery.worker.job Task schedule_start_lesson[d61a59b8-ea6b-4e11-a8e3-b7373a5356a0] succeeded in 0.019000490001417347s: None
2016-08-17 14:20:00,888 INFO celery.worker.strategy Received task: schedule_clean_desktops[dbfce3ce-55d9-46c3-a719-25026d969bc4]
2016-08-17 14:20:00,890 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:20:00,892 WARNING celery.redirected 2016-08-17 14:20:00,891 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:20:00,893 WARNING celery.redirected 2016-08-17 14:20:00,892 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:20:00,893 WARNING celery.redirected 2016-08-17 14:20:00,893 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:20:00,897 WARNING celery.redirected 2016-08-17 14:20:00,896 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:20:00,897 WARNING celery.redirected 2016-08-17 14:20:00,897 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 19, 0, 891147), 'desktop_state_2': 'DELETED'}
2016-08-17 14:20:00,900 WARNING celery.redirected 2016-08-17 14:20:00,900 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:20:00,901 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:20:00,908 INFO celery.worker.job Task schedule_clean_desktops[dbfce3ce-55d9-46c3-a719-25026d969bc4] succeeded in 0.018376359999820124s: None
2016-08-17 14:20:10,396 INFO celery.worker.strategy Received task: schedule_start_lesson[2d7e7b73-8f46-46fb-8eeb-1e2f057edc9f]
2016-08-17 14:20:10,398 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:20:10,399 INFO celery Scheduling start lesson tasks
2016-08-17 14:20:10,400 WARNING celery.redirected 2016-08-17 14:20:10,399 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:20:10,401 WARNING celery.redirected 2016-08-17 14:20:10,400 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:20:10,401 WARNING celery.redirected 2016-08-17 14:20:10,401 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:20:10,405 WARNING celery.redirected 2016-08-17 14:20:10,405 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:20:10,405 WARNING celery.redirected 2016-08-17 14:20:10,405 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 20, 10, 403000), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 30, 10, 403000), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:20:10,407 WARNING celery.redirected 2016-08-17 14:20:10,407 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:20:10,408 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:20:10,415 INFO celery.worker.job Task schedule_start_lesson[2d7e7b73-8f46-46fb-8eeb-1e2f057edc9f] succeeded in 0.016927355000007083s: None
2016-08-17 14:21:05,266 INFO celery.worker.strategy Received task: schedule_clean_desktops[3e14b74e-a546-4d5a-ad20-cbe83b375e9d]
2016-08-17 14:21:05,267 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:21:05,269 WARNING celery.redirected 2016-08-17 14:21:05,268 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:21:05,270 WARNING celery.redirected 2016-08-17 14:21:05,270 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:21:05,271 WARNING celery.redirected 2016-08-17 14:21:05,270 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:21:05,274 WARNING celery.redirected 2016-08-17 14:21:05,274 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:21:05,274 WARNING celery.redirected 2016-08-17 14:21:05,274 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 20, 5, 268138), 'desktop_state_2': 'DELETED'}
2016-08-17 14:21:05,276 WARNING celery.redirected 2016-08-17 14:21:05,276 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:21:05,277 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:21:05,284 INFO celery.worker.job Task schedule_clean_desktops[3e14b74e-a546-4d5a-ad20-cbe83b375e9d] succeeded in 0.017290452999077388s: None
2016-08-17 14:21:10,113 INFO celery.worker.strategy Received task: schedule_start_lesson[bc2afc0c-46b1-4a6a-a33b-85ba25ec0bed]
2016-08-17 14:21:10,114 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:21:10,114 INFO celery Scheduling start lesson tasks
2016-08-17 14:21:10,115 WARNING celery.redirected 2016-08-17 14:21:10,115 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:21:10,116 WARNING celery.redirected 2016-08-17 14:21:10,116 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:21:10,117 WARNING celery.redirected 2016-08-17 14:21:10,117 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:21:10,120 WARNING celery.redirected 2016-08-17 14:21:10,120 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:21:10,121 WARNING celery.redirected 2016-08-17 14:21:10,121 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 21, 10, 118558), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 31, 10, 118558), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:21:10,123 WARNING celery.redirected 2016-08-17 14:21:10,123 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:21:10,124 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:21:10,130 INFO celery.worker.job Task schedule_start_lesson[bc2afc0c-46b1-4a6a-a33b-85ba25ec0bed] succeeded in 0.016657086998748127s: None
2016-08-17 14:22:06,284 INFO celery.worker.strategy Received task: schedule_clean_desktops[af2f0b6c-061c-46a3-afac-5a609fdb9988]
2016-08-17 14:22:06,286 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:22:06,287 WARNING celery.redirected 2016-08-17 14:22:06,287 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:22:06,288 WARNING celery.redirected 2016-08-17 14:22:06,288 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:22:06,288 WARNING celery.redirected 2016-08-17 14:22:06,288 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:22:06,292 WARNING celery.redirected 2016-08-17 14:22:06,292 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:22:06,292 WARNING celery.redirected 2016-08-17 14:22:06,292 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 21, 6, 286652), 'desktop_state_2': 'DELETED'}
2016-08-17 14:22:06,294 WARNING celery.redirected 2016-08-17 14:22:06,294 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:22:06,295 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:22:06,303 INFO celery.worker.job Task schedule_clean_desktops[af2f0b6c-061c-46a3-afac-5a609fdb9988] succeeded in 0.0171999850008433s: None
2016-08-17 14:22:11,022 INFO celery.worker.strategy Received task: schedule_start_lesson[65d3eb95-7648-458f-a426-9edfce409ab3]
2016-08-17 14:22:11,023 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:22:11,024 INFO celery Scheduling start lesson tasks
2016-08-17 14:22:11,025 WARNING celery.redirected 2016-08-17 14:22:11,024 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:22:11,026 WARNING celery.redirected 2016-08-17 14:22:11,025 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:22:11,026 WARNING celery.redirected 2016-08-17 14:22:11,026 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:22:11,030 WARNING celery.redirected 2016-08-17 14:22:11,030 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:22:11,030 WARNING celery.redirected 2016-08-17 14:22:11,030 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 22, 11, 27959), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 32, 11, 27959), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:22:11,033 WARNING celery.redirected 2016-08-17 14:22:11,033 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:22:11,035 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:22:11,044 INFO celery.worker.job Task schedule_start_lesson[65d3eb95-7648-458f-a426-9edfce409ab3] succeeded in 0.02161883000007947s: None
2016-08-17 14:23:05,900 INFO celery.worker.strategy Received task: schedule_clean_desktops[5d9e2960-f60c-4020-bcf2-ddb192499de7]
2016-08-17 14:23:05,901 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:23:05,902 WARNING celery.redirected 2016-08-17 14:23:05,902 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:23:05,903 WARNING celery.redirected 2016-08-17 14:23:05,903 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:23:05,904 WARNING celery.redirected 2016-08-17 14:23:05,904 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:23:05,907 WARNING celery.redirected 2016-08-17 14:23:05,907 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:23:05,907 WARNING celery.redirected 2016-08-17 14:23:05,907 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 22, 5, 902038), 'desktop_state_2': 'DELETED'}
2016-08-17 14:23:05,910 WARNING celery.redirected 2016-08-17 14:23:05,910 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:23:05,912 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:23:05,921 INFO celery.worker.job Task schedule_clean_desktops[5d9e2960-f60c-4020-bcf2-ddb192499de7] succeeded in 0.019949880999774905s: None
2016-08-17 14:23:10,627 INFO celery.worker.strategy Received task: schedule_start_lesson[0b45ad62-baf7-4128-bcfc-f31920643e3e]
2016-08-17 14:23:10,628 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:23:10,629 INFO celery Scheduling start lesson tasks
2016-08-17 14:23:10,630 WARNING celery.redirected 2016-08-17 14:23:10,629 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:23:10,630 WARNING celery.redirected 2016-08-17 14:23:10,630 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:23:10,631 WARNING celery.redirected 2016-08-17 14:23:10,631 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:23:10,634 WARNING celery.redirected 2016-08-17 14:23:10,634 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:23:10,635 WARNING celery.redirected 2016-08-17 14:23:10,635 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 23, 10, 632707), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 33, 10, 632707), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:23:10,637 WARNING celery.redirected 2016-08-17 14:23:10,637 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:23:10,638 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:23:10,645 INFO celery.worker.job Task schedule_start_lesson[0b45ad62-baf7-4128-bcfc-f31920643e3e] succeeded in 0.016645722000248497s: None
2016-08-17 14:24:05,608 INFO celery.worker.strategy Received task: schedule_clean_desktops[fb018f0d-82df-45c4-a481-331d86b2ad6d]
2016-08-17 14:24:05,609 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:24:05,611 WARNING celery.redirected 2016-08-17 14:24:05,611 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:24:05,612 WARNING celery.redirected 2016-08-17 14:24:05,612 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:24:05,613 WARNING celery.redirected 2016-08-17 14:24:05,613 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:24:05,616 WARNING celery.redirected 2016-08-17 14:24:05,616 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:24:05,617 WARNING celery.redirected 2016-08-17 14:24:05,617 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 23, 5, 610725), 'desktop_state_2': 'DELETED'}
2016-08-17 14:24:05,619 WARNING celery.redirected 2016-08-17 14:24:05,619 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:24:05,620 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:24:05,627 INFO celery.worker.job Task schedule_clean_desktops[fb018f0d-82df-45c4-a481-331d86b2ad6d] succeeded in 0.017661105999650317s: None
2016-08-17 14:24:11,595 INFO celery.worker.strategy Received task: schedule_start_lesson[e15c9980-5453-4164-a91a-a50ea4a40257]
2016-08-17 14:24:11,597 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:24:11,597 INFO celery Scheduling start lesson tasks
2016-08-17 14:24:11,598 WARNING celery.redirected 2016-08-17 14:24:11,598 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:24:11,599 WARNING celery.redirected 2016-08-17 14:24:11,599 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:24:11,600 WARNING celery.redirected 2016-08-17 14:24:11,600 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:24:11,603 WARNING celery.redirected 2016-08-17 14:24:11,603 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:24:11,604 WARNING celery.redirected 2016-08-17 14:24:11,604 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 24, 11, 601478), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 34, 11, 601478), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:24:11,606 WARNING celery.redirected 2016-08-17 14:24:11,606 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:24:11,607 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:24:11,613 INFO celery.worker.job Task schedule_start_lesson[e15c9980-5453-4164-a91a-a50ea4a40257] succeeded in 0.016592138999840245s: None
2016-08-17 14:25:06,487 INFO celery.worker.strategy Received task: schedule_clean_desktops[cc750704-d7ea-4b1d-bc85-8bdcd6f5f142]
2016-08-17 14:25:06,489 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:25:06,491 WARNING celery.redirected 2016-08-17 14:25:06,491 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:25:06,493 WARNING celery.redirected 2016-08-17 14:25:06,492 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:25:06,493 WARNING celery.redirected 2016-08-17 14:25:06,493 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:25:06,496 WARNING celery.redirected 2016-08-17 14:25:06,496 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:25:06,497 WARNING celery.redirected 2016-08-17 14:25:06,497 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 24, 6, 490453), 'desktop_state_2': 'DELETED'}
2016-08-17 14:25:06,499 WARNING celery.redirected 2016-08-17 14:25:06,499 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:25:06,500 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:25:06,507 INFO celery.worker.job Task schedule_clean_desktops[cc750704-d7ea-4b1d-bc85-8bdcd6f5f142] succeeded in 0.017768120998880477s: None
2016-08-17 14:25:11,183 INFO celery.worker.strategy Received task: schedule_start_lesson[f8eb952a-c2eb-4841-9199-466691ba74bc]
2016-08-17 14:25:11,185 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:25:11,185 INFO celery Scheduling start lesson tasks
2016-08-17 14:25:11,186 WARNING celery.redirected 2016-08-17 14:25:11,186 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:25:11,187 WARNING celery.redirected 2016-08-17 14:25:11,187 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:25:11,188 WARNING celery.redirected 2016-08-17 14:25:11,188 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:25:11,192 WARNING celery.redirected 2016-08-17 14:25:11,192 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:25:11,193 WARNING celery.redirected 2016-08-17 14:25:11,193 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 25, 11, 190047), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 35, 11, 190047), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:25:11,195 WARNING celery.redirected 2016-08-17 14:25:11,195 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:25:11,196 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:25:11,202 INFO celery.worker.job Task schedule_start_lesson[f8eb952a-c2eb-4841-9199-466691ba74bc] succeeded in 0.017876527999760583s: None
2016-08-17 14:26:11,430 INFO celery.worker.strategy Received task: schedule_clean_desktops[fdf01161-aa92-45fe-bf2a-aecbdbc03d56]
2016-08-17 14:26:11,432 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:26:11,434 WARNING celery.redirected 2016-08-17 14:26:11,434 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:26:11,436 WARNING celery.redirected 2016-08-17 14:26:11,435 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:26:11,437 WARNING celery.redirected 2016-08-17 14:26:11,436 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:26:11,441 WARNING celery.redirected 2016-08-17 14:26:11,440 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:26:11,442 WARNING celery.redirected 2016-08-17 14:26:11,441 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 25, 11, 433183), 'desktop_state_2': 'DELETED'}
2016-08-17 14:26:11,445 WARNING celery.redirected 2016-08-17 14:26:11,444 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:26:11,446 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:26:11,456 INFO celery.worker.job Task schedule_clean_desktops[fdf01161-aa92-45fe-bf2a-aecbdbc03d56] succeeded in 0.02452970599915716s: None
2016-08-17 14:26:16,323 INFO celery.worker.strategy Received task: schedule_start_lesson[742b0811-1700-47a9-a9a6-7bf2ae129081]
2016-08-17 14:26:16,325 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:26:16,325 INFO celery Scheduling start lesson tasks
2016-08-17 14:26:16,326 WARNING celery.redirected 2016-08-17 14:26:16,326 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:26:16,327 WARNING celery.redirected 2016-08-17 14:26:16,327 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:26:16,328 WARNING celery.redirected 2016-08-17 14:26:16,328 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:26:16,332 WARNING celery.redirected 2016-08-17 14:26:16,331 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:26:16,332 WARNING celery.redirected 2016-08-17 14:26:16,332 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 26, 16, 329511), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 36, 16, 329511), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:26:16,334 WARNING celery.redirected 2016-08-17 14:26:16,334 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:26:16,335 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:26:16,342 INFO celery.worker.job Task schedule_start_lesson[742b0811-1700-47a9-a9a6-7bf2ae129081] succeeded in 0.01755480700012413s: None
2016-08-17 14:27:16,523 INFO celery.worker.strategy Received task: schedule_clean_desktops[a11193b5-35fb-4da1-8f60-35c7a9fe87e8]
2016-08-17 14:27:16,524 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:27:16,526 WARNING celery.redirected 2016-08-17 14:27:16,525 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:27:16,527 WARNING celery.redirected 2016-08-17 14:27:16,526 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:27:16,527 WARNING celery.redirected 2016-08-17 14:27:16,527 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:27:16,530 WARNING celery.redirected 2016-08-17 14:27:16,530 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:27:16,531 WARNING celery.redirected 2016-08-17 14:27:16,531 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 26, 16, 525326), 'desktop_state_2': 'DELETED'}
2016-08-17 14:27:16,533 WARNING celery.redirected 2016-08-17 14:27:16,532 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:27:16,534 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:27:16,542 INFO celery.worker.job Task schedule_clean_desktops[a11193b5-35fb-4da1-8f60-35c7a9fe87e8] succeeded in 0.01802710899937665s: None
2016-08-17 14:27:21,303 INFO celery.worker.strategy Received task: schedule_start_lesson[52fbf90d-61bf-4117-90ca-ead8d5e7237f]
2016-08-17 14:27:21,304 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:27:21,305 INFO celery Scheduling start lesson tasks
2016-08-17 14:27:21,306 WARNING celery.redirected 2016-08-17 14:27:21,306 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:27:21,307 WARNING celery.redirected 2016-08-17 14:27:21,307 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:27:21,308 WARNING celery.redirected 2016-08-17 14:27:21,308 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:27:21,312 WARNING celery.redirected 2016-08-17 14:27:21,312 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:27:21,313 WARNING celery.redirected 2016-08-17 14:27:21,312 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 27, 21, 309633), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 37, 21, 309633), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:27:21,315 WARNING celery.redirected 2016-08-17 14:27:21,315 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:27:21,316 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:27:21,324 INFO celery.worker.job Task schedule_start_lesson[52fbf90d-61bf-4117-90ca-ead8d5e7237f] succeeded in 0.019962128999395645s: None
2016-08-17 14:28:20,761 INFO celery.worker.strategy Received task: schedule_clean_desktops[4985e3f2-7666-41ad-b20b-47469dbdda37]
2016-08-17 14:28:20,762 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:28:20,764 WARNING celery.redirected 2016-08-17 14:28:20,764 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:28:20,765 WARNING celery.redirected 2016-08-17 14:28:20,765 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:28:20,765 WARNING celery.redirected 2016-08-17 14:28:20,765 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:28:20,768 WARNING celery.redirected 2016-08-17 14:28:20,768 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:28:20,769 WARNING celery.redirected 2016-08-17 14:28:20,769 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 27, 20, 763489), 'desktop_state_2': 'DELETED'}
2016-08-17 14:28:20,771 WARNING celery.redirected 2016-08-17 14:28:20,771 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:28:20,772 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:28:20,779 INFO celery.worker.job Task schedule_clean_desktops[4985e3f2-7666-41ad-b20b-47469dbdda37] succeeded in 0.016334927999196225s: None
2016-08-17 14:28:26,783 INFO celery.worker.strategy Received task: schedule_start_lesson[ba3ee969-8060-4619-9972-40b905ac8c21]
2016-08-17 14:28:26,784 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:28:26,785 INFO celery Scheduling start lesson tasks
2016-08-17 14:28:26,786 WARNING celery.redirected 2016-08-17 14:28:26,785 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:28:26,787 WARNING celery.redirected 2016-08-17 14:28:26,786 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:28:26,787 WARNING celery.redirected 2016-08-17 14:28:26,787 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:28:26,791 WARNING celery.redirected 2016-08-17 14:28:26,791 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:28:26,791 WARNING celery.redirected 2016-08-17 14:28:26,791 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 28, 26, 789002), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 38, 26, 789002), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:28:26,793 WARNING celery.redirected 2016-08-17 14:28:26,793 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:28:26,794 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:28:26,801 INFO celery.worker.job Task schedule_start_lesson[ba3ee969-8060-4619-9972-40b905ac8c21] succeeded in 0.017253316998903756s: None
2016-08-17 14:29:26,440 INFO celery.worker.strategy Received task: schedule_clean_desktops[a70216b3-0b53-4159-804b-7cc954b08186]
2016-08-17 14:29:26,441 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:29:26,443 WARNING celery.redirected 2016-08-17 14:29:26,443 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:29:26,444 WARNING celery.redirected 2016-08-17 14:29:26,444 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:29:26,444 WARNING celery.redirected 2016-08-17 14:29:26,444 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:29:26,448 WARNING celery.redirected 2016-08-17 14:29:26,448 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:29:26,448 WARNING celery.redirected 2016-08-17 14:29:26,448 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 28, 26, 442579), 'desktop_state_2': 'DELETED'}
2016-08-17 14:29:26,451 WARNING celery.redirected 2016-08-17 14:29:26,451 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:29:26,452 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:29:26,461 INFO celery.worker.job Task schedule_clean_desktops[a70216b3-0b53-4159-804b-7cc954b08186] succeeded in 0.019491847000608686s: None
2016-08-17 14:29:31,252 INFO celery.worker.strategy Received task: schedule_start_lesson[b4618af3-20e5-4025-8520-981760496815]
2016-08-17 14:29:31,254 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:29:31,254 INFO celery Scheduling start lesson tasks
2016-08-17 14:29:31,255 WARNING celery.redirected 2016-08-17 14:29:31,255 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:29:31,256 WARNING celery.redirected 2016-08-17 14:29:31,256 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:29:31,256 WARNING celery.redirected 2016-08-17 14:29:31,256 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:29:31,260 WARNING celery.redirected 2016-08-17 14:29:31,260 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:29:31,260 WARNING celery.redirected 2016-08-17 14:29:31,260 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 29, 31, 258238), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 39, 31, 258238), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:29:31,262 WARNING celery.redirected 2016-08-17 14:29:31,262 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:29:31,263 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:29:31,270 INFO celery.worker.job Task schedule_start_lesson[b4618af3-20e5-4025-8520-981760496815] succeeded in 0.016729409999243217s: None
2016-08-17 14:30:31,944 INFO celery.worker.strategy Received task: schedule_clean_desktops[f42abfb8-df9f-4b2e-a261-b397ab96459a]
2016-08-17 14:30:31,946 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:30:31,947 WARNING celery.redirected 2016-08-17 14:30:31,947 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:30:31,949 WARNING celery.redirected 2016-08-17 14:30:31,948 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:30:31,949 WARNING celery.redirected 2016-08-17 14:30:31,949 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:30:31,952 WARNING celery.redirected 2016-08-17 14:30:31,952 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:30:31,953 WARNING celery.redirected 2016-08-17 14:30:31,953 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 29, 31, 946850), 'desktop_state_2': 'DELETED'}
2016-08-17 14:30:31,955 WARNING celery.redirected 2016-08-17 14:30:31,955 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:30:31,956 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:30:31,963 INFO celery.worker.job Task schedule_clean_desktops[f42abfb8-df9f-4b2e-a261-b397ab96459a] succeeded in 0.017135354999481933s: None
2016-08-17 14:30:36,708 INFO celery.worker.strategy Received task: schedule_start_lesson[abce5767-8c88-4649-8883-04e9dbe932f5]
2016-08-17 14:30:36,709 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:30:36,710 INFO celery Scheduling start lesson tasks
2016-08-17 14:30:36,711 WARNING celery.redirected 2016-08-17 14:30:36,711 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:30:36,712 WARNING celery.redirected 2016-08-17 14:30:36,712 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:30:36,713 WARNING celery.redirected 2016-08-17 14:30:36,712 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:30:36,720 WARNING celery.redirected 2016-08-17 14:30:36,719 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:30:36,720 WARNING celery.redirected 2016-08-17 14:30:36,720 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 30, 36, 715705), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 40, 36, 715705), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:30:36,723 WARNING celery.redirected 2016-08-17 14:30:36,723 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:30:36,724 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:30:36,731 INFO celery.worker.job Task schedule_start_lesson[abce5767-8c88-4649-8883-04e9dbe932f5] succeeded in 0.02221825199922023s: None
2016-08-17 14:31:36,039 INFO celery.worker.strategy Received task: schedule_clean_desktops[fdd4051b-628b-488d-9354-db2f44710c0d]
2016-08-17 14:31:36,040 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:31:36,042 WARNING celery.redirected 2016-08-17 14:31:36,042 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:31:36,043 WARNING celery.redirected 2016-08-17 14:31:36,043 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:31:36,043 WARNING celery.redirected 2016-08-17 14:31:36,043 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:31:36,047 WARNING celery.redirected 2016-08-17 14:31:36,047 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:31:36,048 WARNING celery.redirected 2016-08-17 14:31:36,047 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 30, 36, 41480), 'desktop_state_2': 'DELETED'}
2016-08-17 14:31:36,050 WARNING celery.redirected 2016-08-17 14:31:36,050 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:31:36,051 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:31:36,057 INFO celery.worker.job Task schedule_clean_desktops[fdd4051b-628b-488d-9354-db2f44710c0d] succeeded in 0.017075114001272595s: None
2016-08-17 14:31:42,154 INFO celery.worker.strategy Received task: schedule_start_lesson[e79e1f5c-124c-4656-856a-bd15b062c60a]
2016-08-17 14:31:42,155 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:31:42,156 INFO celery Scheduling start lesson tasks
2016-08-17 14:31:42,157 WARNING celery.redirected 2016-08-17 14:31:42,157 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:31:42,158 WARNING celery.redirected 2016-08-17 14:31:42,158 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:31:42,158 WARNING celery.redirected 2016-08-17 14:31:42,158 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:31:42,162 WARNING celery.redirected 2016-08-17 14:31:42,162 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:31:42,163 WARNING celery.redirected 2016-08-17 14:31:42,163 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 31, 42, 160327), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 41, 42, 160327), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:31:42,166 WARNING celery.redirected 2016-08-17 14:31:42,166 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:31:42,167 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:31:42,175 INFO celery.worker.job Task schedule_start_lesson[e79e1f5c-124c-4656-856a-bd15b062c60a] succeeded in 0.02012250400002813s: None
2016-08-17 14:32:36,955 INFO celery.worker.strategy Received task: schedule_clean_desktops[adf44db7-10f7-4d98-bc33-d303e94294d8]
2016-08-17 14:32:36,957 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:32:36,958 WARNING celery.redirected 2016-08-17 14:32:36,958 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:32:36,959 WARNING celery.redirected 2016-08-17 14:32:36,959 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:32:36,960 WARNING celery.redirected 2016-08-17 14:32:36,959 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:32:36,963 WARNING celery.redirected 2016-08-17 14:32:36,962 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:32:36,963 WARNING celery.redirected 2016-08-17 14:32:36,963 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 31, 36, 957844), 'desktop_state_2': 'DELETED'}
2016-08-17 14:32:36,966 WARNING celery.redirected 2016-08-17 14:32:36,965 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:32:36,967 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:32:36,974 INFO celery.worker.job Task schedule_clean_desktops[adf44db7-10f7-4d98-bc33-d303e94294d8] succeeded in 0.01755851899906702s: None
2016-08-17 14:32:41,771 INFO celery.worker.strategy Received task: schedule_start_lesson[2d498673-df98-4c15-b3a2-fb2d23ec07d8]
2016-08-17 14:32:41,773 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:32:41,774 INFO celery Scheduling start lesson tasks
2016-08-17 14:32:41,775 WARNING celery.redirected 2016-08-17 14:32:41,775 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:32:41,776 WARNING celery.redirected 2016-08-17 14:32:41,776 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:32:41,777 WARNING celery.redirected 2016-08-17 14:32:41,777 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:32:41,782 WARNING celery.redirected 2016-08-17 14:32:41,782 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:32:41,783 WARNING celery.redirected 2016-08-17 14:32:41,783 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 32, 41, 778993), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 42, 41, 778993), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:32:41,785 WARNING celery.redirected 2016-08-17 14:32:41,785 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:32:41,787 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:32:41,798 INFO celery.worker.job Task schedule_start_lesson[2d498673-df98-4c15-b3a2-fb2d23ec07d8] succeeded in 0.02495020600144926s: None
2016-08-17 14:33:36,388 INFO celery.worker.strategy Received task: schedule_clean_desktops[5fdac415-f9ed-4161-894e-4b273239c210]
2016-08-17 14:33:36,390 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:33:36,391 WARNING celery.redirected 2016-08-17 14:33:36,391 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:33:36,392 WARNING celery.redirected 2016-08-17 14:33:36,392 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:33:36,393 WARNING celery.redirected 2016-08-17 14:33:36,393 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:33:36,397 WARNING celery.redirected 2016-08-17 14:33:36,397 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:33:36,398 WARNING celery.redirected 2016-08-17 14:33:36,397 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 32, 36, 390999), 'desktop_state_2': 'DELETED'}
2016-08-17 14:33:36,400 WARNING celery.redirected 2016-08-17 14:33:36,400 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:33:36,401 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:33:36,407 INFO celery.worker.job Task schedule_clean_desktops[5fdac415-f9ed-4161-894e-4b273239c210] succeeded in 0.01751581600001373s: None
2016-08-17 14:33:41,228 INFO celery.worker.strategy Received task: schedule_start_lesson[f8aeed97-5c64-42b7-a6d2-a106b8961a9e]
2016-08-17 14:33:41,229 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:33:41,230 INFO celery Scheduling start lesson tasks
2016-08-17 14:33:41,231 WARNING celery.redirected 2016-08-17 14:33:41,231 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:33:41,232 WARNING celery.redirected 2016-08-17 14:33:41,232 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:33:41,232 WARNING celery.redirected 2016-08-17 14:33:41,232 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:33:41,236 WARNING celery.redirected 2016-08-17 14:33:41,236 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:33:41,236 WARNING celery.redirected 2016-08-17 14:33:41,236 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 33, 41, 234034), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 43, 41, 234034), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:33:41,238 WARNING celery.redirected 2016-08-17 14:33:41,238 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:33:41,239 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:33:41,246 INFO celery.worker.job Task schedule_start_lesson[f8aeed97-5c64-42b7-a6d2-a106b8961a9e] succeeded in 0.016888969999854453s: None
2016-08-17 14:34:37,026 INFO celery.worker.strategy Received task: schedule_clean_desktops[bb066383-87ea-48e5-a9e3-8a84e42d8ae3]
2016-08-17 14:34:37,027 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:34:37,029 WARNING celery.redirected 2016-08-17 14:34:37,029 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:34:37,030 WARNING celery.redirected 2016-08-17 14:34:37,030 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:34:37,031 WARNING celery.redirected 2016-08-17 14:34:37,031 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:34:37,034 WARNING celery.redirected 2016-08-17 14:34:37,034 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:34:37,034 WARNING celery.redirected 2016-08-17 14:34:37,034 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 33, 37, 28582), 'desktop_state_2': 'DELETED'}
2016-08-17 14:34:37,037 WARNING celery.redirected 2016-08-17 14:34:37,037 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:34:37,039 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:34:37,046 INFO celery.worker.job Task schedule_clean_desktops[bb066383-87ea-48e5-a9e3-8a84e42d8ae3] succeeded in 0.01863214200056973s: None
2016-08-17 14:34:41,789 INFO celery.worker.strategy Received task: schedule_start_lesson[a54f00b1-ea27-4964-ae0a-e0a3dbb81067]
2016-08-17 14:34:41,790 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:34:41,790 INFO celery Scheduling start lesson tasks
2016-08-17 14:34:41,791 WARNING celery.redirected 2016-08-17 14:34:41,791 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:34:41,792 WARNING celery.redirected 2016-08-17 14:34:41,792 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:34:41,793 WARNING celery.redirected 2016-08-17 14:34:41,793 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:34:41,797 WARNING celery.redirected 2016-08-17 14:34:41,796 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:34:41,797 WARNING celery.redirected 2016-08-17 14:34:41,797 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 34, 41, 794752), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 44, 41, 794752), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:34:41,799 WARNING celery.redirected 2016-08-17 14:34:41,799 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:34:41,801 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:34:41,808 INFO celery.worker.job Task schedule_start_lesson[a54f00b1-ea27-4964-ae0a-e0a3dbb81067] succeeded in 0.01791629500075942s: None
2016-08-17 14:35:36,487 INFO celery.worker.strategy Received task: schedule_clean_desktops[f4fee754-f972-4382-a1d2-21b9d5504a35]
2016-08-17 14:35:36,491 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:35:36,493 WARNING celery.redirected 2016-08-17 14:35:36,493 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:35:36,495 WARNING celery.redirected 2016-08-17 14:35:36,495 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:35:36,496 WARNING celery.redirected 2016-08-17 14:35:36,496 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:35:36,501 WARNING celery.redirected 2016-08-17 14:35:36,501 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:35:36,502 WARNING celery.redirected 2016-08-17 14:35:36,502 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 34, 36, 492725), 'desktop_state_2': 'DELETED'}
2016-08-17 14:35:36,505 WARNING celery.redirected 2016-08-17 14:35:36,505 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:35:36,506 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:35:36,516 INFO celery.worker.job Task schedule_clean_desktops[f4fee754-f972-4382-a1d2-21b9d5504a35] succeeded in 0.024705034000362502s: None
2016-08-17 14:35:41,276 INFO celery.worker.strategy Received task: schedule_start_lesson[3452f6c3-d3da-4ae9-8544-39193d8ab5bb]
2016-08-17 14:35:41,278 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:35:41,279 INFO celery Scheduling start lesson tasks
2016-08-17 14:35:41,280 WARNING celery.redirected 2016-08-17 14:35:41,279 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:35:41,280 WARNING celery.redirected 2016-08-17 14:35:41,280 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:35:41,281 WARNING celery.redirected 2016-08-17 14:35:41,281 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:35:41,285 WARNING celery.redirected 2016-08-17 14:35:41,285 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:35:41,285 WARNING celery.redirected 2016-08-17 14:35:41,285 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 35, 41, 283082), 'end_date_2': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 45, 41, 283082), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:35:41,287 WARNING celery.redirected 2016-08-17 14:35:41,287 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:35:41,288 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:35:41,295 INFO celery.worker.job Task schedule_start_lesson[3452f6c3-d3da-4ae9-8544-39193d8ab5bb] succeeded in 0.01689829099996132s: None
2016-08-17 14:36:37,124 INFO celery.worker.strategy Received task: schedule_clean_desktops[7b383ca9-107b-49f0-9e4f-106c5065f297]
2016-08-17 14:36:37,126 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:36:37,127 WARNING celery.redirected 2016-08-17 14:36:37,127 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:36:37,129 WARNING celery.redirected 2016-08-17 14:36:37,128 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:36:37,129 WARNING celery.redirected 2016-08-17 14:36:37,129 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 14:36:37,133 WARNING celery.redirected 2016-08-17 14:36:37,133 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 14:36:37,134 WARNING celery.redirected 2016-08-17 14:36:37,134 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 14, 35, 37, 126969), 'desktop_state_2': 'DELETED'}
2016-08-17 14:36:37,137 WARNING celery.redirected 2016-08-17 14:36:37,136 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:36:37,138 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:36:37,147 INFO celery.worker.job Task schedule_clean_desktops[7b383ca9-107b-49f0-9e4f-106c5065f297] succeeded in 0.020879755000350997s: None
2016-08-17 14:36:41,930 INFO celery.worker.strategy Received task: schedule_start_lesson[52818f94-f272-442d-9e49-344767d7d517]
2016-08-17 14:36:41,931 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 14:36:41,932 INFO celery Scheduling start lesson tasks
2016-08-17 14:36:41,933 WARNING celery.redirected 2016-08-17 14:36:41,933 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 14:36:41,934 WARNING celery.redirected 2016-08-17 14:36:41,934 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 14:36:41,934 WARNING celery.redirected 2016-08-17 14:36:41,934 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 14:36:41,938 WARNING celery.redirected 2016-08-17 14:36:41,938 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 14:36:41,939 WARNING celery.redirected 2016-08-17 14:36:41,939 INFO sqlalchemy.engine.base.Engine {'end_time_1': datetime.time(14, 36, 41, 936035), 'end_date_2': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(14, 46, 41, 936035), 'start_date_1': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_2': datetime.date(2016, 8, 17)}
2016-08-17 14:36:41,943 WARNING celery.redirected 2016-08-17 14:36:41,943 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 14:36:41,945 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 14:36:41,952 INFO celery.worker.job Task schedule_start_lesson[52818f94-f272-442d-9e49-344767d7d517] succeeded in 0.02107634800086089s: None
2016-08-17 14:36:46,761 WARNING celery.redirected ***** teardown request *****
2016-08-17 14:36:46,762 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:28,792 INFO celery.worker.consumer Connected to sqla+sqlite:///celery-broker.sqlite
2016-08-17 16:59:29,672 WARNING celery.redirected celery@wenbiaodeMacBook-Pro.local ready.
2016-08-17 16:59:29,681 INFO celery.worker.strategy Received task: reboot_desktop[7a799f6d-4bbc-4b85-b0e3-1a4edd54e966] eta:[2016-08-17 08:36:18.829589+00:00]
2016-08-17 16:59:29,686 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 16:59:29,841 WARNING celery.redirected 2016-08-17 16:59:29,840 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 16:59:29,842 WARNING celery.redirected 2016-08-17 16:59:29,842 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:29,844 WARNING celery.redirected 2016-08-17 16:59:29,844 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 16:59:29,844 WARNING celery.redirected 2016-08-17 16:59:29,844 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:29,848 WARNING celery.redirected 2016-08-17 16:59:29,848 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 16:59:29,848 WARNING celery.redirected 2016-08-17 16:59:29,848 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:29,850 WARNING celery.redirected 2016-08-17 16:59:29,850 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:29,851 WARNING celery.redirected 2016-08-17 16:59:29,851 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:29,853 WARNING celery.redirected 2016-08-17 16:59:29,853 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:29,854 WARNING celery.redirected 2016-08-17 16:59:29,854 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:29,855 WARNING celery.redirected 2016-08-17 16:59:29,855 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 16:59:29,856 WARNING celery.redirected 2016-08-17 16:59:29,856 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:29,858 WARNING celery.redirected 2016-08-17 16:59:29,857 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:29,863 WARNING celery.redirected 2016-08-17 16:59:29,863 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:29,864 WARNING celery.redirected 2016-08-17 16:59:29,863 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 16:59:29,869 WARNING celery.redirected 2016-08-17 16:59:29,868 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:29,869 WARNING celery.redirected 2016-08-17 16:59:29,869 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:29,871 INFO celery Reboot desktop for <DesktopTask 11>
2016-08-17 16:59:29,878 WARNING celery.redirected 2016-08-17 16:59:29,878 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:29,879 WARNING celery.redirected 2016-08-17 16:59:29,879 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 16:59:29,883 WARNING celery.redirected 2016-08-17 16:59:29,883 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:29,886 WARNING celery.redirected 2016-08-17 16:59:29,885 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:29,891 WARNING celery.redirected 2016-08-17 16:59:29,891 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:29,892 WARNING celery.redirected 2016-08-17 16:59:29,892 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:29,894 WARNING celery.redirected 2016-08-17 16:59:29,894 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:29,895 WARNING celery.redirected 2016-08-17 16:59:29,895 INFO sqlalchemy.engine.base.Engine {'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 29, 894233), 'state': 'RUNNING', 'desktop_tasks_id': 11}
2016-08-17 16:59:29,896 WARNING celery.redirected 2016-08-17 16:59:29,896 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:29,901 WARNING celery.redirected 2016-08-17 16:59:29,900 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:29,903 WARNING celery.redirected 2016-08-17 16:59:29,903 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(param_1)s
2016-08-17 16:59:29,903 WARNING celery.redirected 2016-08-17 16:59:29,903 INFO sqlalchemy.engine.base.Engine {'param_1': 4}
2016-08-17 16:59:30,231 WARNING celery.redirected 2016-08-17 16:59:30,231 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:30,232 WARNING celery.redirected 2016-08-17 16:59:30,231 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:30,235 WARNING celery.redirected 2016-08-17 16:59:30,235 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:30,235 WARNING celery.redirected 2016-08-17 16:59:30,235 INFO sqlalchemy.engine.base.Engine {'context': '{"desktop": 4, "detect_timeout": 30, "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "wait_timeout": 600, "course_name": null, "serial": null, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "floating_ip": "172.18.231.157", "wait_state": "ACTIVE", "detect_method": "PING"}', 'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 30, 234938), 'desktop_tasks_id': 11}
2016-08-17 16:59:30,239 WARNING celery.redirected 2016-08-17 16:59:30,238 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 16:59:30,239 WARNING celery.redirected 2016-08-17 16:59:30,239 INFO sqlalchemy.engine.base.Engine {'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 30, 238533), 'stage': 'REBOOT', 'task_id': 11, 'context': '{"desktop": 4, "detect_timeout": 30, "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "wait_timeout": 600, "course_name": null, "serial": null, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "floating_ip": "172.18.231.157", "wait_state": "ACTIVE", "detect_method": "PING"}', 'success': 1, 'detail': '', 'created_at': datetime.datetime(2016, 8, 17, 16, 59, 30, 238441)}
2016-08-17 16:59:30,241 WARNING celery.redirected 2016-08-17 16:59:30,241 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:30,243 WARNING celery.redirected 2016-08-17 16:59:30,243 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:30,244 WARNING celery.redirected 2016-08-17 16:59:30,244 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:30,245 WARNING celery.redirected 2016-08-17 16:59:30,244 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:30,247 WARNING celery.redirected 2016-08-17 16:59:30,247 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:30,248 WARNING celery.redirected 2016-08-17 16:59:30,247 INFO sqlalchemy.engine.base.Engine {'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 30, 247295), 'stage': 'WAIT', 'desktop_tasks_id': 11}
2016-08-17 16:59:30,249 WARNING celery.redirected 2016-08-17 16:59:30,249 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:30,251 WARNING celery.redirected 2016-08-17 16:59:30,251 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:30,252 WARNING celery.redirected 2016-08-17 16:59:30,252 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:30,253 WARNING celery.redirected 2016-08-17 16:59:30,252 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:30,254 INFO celery Reboot desktop for <DesktopTask 11>, success
2016-08-17 16:59:30,255 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:30,255 WARNING celery.redirected 2016-08-17 16:59:30,255 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:30,371 INFO celery.worker.job Task reboot_desktop[7a799f6d-4bbc-4b85-b0e3-1a4edd54e966] succeeded in 0.6859618099988438s: None
2016-08-17 16:59:30,972 INFO celery.worker.strategy Received task: wait_desktop[db538979-0854-40af-9b75-54ce7de3811e] eta:[2016-08-17 08:59:33.263385+00:00]
2016-08-17 16:59:32,307 INFO celery.beat beat: Starting...
2016-08-17 16:59:32,375 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 16:59:32,376 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 16:59:32,379 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 16:59:32,379 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 16:59:32,410 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 16:59:32,561 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 16:59:33,271 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 16:59:33,361 INFO celery.worker.strategy Received task: schedule_start_lesson[3f31d8cc-4b0b-4319-949f-dea7c7ba89d3]
2016-08-17 16:59:33,364 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 16:59:33,371 WARNING celery.redirected 2016-08-17 16:59:33,370 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 16:59:33,373 WARNING celery.redirected 2016-08-17 16:59:33,372 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,375 WARNING celery.redirected 2016-08-17 16:59:33,375 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 16:59:33,376 WARNING celery.redirected 2016-08-17 16:59:33,376 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,378 WARNING celery.redirected 2016-08-17 16:59:33,378 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 16:59:33,379 WARNING celery.redirected 2016-08-17 16:59:33,378 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,381 WARNING celery.redirected 2016-08-17 16:59:33,381 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:33,382 WARNING celery.redirected 2016-08-17 16:59:33,381 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,383 WARNING celery.redirected 2016-08-17 16:59:33,383 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:33,383 WARNING celery.redirected 2016-08-17 16:59:33,383 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,385 WARNING celery.redirected 2016-08-17 16:59:33,385 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 16:59:33,386 WARNING celery.redirected 2016-08-17 16:59:33,385 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,388 WARNING celery.redirected 2016-08-17 16:59:33,388 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:33,390 WARNING celery.redirected 2016-08-17 16:59:33,390 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:33,391 WARNING celery.redirected 2016-08-17 16:59:33,391 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 16:59:33,395 WARNING celery.redirected 2016-08-17 16:59:33,395 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:33,396 WARNING celery.redirected 2016-08-17 16:59:33,396 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:33,397 INFO celery Wait state for <DesktopTask 11>
2016-08-17 16:59:33,400 WARNING celery.redirected 2016-08-17 16:59:33,400 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:33,401 WARNING celery.redirected 2016-08-17 16:59:33,401 INFO sqlalchemy.engine.base.Engine {'context': '{"desktop": 4, "detect_timeout": 30, "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "wait_timeout": 600, "course_name": null, "serial": null, "floating_ip": "172.18.231.157", "wait_started_at": "2016-08-17T16:59:33.398146", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "wait_state": "ACTIVE", "detect_method": "PING"}', 'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 33, 400431), 'desktop_tasks_id': 11}
2016-08-17 16:59:33,402 INFO celery Scheduling start lesson tasks
2016-08-17 16:59:33,404 WARNING celery.redirected 2016-08-17 16:59:33,403 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:33,407 WARNING celery.redirected 2016-08-17 16:59:33,406 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:33,408 WARNING celery.redirected 2016-08-17 16:59:33,408 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:33,409 WARNING celery.redirected 2016-08-17 16:59:33,409 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:33,458 INFO celery.worker.strategy Received task: schedule_clean_desktops[dc0b929f-4ad1-44cd-9ccc-39ba7ec486ff]
2016-08-17 16:59:33,460 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 16:59:33,511 WARNING celery.redirected 2016-08-17 16:59:33,510 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 16:59:33,512 WARNING celery.redirected 2016-08-17 16:59:33,512 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,515 WARNING celery.redirected 2016-08-17 16:59:33,515 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 16:59:33,516 WARNING celery.redirected 2016-08-17 16:59:33,516 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,519 WARNING celery.redirected 2016-08-17 16:59:33,518 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 16:59:33,519 WARNING celery.redirected 2016-08-17 16:59:33,519 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,523 WARNING celery.redirected 2016-08-17 16:59:33,523 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:33,524 WARNING celery.redirected 2016-08-17 16:59:33,524 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,526 WARNING celery.redirected 2016-08-17 16:59:33,526 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:33,527 WARNING celery.redirected 2016-08-17 16:59:33,526 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,529 WARNING celery.redirected 2016-08-17 16:59:33,528 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 16:59:33,529 WARNING celery.redirected 2016-08-17 16:59:33,529 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,531 WARNING celery.redirected 2016-08-17 16:59:33,531 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:33,533 WARNING celery.redirected 2016-08-17 16:59:33,533 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:33,534 WARNING celery.redirected 2016-08-17 16:59:33,534 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 16:59:33,542 WARNING celery.redirected 2016-08-17 16:59:33,542 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 16:59:33,543 WARNING celery.redirected 2016-08-17 16:59:33,543 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(16, 59, 33, 536695), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 9, 33, 536695)}
2016-08-17 16:59:33,546 WARNING celery.redirected 2016-08-17 16:59:33,546 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:33,547 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:33,577 INFO celery.worker.job Task schedule_start_lesson[3f31d8cc-4b0b-4319-949f-dea7c7ba89d3] succeeded in 0.2141645140000037s: None
2016-08-17 16:59:33,612 WARNING celery.redirected 2016-08-17 16:59:33,612 INFO sqlalchemy.engine.base.Engine SHOW VARIABLES LIKE 'sql_mode'
2016-08-17 16:59:33,613 WARNING celery.redirected 2016-08-17 16:59:33,613 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,615 WARNING celery.redirected 2016-08-17 16:59:33,615 INFO sqlalchemy.engine.base.Engine SELECT DATABASE()
2016-08-17 16:59:33,615 WARNING celery.redirected 2016-08-17 16:59:33,615 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,617 WARNING celery.redirected 2016-08-17 16:59:33,616 INFO sqlalchemy.engine.base.Engine show collation where `Charset` = 'utf8' and `Collation` = 'utf8_bin'
2016-08-17 16:59:33,617 WARNING celery.redirected 2016-08-17 16:59:33,617 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,619 WARNING celery.redirected 2016-08-17 16:59:33,619 INFO sqlalchemy.engine.base.Engine SELECT CAST('test plain returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:33,620 WARNING celery.redirected 2016-08-17 16:59:33,620 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,621 WARNING celery.redirected 2016-08-17 16:59:33,621 INFO sqlalchemy.engine.base.Engine SELECT CAST('test unicode returns' AS CHAR(60)) AS anon_1
2016-08-17 16:59:33,622 WARNING celery.redirected 2016-08-17 16:59:33,622 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,624 WARNING celery.redirected 2016-08-17 16:59:33,624 INFO sqlalchemy.engine.base.Engine SELECT CAST('test collated returns' AS CHAR CHARACTER SET utf8) COLLATE utf8_bin AS anon_1
2016-08-17 16:59:33,624 WARNING celery.redirected 2016-08-17 16:59:33,624 INFO sqlalchemy.engine.base.Engine {}
2016-08-17 16:59:33,626 WARNING celery.redirected 2016-08-17 16:59:33,626 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:33,628 WARNING celery.redirected 2016-08-17 16:59:33,628 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:33,628 WARNING celery.redirected 2016-08-17 16:59:33,628 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 16:59:33,633 WARNING celery.redirected 2016-08-17 16:59:33,633 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 16:59:33,634 WARNING celery.redirected 2016-08-17 16:59:33,633 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 16, 58, 33, 499443)}
2016-08-17 16:59:33,636 WARNING celery.redirected 2016-08-17 16:59:33,636 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:33,637 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:33,653 INFO celery.worker.job Task schedule_clean_desktops[dc0b929f-4ad1-44cd-9ccc-39ba7ec486ff] succeeded in 0.19383944899891503s: None
2016-08-17 16:59:33,669 WARNING celery.redirected 2016-08-17 16:59:33,669 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:33,670 WARNING celery.redirected 2016-08-17 16:59:33,670 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 16:59:33,674 WARNING celery.redirected 2016-08-17 16:59:33,674 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:33,676 WARNING celery.redirected 2016-08-17 16:59:33,676 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:33,677 WARNING celery.redirected 2016-08-17 16:59:33,677 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:33,678 WARNING celery.redirected 2016-08-17 16:59:33,677 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:33,679 INFO celery Wait state for <DesktopTask 11>, stage success
2016-08-17 16:59:33,681 WARNING celery.redirected 2016-08-17 16:59:33,681 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 16:59:33,682 WARNING celery.redirected 2016-08-17 16:59:33,682 INFO sqlalchemy.engine.base.Engine {'detail': '', 'stage': 'WAIT', 'task_id': 11, 'context': '{"desktop": 4, "detect_timeout": 30, "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "wait_timeout": 600, "course_name": null, "serial": null, "floating_ip": "172.18.231.157", "wait_started_at": "2016-08-17T16:59:33.398146", "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "wait_state": "ACTIVE", "detect_method": "PING"}', 'success': 1, 'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 33, 681390), 'created_at': datetime.datetime(2016, 8, 17, 16, 59, 33, 681328)}
2016-08-17 16:59:33,683 WARNING celery.redirected 2016-08-17 16:59:33,683 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:33,685 WARNING celery.redirected 2016-08-17 16:59:33,685 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:33,686 WARNING celery.redirected 2016-08-17 16:59:33,686 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:33,687 WARNING celery.redirected 2016-08-17 16:59:33,687 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:33,690 WARNING celery.redirected 2016-08-17 16:59:33,690 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, stage=%(stage)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:33,690 WARNING celery.redirected 2016-08-17 16:59:33,690 INFO sqlalchemy.engine.base.Engine {'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 33, 689801), 'stage': 'DETECT', 'desktop_tasks_id': 11}
2016-08-17 16:59:33,692 WARNING celery.redirected 2016-08-17 16:59:33,692 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:33,694 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:33,815 INFO celery.worker.job Task wait_desktop[db538979-0854-40af-9b75-54ce7de3811e] succeeded in 0.545631739001692s: None
2016-08-17 16:59:34,747 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 08:59:36.705355+00:00]
2016-08-17 16:59:36,710 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 16:59:36,712 WARNING celery.redirected 2016-08-17 16:59:36,712 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:36,713 WARNING celery.redirected 2016-08-17 16:59:36,713 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:36,714 WARNING celery.redirected 2016-08-17 16:59:36,714 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 16:59:36,717 WARNING celery.redirected 2016-08-17 16:59:36,717 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:36,718 WARNING celery.redirected 2016-08-17 16:59:36,718 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:36,721 INFO celery Detect for <DesktopTask 11>
2016-08-17 16:59:36,723 WARNING celery.redirected 2016-08-17 16:59:36,723 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, context=%(context)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:36,724 WARNING celery.redirected 2016-08-17 16:59:36,723 INFO sqlalchemy.engine.base.Engine {'context': '{"detect_timeout": 30, "detect_started_at": "2016-08-17T16:59:36.722208", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "wait_started_at": "2016-08-17T16:59:33.398146", "wait_timeout": 600, "course_name": null, "serial": null, "floating_ip": "172.18.231.157", "wait_state": "ACTIVE", "detect_method": "PING"}', 'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 36, 723042), 'desktop_tasks_id': 11}
2016-08-17 16:59:36,727 WARNING celery.redirected 2016-08-17 16:59:36,727 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:36,730 WARNING celery.redirected 2016-08-17 16:59:36,730 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:36,731 WARNING celery.redirected 2016-08-17 16:59:36,731 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:36,732 WARNING celery.redirected 2016-08-17 16:59:36,732 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:37,748 ERROR celery Detect(ping) for <DesktopTask 11>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 16:59:37,765 WARNING celery.redirected 2016-08-17 16:59:37,765 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:37,765 WARNING celery.redirected 2016-08-17 16:59:37,765 INFO sqlalchemy.engine.base.Engine {'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 37, 764850), 'desktop_tasks_id': 11}
2016-08-17 16:59:37,767 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:37,767 WARNING celery.redirected 2016-08-17 16:59:37,767 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 16:59:37,779 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 16:59:38,444 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 08:59:57.756650+00:00]
2016-08-17 16:59:57,760 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 16:59:57,768 WARNING celery.redirected 2016-08-17 16:59:57,767 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:57,769 WARNING celery.redirected 2016-08-17 16:59:57,769 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 16:59:57,771 WARNING celery.redirected 2016-08-17 16:59:57,770 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 16:59:57,777 WARNING celery.redirected 2016-08-17 16:59:57,777 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:57,778 WARNING celery.redirected 2016-08-17 16:59:57,778 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:57,781 INFO celery Detect for <DesktopTask 11>
2016-08-17 16:59:57,786 WARNING celery.redirected 2016-08-17 16:59:57,785 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 16:59:57,789 WARNING celery.redirected 2016-08-17 16:59:57,789 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 16:59:57,790 WARNING celery.redirected 2016-08-17 16:59:57,790 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 16:59:57,791 WARNING celery.redirected 2016-08-17 16:59:57,790 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 16:59:58,802 ERROR celery Detect(ping) for <DesktopTask 11>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 16:59:58,905 WARNING celery.redirected 2016-08-17 16:59:58,904 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 16:59:58,905 WARNING celery.redirected 2016-08-17 16:59:58,905 INFO sqlalchemy.engine.base.Engine {'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 16, 59, 58, 904638), 'desktop_tasks_id': 11}
2016-08-17 16:59:58,907 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 16:59:58,907 WARNING celery.redirected 2016-08-17 16:59:58,907 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 16:59:58,917 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 16:59:59,728 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 09:00:18.814968+00:00]
2016-08-17 17:00:02,565 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:00:02,566 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:00:02,568 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:00:02,568 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:00:02,576 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:00:02,577 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:00:02,577 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:00:02,577 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:00:18,816 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:00:18,819 WARNING celery.redirected 2016-08-17 17:00:18,819 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:00:18,821 WARNING celery.redirected 2016-08-17 17:00:18,821 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:00:18,822 WARNING celery.redirected 2016-08-17 17:00:18,822 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:00:18,826 WARNING celery.redirected 2016-08-17 17:00:18,826 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:00:18,826 WARNING celery.redirected 2016-08-17 17:00:18,826 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:00:18,828 INFO celery Detect for <DesktopTask 11>
2016-08-17 17:00:18,829 WARNING celery.redirected 2016-08-17 17:00:18,829 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:00:18,830 WARNING celery.redirected 2016-08-17 17:00:18,830 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:00:18,831 WARNING celery.redirected 2016-08-17 17:00:18,831 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:00:18,832 WARNING celery.redirected 2016-08-17 17:00:18,832 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:00:19,842 ERROR celery Detect(ping) for <DesktopTask 11>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 17:00:19,941 WARNING celery.redirected 2016-08-17 17:00:19,941 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 17:00:19,942 WARNING celery.redirected 2016-08-17 17:00:19,942 INFO sqlalchemy.engine.base.Engine {'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 17, 0, 19, 941389), 'desktop_tasks_id': 11}
2016-08-17 17:00:19,943 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:00:19,944 WARNING celery.redirected 2016-08-17 17:00:19,944 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 17:00:19,953 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 17:00:20,736 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 09:00:39.855256+00:00]
2016-08-17 17:00:32,564 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:00:32,582 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:00:32,582 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:00:32,585 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:00:32,585 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:00:32,590 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:00:32,591 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:00:32,591 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:00:32,591 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:00:32,804 INFO celery.worker.strategy Received task: schedule_start_lesson[9f5ecb9c-33d4-4ffd-85ce-b49804f9ac58]
2016-08-17 17:00:32,806 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:00:32,806 INFO celery Scheduling start lesson tasks
2016-08-17 17:00:32,809 WARNING celery.redirected 2016-08-17 17:00:32,809 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:00:32,810 WARNING celery.redirected 2016-08-17 17:00:32,810 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:00:32,811 WARNING celery.redirected 2016-08-17 17:00:32,811 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:00:32,816 WARNING celery.redirected 2016-08-17 17:00:32,816 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:00:32,817 WARNING celery.redirected 2016-08-17 17:00:32,816 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 0, 32, 813228), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 10, 32, 813228)}
2016-08-17 17:00:32,820 WARNING celery.redirected 2016-08-17 17:00:32,820 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:00:32,821 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:00:32,830 INFO celery.worker.job Task schedule_start_lesson[9f5ecb9c-33d4-4ffd-85ce-b49804f9ac58] succeeded in 0.02449216199966031s: None
2016-08-17 17:00:37,589 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:00:38,879 INFO celery.worker.strategy Received task: schedule_clean_desktops[8c2ff093-9f7e-4619-a23d-5302d02c697c]
2016-08-17 17:00:38,881 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:00:38,883 WARNING celery.redirected 2016-08-17 17:00:38,883 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:00:38,884 WARNING celery.redirected 2016-08-17 17:00:38,884 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:00:38,885 WARNING celery.redirected 2016-08-17 17:00:38,884 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:00:38,889 WARNING celery.redirected 2016-08-17 17:00:38,889 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:00:38,890 WARNING celery.redirected 2016-08-17 17:00:38,890 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 16, 59, 38, 882061), 'desktop_state_2': 'DELETED'}
2016-08-17 17:00:38,892 WARNING celery.redirected 2016-08-17 17:00:38,892 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:00:38,893 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:00:38,900 INFO celery.worker.job Task schedule_clean_desktops[8c2ff093-9f7e-4619-a23d-5302d02c697c] succeeded in 0.01987242600080208s: None
2016-08-17 17:00:39,861 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:00:39,863 WARNING celery.redirected 2016-08-17 17:00:39,863 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:00:39,864 WARNING celery.redirected 2016-08-17 17:00:39,864 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:00:39,865 WARNING celery.redirected 2016-08-17 17:00:39,865 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:00:39,868 WARNING celery.redirected 2016-08-17 17:00:39,868 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:00:39,868 WARNING celery.redirected 2016-08-17 17:00:39,868 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:00:39,870 INFO celery Detect for <DesktopTask 11>
2016-08-17 17:00:39,871 WARNING celery.redirected 2016-08-17 17:00:39,870 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:00:39,872 WARNING celery.redirected 2016-08-17 17:00:39,872 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:00:39,873 WARNING celery.redirected 2016-08-17 17:00:39,873 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:00:39,874 WARNING celery.redirected 2016-08-17 17:00:39,874 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:00:40,880 ERROR celery Detect(ping) for <DesktopTask 11>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 17:00:40,892 WARNING celery.redirected 2016-08-17 17:00:40,892 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 17:00:40,892 WARNING celery.redirected 2016-08-17 17:00:40,892 INFO sqlalchemy.engine.base.Engine {'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 17, 0, 40, 891957), 'desktop_tasks_id': 11}
2016-08-17 17:00:40,894 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:00:40,894 WARNING celery.redirected 2016-08-17 17:00:40,894 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 17:00:40,904 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 17:00:41,243 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 09:01:00.883831+00:00]
2016-08-17 17:01:00,889 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:00,891 WARNING celery.redirected 2016-08-17 17:01:00,890 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:00,892 WARNING celery.redirected 2016-08-17 17:01:00,892 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:00,892 WARNING celery.redirected 2016-08-17 17:01:00,892 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:01:00,896 WARNING celery.redirected 2016-08-17 17:01:00,896 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:00,897 WARNING celery.redirected 2016-08-17 17:01:00,897 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:00,900 INFO celery Detect for <DesktopTask 11>
2016-08-17 17:01:00,901 WARNING celery.redirected 2016-08-17 17:01:00,901 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:00,905 WARNING celery.redirected 2016-08-17 17:01:00,904 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:00,906 WARNING celery.redirected 2016-08-17 17:01:00,906 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:00,907 WARNING celery.redirected 2016-08-17 17:01:00,907 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:01,915 ERROR celery Detect(ping) for <DesktopTask 11>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 17:01:01,928 WARNING celery.redirected 2016-08-17 17:01:01,927 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 17:01:01,929 WARNING celery.redirected 2016-08-17 17:01:01,929 INFO sqlalchemy.engine.base.Engine {'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 17, 1, 1, 927713), 'desktop_tasks_id': 11}
2016-08-17 17:01:01,931 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:01,932 WARNING celery.redirected 2016-08-17 17:01:01,931 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 17:01:01,947 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 17:01:02,068 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 09:01:21.917659+00:00]
2016-08-17 17:01:02,799 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:01:02,800 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:01:02,802 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:01:02,802 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:01:02,809 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:01:02,810 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:01:02,812 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:01:02,813 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:01:21,923 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:21,925 WARNING celery.redirected 2016-08-17 17:01:21,925 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:21,926 WARNING celery.redirected 2016-08-17 17:01:21,926 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:21,927 WARNING celery.redirected 2016-08-17 17:01:21,927 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:01:21,930 WARNING celery.redirected 2016-08-17 17:01:21,929 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:21,931 WARNING celery.redirected 2016-08-17 17:01:21,930 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:21,933 INFO celery Detect for <DesktopTask 11>
2016-08-17 17:01:21,934 WARNING celery.redirected 2016-08-17 17:01:21,934 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:21,935 WARNING celery.redirected 2016-08-17 17:01:21,935 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:21,936 WARNING celery.redirected 2016-08-17 17:01:21,936 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:21,937 WARNING celery.redirected 2016-08-17 17:01:21,937 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:22,948 ERROR celery Detect(ping) for <DesktopTask 11>, fail
Traceback (most recent call last):
  File "/Users/zwb/Documents/git/phoenix/src/web/app/celery_tasks.py", line 1348, in detect_floating
    result = ping(floating_ip)
  File "/Users/zwb/Documents/git/phoenix/src/web/../phoenix/common/ping.py", line 29, in ping
    return p.wait(timeout=timeout) == 0
  File "/Library/Frameworks/Python.framework/Versions/3.4/lib/python3.4/subprocess.py", line 1558, in wait
    raise TimeoutExpired(self.args, timeout)
subprocess.TimeoutExpired: Command '['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157']' timed out after 1 seconds
2016-08-17 17:01:22,965 WARNING celery.redirected 2016-08-17 17:01:22,965 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, retries=%(retries)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 17:01:22,965 WARNING celery.redirected 2016-08-17 17:01:22,965 INFO sqlalchemy.engine.base.Engine {'retries': 1, 'updated_at': datetime.datetime(2016, 8, 17, 17, 1, 22, 964859), 'desktop_tasks_id': 11}
2016-08-17 17:01:22,967 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:22,967 WARNING celery.redirected 2016-08-17 17:01:22,967 INFO sqlalchemy.engine.base.Engine ROLLBACK
2016-08-17 17:01:22,979 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] retry: Retry in 20s: TimeoutExpired(['ping', '-c', '1', '-s', '32', '-t', '1', '172.18.231.157'], 1)
2016-08-17 17:01:23,795 INFO celery.worker.strategy Received task: detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] eta:[2016-08-17 09:01:42.956862+00:00]
2016-08-17 17:01:37,802 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:01:37,802 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:01:37,802 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:01:37,803 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:01:37,805 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:01:37,916 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:01:37,916 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:01:37,918 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:01:37,919 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:01:37,923 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:01:37,923 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:01:37,924 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:01:37,924 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:01:38,972 INFO celery.worker.strategy Received task: schedule_start_lesson[e7080319-1031-4a1c-ac79-a2d10e91db56]
2016-08-17 17:01:38,975 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:38,976 INFO celery Scheduling start lesson tasks
2016-08-17 17:01:38,977 WARNING celery.redirected 2016-08-17 17:01:38,977 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:38,978 WARNING celery.redirected 2016-08-17 17:01:38,978 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:38,979 WARNING celery.redirected 2016-08-17 17:01:38,979 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:01:38,987 WARNING celery.redirected 2016-08-17 17:01:38,987 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:01:38,988 WARNING celery.redirected 2016-08-17 17:01:38,987 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 1, 38, 981629), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 11, 38, 981629)}
2016-08-17 17:01:38,990 WARNING celery.redirected 2016-08-17 17:01:38,990 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:38,992 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:39,002 INFO celery.worker.job Task schedule_start_lesson[e7080319-1031-4a1c-ac79-a2d10e91db56] succeeded in 0.027200022999750217s: None
2016-08-17 17:01:42,923 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:01:42,961 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:42,963 WARNING celery.redirected 2016-08-17 17:01:42,963 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:42,964 WARNING celery.redirected 2016-08-17 17:01:42,964 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:42,964 WARNING celery.redirected 2016-08-17 17:01:42,964 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:01:42,967 WARNING celery.redirected 2016-08-17 17:01:42,967 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:42,968 WARNING celery.redirected 2016-08-17 17:01:42,968 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:42,969 INFO celery Detect for <DesktopTask 11>
2016-08-17 17:01:42,970 WARNING celery.redirected 2016-08-17 17:01:42,970 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:42,971 WARNING celery.redirected 2016-08-17 17:01:42,971 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:42,972 WARNING celery.redirected 2016-08-17 17:01:42,972 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:42,973 WARNING celery.redirected 2016-08-17 17:01:42,973 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:42,981 INFO celery Detect for <DesktopTask 11>, success
2016-08-17 17:01:42,985 WARNING celery.redirected 2016-08-17 17:01:42,985 INFO sqlalchemy.engine.base.Engine INSERT INTO stage_results (created_at, updated_at, task_id, stage, success, detail, context) VALUES (%(created_at)s, %(updated_at)s, %(task_id)s, %(stage)s, %(success)s, %(detail)s, %(context)s)
2016-08-17 17:01:42,986 WARNING celery.redirected 2016-08-17 17:01:42,985 INFO sqlalchemy.engine.base.Engine {'detail': '', 'stage': 'DETECT', 'task_id': 11, 'context': '{"detect_timeout": 30, "detect_started_at": "2016-08-17T16:59:36.722208", "desktop_state_map": {"ERROR": "ERROR", "SUCCESS": "ACTIVE"}, "vm": "bbe05795-86c1-4af3-8704-f8c9aacf3be6", "desktop": 4, "wait_started_at": "2016-08-17T16:59:33.398146", "wait_timeout": 600, "course_name": null, "serial": null, "floating_ip": "172.18.231.157", "wait_state": "ACTIVE", "detect_method": "PING"}', 'success': 1, 'updated_at': datetime.datetime(2016, 8, 17, 17, 1, 42, 985053), 'created_at': datetime.datetime(2016, 8, 17, 17, 1, 42, 984990)}
2016-08-17 17:01:42,987 WARNING celery.redirected 2016-08-17 17:01:42,987 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:42,989 WARNING celery.redirected 2016-08-17 17:01:42,989 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:42,990 WARNING celery.redirected 2016-08-17 17:01:42,990 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:42,991 WARNING celery.redirected 2016-08-17 17:01:42,991 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:42,994 WARNING celery.redirected 2016-08-17 17:01:42,994 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 17:01:42,995 WARNING celery.redirected 2016-08-17 17:01:42,994 INFO sqlalchemy.engine.base.Engine {'state': 'FINISHED', 'result': 'SUCCESS', 'updated_at': datetime.datetime(2016, 8, 17, 17, 1, 42, 994080), 'desktop_tasks_id': 11}
2016-08-17 17:01:42,996 WARNING celery.redirected 2016-08-17 17:01:42,996 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:42,998 WARNING celery.redirected 2016-08-17 17:01:42,998 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:42,999 WARNING celery.redirected 2016-08-17 17:01:42,999 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:42,999 WARNING celery.redirected 2016-08-17 17:01:42,999 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:43,005 WARNING celery.redirected 2016-08-17 17:01:43,005 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:43,006 WARNING celery.redirected 2016-08-17 17:01:43,006 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 17:01:43,009 WARNING celery.redirected 2016-08-17 17:01:43,009 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 17:01:43,010 WARNING celery.redirected 2016-08-17 17:01:43,009 INFO sqlalchemy.engine.base.Engine {'updated_at': datetime.datetime(2016, 8, 17, 17, 1, 43, 9321), 'desktops_id': 4, 'desktop_state': 'ACTIVE'}
2016-08-17 17:01:43,011 WARNING celery.redirected 2016-08-17 17:01:43,011 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:43,012 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:43,024 INFO celery.worker.job Task detect_floating[fb2dd38c-71f4-4cb8-b2a8-e3b3fac45907] succeeded in 0.06290341999920201s: None
2016-08-17 17:01:43,818 INFO celery.worker.strategy Received task: schedule_clean_desktops[b524f30a-92c8-48a3-9a3e-a29fb1d6ade6]
2016-08-17 17:01:43,820 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:43,822 WARNING celery.redirected 2016-08-17 17:01:43,822 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:43,823 WARNING celery.redirected 2016-08-17 17:01:43,823 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:43,824 WARNING celery.redirected 2016-08-17 17:01:43,824 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:01:43,828 WARNING celery.redirected 2016-08-17 17:01:43,828 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:01:43,829 WARNING celery.redirected 2016-08-17 17:01:43,828 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 0, 43, 821274)}
2016-08-17 17:01:43,833 WARNING celery.redirected 2016-08-17 17:01:43,833 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:43,835 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:43,842 INFO celery.worker.job Task schedule_clean_desktops[b524f30a-92c8-48a3-9a3e-a29fb1d6ade6] succeeded in 0.02243928299867548s: None
2016-08-17 17:01:43,901 INFO celery.worker.strategy Received task: set_desktop_state[b70ffc01-ccc6-4f79-96e0-16a3fee883f8]
2016-08-17 17:01:43,903 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:43,904 WARNING celery.redirected 2016-08-17 17:01:43,904 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:43,905 WARNING celery.redirected 2016-08-17 17:01:43,905 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:43,906 WARNING celery.redirected 2016-08-17 17:01:43,906 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:01:43,910 WARNING celery.redirected 2016-08-17 17:01:43,909 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 17:01:43,911 WARNING celery.redirected 2016-08-17 17:01:43,910 INFO sqlalchemy.engine.base.Engine {'param_1': 11}
2016-08-17 17:01:43,932 WARNING celery.redirected 2016-08-17 17:01:43,931 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:43,933 WARNING celery.redirected 2016-08-17 17:01:43,932 INFO sqlalchemy.engine.base.Engine {'id_1': 4, 'param_1': 1}
2016-08-17 17:01:43,938 WARNING celery.redirected 2016-08-17 17:01:43,938 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:43,940 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:44,161 INFO celery.worker.job Task set_desktop_state[b70ffc01-ccc6-4f79-96e0-16a3fee883f8] succeeded in 0.2589527569980419s: None
2016-08-17 17:01:45,242 INFO celery.worker.strategy Received task: _create_desktop_detect[a8bc7cfa-6fac-4a1a-9c3a-6e710269be45]
2016-08-17 17:01:45,248 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:01:45,250 WARNING celery.redirected 2016-08-17 17:01:45,250 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:01:45,252 WARNING celery.redirected 2016-08-17 17:01:45,252 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 17:01:45,253 WARNING celery.redirected 2016-08-17 17:01:45,253 INFO sqlalchemy.engine.base.Engine {'id_1': 11, 'param_1': 1}
2016-08-17 17:01:45,255 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:01:45,256 WARNING celery.redirected 2016-08-17 17:01:45,256 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:01:45,267 INFO celery.worker.job Task _create_desktop_detect[a8bc7cfa-6fac-4a1a-9c3a-6e710269be45] succeeded in 0.01914651599872741s: None
2016-08-17 17:02:07,941 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:02:07,941 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:02:07,945 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:02:07,945 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:02:07,950 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:02:07,951 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:02:07,951 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:02:07,951 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:02:42,936 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:02:42,936 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:02:42,936 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:02:42,936 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:02:42,939 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:02:42,963 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:02:42,964 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:02:42,967 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:02:42,967 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:02:42,971 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:02:42,971 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:02:42,971 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:02:42,971 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:02:43,882 INFO celery.worker.strategy Received task: schedule_start_lesson[b904b03d-c977-4636-a0c7-f739b37156b6]
2016-08-17 17:02:43,884 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:02:43,884 INFO celery Scheduling start lesson tasks
2016-08-17 17:02:43,886 WARNING celery.redirected 2016-08-17 17:02:43,885 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:02:43,887 WARNING celery.redirected 2016-08-17 17:02:43,886 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:02:43,887 WARNING celery.redirected 2016-08-17 17:02:43,887 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:02:43,891 WARNING celery.redirected 2016-08-17 17:02:43,891 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:02:43,892 WARNING celery.redirected 2016-08-17 17:02:43,892 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 2, 43, 889111), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 12, 43, 889111)}
2016-08-17 17:02:43,894 WARNING celery.redirected 2016-08-17 17:02:43,894 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:02:43,895 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:02:43,903 INFO celery.worker.job Task schedule_start_lesson[b904b03d-c977-4636-a0c7-f739b37156b6] succeeded in 0.019174873999872943s: None
2016-08-17 17:02:47,971 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:02:48,887 INFO celery.worker.strategy Received task: schedule_clean_desktops[2becfa29-5f91-48ef-a75b-7df0f7492580]
2016-08-17 17:02:48,889 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:02:48,892 WARNING celery.redirected 2016-08-17 17:02:48,891 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:02:48,899 WARNING celery.redirected 2016-08-17 17:02:48,898 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:02:48,899 WARNING celery.redirected 2016-08-17 17:02:48,899 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:02:48,904 WARNING celery.redirected 2016-08-17 17:02:48,904 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:02:48,905 WARNING celery.redirected 2016-08-17 17:02:48,905 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 1, 48, 890297), 'desktop_state_2': 'DELETED'}
2016-08-17 17:02:48,907 WARNING celery.redirected 2016-08-17 17:02:48,907 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:02:48,908 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:02:48,918 INFO celery.worker.job Task schedule_clean_desktops[2becfa29-5f91-48ef-a75b-7df0f7492580] succeeded in 0.029771197001537075s: None
2016-08-17 17:03:12,985 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:03:12,986 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:03:12,990 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:03:12,991 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:03:12,999 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:03:13,000 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:03:13,000 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:03:13,001 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:03:47,986 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:03:47,986 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:03:47,987 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:03:47,987 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:03:47,989 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:03:48,011 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:03:48,011 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:03:48,014 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:03:48,014 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:03:48,015 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:03:48,031 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:03:48,031 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:03:48,034 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:03:48,035 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:03:48,038 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:03:48,038 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:03:48,039 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:03:48,039 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:03:48,218 INFO celery.worker.strategy Received task: schedule_start_lesson[c2ac8e4e-399b-4afe-a019-142776e3d28d]
2016-08-17 17:03:48,220 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:03:48,220 INFO celery Scheduling start lesson tasks
2016-08-17 17:03:48,222 WARNING celery.redirected 2016-08-17 17:03:48,221 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:03:48,223 WARNING celery.redirected 2016-08-17 17:03:48,222 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:03:48,223 WARNING celery.redirected 2016-08-17 17:03:48,223 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:03:48,227 WARNING celery.redirected 2016-08-17 17:03:48,227 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:03:48,228 WARNING celery.redirected 2016-08-17 17:03:48,227 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 3, 48, 224869), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 13, 48, 224869)}
2016-08-17 17:03:48,230 WARNING celery.redirected 2016-08-17 17:03:48,230 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:03:48,231 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:03:48,240 INFO celery.worker.job Task schedule_start_lesson[c2ac8e4e-399b-4afe-a019-142776e3d28d] succeeded in 0.020112457998038735s: None
2016-08-17 17:03:48,295 INFO celery.worker.strategy Received task: schedule_clean_desktops[20050942-b472-42e7-8331-13078394c25b]
2016-08-17 17:03:48,298 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:03:48,300 WARNING celery.redirected 2016-08-17 17:03:48,300 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:03:48,301 WARNING celery.redirected 2016-08-17 17:03:48,301 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:03:48,302 WARNING celery.redirected 2016-08-17 17:03:48,302 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:03:48,308 WARNING celery.redirected 2016-08-17 17:03:48,308 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:03:48,309 WARNING celery.redirected 2016-08-17 17:03:48,309 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 2, 48, 299149), 'desktop_state_2': 'DELETED'}
2016-08-17 17:03:48,311 WARNING celery.redirected 2016-08-17 17:03:48,311 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:03:48,312 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:03:48,325 INFO celery.worker.job Task schedule_clean_desktops[20050942-b472-42e7-8331-13078394c25b] succeeded in 0.027058653999119997s: None
2016-08-17 17:04:23,019 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:04:23,020 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:04:23,020 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:04:23,020 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:04:23,025 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:04:23,025 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:04:23,026 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:04:23,026 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:04:48,012 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:04:48,036 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:04:49,006 INFO celery.worker.strategy Received task: schedule_start_lesson[13a89cc6-a571-4f9a-b6a5-c4edd27e7de1]
2016-08-17 17:04:49,012 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:04:49,012 INFO celery Scheduling start lesson tasks
2016-08-17 17:04:49,013 WARNING celery.redirected 2016-08-17 17:04:49,013 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:04:49,014 WARNING celery.redirected 2016-08-17 17:04:49,014 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:04:49,015 WARNING celery.redirected 2016-08-17 17:04:49,015 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:04:49,021 WARNING celery.redirected 2016-08-17 17:04:49,020 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:04:49,021 WARNING celery.redirected 2016-08-17 17:04:49,021 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 4, 49, 18760), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 14, 49, 18760)}
2016-08-17 17:04:49,023 WARNING celery.redirected 2016-08-17 17:04:49,023 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:04:49,024 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:04:49,032 INFO celery.worker.job Task schedule_start_lesson[13a89cc6-a571-4f9a-b6a5-c4edd27e7de1] succeeded in 0.02140776699889102s: None
2016-08-17 17:04:49,086 INFO celery.worker.strategy Received task: schedule_clean_desktops[16009bb5-5b9b-417b-829f-5974082bfc57]
2016-08-17 17:04:49,088 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:04:49,089 WARNING celery.redirected 2016-08-17 17:04:49,089 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:04:49,090 WARNING celery.redirected 2016-08-17 17:04:49,090 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:04:49,091 WARNING celery.redirected 2016-08-17 17:04:49,091 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:04:49,094 WARNING celery.redirected 2016-08-17 17:04:49,094 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:04:49,094 WARNING celery.redirected 2016-08-17 17:04:49,094 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 3, 49, 89072), 'desktop_state_2': 'DELETED'}
2016-08-17 17:04:49,096 WARNING celery.redirected 2016-08-17 17:04:49,096 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:04:49,097 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:04:49,105 INFO celery.worker.job Task schedule_clean_desktops[16009bb5-5b9b-417b-829f-5974082bfc57] succeeded in 0.01684032599951024s: None
2016-08-17 17:04:53,054 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:04:53,055 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:04:53,059 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:04:53,059 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:04:53,064 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:04:53,064 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:04:53,064 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:04:53,064 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:05:28,049 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:05:28,050 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:05:28,050 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:05:28,051 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:05:28,065 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:05:28,066 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:05:28,066 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:05:28,066 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:05:48,058 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:05:48,077 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:05:48,826 INFO celery.worker.strategy Received task: schedule_start_lesson[0fa9a83c-18a1-46c4-9974-55e68e526f30]
2016-08-17 17:05:48,828 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:05:48,829 INFO celery Scheduling start lesson tasks
2016-08-17 17:05:48,830 WARNING celery.redirected 2016-08-17 17:05:48,830 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:05:48,831 WARNING celery.redirected 2016-08-17 17:05:48,831 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:05:48,832 WARNING celery.redirected 2016-08-17 17:05:48,831 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:05:48,836 WARNING celery.redirected 2016-08-17 17:05:48,836 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:05:48,836 WARNING celery.redirected 2016-08-17 17:05:48,836 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 5, 48, 833308), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 15, 48, 833308)}
2016-08-17 17:05:48,838 WARNING celery.redirected 2016-08-17 17:05:48,838 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:05:48,839 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:05:48,847 INFO celery.worker.job Task schedule_start_lesson[0fa9a83c-18a1-46c4-9974-55e68e526f30] succeeded in 0.018368175999057712s: None
2016-08-17 17:05:48,897 INFO celery.worker.strategy Received task: schedule_clean_desktops[11edd4f7-90bc-492c-a8cb-9f8f67513dbf]
2016-08-17 17:05:48,898 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:05:48,900 WARNING celery.redirected 2016-08-17 17:05:48,900 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:05:48,901 WARNING celery.redirected 2016-08-17 17:05:48,901 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:05:48,901 WARNING celery.redirected 2016-08-17 17:05:48,901 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:05:48,905 WARNING celery.redirected 2016-08-17 17:05:48,904 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:05:48,905 WARNING celery.redirected 2016-08-17 17:05:48,905 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 4, 48, 899582)}
2016-08-17 17:05:48,907 WARNING celery.redirected 2016-08-17 17:05:48,907 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:05:48,908 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:05:48,915 INFO celery.worker.job Task schedule_clean_desktops[11edd4f7-90bc-492c-a8cb-9f8f67513dbf] succeeded in 0.01676467599827447s: None
2016-08-17 17:05:58,094 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:05:58,095 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:05:58,097 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:05:58,097 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:05:58,102 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:05:58,102 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:05:58,103 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:05:58,103 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:06:33,082 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:06:33,083 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:06:33,083 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:06:33,083 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:06:33,090 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:06:33,090 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:06:33,090 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:06:33,091 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:06:48,083 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:06:48,101 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:06:48,853 INFO celery.worker.strategy Received task: schedule_start_lesson[5a45523d-bb8a-468c-9722-a8549fc8e2ab]
2016-08-17 17:06:48,855 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:06:48,855 INFO celery Scheduling start lesson tasks
2016-08-17 17:06:48,857 WARNING celery.redirected 2016-08-17 17:06:48,856 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:06:48,858 WARNING celery.redirected 2016-08-17 17:06:48,857 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:06:48,858 WARNING celery.redirected 2016-08-17 17:06:48,858 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:06:48,863 WARNING celery.redirected 2016-08-17 17:06:48,862 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:06:48,863 WARNING celery.redirected 2016-08-17 17:06:48,863 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 6, 48, 860011), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 16, 48, 860011)}
2016-08-17 17:06:48,865 WARNING celery.redirected 2016-08-17 17:06:48,865 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:06:48,866 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:06:48,873 INFO celery.worker.job Task schedule_start_lesson[5a45523d-bb8a-468c-9722-a8549fc8e2ab] succeeded in 0.018579373001557542s: None
2016-08-17 17:06:48,926 INFO celery.worker.strategy Received task: schedule_clean_desktops[d783d3dc-23e9-4976-ab19-af29ac242c7e]
2016-08-17 17:06:48,927 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:06:48,928 WARNING celery.redirected 2016-08-17 17:06:48,928 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:06:48,929 WARNING celery.redirected 2016-08-17 17:06:48,929 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:06:48,930 WARNING celery.redirected 2016-08-17 17:06:48,930 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:06:48,933 WARNING celery.redirected 2016-08-17 17:06:48,933 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:06:48,934 WARNING celery.redirected 2016-08-17 17:06:48,934 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 5, 48, 928125), 'desktop_state_2': 'DELETED'}
2016-08-17 17:06:48,936 WARNING celery.redirected 2016-08-17 17:06:48,936 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:06:48,937 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:06:48,944 INFO celery.worker.job Task schedule_clean_desktops[d783d3dc-23e9-4976-ab19-af29ac242c7e] succeeded in 0.01699732500128448s: None
2016-08-17 17:07:03,116 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:07:03,116 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:07:03,118 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:07:03,118 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:07:03,123 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:07:03,124 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:07:03,124 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:07:03,124 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:07:38,105 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:07:38,105 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:07:38,106 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:07:38,106 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:07:38,111 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:07:38,111 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:07:38,112 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:07:38,112 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:07:48,109 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:07:48,127 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:07:48,447 INFO celery.worker.strategy Received task: schedule_start_lesson[f8c8a872-944b-480e-b3ec-2bb586aa80c4]
2016-08-17 17:07:48,449 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:07:48,450 INFO celery Scheduling start lesson tasks
2016-08-17 17:07:48,451 WARNING celery.redirected 2016-08-17 17:07:48,451 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:07:48,453 WARNING celery.redirected 2016-08-17 17:07:48,453 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:07:48,454 WARNING celery.redirected 2016-08-17 17:07:48,453 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:07:48,460 WARNING celery.redirected 2016-08-17 17:07:48,460 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:07:48,460 WARNING celery.redirected 2016-08-17 17:07:48,460 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 7, 48, 456811), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 17, 48, 456811)}
2016-08-17 17:07:48,462 WARNING celery.redirected 2016-08-17 17:07:48,462 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:07:48,463 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:07:48,471 INFO celery.worker.job Task schedule_start_lesson[f8c8a872-944b-480e-b3ec-2bb586aa80c4] succeeded in 0.02154364400121267s: None
2016-08-17 17:07:48,528 INFO celery.worker.strategy Received task: schedule_clean_desktops[bf5411e6-5cee-4bc7-a0e9-7c16dd28a93f]
2016-08-17 17:07:48,530 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:07:48,532 WARNING celery.redirected 2016-08-17 17:07:48,532 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:07:48,533 WARNING celery.redirected 2016-08-17 17:07:48,533 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:07:48,533 WARNING celery.redirected 2016-08-17 17:07:48,533 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:07:48,537 WARNING celery.redirected 2016-08-17 17:07:48,537 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:07:48,538 WARNING celery.redirected 2016-08-17 17:07:48,538 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 6, 48, 531625), 'desktop_state_2': 'DELETED'}
2016-08-17 17:07:48,540 WARNING celery.redirected 2016-08-17 17:07:48,540 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:07:48,541 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:07:48,548 INFO celery.worker.job Task schedule_clean_desktops[bf5411e6-5cee-4bc7-a0e9-7c16dd28a93f] succeeded in 0.018082964998029638s: None
2016-08-17 17:08:08,164 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:08:08,164 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:08:08,167 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:08:08,167 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:08:08,173 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:08:08,173 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:08:08,173 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:08:08,174 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:08:43,157 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:08:43,157 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:08:43,157 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:08:43,157 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:08:43,165 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:08:43,165 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:08:43,166 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:08:43,166 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:08:48,163 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:08:48,180 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:08:48,491 INFO celery.worker.strategy Received task: schedule_start_lesson[194ebdf6-5228-4d29-b21e-6e8dc9aa2e7a]
2016-08-17 17:08:48,492 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:08:48,493 INFO celery Scheduling start lesson tasks
2016-08-17 17:08:48,494 WARNING celery.redirected 2016-08-17 17:08:48,494 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:08:48,495 WARNING celery.redirected 2016-08-17 17:08:48,495 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:08:48,496 WARNING celery.redirected 2016-08-17 17:08:48,495 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:08:48,499 WARNING celery.redirected 2016-08-17 17:08:48,499 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:08:48,500 WARNING celery.redirected 2016-08-17 17:08:48,500 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 8, 48, 497413), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 18, 48, 497413)}
2016-08-17 17:08:48,503 WARNING celery.redirected 2016-08-17 17:08:48,502 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:08:48,504 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:08:48,510 INFO celery.worker.job Task schedule_start_lesson[194ebdf6-5228-4d29-b21e-6e8dc9aa2e7a] succeeded in 0.018174275999626843s: None
2016-08-17 17:08:48,560 INFO celery.worker.strategy Received task: schedule_clean_desktops[2afe18b8-652a-46bf-b02c-e1371b2616d9]
2016-08-17 17:08:48,561 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:08:48,562 WARNING celery.redirected 2016-08-17 17:08:48,562 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:08:48,563 WARNING celery.redirected 2016-08-17 17:08:48,563 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:08:48,564 WARNING celery.redirected 2016-08-17 17:08:48,564 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:08:48,567 WARNING celery.redirected 2016-08-17 17:08:48,567 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:08:48,567 WARNING celery.redirected 2016-08-17 17:08:48,567 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 7, 48, 561969), 'desktop_state_2': 'DELETED'}
2016-08-17 17:08:48,569 WARNING celery.redirected 2016-08-17 17:08:48,569 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:08:48,570 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:08:48,577 INFO celery.worker.job Task schedule_clean_desktops[2afe18b8-652a-46bf-b02c-e1371b2616d9] succeeded in 0.016222191999986535s: None
2016-08-17 17:09:13,187 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:09:13,187 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:09:13,189 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:09:13,190 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:09:13,195 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:09:13,196 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:09:13,196 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:09:13,196 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:09:48,182 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:09:48,182 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:09:48,182 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:09:48,183 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:09:48,185 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:09:48,269 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:09:48,269 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:09:48,271 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:09:48,272 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:09:48,272 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:09:48,296 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:09:48,296 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:09:48,298 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:09:48,299 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:09:48,303 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:09:48,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:09:48,303 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:09:48,303 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:09:49,332 INFO celery.worker.strategy Received task: schedule_start_lesson[10a7f809-2b96-4813-a7ba-d0acfe630e5a]
2016-08-17 17:09:49,335 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:09:49,336 INFO celery Scheduling start lesson tasks
2016-08-17 17:09:49,336 WARNING celery.redirected 2016-08-17 17:09:49,336 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:09:49,338 WARNING celery.redirected 2016-08-17 17:09:49,337 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:09:49,338 WARNING celery.redirected 2016-08-17 17:09:49,338 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:09:49,347 WARNING celery.redirected 2016-08-17 17:09:49,346 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:09:49,347 WARNING celery.redirected 2016-08-17 17:09:49,347 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 9, 49, 340379), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 19, 49, 340379)}
2016-08-17 17:09:49,351 WARNING celery.redirected 2016-08-17 17:09:49,351 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:09:49,354 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:09:49,367 INFO celery.worker.job Task schedule_start_lesson[10a7f809-2b96-4813-a7ba-d0acfe630e5a] succeeded in 0.03185068799939472s: None
2016-08-17 17:09:49,420 INFO celery.worker.strategy Received task: schedule_clean_desktops[9b94d35f-c56f-4c01-b0d4-7a0c3fcae1ca]
2016-08-17 17:09:49,422 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:09:49,423 WARNING celery.redirected 2016-08-17 17:09:49,423 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:09:49,424 WARNING celery.redirected 2016-08-17 17:09:49,424 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:09:49,425 WARNING celery.redirected 2016-08-17 17:09:49,425 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:09:49,428 WARNING celery.redirected 2016-08-17 17:09:49,428 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:09:49,429 WARNING celery.redirected 2016-08-17 17:09:49,429 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 8, 49, 422877), 'desktop_state_2': 'DELETED'}
2016-08-17 17:09:49,431 WARNING celery.redirected 2016-08-17 17:09:49,431 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:09:49,432 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:09:49,445 INFO celery.worker.job Task schedule_clean_desktops[9b94d35f-c56f-4c01-b0d4-7a0c3fcae1ca] succeeded in 0.02364775099704275s: None
2016-08-17 17:10:23,286 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:10:23,286 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:10:23,286 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:10:23,287 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:10:23,292 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:10:23,292 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:10:23,292 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:10:23,293 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:10:48,280 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:10:48,660 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:10:49,648 INFO celery.worker.strategy Received task: schedule_start_lesson[b58579d4-245b-4b81-8059-5dc3a42425c8]
2016-08-17 17:10:49,650 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:10:49,650 INFO celery Scheduling start lesson tasks
2016-08-17 17:10:49,651 WARNING celery.redirected 2016-08-17 17:10:49,651 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:10:49,653 WARNING celery.redirected 2016-08-17 17:10:49,652 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:10:49,653 WARNING celery.redirected 2016-08-17 17:10:49,653 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:10:49,665 WARNING celery.redirected 2016-08-17 17:10:49,665 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:10:49,666 WARNING celery.redirected 2016-08-17 17:10:49,666 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 10, 49, 661165), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 20, 49, 661165)}
2016-08-17 17:10:49,669 WARNING celery.redirected 2016-08-17 17:10:49,669 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:10:49,670 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:10:49,677 INFO celery.worker.job Task schedule_start_lesson[b58579d4-245b-4b81-8059-5dc3a42425c8] succeeded in 0.027582912996876985s: None
2016-08-17 17:10:49,735 INFO celery.worker.strategy Received task: schedule_clean_desktops[b32c4b5c-277f-44d9-8a1c-5970a25e0cf7]
2016-08-17 17:10:49,736 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:10:49,738 WARNING celery.redirected 2016-08-17 17:10:49,738 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:10:49,739 WARNING celery.redirected 2016-08-17 17:10:49,739 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:10:49,740 WARNING celery.redirected 2016-08-17 17:10:49,740 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:10:49,743 WARNING celery.redirected 2016-08-17 17:10:49,743 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:10:49,744 WARNING celery.redirected 2016-08-17 17:10:49,744 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 9, 49, 737646)}
2016-08-17 17:10:49,747 WARNING celery.redirected 2016-08-17 17:10:49,747 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:10:49,748 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:10:49,755 INFO celery.worker.job Task schedule_clean_desktops[b32c4b5c-277f-44d9-8a1c-5970a25e0cf7] succeeded in 0.019010398002137663s: None
2016-08-17 17:10:53,678 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:10:53,678 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:10:53,681 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:10:53,681 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:10:53,687 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:10:53,687 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:10:53,688 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:10:53,688 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:11:28,667 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:11:28,667 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:11:28,667 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:11:28,667 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:11:28,672 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:11:28,672 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:11:28,673 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:11:28,673 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:11:48,661 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:11:49,181 INFO celery.worker.strategy Received task: schedule_start_lesson[fa1fd690-1c63-4179-b41f-8fdaf8232344]
2016-08-17 17:11:49,183 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:11:49,183 INFO celery Scheduling start lesson tasks
2016-08-17 17:11:49,184 WARNING celery.redirected 2016-08-17 17:11:49,184 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:11:49,185 WARNING celery.redirected 2016-08-17 17:11:49,185 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:11:49,186 WARNING celery.redirected 2016-08-17 17:11:49,186 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:11:49,190 WARNING celery.redirected 2016-08-17 17:11:49,190 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:11:49,191 WARNING celery.redirected 2016-08-17 17:11:49,191 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 11, 49, 187393), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 21, 49, 187393)}
2016-08-17 17:11:49,194 WARNING celery.redirected 2016-08-17 17:11:49,194 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:11:49,195 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:11:49,202 INFO celery.worker.job Task schedule_start_lesson[fa1fd690-1c63-4179-b41f-8fdaf8232344] succeeded in 0.019090886999038048s: None
2016-08-17 17:11:53,678 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:11:53,980 INFO celery.worker.strategy Received task: schedule_clean_desktops[8c399b73-0f4e-41cc-a1da-8636c055b46c]
2016-08-17 17:11:53,982 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:11:53,984 WARNING celery.redirected 2016-08-17 17:11:53,984 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:11:53,985 WARNING celery.redirected 2016-08-17 17:11:53,985 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:11:53,986 WARNING celery.redirected 2016-08-17 17:11:53,985 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:11:53,990 WARNING celery.redirected 2016-08-17 17:11:53,990 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:11:53,990 WARNING celery.redirected 2016-08-17 17:11:53,990 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 10, 53, 983205), 'desktop_state_2': 'DELETED'}
2016-08-17 17:11:53,992 WARNING celery.redirected 2016-08-17 17:11:53,992 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:11:53,993 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:11:54,000 INFO celery.worker.job Task schedule_clean_desktops[8c399b73-0f4e-41cc-a1da-8636c055b46c] succeeded in 0.018524069000704912s: None
2016-08-17 17:11:58,694 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:11:58,694 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:11:58,697 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:11:58,697 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:11:58,702 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:11:58,702 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:11:58,703 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:11:58,703 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:12:33,683 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:12:33,683 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:12:33,683 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:12:33,683 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:12:33,688 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:12:33,689 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:12:33,689 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:12:33,689 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:12:53,683 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:12:54,598 INFO celery.worker.strategy Received task: schedule_start_lesson[7bf92215-787f-46b9-9731-9c0f91bcdcb8]
2016-08-17 17:12:54,600 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:12:54,600 INFO celery Scheduling start lesson tasks
2016-08-17 17:12:54,601 WARNING celery.redirected 2016-08-17 17:12:54,601 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:12:54,602 WARNING celery.redirected 2016-08-17 17:12:54,602 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:12:54,603 WARNING celery.redirected 2016-08-17 17:12:54,603 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:12:54,606 WARNING celery.redirected 2016-08-17 17:12:54,606 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:12:54,607 WARNING celery.redirected 2016-08-17 17:12:54,607 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 12, 54, 604600), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 22, 54, 604600)}
2016-08-17 17:12:54,610 WARNING celery.redirected 2016-08-17 17:12:54,610 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:12:54,611 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:12:54,618 INFO celery.worker.job Task schedule_start_lesson[7bf92215-787f-46b9-9731-9c0f91bcdcb8] succeeded in 0.018255335999128874s: None
2016-08-17 17:12:58,699 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:12:59,403 INFO celery.worker.strategy Received task: schedule_clean_desktops[4a356d8f-6551-4780-9129-da1be5b7ff36]
2016-08-17 17:12:59,404 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:12:59,406 WARNING celery.redirected 2016-08-17 17:12:59,406 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:12:59,407 WARNING celery.redirected 2016-08-17 17:12:59,407 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:12:59,408 WARNING celery.redirected 2016-08-17 17:12:59,408 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:12:59,411 WARNING celery.redirected 2016-08-17 17:12:59,411 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:12:59,412 WARNING celery.redirected 2016-08-17 17:12:59,411 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 11, 59, 405607)}
2016-08-17 17:12:59,414 WARNING celery.redirected 2016-08-17 17:12:59,414 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:12:59,416 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:12:59,423 INFO celery.worker.job Task schedule_clean_desktops[4a356d8f-6551-4780-9129-da1be5b7ff36] succeeded in 0.019258734999311855s: None
2016-08-17 17:13:03,715 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:13:03,715 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:13:03,717 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:13:03,718 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:13:03,723 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:13:03,723 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:13:03,723 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:13:03,723 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:13:38,707 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:13:38,708 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:13:38,708 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:13:38,708 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:13:38,714 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:13:38,714 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:13:38,714 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:13:38,714 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:13:58,705 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:13:59,922 INFO celery.worker.strategy Received task: schedule_start_lesson[b7c0e1f0-7457-4913-9cd7-9ece0c544780]
2016-08-17 17:13:59,923 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:13:59,924 INFO celery Scheduling start lesson tasks
2016-08-17 17:13:59,925 WARNING celery.redirected 2016-08-17 17:13:59,925 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:13:59,926 WARNING celery.redirected 2016-08-17 17:13:59,926 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:13:59,926 WARNING celery.redirected 2016-08-17 17:13:59,926 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:13:59,933 WARNING celery.redirected 2016-08-17 17:13:59,933 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:13:59,934 WARNING celery.redirected 2016-08-17 17:13:59,934 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 13, 59, 928197), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 23, 59, 928197)}
2016-08-17 17:13:59,937 WARNING celery.redirected 2016-08-17 17:13:59,937 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:13:59,938 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:13:59,945 INFO celery.worker.job Task schedule_start_lesson[b7c0e1f0-7457-4913-9cd7-9ece0c544780] succeeded in 0.02171402699968894s: None
2016-08-17 17:14:03,878 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:14:04,710 INFO celery.worker.strategy Received task: schedule_clean_desktops[84ab8414-f74c-46b4-9963-2997d251cbd1]
2016-08-17 17:14:04,712 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:14:04,713 WARNING celery.redirected 2016-08-17 17:14:04,713 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:14:04,715 WARNING celery.redirected 2016-08-17 17:14:04,714 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:14:04,715 WARNING celery.redirected 2016-08-17 17:14:04,715 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:14:04,719 WARNING celery.redirected 2016-08-17 17:14:04,719 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:14:04,720 WARNING celery.redirected 2016-08-17 17:14:04,720 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 13, 4, 713070)}
2016-08-17 17:14:04,722 WARNING celery.redirected 2016-08-17 17:14:04,722 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:14:04,723 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:14:04,734 INFO celery.worker.job Task schedule_clean_desktops[84ab8414-f74c-46b4-9963-2997d251cbd1] succeeded in 0.021943561001535272s: None
2016-08-17 17:14:08,896 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:14:08,896 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:14:08,898 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:14:08,898 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:14:08,903 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:14:08,904 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:14:08,904 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:14:08,904 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:14:43,884 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:14:43,884 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:14:43,885 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:14:43,885 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:14:43,891 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:14:43,891 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:14:43,892 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:14:43,892 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:15:03,881 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:15:04,198 INFO celery.worker.strategy Received task: schedule_start_lesson[dd2f9eef-3c4c-4375-8c52-545ca431edbe]
2016-08-17 17:15:04,199 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:15:04,200 INFO celery Scheduling start lesson tasks
2016-08-17 17:15:04,201 WARNING celery.redirected 2016-08-17 17:15:04,201 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:15:04,202 WARNING celery.redirected 2016-08-17 17:15:04,202 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:15:04,203 WARNING celery.redirected 2016-08-17 17:15:04,203 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:15:04,208 WARNING celery.redirected 2016-08-17 17:15:04,208 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:15:04,208 WARNING celery.redirected 2016-08-17 17:15:04,208 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 15, 4, 205473), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 25, 4, 205473)}
2016-08-17 17:15:04,211 WARNING celery.redirected 2016-08-17 17:15:04,211 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:15:04,212 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:15:04,224 INFO celery.worker.job Task schedule_start_lesson[dd2f9eef-3c4c-4375-8c52-545ca431edbe] succeeded in 0.0252420520009764s: None
2016-08-17 17:15:08,914 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:15:09,121 INFO celery.worker.strategy Received task: schedule_clean_desktops[58417f0f-6d3f-4379-93e6-17d72cbc83e0]
2016-08-17 17:15:09,123 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:15:09,125 WARNING celery.redirected 2016-08-17 17:15:09,125 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:15:09,126 WARNING celery.redirected 2016-08-17 17:15:09,126 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:15:09,126 WARNING celery.redirected 2016-08-17 17:15:09,126 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:15:09,130 WARNING celery.redirected 2016-08-17 17:15:09,129 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:15:09,130 WARNING celery.redirected 2016-08-17 17:15:09,130 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 14, 9, 124500), 'desktop_state_2': 'DELETED'}
2016-08-17 17:15:09,132 WARNING celery.redirected 2016-08-17 17:15:09,132 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:15:09,133 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:15:09,141 INFO celery.worker.job Task schedule_clean_desktops[58417f0f-6d3f-4379-93e6-17d72cbc83e0] succeeded in 0.017951734000234865s: None
2016-08-17 17:15:13,934 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:15:13,935 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:15:13,937 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:15:13,938 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:15:13,943 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:15:13,943 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:15:13,943 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:15:13,944 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:15:48,925 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:15:48,926 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:15:48,926 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:15:48,927 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:15:48,933 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:15:48,933 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:15:48,934 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:15:48,934 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:16:08,924 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:16:09,197 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:16:10,246 INFO celery.worker.strategy Received task: schedule_start_lesson[61732a30-df1d-4955-b561-20d1dd376179]
2016-08-17 17:16:10,248 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:16:10,249 INFO celery Scheduling start lesson tasks
2016-08-17 17:16:10,250 WARNING celery.redirected 2016-08-17 17:16:10,250 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:16:10,251 WARNING celery.redirected 2016-08-17 17:16:10,251 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:16:10,252 WARNING celery.redirected 2016-08-17 17:16:10,251 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:16:10,256 WARNING celery.redirected 2016-08-17 17:16:10,256 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:16:10,256 WARNING celery.redirected 2016-08-17 17:16:10,256 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 16, 10, 253487), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 26, 10, 253487)}
2016-08-17 17:16:10,258 WARNING celery.redirected 2016-08-17 17:16:10,258 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:16:10,259 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:16:10,267 INFO celery.worker.job Task schedule_start_lesson[61732a30-df1d-4955-b561-20d1dd376179] succeeded in 0.01963442900159862s: None
2016-08-17 17:16:10,321 INFO celery.worker.strategy Received task: schedule_clean_desktops[7df9c916-64cf-4e95-bb44-57b5240cfd59]
2016-08-17 17:16:10,322 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:16:10,324 WARNING celery.redirected 2016-08-17 17:16:10,324 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:16:10,325 WARNING celery.redirected 2016-08-17 17:16:10,325 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:16:10,325 WARNING celery.redirected 2016-08-17 17:16:10,325 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:16:10,329 WARNING celery.redirected 2016-08-17 17:16:10,328 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:16:10,329 WARNING celery.redirected 2016-08-17 17:16:10,329 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 15, 10, 323467)}
2016-08-17 17:16:10,331 WARNING celery.redirected 2016-08-17 17:16:10,331 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:16:10,332 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:16:10,339 INFO celery.worker.job Task schedule_clean_desktops[7df9c916-64cf-4e95-bb44-57b5240cfd59] succeeded in 0.017084704999433598s: None
2016-08-17 17:16:19,215 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:16:19,215 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:16:19,217 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:16:19,218 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:16:19,222 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:16:19,223 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:16:19,223 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:16:19,223 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:16:54,205 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:16:54,205 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:16:54,205 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:16:54,205 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:16:54,211 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:16:54,211 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:16:54,211 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:16:54,211 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:17:09,204 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:17:09,221 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:17:09,984 INFO celery.worker.strategy Received task: schedule_start_lesson[9e071892-b482-4af4-86ad-36724987fdbe]
2016-08-17 17:17:09,985 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:17:09,986 INFO celery Scheduling start lesson tasks
2016-08-17 17:17:09,987 WARNING celery.redirected 2016-08-17 17:17:09,987 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:17:09,988 WARNING celery.redirected 2016-08-17 17:17:09,988 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:17:09,988 WARNING celery.redirected 2016-08-17 17:17:09,988 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:17:09,992 WARNING celery.redirected 2016-08-17 17:17:09,992 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:17:09,993 WARNING celery.redirected 2016-08-17 17:17:09,993 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 17, 9, 990060), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 27, 9, 990060)}
2016-08-17 17:17:09,995 WARNING celery.redirected 2016-08-17 17:17:09,995 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:17:09,996 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:17:10,004 INFO celery.worker.job Task schedule_start_lesson[9e071892-b482-4af4-86ad-36724987fdbe] succeeded in 0.019096731000900036s: None
2016-08-17 17:17:10,058 INFO celery.worker.strategy Received task: schedule_clean_desktops[32c01a2b-d5ed-4c5f-ac3f-3b087b89097b]
2016-08-17 17:17:10,060 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:17:10,062 WARNING celery.redirected 2016-08-17 17:17:10,062 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:17:10,063 WARNING celery.redirected 2016-08-17 17:17:10,063 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:17:10,063 WARNING celery.redirected 2016-08-17 17:17:10,063 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:17:10,067 WARNING celery.redirected 2016-08-17 17:17:10,066 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:17:10,067 WARNING celery.redirected 2016-08-17 17:17:10,067 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 16, 10, 61646), 'desktop_state_2': 'DELETED'}
2016-08-17 17:17:10,069 WARNING celery.redirected 2016-08-17 17:17:10,069 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:17:10,070 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:17:10,078 INFO celery.worker.job Task schedule_clean_desktops[32c01a2b-d5ed-4c5f-ac3f-3b087b89097b] succeeded in 0.017534436999994796s: None
2016-08-17 17:17:24,244 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:17:24,244 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:17:24,248 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:17:24,248 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:17:24,253 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:17:24,253 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:17:24,253 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:17:24,253 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:17:59,234 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:17:59,234 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:17:59,235 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:17:59,235 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:17:59,240 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:17:59,240 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:17:59,240 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:17:59,240 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:18:09,234 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:18:09,252 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:18:10,032 INFO celery.worker.strategy Received task: schedule_start_lesson[bb1c19d8-1653-403b-bc3d-1654399a8d6e]
2016-08-17 17:18:10,033 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:18:10,034 INFO celery Scheduling start lesson tasks
2016-08-17 17:18:10,037 WARNING celery.redirected 2016-08-17 17:18:10,036 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:18:10,039 WARNING celery.redirected 2016-08-17 17:18:10,038 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:18:10,040 WARNING celery.redirected 2016-08-17 17:18:10,039 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:18:10,046 WARNING celery.redirected 2016-08-17 17:18:10,046 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:18:10,047 WARNING celery.redirected 2016-08-17 17:18:10,047 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 18, 10, 43317), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 28, 10, 43317)}
2016-08-17 17:18:10,051 WARNING celery.redirected 2016-08-17 17:18:10,051 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:18:10,053 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:18:10,064 INFO celery.worker.job Task schedule_start_lesson[bb1c19d8-1653-403b-bc3d-1654399a8d6e] succeeded in 0.031112827000470133s: None
2016-08-17 17:18:10,112 INFO celery.worker.strategy Received task: schedule_clean_desktops[517723ef-b8c4-491a-89c4-8b08ac7f5dec]
2016-08-17 17:18:10,113 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:18:10,115 WARNING celery.redirected 2016-08-17 17:18:10,115 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:18:10,116 WARNING celery.redirected 2016-08-17 17:18:10,116 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:18:10,117 WARNING celery.redirected 2016-08-17 17:18:10,116 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:18:10,120 WARNING celery.redirected 2016-08-17 17:18:10,120 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:18:10,121 WARNING celery.redirected 2016-08-17 17:18:10,121 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 17, 10, 114307)}
2016-08-17 17:18:10,124 WARNING celery.redirected 2016-08-17 17:18:10,124 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:18:10,126 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:18:10,135 INFO celery.worker.job Task schedule_clean_desktops[517723ef-b8c4-491a-89c4-8b08ac7f5dec] succeeded in 0.02220802300143987s: None
2016-08-17 17:18:29,263 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:18:29,263 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:18:29,267 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:18:29,267 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:18:29,273 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:18:29,273 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:18:29,273 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:18:29,274 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:19:04,249 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:19:04,249 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:19:04,249 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:19:04,249 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:19:04,255 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:19:04,255 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:19:04,255 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:19:04,255 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:19:09,249 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:19:09,266 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:19:09,841 INFO celery.worker.strategy Received task: schedule_start_lesson[c9f5726d-c410-4f29-82bb-8c9a5245408c]
2016-08-17 17:19:09,842 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:19:09,843 INFO celery Scheduling start lesson tasks
2016-08-17 17:19:09,843 WARNING celery.redirected 2016-08-17 17:19:09,843 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:19:09,844 WARNING celery.redirected 2016-08-17 17:19:09,844 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:19:09,845 WARNING celery.redirected 2016-08-17 17:19:09,845 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:19:09,849 WARNING celery.redirected 2016-08-17 17:19:09,849 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:19:09,849 WARNING celery.redirected 2016-08-17 17:19:09,849 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 19, 9, 846921), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 29, 9, 846921)}
2016-08-17 17:19:09,852 WARNING celery.redirected 2016-08-17 17:19:09,851 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:19:09,853 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:19:09,860 INFO celery.worker.job Task schedule_start_lesson[c9f5726d-c410-4f29-82bb-8c9a5245408c] succeeded in 0.018356802000198513s: None
2016-08-17 17:19:09,911 INFO celery.worker.strategy Received task: schedule_clean_desktops[9f52b38c-742a-42f1-8236-843ad27a8042]
2016-08-17 17:19:09,913 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:19:09,914 WARNING celery.redirected 2016-08-17 17:19:09,914 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:19:09,915 WARNING celery.redirected 2016-08-17 17:19:09,915 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:19:09,916 WARNING celery.redirected 2016-08-17 17:19:09,916 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:19:09,919 WARNING celery.redirected 2016-08-17 17:19:09,919 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:19:09,920 WARNING celery.redirected 2016-08-17 17:19:09,920 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 18, 9, 913939)}
2016-08-17 17:19:09,922 WARNING celery.redirected 2016-08-17 17:19:09,922 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:19:09,923 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:19:09,930 INFO celery.worker.job Task schedule_clean_desktops[9f52b38c-742a-42f1-8236-843ad27a8042] succeeded in 0.0177786960011872s: None
2016-08-17 17:19:34,275 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:19:34,276 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:19:34,279 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:19:34,280 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:19:34,284 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:19:34,285 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:19:34,285 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:19:34,285 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:20:09,275 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:20:09,276 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:20:09,276 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:20:09,276 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:20:09,278 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:20:09,388 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:20:09,389 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:20:09,392 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:20:09,392 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:20:09,392 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:20:09,410 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:20:09,410 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:20:09,413 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:20:09,413 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:20:09,416 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:20:09,416 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:20:09,417 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:20:09,417 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:20:10,452 INFO celery.worker.strategy Received task: schedule_start_lesson[37fa82f3-5355-479a-a882-496f0bc2a14d]
2016-08-17 17:20:10,454 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:20:10,454 INFO celery Scheduling start lesson tasks
2016-08-17 17:20:10,455 WARNING celery.redirected 2016-08-17 17:20:10,455 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:20:10,456 WARNING celery.redirected 2016-08-17 17:20:10,456 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:20:10,457 WARNING celery.redirected 2016-08-17 17:20:10,457 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:20:10,461 WARNING celery.redirected 2016-08-17 17:20:10,460 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:20:10,461 WARNING celery.redirected 2016-08-17 17:20:10,461 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 20, 10, 458515), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 30, 10, 458515)}
2016-08-17 17:20:10,463 WARNING celery.redirected 2016-08-17 17:20:10,463 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:20:10,464 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:20:10,472 INFO celery.worker.job Task schedule_start_lesson[37fa82f3-5355-479a-a882-496f0bc2a14d] succeeded in 0.01859150100062834s: None
2016-08-17 17:20:10,523 INFO celery.worker.strategy Received task: schedule_clean_desktops[5e1a1588-2fd7-4eb5-9c52-7d54e70f8ba4]
2016-08-17 17:20:10,525 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:20:10,526 WARNING celery.redirected 2016-08-17 17:20:10,526 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:20:10,527 WARNING celery.redirected 2016-08-17 17:20:10,527 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:20:10,528 WARNING celery.redirected 2016-08-17 17:20:10,528 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:20:10,531 WARNING celery.redirected 2016-08-17 17:20:10,531 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:20:10,531 WARNING celery.redirected 2016-08-17 17:20:10,531 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 19, 10, 525944)}
2016-08-17 17:20:10,533 WARNING celery.redirected 2016-08-17 17:20:10,533 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:20:10,534 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:20:10,543 INFO celery.worker.job Task schedule_clean_desktops[5e1a1588-2fd7-4eb5-9c52-7d54e70f8ba4] succeeded in 0.018654460000107065s: None
2016-08-17 17:20:44,401 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:20:44,401 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:20:44,402 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:20:44,402 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:20:44,407 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:20:44,407 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:20:44,407 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:20:44,408 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:21:09,394 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:21:09,410 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:21:09,786 INFO celery.worker.strategy Received task: schedule_start_lesson[12d26bdf-a969-4415-bb49-f252f46eba1c]
2016-08-17 17:21:09,787 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:21:09,788 INFO celery Scheduling start lesson tasks
2016-08-17 17:21:09,789 WARNING celery.redirected 2016-08-17 17:21:09,789 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:21:09,790 WARNING celery.redirected 2016-08-17 17:21:09,790 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:21:09,791 WARNING celery.redirected 2016-08-17 17:21:09,791 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:21:09,795 WARNING celery.redirected 2016-08-17 17:21:09,794 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:21:09,795 WARNING celery.redirected 2016-08-17 17:21:09,795 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 21, 9, 792657), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 31, 9, 792657)}
2016-08-17 17:21:09,798 WARNING celery.redirected 2016-08-17 17:21:09,797 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:21:09,799 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:21:09,806 INFO celery.worker.job Task schedule_start_lesson[12d26bdf-a969-4415-bb49-f252f46eba1c] succeeded in 0.018375596999248955s: None
2016-08-17 17:21:09,861 INFO celery.worker.strategy Received task: schedule_clean_desktops[aef5efc0-638a-41d8-9ca6-1873351fa892]
2016-08-17 17:21:09,862 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:21:09,864 WARNING celery.redirected 2016-08-17 17:21:09,864 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:21:09,865 WARNING celery.redirected 2016-08-17 17:21:09,865 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:21:09,865 WARNING celery.redirected 2016-08-17 17:21:09,865 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:21:09,868 WARNING celery.redirected 2016-08-17 17:21:09,868 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:21:09,869 WARNING celery.redirected 2016-08-17 17:21:09,869 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 20, 9, 863437)}
2016-08-17 17:21:09,871 WARNING celery.redirected 2016-08-17 17:21:09,871 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:21:09,873 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:21:09,879 INFO celery.worker.job Task schedule_clean_desktops[aef5efc0-638a-41d8-9ca6-1873351fa892] succeeded in 0.017052765000698855s: None
2016-08-17 17:21:14,426 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:21:14,426 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:21:14,429 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:21:14,429 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:21:14,433 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:21:14,433 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:21:14,433 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:21:14,433 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:21:49,412 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:21:49,412 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:21:49,413 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:21:49,413 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:21:49,418 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:21:49,418 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:21:49,418 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:21:49,418 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:22:09,407 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:22:09,425 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:22:09,972 INFO celery.worker.strategy Received task: schedule_start_lesson[96b858bf-6d5d-4a6e-ab54-20dacba21d25]
2016-08-17 17:22:09,974 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:22:09,974 INFO celery Scheduling start lesson tasks
2016-08-17 17:22:09,975 WARNING celery.redirected 2016-08-17 17:22:09,975 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:22:09,976 WARNING celery.redirected 2016-08-17 17:22:09,976 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:22:09,977 WARNING celery.redirected 2016-08-17 17:22:09,977 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:22:09,981 WARNING celery.redirected 2016-08-17 17:22:09,981 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:22:09,981 WARNING celery.redirected 2016-08-17 17:22:09,981 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 22, 9, 978661), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 32, 9, 978661)}
2016-08-17 17:22:09,984 WARNING celery.redirected 2016-08-17 17:22:09,984 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:22:09,986 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:22:09,993 INFO celery.worker.job Task schedule_start_lesson[96b858bf-6d5d-4a6e-ab54-20dacba21d25] succeeded in 0.019882047999999486s: None
2016-08-17 17:22:10,049 INFO celery.worker.strategy Received task: schedule_clean_desktops[95517f54-4858-4caf-87b6-bfa68f770644]
2016-08-17 17:22:10,050 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:22:10,051 WARNING celery.redirected 2016-08-17 17:22:10,051 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:22:10,052 WARNING celery.redirected 2016-08-17 17:22:10,052 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:22:10,053 WARNING celery.redirected 2016-08-17 17:22:10,053 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:22:10,057 WARNING celery.redirected 2016-08-17 17:22:10,056 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:22:10,057 WARNING celery.redirected 2016-08-17 17:22:10,057 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 21, 10, 51031), 'desktop_state_2': 'DELETED'}
2016-08-17 17:22:10,059 WARNING celery.redirected 2016-08-17 17:22:10,059 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:22:10,060 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:22:10,067 INFO celery.worker.job Task schedule_clean_desktops[95517f54-4858-4caf-87b6-bfa68f770644] succeeded in 0.017023191998305265s: None
2016-08-17 17:22:19,437 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:22:19,438 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:22:19,440 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:22:19,440 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:22:19,445 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:22:19,445 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:22:19,445 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:22:19,446 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:22:54,421 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:22:54,421 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:22:54,421 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:22:54,421 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:22:54,426 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:22:54,426 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:22:54,426 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:22:54,427 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:23:09,414 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:23:09,431 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:23:10,138 INFO celery.worker.strategy Received task: schedule_start_lesson[5e470409-080e-4f03-a61d-6bfd2e0eb9a9]
2016-08-17 17:23:10,140 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:23:10,141 INFO celery Scheduling start lesson tasks
2016-08-17 17:23:10,142 WARNING celery.redirected 2016-08-17 17:23:10,142 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:23:10,144 WARNING celery.redirected 2016-08-17 17:23:10,143 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:23:10,144 WARNING celery.redirected 2016-08-17 17:23:10,144 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:23:10,150 WARNING celery.redirected 2016-08-17 17:23:10,149 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:23:10,150 WARNING celery.redirected 2016-08-17 17:23:10,150 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 23, 10, 146584), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 33, 10, 146584)}
2016-08-17 17:23:10,153 WARNING celery.redirected 2016-08-17 17:23:10,153 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:23:10,154 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:23:10,161 INFO celery.worker.job Task schedule_start_lesson[5e470409-080e-4f03-a61d-6bfd2e0eb9a9] succeeded in 0.021223859999736305s: None
2016-08-17 17:23:10,219 INFO celery.worker.strategy Received task: schedule_clean_desktops[531c0d04-37b1-49a9-b204-d43935bcd414]
2016-08-17 17:23:10,220 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:23:10,222 WARNING celery.redirected 2016-08-17 17:23:10,221 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:23:10,223 WARNING celery.redirected 2016-08-17 17:23:10,222 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:23:10,223 WARNING celery.redirected 2016-08-17 17:23:10,223 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:23:10,228 WARNING celery.redirected 2016-08-17 17:23:10,228 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:23:10,229 WARNING celery.redirected 2016-08-17 17:23:10,229 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 22, 10, 221178), 'desktop_state_2': 'DELETED'}
2016-08-17 17:23:10,231 WARNING celery.redirected 2016-08-17 17:23:10,231 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:23:10,232 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:23:10,239 INFO celery.worker.job Task schedule_clean_desktops[531c0d04-37b1-49a9-b204-d43935bcd414] succeeded in 0.019021713000256568s: None
2016-08-17 17:23:24,447 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:23:24,447 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:23:24,449 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:23:24,450 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:23:24,454 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:23:24,455 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:23:24,455 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:23:24,455 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:23:59,434 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:23:59,435 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:23:59,435 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:23:59,435 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:23:59,441 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:23:59,441 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:23:59,441 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:23:59,442 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:24:09,432 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:24:09,449 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:24:10,238 INFO celery.worker.strategy Received task: schedule_start_lesson[bee1f5f4-d1f0-4df1-8dba-58249fa0e758]
2016-08-17 17:24:10,239 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:24:10,240 INFO celery Scheduling start lesson tasks
2016-08-17 17:24:10,241 WARNING celery.redirected 2016-08-17 17:24:10,241 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:24:10,242 WARNING celery.redirected 2016-08-17 17:24:10,241 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:24:10,242 WARNING celery.redirected 2016-08-17 17:24:10,242 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:24:10,245 WARNING celery.redirected 2016-08-17 17:24:10,245 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:24:10,246 WARNING celery.redirected 2016-08-17 17:24:10,246 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 24, 10, 243766), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 34, 10, 243766)}
2016-08-17 17:24:10,248 WARNING celery.redirected 2016-08-17 17:24:10,248 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:24:10,249 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:24:10,256 INFO celery.worker.job Task schedule_start_lesson[bee1f5f4-d1f0-4df1-8dba-58249fa0e758] succeeded in 0.017011751002428355s: None
2016-08-17 17:24:10,307 INFO celery.worker.strategy Received task: schedule_clean_desktops[5bc4f16d-e561-4f5c-9615-3d6dea5cc30b]
2016-08-17 17:24:10,308 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:24:10,310 WARNING celery.redirected 2016-08-17 17:24:10,310 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:24:10,311 WARNING celery.redirected 2016-08-17 17:24:10,311 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:24:10,312 WARNING celery.redirected 2016-08-17 17:24:10,311 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:24:10,315 WARNING celery.redirected 2016-08-17 17:24:10,315 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:24:10,315 WARNING celery.redirected 2016-08-17 17:24:10,315 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 23, 10, 309399), 'desktop_state_2': 'DELETED'}
2016-08-17 17:24:10,318 WARNING celery.redirected 2016-08-17 17:24:10,317 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:24:10,319 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:24:10,325 INFO celery.worker.job Task schedule_clean_desktops[5bc4f16d-e561-4f5c-9615-3d6dea5cc30b] succeeded in 0.01670794200254022s: None
2016-08-17 17:24:29,452 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:24:29,452 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:24:29,455 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:24:29,455 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:24:29,461 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:24:29,461 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:24:29,461 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:24:29,461 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:25:04,432 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:25:04,432 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:25:04,433 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:25:04,433 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:25:04,438 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:25:04,438 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:25:04,438 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:25:04,439 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:25:09,437 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:25:09,454 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:25:10,470 INFO celery.worker.strategy Received task: schedule_start_lesson[6622f231-4e7f-4201-b260-e0872e6e45ca]
2016-08-17 17:25:10,472 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:25:10,472 INFO celery Scheduling start lesson tasks
2016-08-17 17:25:10,473 WARNING celery.redirected 2016-08-17 17:25:10,473 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:25:10,474 WARNING celery.redirected 2016-08-17 17:25:10,474 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:25:10,475 WARNING celery.redirected 2016-08-17 17:25:10,475 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:25:10,481 WARNING celery.redirected 2016-08-17 17:25:10,481 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:25:10,482 WARNING celery.redirected 2016-08-17 17:25:10,481 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 25, 10, 476676), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 35, 10, 476676)}
2016-08-17 17:25:10,484 WARNING celery.redirected 2016-08-17 17:25:10,483 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:25:10,485 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:25:10,492 INFO celery.worker.job Task schedule_start_lesson[6622f231-4e7f-4201-b260-e0872e6e45ca] succeeded in 0.02051655099785421s: None
2016-08-17 17:25:10,541 INFO celery.worker.strategy Received task: schedule_clean_desktops[695cc029-4452-4946-816e-8ea6f139140c]
2016-08-17 17:25:10,542 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:25:10,543 WARNING celery.redirected 2016-08-17 17:25:10,543 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:25:10,545 WARNING celery.redirected 2016-08-17 17:25:10,544 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:25:10,545 WARNING celery.redirected 2016-08-17 17:25:10,545 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:25:10,549 WARNING celery.redirected 2016-08-17 17:25:10,548 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:25:10,550 WARNING celery.redirected 2016-08-17 17:25:10,549 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 24, 10, 543171)}
2016-08-17 17:25:10,553 WARNING celery.redirected 2016-08-17 17:25:10,553 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:25:10,554 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:25:10,561 INFO celery.worker.job Task schedule_clean_desktops[695cc029-4452-4946-816e-8ea6f139140c] succeeded in 0.018808887998602586s: None
2016-08-17 17:25:34,467 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:25:34,467 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:25:34,469 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:25:34,469 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:25:34,474 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:25:34,474 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:25:34,475 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:25:34,475 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:26:09,455 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:26:09,455 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:26:09,456 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:26:09,456 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:26:09,458 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:26:09,475 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:26:09,475 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:26:09,478 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:26:09,478 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:26:09,478 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:26:09,497 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:26:09,497 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:26:09,499 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:26:09,499 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:26:09,502 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:26:09,502 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:26:09,503 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:26:09,503 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:26:09,828 INFO celery.worker.strategy Received task: schedule_start_lesson[a31796c5-0610-4dc6-af23-a04102b97ffc]
2016-08-17 17:26:09,829 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:26:09,830 INFO celery Scheduling start lesson tasks
2016-08-17 17:26:09,831 WARNING celery.redirected 2016-08-17 17:26:09,831 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:26:09,832 WARNING celery.redirected 2016-08-17 17:26:09,832 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:26:09,832 WARNING celery.redirected 2016-08-17 17:26:09,832 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:26:09,836 WARNING celery.redirected 2016-08-17 17:26:09,836 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:26:09,836 WARNING celery.redirected 2016-08-17 17:26:09,836 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 26, 9, 834013), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 36, 9, 834013)}
2016-08-17 17:26:09,838 WARNING celery.redirected 2016-08-17 17:26:09,838 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:26:09,839 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:26:09,847 INFO celery.worker.job Task schedule_start_lesson[a31796c5-0610-4dc6-af23-a04102b97ffc] succeeded in 0.018187294001108967s: None
2016-08-17 17:26:09,901 INFO celery.worker.strategy Received task: schedule_clean_desktops[270c7726-4a4b-4157-a66e-b48b1bdd41c8]
2016-08-17 17:26:09,903 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:26:09,904 WARNING celery.redirected 2016-08-17 17:26:09,904 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:26:09,905 WARNING celery.redirected 2016-08-17 17:26:09,905 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:26:09,905 WARNING celery.redirected 2016-08-17 17:26:09,905 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:26:09,909 WARNING celery.redirected 2016-08-17 17:26:09,909 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:26:09,909 WARNING celery.redirected 2016-08-17 17:26:09,909 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 25, 9, 903649)}
2016-08-17 17:26:09,912 WARNING celery.redirected 2016-08-17 17:26:09,912 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:26:09,913 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:26:09,919 INFO celery.worker.job Task schedule_clean_desktops[270c7726-4a4b-4157-a66e-b48b1bdd41c8] succeeded in 0.016854942001373274s: None
2016-08-17 17:26:44,484 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:26:44,484 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:26:44,484 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:26:44,484 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:26:44,489 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:26:44,490 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:26:44,491 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:26:44,491 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:27:09,476 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:27:09,494 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:27:10,103 INFO celery.worker.strategy Received task: schedule_start_lesson[52ed0054-2f39-470b-a1a7-9cf436c6847c]
2016-08-17 17:27:10,105 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:27:10,106 INFO celery Scheduling start lesson tasks
2016-08-17 17:27:10,107 WARNING celery.redirected 2016-08-17 17:27:10,106 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:27:10,107 WARNING celery.redirected 2016-08-17 17:27:10,107 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:27:10,108 WARNING celery.redirected 2016-08-17 17:27:10,108 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:27:10,112 WARNING celery.redirected 2016-08-17 17:27:10,111 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:27:10,112 WARNING celery.redirected 2016-08-17 17:27:10,112 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 27, 10, 109802), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 37, 10, 109802)}
2016-08-17 17:27:10,114 WARNING celery.redirected 2016-08-17 17:27:10,114 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:27:10,115 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:27:10,123 INFO celery.worker.job Task schedule_start_lesson[52ed0054-2f39-470b-a1a7-9cf436c6847c] succeeded in 0.01797648100182414s: None
2016-08-17 17:27:10,185 INFO celery.worker.strategy Received task: schedule_clean_desktops[8a3c7472-d5f0-4688-b9a0-ebf8acc54544]
2016-08-17 17:27:10,186 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:27:10,189 WARNING celery.redirected 2016-08-17 17:27:10,189 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:27:10,190 WARNING celery.redirected 2016-08-17 17:27:10,190 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:27:10,191 WARNING celery.redirected 2016-08-17 17:27:10,191 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:27:10,195 WARNING celery.redirected 2016-08-17 17:27:10,195 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:27:10,196 WARNING celery.redirected 2016-08-17 17:27:10,196 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 26, 10, 188446), 'desktop_state_2': 'DELETED'}
2016-08-17 17:27:10,198 WARNING celery.redirected 2016-08-17 17:27:10,198 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:27:10,199 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:27:10,205 INFO celery.worker.job Task schedule_clean_desktops[8a3c7472-d5f0-4688-b9a0-ebf8acc54544] succeeded in 0.01914046200181474s: None
2016-08-17 17:27:14,509 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:27:14,509 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:27:14,511 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:27:14,511 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:27:14,516 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:27:14,516 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:27:14,517 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:27:14,517 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:27:49,499 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:27:49,500 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:27:49,500 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:27:49,500 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:27:49,505 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:27:49,505 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:27:49,505 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:27:49,505 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:28:09,489 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:28:09,505 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:28:10,289 INFO celery.worker.strategy Received task: schedule_start_lesson[16220e1b-79b6-473b-a17d-c4e17630113e]
2016-08-17 17:28:10,291 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:28:10,292 INFO celery Scheduling start lesson tasks
2016-08-17 17:28:10,293 WARNING celery.redirected 2016-08-17 17:28:10,293 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:28:10,294 WARNING celery.redirected 2016-08-17 17:28:10,294 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:28:10,294 WARNING celery.redirected 2016-08-17 17:28:10,294 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:28:10,298 WARNING celery.redirected 2016-08-17 17:28:10,298 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:28:10,298 WARNING celery.redirected 2016-08-17 17:28:10,298 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 28, 10, 296086), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 38, 10, 296086)}
2016-08-17 17:28:10,300 WARNING celery.redirected 2016-08-17 17:28:10,300 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:28:10,301 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:28:10,308 INFO celery.worker.job Task schedule_start_lesson[16220e1b-79b6-473b-a17d-c4e17630113e] succeeded in 0.016909377998672426s: None
2016-08-17 17:28:10,358 INFO celery.worker.strategy Received task: schedule_clean_desktops[e2e8da93-3810-4366-b8b9-b25e9ee04329]
2016-08-17 17:28:10,359 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:28:10,361 WARNING celery.redirected 2016-08-17 17:28:10,361 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:28:10,362 WARNING celery.redirected 2016-08-17 17:28:10,362 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:28:10,362 WARNING celery.redirected 2016-08-17 17:28:10,362 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:28:10,365 WARNING celery.redirected 2016-08-17 17:28:10,365 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:28:10,366 WARNING celery.redirected 2016-08-17 17:28:10,366 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 27, 10, 360643)}
2016-08-17 17:28:10,368 WARNING celery.redirected 2016-08-17 17:28:10,368 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:28:10,369 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:28:10,376 INFO celery.worker.job Task schedule_clean_desktops[e2e8da93-3810-4366-b8b9-b25e9ee04329] succeeded in 0.016511624002305325s: None
2016-08-17 17:28:19,522 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:28:19,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:28:19,525 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:28:19,525 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:28:19,530 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:28:19,530 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:28:19,531 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:28:19,531 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:28:54,515 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:28:54,515 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:28:54,516 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:28:54,516 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:28:54,524 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:28:54,524 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:28:54,524 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:28:54,525 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:29:09,508 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:29:10,188 INFO celery.worker.strategy Received task: schedule_start_lesson[865dc7fd-db6d-4cda-a2fe-558e3407a677]
2016-08-17 17:29:10,190 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:29:10,191 INFO celery Scheduling start lesson tasks
2016-08-17 17:29:10,192 WARNING celery.redirected 2016-08-17 17:29:10,192 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:29:10,193 WARNING celery.redirected 2016-08-17 17:29:10,193 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:29:10,194 WARNING celery.redirected 2016-08-17 17:29:10,194 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:29:10,198 WARNING celery.redirected 2016-08-17 17:29:10,198 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:29:10,199 WARNING celery.redirected 2016-08-17 17:29:10,199 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 29, 10, 195600), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 39, 10, 195600)}
2016-08-17 17:29:10,201 WARNING celery.redirected 2016-08-17 17:29:10,201 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:29:10,203 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:29:10,211 INFO celery.worker.job Task schedule_start_lesson[865dc7fd-db6d-4cda-a2fe-558e3407a677] succeeded in 0.021057630998257082s: None
2016-08-17 17:29:14,526 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:29:14,938 INFO celery.worker.strategy Received task: schedule_clean_desktops[d595ffc4-cb0d-4405-ad67-b2e76cc0d036]
2016-08-17 17:29:14,939 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:29:14,941 WARNING celery.redirected 2016-08-17 17:29:14,941 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:29:14,942 WARNING celery.redirected 2016-08-17 17:29:14,942 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:29:14,943 WARNING celery.redirected 2016-08-17 17:29:14,942 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:29:14,948 WARNING celery.redirected 2016-08-17 17:29:14,947 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:29:14,949 WARNING celery.redirected 2016-08-17 17:29:14,948 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 28, 14, 940592)}
2016-08-17 17:29:14,951 WARNING celery.redirected 2016-08-17 17:29:14,951 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:29:14,952 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:29:14,958 INFO celery.worker.job Task schedule_clean_desktops[d595ffc4-cb0d-4405-ad67-b2e76cc0d036] succeeded in 0.019066142001975095s: None
2016-08-17 17:29:24,542 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:29:24,542 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:29:24,545 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:29:24,545 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:29:24,550 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:29:24,550 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:29:24,550 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:29:24,551 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:29:59,529 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:29:59,529 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:29:59,529 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:29:59,529 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:29:59,534 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:29:59,534 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:29:59,534 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:29:59,534 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:30:14,523 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:30:15,131 INFO celery.worker.strategy Received task: schedule_start_lesson[a6f048b4-afed-48b4-afc1-a2a22d5f9626]
2016-08-17 17:30:15,132 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:30:15,133 INFO celery Scheduling start lesson tasks
2016-08-17 17:30:15,134 WARNING celery.redirected 2016-08-17 17:30:15,134 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:30:15,135 WARNING celery.redirected 2016-08-17 17:30:15,135 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:30:15,136 WARNING celery.redirected 2016-08-17 17:30:15,136 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:30:15,141 WARNING celery.redirected 2016-08-17 17:30:15,140 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:30:15,142 WARNING celery.redirected 2016-08-17 17:30:15,141 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 30, 15, 137985), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 40, 15, 137985)}
2016-08-17 17:30:15,144 WARNING celery.redirected 2016-08-17 17:30:15,144 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:30:15,146 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:30:15,152 INFO celery.worker.job Task schedule_start_lesson[a6f048b4-afed-48b4-afc1-a2a22d5f9626] succeeded in 0.019816785003058612s: None
2016-08-17 17:30:19,536 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:30:19,887 INFO celery.worker.strategy Received task: schedule_clean_desktops[a3911457-4746-4def-b1be-8542d884fdac]
2016-08-17 17:30:19,888 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:30:19,889 WARNING celery.redirected 2016-08-17 17:30:19,889 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:30:19,890 WARNING celery.redirected 2016-08-17 17:30:19,890 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:30:19,891 WARNING celery.redirected 2016-08-17 17:30:19,891 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:30:19,894 WARNING celery.redirected 2016-08-17 17:30:19,894 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:30:19,894 WARNING celery.redirected 2016-08-17 17:30:19,894 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 29, 19, 888994)}
2016-08-17 17:30:19,897 WARNING celery.redirected 2016-08-17 17:30:19,897 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:30:19,898 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:30:19,905 INFO celery.worker.job Task schedule_clean_desktops[a3911457-4746-4def-b1be-8542d884fdac] succeeded in 0.016849992996867513s: None
2016-08-17 17:30:29,552 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:30:29,552 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:30:29,555 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:30:29,555 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:30:29,560 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:30:29,561 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:30:29,561 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:30:29,561 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:31:04,543 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:31:04,543 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:31:04,543 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:31:04,544 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:31:04,549 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:31:04,549 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:31:04,549 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:31:04,549 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:31:19,542 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:31:20,208 INFO celery.worker.strategy Received task: schedule_start_lesson[300e88fd-b270-45d6-aca1-0e8023edb1d3]
2016-08-17 17:31:20,209 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:31:20,210 INFO celery Scheduling start lesson tasks
2016-08-17 17:31:20,211 WARNING celery.redirected 2016-08-17 17:31:20,211 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:31:20,212 WARNING celery.redirected 2016-08-17 17:31:20,212 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:31:20,213 WARNING celery.redirected 2016-08-17 17:31:20,213 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:31:20,217 WARNING celery.redirected 2016-08-17 17:31:20,217 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:31:20,218 WARNING celery.redirected 2016-08-17 17:31:20,218 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 31, 20, 214626), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 41, 20, 214626)}
2016-08-17 17:31:20,221 WARNING celery.redirected 2016-08-17 17:31:20,220 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:31:20,222 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:31:20,229 INFO celery.worker.job Task schedule_start_lesson[300e88fd-b270-45d6-aca1-0e8023edb1d3] succeeded in 0.02006885999799124s: None
2016-08-17 17:31:24,559 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:31:24,979 INFO celery.worker.strategy Received task: schedule_clean_desktops[a8e4821e-e56b-4182-8007-2d5ebfd46316]
2016-08-17 17:31:24,981 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:31:24,983 WARNING celery.redirected 2016-08-17 17:31:24,983 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:31:24,984 WARNING celery.redirected 2016-08-17 17:31:24,984 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:31:24,985 WARNING celery.redirected 2016-08-17 17:31:24,984 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:31:24,988 WARNING celery.redirected 2016-08-17 17:31:24,988 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:31:24,989 WARNING celery.redirected 2016-08-17 17:31:24,988 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 30, 24, 982383), 'desktop_state_2': 'DELETED'}
2016-08-17 17:31:24,992 WARNING celery.redirected 2016-08-17 17:31:24,992 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:31:24,993 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:31:25,001 INFO celery.worker.job Task schedule_clean_desktops[a8e4821e-e56b-4182-8007-2d5ebfd46316] succeeded in 0.020480492999922717s: None
2016-08-17 17:31:34,576 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:31:34,576 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:31:34,579 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:31:34,579 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:31:34,585 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:31:34,585 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:31:34,585 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:31:34,585 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:32:09,560 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:32:09,560 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:32:09,560 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:32:09,560 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:32:09,565 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:32:09,565 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:32:09,566 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:32:09,566 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:32:24,563 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:32:25,852 INFO celery.worker.strategy Received task: schedule_start_lesson[9abc27c8-26f8-4e71-acae-c972696bf1e1]
2016-08-17 17:32:25,854 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:32:25,854 INFO celery Scheduling start lesson tasks
2016-08-17 17:32:25,855 WARNING celery.redirected 2016-08-17 17:32:25,855 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:32:25,856 WARNING celery.redirected 2016-08-17 17:32:25,856 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:32:25,857 WARNING celery.redirected 2016-08-17 17:32:25,857 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:32:25,861 WARNING celery.redirected 2016-08-17 17:32:25,861 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:32:25,861 WARNING celery.redirected 2016-08-17 17:32:25,861 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 32, 25, 858642), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 42, 25, 858642)}
2016-08-17 17:32:25,863 WARNING celery.redirected 2016-08-17 17:32:25,863 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:32:25,864 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:32:25,873 INFO celery.worker.job Task schedule_start_lesson[9abc27c8-26f8-4e71-acae-c972696bf1e1] succeeded in 0.019266229999630013s: None
2016-08-17 17:32:29,784 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:32:30,686 INFO celery.worker.strategy Received task: schedule_clean_desktops[a17b1044-c9b4-489e-b7c4-34b89fe794b4]
2016-08-17 17:32:30,687 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:32:30,689 WARNING celery.redirected 2016-08-17 17:32:30,689 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:32:30,690 WARNING celery.redirected 2016-08-17 17:32:30,690 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:32:30,691 WARNING celery.redirected 2016-08-17 17:32:30,691 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:32:30,694 WARNING celery.redirected 2016-08-17 17:32:30,694 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:32:30,695 WARNING celery.redirected 2016-08-17 17:32:30,695 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 31, 30, 688427), 'desktop_state_2': 'DELETED'}
2016-08-17 17:32:30,697 WARNING celery.redirected 2016-08-17 17:32:30,697 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:32:30,699 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:32:30,706 INFO celery.worker.job Task schedule_clean_desktops[a17b1044-c9b4-489e-b7c4-34b89fe794b4] succeeded in 0.018894804001320153s: None
2016-08-17 17:32:39,800 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:32:39,800 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:32:39,802 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:32:39,803 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:32:39,808 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:32:39,808 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:32:39,808 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:32:39,808 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:33:14,797 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:33:14,798 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:33:14,799 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:33:14,799 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:33:14,805 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:33:14,805 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:33:14,806 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:33:14,806 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:33:29,798 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:33:30,163 INFO celery.worker.strategy Received task: schedule_start_lesson[ffeb8f71-570e-4d56-b762-ab53bf3e7d74]
2016-08-17 17:33:30,164 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:33:30,164 INFO celery Scheduling start lesson tasks
2016-08-17 17:33:30,165 WARNING celery.redirected 2016-08-17 17:33:30,165 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:33:30,166 WARNING celery.redirected 2016-08-17 17:33:30,166 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:33:30,167 WARNING celery.redirected 2016-08-17 17:33:30,167 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:33:30,171 WARNING celery.redirected 2016-08-17 17:33:30,171 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:33:30,171 WARNING celery.redirected 2016-08-17 17:33:30,171 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 33, 30, 168636), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 43, 30, 168636)}
2016-08-17 17:33:30,173 WARNING celery.redirected 2016-08-17 17:33:30,173 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:33:30,174 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:33:30,182 INFO celery.worker.job Task schedule_start_lesson[ffeb8f71-570e-4d56-b762-ab53bf3e7d74] succeeded in 0.017998398001509486s: None
2016-08-17 17:33:34,819 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:33:35,060 INFO celery.worker.strategy Received task: schedule_clean_desktops[baed9f5b-4d70-4504-9ed9-9c8bbc699f59]
2016-08-17 17:33:35,062 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:33:35,063 WARNING celery.redirected 2016-08-17 17:33:35,063 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:33:35,064 WARNING celery.redirected 2016-08-17 17:33:35,064 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:33:35,064 WARNING celery.redirected 2016-08-17 17:33:35,064 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:33:35,068 WARNING celery.redirected 2016-08-17 17:33:35,067 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:33:35,068 WARNING celery.redirected 2016-08-17 17:33:35,068 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 32, 35, 62702), 'desktop_state_2': 'DELETED'}
2016-08-17 17:33:35,070 WARNING celery.redirected 2016-08-17 17:33:35,070 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:33:35,072 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:33:35,080 INFO celery.worker.job Task schedule_clean_desktops[baed9f5b-4d70-4504-9ed9-9c8bbc699f59] succeeded in 0.01845963600135292s: None
2016-08-17 17:33:44,838 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:33:44,839 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:33:44,842 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:33:44,842 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:33:44,847 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:33:44,847 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:33:44,847 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:33:44,847 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:34:19,838 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:34:19,839 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:34:19,840 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:34:19,840 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:34:19,845 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:34:19,845 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:34:19,845 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:34:19,846 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:34:34,840 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:34:35,539 INFO celery.worker.strategy Received task: schedule_start_lesson[92aaf17b-c092-44fa-a113-a0c5a8dafe30]
2016-08-17 17:34:35,540 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:34:35,541 INFO celery Scheduling start lesson tasks
2016-08-17 17:34:35,542 WARNING celery.redirected 2016-08-17 17:34:35,542 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:34:35,543 WARNING celery.redirected 2016-08-17 17:34:35,543 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:34:35,543 WARNING celery.redirected 2016-08-17 17:34:35,543 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:34:35,547 WARNING celery.redirected 2016-08-17 17:34:35,547 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:34:35,547 WARNING celery.redirected 2016-08-17 17:34:35,547 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 34, 35, 545162), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 44, 35, 545162)}
2016-08-17 17:34:35,549 WARNING celery.redirected 2016-08-17 17:34:35,549 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:34:35,550 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:34:35,559 INFO celery.worker.job Task schedule_start_lesson[92aaf17b-c092-44fa-a113-a0c5a8dafe30] succeeded in 0.018834990998584544s: None
2016-08-17 17:34:39,855 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:34:40,505 INFO celery.worker.strategy Received task: schedule_clean_desktops[0cce9bc7-48fd-4d23-8dec-196169904af6]
2016-08-17 17:34:40,507 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:34:40,512 WARNING celery.redirected 2016-08-17 17:34:40,511 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:34:40,513 WARNING celery.redirected 2016-08-17 17:34:40,513 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:34:40,514 WARNING celery.redirected 2016-08-17 17:34:40,514 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:34:40,518 WARNING celery.redirected 2016-08-17 17:34:40,518 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:34:40,518 WARNING celery.redirected 2016-08-17 17:34:40,518 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 33, 40, 508583)}
2016-08-17 17:34:40,520 WARNING celery.redirected 2016-08-17 17:34:40,520 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:34:40,521 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:34:40,531 INFO celery.worker.job Task schedule_clean_desktops[0cce9bc7-48fd-4d23-8dec-196169904af6] succeeded in 0.024097958998027025s: None
2016-08-17 17:34:49,869 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:34:49,870 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:34:49,877 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:34:49,877 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:34:49,884 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:34:49,885 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:34:49,886 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:34:49,886 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:35:24,875 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:35:24,876 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:35:24,876 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:35:24,876 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:35:24,883 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:35:24,884 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:35:24,884 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:35:24,885 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:35:39,880 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:35:40,618 INFO celery.worker.strategy Received task: schedule_start_lesson[1885b4e1-8c76-4c81-a0a3-f2a36a9a7571]
2016-08-17 17:35:40,620 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:35:40,620 INFO celery Scheduling start lesson tasks
2016-08-17 17:35:40,621 WARNING celery.redirected 2016-08-17 17:35:40,621 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:35:40,622 WARNING celery.redirected 2016-08-17 17:35:40,622 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:35:40,623 WARNING celery.redirected 2016-08-17 17:35:40,623 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:35:40,627 WARNING celery.redirected 2016-08-17 17:35:40,627 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:35:40,628 WARNING celery.redirected 2016-08-17 17:35:40,627 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 35, 40, 624809), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 45, 40, 624809)}
2016-08-17 17:35:40,630 WARNING celery.redirected 2016-08-17 17:35:40,630 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:35:40,631 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:35:40,640 INFO celery.worker.job Task schedule_start_lesson[1885b4e1-8c76-4c81-a0a3-f2a36a9a7571] succeeded in 0.021088116998726036s: None
2016-08-17 17:35:44,964 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:35:45,447 INFO celery.worker.strategy Received task: schedule_clean_desktops[a53280b9-c28b-4d8d-9f66-db5b8da0c4a1]
2016-08-17 17:35:45,449 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:35:45,450 WARNING celery.redirected 2016-08-17 17:35:45,450 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:35:45,451 WARNING celery.redirected 2016-08-17 17:35:45,451 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:35:45,452 WARNING celery.redirected 2016-08-17 17:35:45,452 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:35:45,455 WARNING celery.redirected 2016-08-17 17:35:45,455 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:35:45,456 WARNING celery.redirected 2016-08-17 17:35:45,456 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 34, 45, 449763), 'desktop_state_2': 'DELETED'}
2016-08-17 17:35:45,459 WARNING celery.redirected 2016-08-17 17:35:45,459 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:35:45,460 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:35:45,467 INFO celery.worker.job Task schedule_clean_desktops[a53280b9-c28b-4d8d-9f66-db5b8da0c4a1] succeeded in 0.01850463899972965s: None
2016-08-17 17:35:54,983 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:35:54,984 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:35:54,986 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:35:54,986 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:35:54,992 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:35:54,993 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:35:54,993 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:35:54,993 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:36:29,969 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:36:29,970 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:36:29,971 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:36:29,971 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:36:29,976 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:36:29,976 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:36:29,977 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:36:29,977 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:36:44,969 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:36:45,137 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:36:46,197 INFO celery.worker.strategy Received task: schedule_start_lesson[924cb6e4-13f7-46c8-b293-4fe3f730cbd4]
2016-08-17 17:36:46,199 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:36:46,200 INFO celery Scheduling start lesson tasks
2016-08-17 17:36:46,200 WARNING celery.redirected 2016-08-17 17:36:46,200 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:36:46,201 WARNING celery.redirected 2016-08-17 17:36:46,201 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:36:46,202 WARNING celery.redirected 2016-08-17 17:36:46,202 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:36:46,205 WARNING celery.redirected 2016-08-17 17:36:46,205 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:36:46,206 WARNING celery.redirected 2016-08-17 17:36:46,206 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 36, 46, 203660), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 46, 46, 203660)}
2016-08-17 17:36:46,209 WARNING celery.redirected 2016-08-17 17:36:46,209 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:36:46,211 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:36:46,218 INFO celery.worker.job Task schedule_start_lesson[924cb6e4-13f7-46c8-b293-4fe3f730cbd4] succeeded in 0.019000714000867447s: None
2016-08-17 17:36:46,269 INFO celery.worker.strategy Received task: schedule_clean_desktops[da62fb67-65cf-4fc6-b23b-55e9a3586754]
2016-08-17 17:36:46,270 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:36:46,272 WARNING celery.redirected 2016-08-17 17:36:46,272 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:36:46,273 WARNING celery.redirected 2016-08-17 17:36:46,273 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:36:46,273 WARNING celery.redirected 2016-08-17 17:36:46,273 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:36:46,276 WARNING celery.redirected 2016-08-17 17:36:46,276 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:36:46,277 WARNING celery.redirected 2016-08-17 17:36:46,277 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 35, 46, 271321), 'desktop_state_2': 'DELETED'}
2016-08-17 17:36:46,279 WARNING celery.redirected 2016-08-17 17:36:46,279 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:36:46,280 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:36:46,288 INFO celery.worker.job Task schedule_clean_desktops[da62fb67-65cf-4fc6-b23b-55e9a3586754] succeeded in 0.017911431001266465s: None
2016-08-17 17:37:00,150 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:37:00,151 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:37:00,155 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:37:00,155 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:37:00,163 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:37:00,163 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:37:00,164 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:37:00,164 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:37:35,146 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:37:35,146 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:37:35,147 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:37:35,147 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:37:35,153 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:37:35,153 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:37:35,153 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:37:35,153 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:37:45,145 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:37:45,163 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:37:45,230 INFO celery.worker.strategy Received task: schedule_start_lesson[02283eda-ef82-47b0-8ecc-ea6109551db6]
2016-08-17 17:37:45,231 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:37:45,232 INFO celery Scheduling start lesson tasks
2016-08-17 17:37:45,233 WARNING celery.redirected 2016-08-17 17:37:45,233 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:37:45,234 WARNING celery.redirected 2016-08-17 17:37:45,234 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:37:45,235 WARNING celery.redirected 2016-08-17 17:37:45,234 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:37:45,238 WARNING celery.redirected 2016-08-17 17:37:45,238 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:37:45,239 WARNING celery.redirected 2016-08-17 17:37:45,239 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 37, 45, 236341), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 47, 45, 236341)}
2016-08-17 17:37:45,241 WARNING celery.redirected 2016-08-17 17:37:45,241 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:37:45,242 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:37:45,250 INFO celery.worker.job Task schedule_start_lesson[02283eda-ef82-47b0-8ecc-ea6109551db6] succeeded in 0.018962838999868836s: None
2016-08-17 17:37:45,302 INFO celery.worker.strategy Received task: schedule_clean_desktops[418314dd-9fb5-4403-b73f-c750bcd0431c]
2016-08-17 17:37:45,303 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:37:45,305 WARNING celery.redirected 2016-08-17 17:37:45,304 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:37:45,306 WARNING celery.redirected 2016-08-17 17:37:45,306 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:37:45,307 WARNING celery.redirected 2016-08-17 17:37:45,307 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:37:45,310 WARNING celery.redirected 2016-08-17 17:37:45,310 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:37:45,311 WARNING celery.redirected 2016-08-17 17:37:45,311 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 36, 45, 304136), 'desktop_state_2': 'DELETED'}
2016-08-17 17:37:45,313 WARNING celery.redirected 2016-08-17 17:37:45,313 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:37:45,314 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:37:45,321 INFO celery.worker.job Task schedule_clean_desktops[418314dd-9fb5-4403-b73f-c750bcd0431c] succeeded in 0.018448051003360888s: None
2016-08-17 17:38:05,288 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:38:05,289 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:38:05,291 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:38:05,291 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:38:05,297 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:38:05,298 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:38:05,298 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:38:05,298 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:38:40,277 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:38:40,278 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:38:40,278 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:38:40,278 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:38:40,284 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:38:40,284 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:38:40,284 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:38:40,284 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:38:45,283 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:38:45,304 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:38:46,335 INFO celery.worker.strategy Received task: schedule_start_lesson[b508055a-90fa-4a00-bd74-27319dd7a0f2]
2016-08-17 17:38:46,338 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:38:46,340 INFO celery Scheduling start lesson tasks
2016-08-17 17:38:46,344 WARNING celery.redirected 2016-08-17 17:38:46,344 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:38:46,347 WARNING celery.redirected 2016-08-17 17:38:46,347 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:38:46,347 WARNING celery.redirected 2016-08-17 17:38:46,347 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:38:46,353 WARNING celery.redirected 2016-08-17 17:38:46,353 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:38:46,354 WARNING celery.redirected 2016-08-17 17:38:46,354 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 38, 46, 350249), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 48, 46, 350249)}
2016-08-17 17:38:46,356 WARNING celery.redirected 2016-08-17 17:38:46,356 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:38:46,357 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:38:46,368 INFO celery.worker.job Task schedule_start_lesson[b508055a-90fa-4a00-bd74-27319dd7a0f2] succeeded in 0.03105486799904611s: None
2016-08-17 17:38:46,406 INFO celery.worker.strategy Received task: schedule_clean_desktops[46676685-a785-475f-8d67-53bf5c25472a]
2016-08-17 17:38:46,408 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:38:46,412 WARNING celery.redirected 2016-08-17 17:38:46,411 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:38:46,413 WARNING celery.redirected 2016-08-17 17:38:46,413 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:38:46,414 WARNING celery.redirected 2016-08-17 17:38:46,414 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:38:46,419 WARNING celery.redirected 2016-08-17 17:38:46,419 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:38:46,420 WARNING celery.redirected 2016-08-17 17:38:46,420 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 37, 46, 409672)}
2016-08-17 17:38:46,423 WARNING celery.redirected 2016-08-17 17:38:46,422 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:38:46,424 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:38:46,433 INFO celery.worker.job Task schedule_clean_desktops[46676685-a785-475f-8d67-53bf5c25472a] succeeded in 0.025345199999719625s: None
2016-08-17 17:39:10,303 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:39:10,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:39:10,306 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:39:10,306 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:39:10,311 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:39:10,311 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:39:10,312 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:39:10,312 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:39:45,293 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:39:45,293 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:39:45,293 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:39:45,293 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:39:45,296 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:39:45,433 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:39:45,433 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:39:45,435 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:39:45,436 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:39:45,436 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:39:45,453 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:39:45,453 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:39:45,455 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:39:45,455 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:39:45,458 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:39:45,458 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:39:45,459 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:39:45,459 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:39:46,492 INFO celery.worker.strategy Received task: schedule_start_lesson[c5c6cb1f-d520-4134-9bc4-62ec1140e826]
2016-08-17 17:39:46,495 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:39:46,497 INFO celery Scheduling start lesson tasks
2016-08-17 17:39:46,502 WARNING celery.redirected 2016-08-17 17:39:46,501 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:39:46,504 WARNING celery.redirected 2016-08-17 17:39:46,504 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:39:46,505 WARNING celery.redirected 2016-08-17 17:39:46,505 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:39:46,510 WARNING celery.redirected 2016-08-17 17:39:46,510 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:39:46,511 WARNING celery.redirected 2016-08-17 17:39:46,511 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 39, 46, 507729), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 49, 46, 507729)}
2016-08-17 17:39:46,513 WARNING celery.redirected 2016-08-17 17:39:46,513 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:39:46,514 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:39:46,526 INFO celery.worker.job Task schedule_start_lesson[c5c6cb1f-d520-4134-9bc4-62ec1140e826] succeeded in 0.03166390799742658s: None
2016-08-17 17:39:46,564 INFO celery.worker.strategy Received task: schedule_clean_desktops[53e5ccb4-34b4-459a-abd7-0900e1145d22]
2016-08-17 17:39:46,567 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:39:46,574 WARNING celery.redirected 2016-08-17 17:39:46,574 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:39:46,577 WARNING celery.redirected 2016-08-17 17:39:46,576 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:39:46,577 WARNING celery.redirected 2016-08-17 17:39:46,577 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:39:46,582 WARNING celery.redirected 2016-08-17 17:39:46,582 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:39:46,583 WARNING celery.redirected 2016-08-17 17:39:46,583 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 38, 46, 571066), 'desktop_state_2': 'DELETED'}
2016-08-17 17:39:46,585 WARNING celery.redirected 2016-08-17 17:39:46,585 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:39:46,586 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:39:46,596 INFO celery.worker.job Task schedule_clean_desktops[53e5ccb4-34b4-459a-abd7-0900e1145d22] succeeded in 0.03026536099787336s: None
2016-08-17 17:40:20,433 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:40:20,434 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:40:20,434 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:40:20,434 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:40:20,439 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:40:20,439 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:40:20,440 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:40:20,440 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:40:45,422 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:40:45,440 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:40:45,555 INFO celery.worker.strategy Received task: schedule_start_lesson[2eaab5b8-069c-4baa-9fa5-17d779325ed4]
2016-08-17 17:40:45,557 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:40:45,557 INFO celery Scheduling start lesson tasks
2016-08-17 17:40:45,558 WARNING celery.redirected 2016-08-17 17:40:45,558 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:40:45,559 WARNING celery.redirected 2016-08-17 17:40:45,559 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:40:45,559 WARNING celery.redirected 2016-08-17 17:40:45,559 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:40:45,563 WARNING celery.redirected 2016-08-17 17:40:45,563 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:40:45,564 WARNING celery.redirected 2016-08-17 17:40:45,564 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 40, 45, 561530), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 50, 45, 561530)}
2016-08-17 17:40:45,566 WARNING celery.redirected 2016-08-17 17:40:45,566 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:40:45,567 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:40:45,573 INFO celery.worker.job Task schedule_start_lesson[2eaab5b8-069c-4baa-9fa5-17d779325ed4] succeeded in 0.016919155001232866s: None
2016-08-17 17:40:45,627 INFO celery.worker.strategy Received task: schedule_clean_desktops[0facc5e0-0f1c-4235-be3f-c5a28d253163]
2016-08-17 17:40:45,629 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:40:45,631 WARNING celery.redirected 2016-08-17 17:40:45,631 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:40:45,632 WARNING celery.redirected 2016-08-17 17:40:45,632 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:40:45,633 WARNING celery.redirected 2016-08-17 17:40:45,632 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:40:45,636 WARNING celery.redirected 2016-08-17 17:40:45,636 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:40:45,636 WARNING celery.redirected 2016-08-17 17:40:45,636 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 39, 45, 630729)}
2016-08-17 17:40:45,639 WARNING celery.redirected 2016-08-17 17:40:45,639 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:40:45,640 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:40:45,647 INFO celery.worker.job Task schedule_clean_desktops[0facc5e0-0f1c-4235-be3f-c5a28d253163] succeeded in 0.01808642099786084s: None
2016-08-17 17:40:50,452 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:40:50,452 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:40:50,454 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:40:50,454 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:40:50,459 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:40:50,460 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:40:50,460 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:40:50,460 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:41:25,445 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:41:25,445 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:41:25,445 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:41:25,445 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:41:25,453 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:41:25,453 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:41:25,453 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:41:25,453 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:41:45,443 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:41:45,463 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:41:46,344 INFO celery.worker.strategy Received task: schedule_start_lesson[a0c0b8bc-5ead-4ffd-8d25-1cab94bd95d3]
2016-08-17 17:41:46,346 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:41:46,347 INFO celery Scheduling start lesson tasks
2016-08-17 17:41:46,348 WARNING celery.redirected 2016-08-17 17:41:46,348 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:41:46,349 WARNING celery.redirected 2016-08-17 17:41:46,349 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:41:46,350 WARNING celery.redirected 2016-08-17 17:41:46,349 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:41:46,354 WARNING celery.redirected 2016-08-17 17:41:46,354 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:41:46,355 WARNING celery.redirected 2016-08-17 17:41:46,354 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 41, 46, 351746), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 51, 46, 351746)}
2016-08-17 17:41:46,357 WARNING celery.redirected 2016-08-17 17:41:46,356 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:41:46,358 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:41:46,368 INFO celery.worker.job Task schedule_start_lesson[a0c0b8bc-5ead-4ffd-8d25-1cab94bd95d3] succeeded in 0.021674030998838134s: None
2016-08-17 17:41:46,425 INFO celery.worker.strategy Received task: schedule_clean_desktops[fc898411-1afc-4914-b7a7-6099dea14ee4]
2016-08-17 17:41:46,427 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:41:46,428 WARNING celery.redirected 2016-08-17 17:41:46,428 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:41:46,429 WARNING celery.redirected 2016-08-17 17:41:46,429 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:41:46,430 WARNING celery.redirected 2016-08-17 17:41:46,430 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:41:46,433 WARNING celery.redirected 2016-08-17 17:41:46,433 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:41:46,434 WARNING celery.redirected 2016-08-17 17:41:46,434 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 40, 46, 427919), 'desktop_state_2': 'DELETED'}
2016-08-17 17:41:46,441 WARNING celery.redirected 2016-08-17 17:41:46,440 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:41:46,442 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:41:46,451 INFO celery.worker.job Task schedule_clean_desktops[fc898411-1afc-4914-b7a7-6099dea14ee4] succeeded in 0.024375180000788532s: None
2016-08-17 17:41:55,483 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:41:55,483 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:41:55,486 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:41:55,486 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:41:55,491 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:41:55,491 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:41:55,491 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:41:55,491 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:42:30,482 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:42:30,482 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:42:30,483 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:42:30,483 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:42:30,489 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:42:30,490 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:42:30,490 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:42:30,490 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:42:45,481 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:42:45,500 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:42:45,786 INFO celery.worker.strategy Received task: schedule_start_lesson[6faf34cb-c863-4cd1-aabe-d217fbb70527]
2016-08-17 17:42:45,787 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:42:45,788 INFO celery Scheduling start lesson tasks
2016-08-17 17:42:45,788 WARNING celery.redirected 2016-08-17 17:42:45,788 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:42:45,789 WARNING celery.redirected 2016-08-17 17:42:45,789 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:42:45,790 WARNING celery.redirected 2016-08-17 17:42:45,790 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:42:45,795 WARNING celery.redirected 2016-08-17 17:42:45,795 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:42:45,795 WARNING celery.redirected 2016-08-17 17:42:45,795 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 42, 45, 792044), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 52, 45, 792044)}
2016-08-17 17:42:45,798 WARNING celery.redirected 2016-08-17 17:42:45,797 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:42:45,799 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:42:45,805 INFO celery.worker.job Task schedule_start_lesson[6faf34cb-c863-4cd1-aabe-d217fbb70527] succeeded in 0.018428191000566585s: None
2016-08-17 17:42:45,864 INFO celery.worker.strategy Received task: schedule_clean_desktops[46876bec-f671-4310-9e03-497e04040760]
2016-08-17 17:42:45,865 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:42:45,867 WARNING celery.redirected 2016-08-17 17:42:45,867 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:42:45,868 WARNING celery.redirected 2016-08-17 17:42:45,868 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:42:45,868 WARNING celery.redirected 2016-08-17 17:42:45,868 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:42:45,871 WARNING celery.redirected 2016-08-17 17:42:45,871 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:42:45,872 WARNING celery.redirected 2016-08-17 17:42:45,872 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 41, 45, 866380)}
2016-08-17 17:42:45,874 WARNING celery.redirected 2016-08-17 17:42:45,874 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:42:45,875 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:42:45,885 INFO celery.worker.job Task schedule_clean_desktops[46876bec-f671-4310-9e03-497e04040760] succeeded in 0.020259728000382893s: None
2016-08-17 17:43:00,518 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:43:00,518 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:43:00,521 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:43:00,521 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:43:00,526 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:43:00,526 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:43:00,526 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:43:00,527 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:43:35,515 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:43:35,516 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:43:35,516 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:43:35,516 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:43:35,523 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:43:35,523 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:43:35,523 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:43:35,523 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:43:45,520 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:43:45,765 INFO celery.worker.strategy Received task: schedule_start_lesson[1573c9ed-1a9c-49b5-8631-142b8bdf9ccc]
2016-08-17 17:43:45,766 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:43:45,767 INFO celery Scheduling start lesson tasks
2016-08-17 17:43:45,768 WARNING celery.redirected 2016-08-17 17:43:45,768 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:43:45,769 WARNING celery.redirected 2016-08-17 17:43:45,769 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:43:45,770 WARNING celery.redirected 2016-08-17 17:43:45,770 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:43:45,774 WARNING celery.redirected 2016-08-17 17:43:45,774 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:43:45,775 WARNING celery.redirected 2016-08-17 17:43:45,774 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 43, 45, 771512), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 53, 45, 771512)}
2016-08-17 17:43:45,777 WARNING celery.redirected 2016-08-17 17:43:45,777 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:43:45,780 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:43:45,793 INFO celery.worker.job Task schedule_start_lesson[1573c9ed-1a9c-49b5-8631-142b8bdf9ccc] succeeded in 0.0270089529985853s: None
2016-08-17 17:43:50,537 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:43:51,923 INFO celery.worker.strategy Received task: schedule_clean_desktops[c517f4e5-907c-4324-9e9e-dddfc98ce22e]
2016-08-17 17:43:51,924 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:43:51,926 WARNING celery.redirected 2016-08-17 17:43:51,926 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:43:51,929 WARNING celery.redirected 2016-08-17 17:43:51,929 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:43:51,930 WARNING celery.redirected 2016-08-17 17:43:51,930 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:43:51,933 WARNING celery.redirected 2016-08-17 17:43:51,933 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:43:51,934 WARNING celery.redirected 2016-08-17 17:43:51,934 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 42, 51, 925040), 'desktop_state_2': 'DELETED'}
2016-08-17 17:43:51,936 WARNING celery.redirected 2016-08-17 17:43:51,936 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:43:51,937 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:43:51,945 INFO celery.worker.job Task schedule_clean_desktops[c517f4e5-907c-4324-9e9e-dddfc98ce22e] succeeded in 0.020814297000470106s: None
2016-08-17 17:44:05,902 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:44:05,902 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:44:05,906 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:44:05,906 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:44:05,912 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:44:05,912 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:44:05,912 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:44:05,912 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:44:40,888 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:44:40,888 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:44:40,889 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:44:40,889 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:44:40,894 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:44:40,894 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:44:40,894 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:44:40,894 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:44:50,889 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:44:51,096 INFO celery.worker.strategy Received task: schedule_start_lesson[a721bbd0-3a9b-491e-85c6-0ffba0bb7186]
2016-08-17 17:44:51,097 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:44:51,098 INFO celery Scheduling start lesson tasks
2016-08-17 17:44:51,099 WARNING celery.redirected 2016-08-17 17:44:51,099 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:44:51,100 WARNING celery.redirected 2016-08-17 17:44:51,100 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:44:51,100 WARNING celery.redirected 2016-08-17 17:44:51,100 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:44:51,104 WARNING celery.redirected 2016-08-17 17:44:51,104 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:44:51,105 WARNING celery.redirected 2016-08-17 17:44:51,105 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 44, 51, 102308), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 54, 51, 102308)}
2016-08-17 17:44:51,107 WARNING celery.redirected 2016-08-17 17:44:51,107 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:44:51,108 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:44:51,121 INFO celery.worker.job Task schedule_start_lesson[a721bbd0-3a9b-491e-85c6-0ffba0bb7186] succeeded in 0.024205862999224337s: None
2016-08-17 17:44:55,906 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:44:55,966 INFO celery.worker.strategy Received task: schedule_clean_desktops[56b3fbab-95f2-44f6-a551-5c634a0ec833]
2016-08-17 17:44:55,970 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:44:55,972 WARNING celery.redirected 2016-08-17 17:44:55,971 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:44:55,973 WARNING celery.redirected 2016-08-17 17:44:55,973 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:44:55,974 WARNING celery.redirected 2016-08-17 17:44:55,974 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:44:55,978 WARNING celery.redirected 2016-08-17 17:44:55,977 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:44:55,978 WARNING celery.redirected 2016-08-17 17:44:55,978 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 43, 55, 971191), 'desktop_state_2': 'DELETED'}
2016-08-17 17:44:55,984 WARNING celery.redirected 2016-08-17 17:44:55,983 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:44:55,987 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:44:55,994 INFO celery.worker.job Task schedule_clean_desktops[56b3fbab-95f2-44f6-a551-5c634a0ec833] succeeded in 0.024764861998846754s: None
2016-08-17 17:45:10,957 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:45:10,958 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:45:10,961 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:45:10,961 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:45:10,967 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:45:10,968 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:45:10,968 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:45:10,968 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:45:45,953 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:45:45,954 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:45:45,954 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:45:45,954 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:45:45,960 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:45:45,960 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:45:45,960 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:45:45,960 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:45:55,956 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:45:56,636 INFO celery.worker.strategy Received task: schedule_start_lesson[f5419d9f-abd7-41b2-930a-f7524452a9ca]
2016-08-17 17:45:56,637 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:45:56,638 INFO celery Scheduling start lesson tasks
2016-08-17 17:45:56,639 WARNING celery.redirected 2016-08-17 17:45:56,639 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:45:56,640 WARNING celery.redirected 2016-08-17 17:45:56,640 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:45:56,641 WARNING celery.redirected 2016-08-17 17:45:56,641 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:45:56,645 WARNING celery.redirected 2016-08-17 17:45:56,645 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:45:56,645 WARNING celery.redirected 2016-08-17 17:45:56,645 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 45, 56, 642750), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 55, 56, 642750)}
2016-08-17 17:45:56,647 WARNING celery.redirected 2016-08-17 17:45:56,647 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:45:56,649 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:45:56,661 INFO celery.worker.job Task schedule_start_lesson[f5419d9f-abd7-41b2-930a-f7524452a9ca] succeeded in 0.023896662998595275s: None
2016-08-17 17:46:00,974 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:46:01,462 INFO celery.worker.strategy Received task: schedule_clean_desktops[cb40c094-3fe6-4efe-9e75-a5ad00414046]
2016-08-17 17:46:01,463 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:46:01,465 WARNING celery.redirected 2016-08-17 17:46:01,465 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:46:01,466 WARNING celery.redirected 2016-08-17 17:46:01,466 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:46:01,466 WARNING celery.redirected 2016-08-17 17:46:01,466 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:46:01,470 WARNING celery.redirected 2016-08-17 17:46:01,469 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:46:01,471 WARNING celery.redirected 2016-08-17 17:46:01,470 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 45, 1, 464426), 'desktop_state_2': 'DELETED'}
2016-08-17 17:46:01,473 WARNING celery.redirected 2016-08-17 17:46:01,472 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:46:01,474 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:46:01,481 INFO celery.worker.job Task schedule_clean_desktops[cb40c094-3fe6-4efe-9e75-a5ad00414046] succeeded in 0.01805754500310286s: None
2016-08-17 17:46:15,989 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:46:15,989 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:46:15,993 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:46:15,993 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:46:15,999 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:46:15,999 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:46:15,999 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:46:16,000 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:46:50,991 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:46:50,991 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:46:50,992 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:46:50,992 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:46:50,996 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:46:50,997 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:46:50,997 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:46:50,997 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:47:00,992 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:47:01,015 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:47:01,956 INFO celery.worker.strategy Received task: schedule_start_lesson[5548fc95-a33d-4554-937a-c868cc337397]
2016-08-17 17:47:01,958 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:47:01,958 INFO celery Scheduling start lesson tasks
2016-08-17 17:47:01,959 WARNING celery.redirected 2016-08-17 17:47:01,959 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:47:01,960 WARNING celery.redirected 2016-08-17 17:47:01,960 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:47:01,961 WARNING celery.redirected 2016-08-17 17:47:01,961 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:47:01,964 WARNING celery.redirected 2016-08-17 17:47:01,964 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:47:01,965 WARNING celery.redirected 2016-08-17 17:47:01,965 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 47, 1, 962615), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 57, 1, 962615)}
2016-08-17 17:47:01,967 WARNING celery.redirected 2016-08-17 17:47:01,967 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:47:01,968 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:47:01,976 INFO celery.worker.job Task schedule_start_lesson[5548fc95-a33d-4554-937a-c868cc337397] succeeded in 0.018690807999519166s: None
2016-08-17 17:47:02,028 INFO celery.worker.strategy Received task: schedule_clean_desktops[0f8e5021-66b2-4c36-8a29-17be29dbd68d]
2016-08-17 17:47:02,030 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:47:02,031 WARNING celery.redirected 2016-08-17 17:47:02,031 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:47:02,032 WARNING celery.redirected 2016-08-17 17:47:02,032 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:47:02,033 WARNING celery.redirected 2016-08-17 17:47:02,033 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:47:02,036 WARNING celery.redirected 2016-08-17 17:47:02,036 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:47:02,036 WARNING celery.redirected 2016-08-17 17:47:02,036 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 46, 2, 30962), 'desktop_state_2': 'DELETED'}
2016-08-17 17:47:02,039 WARNING celery.redirected 2016-08-17 17:47:02,039 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:47:02,040 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:47:02,048 INFO celery.worker.job Task schedule_clean_desktops[0f8e5021-66b2-4c36-8a29-17be29dbd68d] succeeded in 0.018201287999545457s: None
2016-08-17 17:47:21,028 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:47:21,028 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:47:21,032 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:47:21,032 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:47:21,037 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:47:21,038 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:47:21,038 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:47:21,038 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:47:56,034 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:47:56,035 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:47:56,035 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:47:56,035 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:47:56,041 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:47:56,041 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:47:56,042 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:47:56,042 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:48:01,040 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:48:01,239 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:48:02,308 INFO celery.worker.strategy Received task: schedule_start_lesson[7a61c16a-2d5b-4f1c-aafb-d4451ef4dddc]
2016-08-17 17:48:02,310 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:48:02,311 INFO celery Scheduling start lesson tasks
2016-08-17 17:48:02,312 WARNING celery.redirected 2016-08-17 17:48:02,311 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:48:02,313 WARNING celery.redirected 2016-08-17 17:48:02,312 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:48:02,313 WARNING celery.redirected 2016-08-17 17:48:02,313 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:48:02,316 WARNING celery.redirected 2016-08-17 17:48:02,316 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:48:02,317 WARNING celery.redirected 2016-08-17 17:48:02,317 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 48, 2, 314722), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 58, 2, 314722)}
2016-08-17 17:48:02,319 WARNING celery.redirected 2016-08-17 17:48:02,319 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:48:02,320 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:48:02,328 INFO celery.worker.job Task schedule_start_lesson[7a61c16a-2d5b-4f1c-aafb-d4451ef4dddc] succeeded in 0.01827758699801052s: None
2016-08-17 17:48:02,389 INFO celery.worker.strategy Received task: schedule_clean_desktops[4b364825-2e63-4a76-986e-bc05a2a15abe]
2016-08-17 17:48:02,390 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:48:02,392 WARNING celery.redirected 2016-08-17 17:48:02,392 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:48:02,393 WARNING celery.redirected 2016-08-17 17:48:02,393 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:48:02,394 WARNING celery.redirected 2016-08-17 17:48:02,394 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:48:02,398 WARNING celery.redirected 2016-08-17 17:48:02,397 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:48:02,398 WARNING celery.redirected 2016-08-17 17:48:02,398 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 47, 2, 391791)}
2016-08-17 17:48:02,400 WARNING celery.redirected 2016-08-17 17:48:02,400 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:48:02,401 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:48:02,413 INFO celery.worker.job Task schedule_clean_desktops[4b364825-2e63-4a76-986e-bc05a2a15abe] succeeded in 0.022405514999263687s: None
2016-08-17 17:48:26,253 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:48:26,253 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:48:26,257 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:48:26,257 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:48:26,263 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:48:26,263 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:48:26,263 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:48:26,264 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:49:01,245 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:49:01,246 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:49:01,246 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:49:01,246 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:49:01,250 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:49:01,271 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:49:01,271 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:49:01,274 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:49:01,274 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:49:01,274 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:49:01,295 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:49:01,295 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:49:01,297 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:49:01,297 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:49:01,301 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:49:01,301 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:49:01,301 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:49:01,301 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:49:02,020 INFO celery.worker.strategy Received task: schedule_start_lesson[6c4be278-71df-4f87-bc37-e4b25147ccdd]
2016-08-17 17:49:02,022 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:49:02,023 INFO celery Scheduling start lesson tasks
2016-08-17 17:49:02,024 WARNING celery.redirected 2016-08-17 17:49:02,024 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:49:02,025 WARNING celery.redirected 2016-08-17 17:49:02,025 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:49:02,026 WARNING celery.redirected 2016-08-17 17:49:02,025 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:49:02,030 WARNING celery.redirected 2016-08-17 17:49:02,029 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:49:02,031 WARNING celery.redirected 2016-08-17 17:49:02,030 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 49, 2, 27559), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(17, 59, 2, 27559)}
2016-08-17 17:49:02,032 WARNING celery.redirected 2016-08-17 17:49:02,032 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:49:02,033 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:49:02,042 INFO celery.worker.job Task schedule_start_lesson[6c4be278-71df-4f87-bc37-e4b25147ccdd] succeeded in 0.01989152200258104s: None
2016-08-17 17:49:02,102 INFO celery.worker.strategy Received task: schedule_clean_desktops[152e0efd-3b07-4bc7-96a9-591b8a6ea11d]
2016-08-17 17:49:02,104 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:49:02,105 WARNING celery.redirected 2016-08-17 17:49:02,105 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:49:02,107 WARNING celery.redirected 2016-08-17 17:49:02,106 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:49:02,107 WARNING celery.redirected 2016-08-17 17:49:02,107 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:49:02,115 WARNING celery.redirected 2016-08-17 17:49:02,115 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:49:02,115 WARNING celery.redirected 2016-08-17 17:49:02,115 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 48, 2, 104756)}
2016-08-17 17:49:02,117 WARNING celery.redirected 2016-08-17 17:49:02,117 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:49:02,119 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:49:02,127 INFO celery.worker.job Task schedule_clean_desktops[152e0efd-3b07-4bc7-96a9-591b8a6ea11d] succeeded in 0.023145260001911083s: None
2016-08-17 17:49:36,281 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:49:36,282 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:49:36,282 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:49:36,282 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:49:36,288 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:49:36,288 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:49:36,288 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:49:36,288 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:50:01,275 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:50:01,294 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:50:02,308 INFO celery.worker.strategy Received task: schedule_start_lesson[094c7ed4-0eaf-442a-a269-719bf7e9b9bc]
2016-08-17 17:50:02,310 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:50:02,310 INFO celery Scheduling start lesson tasks
2016-08-17 17:50:02,311 WARNING celery.redirected 2016-08-17 17:50:02,311 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:50:02,312 WARNING celery.redirected 2016-08-17 17:50:02,312 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:50:02,313 WARNING celery.redirected 2016-08-17 17:50:02,312 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:50:02,316 WARNING celery.redirected 2016-08-17 17:50:02,316 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:50:02,317 WARNING celery.redirected 2016-08-17 17:50:02,317 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 50, 2, 314434), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 0, 2, 314434)}
2016-08-17 17:50:02,319 WARNING celery.redirected 2016-08-17 17:50:02,319 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:50:02,320 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:50:02,327 INFO celery.worker.job Task schedule_start_lesson[094c7ed4-0eaf-442a-a269-719bf7e9b9bc] succeeded in 0.01736774399978458s: None
2016-08-17 17:50:02,393 INFO celery.worker.strategy Received task: schedule_clean_desktops[771f37dd-2404-42cf-8199-38a6e52771ac]
2016-08-17 17:50:02,394 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:50:02,395 WARNING celery.redirected 2016-08-17 17:50:02,395 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:50:02,396 WARNING celery.redirected 2016-08-17 17:50:02,396 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:50:02,397 WARNING celery.redirected 2016-08-17 17:50:02,397 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:50:02,400 WARNING celery.redirected 2016-08-17 17:50:02,400 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:50:02,400 WARNING celery.redirected 2016-08-17 17:50:02,400 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 49, 2, 394957), 'desktop_state_2': 'DELETED'}
2016-08-17 17:50:02,402 WARNING celery.redirected 2016-08-17 17:50:02,402 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:50:02,404 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:50:02,411 INFO celery.worker.job Task schedule_clean_desktops[771f37dd-2404-42cf-8199-38a6e52771ac] succeeded in 0.01784971599772689s: None
2016-08-17 17:50:06,310 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:50:06,310 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:50:06,312 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:50:06,313 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:50:06,319 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:50:06,319 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:50:06,320 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:50:06,320 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:50:41,307 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:50:41,308 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:50:41,311 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:50:41,311 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:50:41,322 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:50:41,322 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:50:41,322 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:50:41,323 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:51:01,309 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:51:01,326 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:51:01,936 INFO celery.worker.strategy Received task: schedule_start_lesson[0bf2205c-f7f7-4441-b0bf-e167bf97e9eb]
2016-08-17 17:51:01,937 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:51:01,938 INFO celery Scheduling start lesson tasks
2016-08-17 17:51:01,939 WARNING celery.redirected 2016-08-17 17:51:01,939 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:51:01,940 WARNING celery.redirected 2016-08-17 17:51:01,940 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:51:01,941 WARNING celery.redirected 2016-08-17 17:51:01,941 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:51:01,945 WARNING celery.redirected 2016-08-17 17:51:01,945 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:51:01,946 WARNING celery.redirected 2016-08-17 17:51:01,946 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 51, 1, 942421), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 1, 1, 942421)}
2016-08-17 17:51:01,948 WARNING celery.redirected 2016-08-17 17:51:01,948 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:51:01,949 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:51:01,957 INFO celery.worker.job Task schedule_start_lesson[0bf2205c-f7f7-4441-b0bf-e167bf97e9eb] succeeded in 0.019970392000686843s: None
2016-08-17 17:51:02,011 INFO celery.worker.strategy Received task: schedule_clean_desktops[85b42bbd-a208-4e0b-8031-59cf07634313]
2016-08-17 17:51:02,013 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:51:02,014 WARNING celery.redirected 2016-08-17 17:51:02,014 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:51:02,015 WARNING celery.redirected 2016-08-17 17:51:02,015 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:51:02,016 WARNING celery.redirected 2016-08-17 17:51:02,016 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:51:02,020 WARNING celery.redirected 2016-08-17 17:51:02,020 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:51:02,020 WARNING celery.redirected 2016-08-17 17:51:02,020 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 50, 2, 13846), 'desktop_state_2': 'DELETED'}
2016-08-17 17:51:02,022 WARNING celery.redirected 2016-08-17 17:51:02,022 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:51:02,023 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:51:02,032 INFO celery.worker.job Task schedule_clean_desktops[85b42bbd-a208-4e0b-8031-59cf07634313] succeeded in 0.018959911998535972s: None
2016-08-17 17:51:11,341 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:51:11,341 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:51:11,344 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:51:11,344 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:51:11,349 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:51:11,349 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:51:11,350 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:51:11,350 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:51:46,336 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:51:46,336 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:51:46,336 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:51:46,336 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:51:46,341 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:51:46,342 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:51:46,342 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:51:46,342 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:52:01,332 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:52:01,349 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:52:02,267 INFO celery.worker.strategy Received task: schedule_start_lesson[259a0933-c705-4ad1-97dc-d9364c97ec2d]
2016-08-17 17:52:02,268 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:52:02,269 INFO celery Scheduling start lesson tasks
2016-08-17 17:52:02,270 WARNING celery.redirected 2016-08-17 17:52:02,270 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:52:02,271 WARNING celery.redirected 2016-08-17 17:52:02,271 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:52:02,271 WARNING celery.redirected 2016-08-17 17:52:02,271 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:52:02,277 WARNING celery.redirected 2016-08-17 17:52:02,277 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:52:02,278 WARNING celery.redirected 2016-08-17 17:52:02,278 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 52, 2, 273622), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 2, 2, 273622)}
2016-08-17 17:52:02,283 WARNING celery.redirected 2016-08-17 17:52:02,282 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:52:02,286 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:52:02,305 INFO celery.worker.job Task schedule_start_lesson[259a0933-c705-4ad1-97dc-d9364c97ec2d] succeeded in 0.03722008800104959s: None
2016-08-17 17:52:02,474 INFO celery.worker.strategy Received task: schedule_clean_desktops[19e22e37-3a81-4fc0-bc35-06806efbb82e]
2016-08-17 17:52:02,475 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:52:02,478 WARNING celery.redirected 2016-08-17 17:52:02,478 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:52:02,481 WARNING celery.redirected 2016-08-17 17:52:02,480 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:52:02,486 WARNING celery.redirected 2016-08-17 17:52:02,485 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:52:02,499 WARNING celery.redirected 2016-08-17 17:52:02,499 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:52:02,502 WARNING celery.redirected 2016-08-17 17:52:02,501 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 51, 2, 476995), 'desktop_state_2': 'DELETED'}
2016-08-17 17:52:02,506 WARNING celery.redirected 2016-08-17 17:52:02,506 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:52:02,513 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:52:02,539 INFO celery.worker.job Task schedule_clean_desktops[19e22e37-3a81-4fc0-bc35-06806efbb82e] succeeded in 0.06351192100191838s: None
2016-08-17 17:52:16,359 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:52:16,360 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:52:16,362 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:52:16,362 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:52:16,368 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:52:16,369 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:52:16,369 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:52:16,369 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:52:51,357 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:52:51,357 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:52:51,357 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:52:51,357 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:52:51,362 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:52:51,363 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:52:51,363 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:52:51,363 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:53:01,354 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:53:01,375 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:53:02,085 INFO celery.worker.strategy Received task: schedule_start_lesson[ae9adbc8-dd63-4a32-b20e-4cb7784678b9]
2016-08-17 17:53:02,088 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:53:02,090 INFO celery Scheduling start lesson tasks
2016-08-17 17:53:02,091 WARNING celery.redirected 2016-08-17 17:53:02,091 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:53:02,092 WARNING celery.redirected 2016-08-17 17:53:02,092 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:53:02,093 WARNING celery.redirected 2016-08-17 17:53:02,092 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:53:02,097 WARNING celery.redirected 2016-08-17 17:53:02,097 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:53:02,098 WARNING celery.redirected 2016-08-17 17:53:02,098 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 53, 2, 94549), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 3, 2, 94549)}
2016-08-17 17:53:02,101 WARNING celery.redirected 2016-08-17 17:53:02,101 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:53:02,102 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:53:02,111 INFO celery.worker.job Task schedule_start_lesson[ae9adbc8-dd63-4a32-b20e-4cb7784678b9] succeeded in 0.02252006499838899s: None
2016-08-17 17:53:02,238 INFO celery.worker.strategy Received task: schedule_clean_desktops[8e671e5f-109f-4426-a45f-37527343d7cc]
2016-08-17 17:53:02,240 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:53:02,243 WARNING celery.redirected 2016-08-17 17:53:02,243 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:53:02,245 WARNING celery.redirected 2016-08-17 17:53:02,245 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:53:02,247 WARNING celery.redirected 2016-08-17 17:53:02,246 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:53:02,259 WARNING celery.redirected 2016-08-17 17:53:02,258 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:53:02,260 WARNING celery.redirected 2016-08-17 17:53:02,259 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 52, 2, 241964)}
2016-08-17 17:53:02,270 WARNING celery.redirected 2016-08-17 17:53:02,270 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:53:02,273 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:53:02,305 INFO celery.worker.job Task schedule_clean_desktops[8e671e5f-109f-4426-a45f-37527343d7cc] succeeded in 0.06510248099948512s: None
2016-08-17 17:53:21,395 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:53:21,397 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:53:21,410 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:53:21,410 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:53:21,429 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:53:21,429 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:53:21,430 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:53:21,430 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:53:51,429 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:53:51,430 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:53:51,430 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:53:51,430 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:53:51,439 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:53:51,440 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:53:51,440 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:53:51,440 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:54:01,433 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:54:01,453 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:54:01,757 INFO celery.worker.strategy Received task: schedule_start_lesson[722cb124-ae0d-4efe-bcfd-0bb02db7e577]
2016-08-17 17:54:01,758 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:54:01,759 INFO celery Scheduling start lesson tasks
2016-08-17 17:54:01,760 WARNING celery.redirected 2016-08-17 17:54:01,760 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:54:01,762 WARNING celery.redirected 2016-08-17 17:54:01,761 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:54:01,762 WARNING celery.redirected 2016-08-17 17:54:01,762 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:54:01,767 WARNING celery.redirected 2016-08-17 17:54:01,767 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:54:01,768 WARNING celery.redirected 2016-08-17 17:54:01,767 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 54, 1, 764136), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 4, 1, 764136)}
2016-08-17 17:54:01,770 WARNING celery.redirected 2016-08-17 17:54:01,770 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:54:01,771 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:54:01,781 INFO celery.worker.job Task schedule_start_lesson[722cb124-ae0d-4efe-bcfd-0bb02db7e577] succeeded in 0.02275394000025699s: None
2016-08-17 17:54:01,842 INFO celery.worker.strategy Received task: schedule_clean_desktops[a0cd0c1b-cd32-4353-8a85-5a6de638e57b]
2016-08-17 17:54:01,843 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:54:01,845 WARNING celery.redirected 2016-08-17 17:54:01,845 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:54:01,846 WARNING celery.redirected 2016-08-17 17:54:01,846 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:54:01,847 WARNING celery.redirected 2016-08-17 17:54:01,847 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:54:01,851 WARNING celery.redirected 2016-08-17 17:54:01,850 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:54:01,852 WARNING celery.redirected 2016-08-17 17:54:01,852 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 53, 1, 844419), 'desktop_state_2': 'DELETED'}
2016-08-17 17:54:01,858 WARNING celery.redirected 2016-08-17 17:54:01,857 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:54:01,860 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:54:01,869 INFO celery.worker.job Task schedule_clean_desktops[a0cd0c1b-cd32-4353-8a85-5a6de638e57b] succeeded in 0.025837478999164887s: None
2016-08-17 17:54:21,473 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:54:21,474 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:54:21,478 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:54:21,478 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:54:21,488 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:54:21,488 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:54:21,488 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:54:21,488 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:54:56,464 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:54:56,465 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:54:56,466 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:54:56,466 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:54:56,471 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:54:56,471 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:54:56,472 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:54:56,472 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:55:01,470 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:55:01,490 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:55:01,765 INFO celery.worker.strategy Received task: schedule_start_lesson[fc955719-9501-4c16-a701-dd4b13bfbbd9]
2016-08-17 17:55:01,766 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:55:01,767 INFO celery Scheduling start lesson tasks
2016-08-17 17:55:01,768 WARNING celery.redirected 2016-08-17 17:55:01,767 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:55:01,769 WARNING celery.redirected 2016-08-17 17:55:01,769 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:55:01,770 WARNING celery.redirected 2016-08-17 17:55:01,769 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:55:01,773 WARNING celery.redirected 2016-08-17 17:55:01,773 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:55:01,774 WARNING celery.redirected 2016-08-17 17:55:01,774 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 55, 1, 771397), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 5, 1, 771397)}
2016-08-17 17:55:01,776 WARNING celery.redirected 2016-08-17 17:55:01,776 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:55:01,777 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:55:01,798 INFO celery.worker.job Task schedule_start_lesson[fc955719-9501-4c16-a701-dd4b13bfbbd9] succeeded in 0.03167753499656101s: None
2016-08-17 17:55:01,851 INFO celery.worker.strategy Received task: schedule_clean_desktops[b90c4903-38b9-497a-b10c-825bdcca64a3]
2016-08-17 17:55:01,852 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:55:01,855 WARNING celery.redirected 2016-08-17 17:55:01,855 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:55:01,857 WARNING celery.redirected 2016-08-17 17:55:01,857 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:55:01,858 WARNING celery.redirected 2016-08-17 17:55:01,858 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:55:01,862 WARNING celery.redirected 2016-08-17 17:55:01,862 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:55:01,862 WARNING celery.redirected 2016-08-17 17:55:01,862 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 54, 1, 853783)}
2016-08-17 17:55:01,864 WARNING celery.redirected 2016-08-17 17:55:01,864 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:55:01,865 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:55:01,873 INFO celery.worker.job Task schedule_clean_desktops[b90c4903-38b9-497a-b10c-825bdcca64a3] succeeded in 0.021096905999002047s: None
2016-08-17 17:55:26,496 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:55:26,497 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:55:26,500 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:55:26,501 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:55:26,505 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:55:26,506 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:55:26,506 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:55:26,506 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:56:01,487 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:56:01,488 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:56:01,489 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:56:01,489 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:56:01,491 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:56:01,507 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:56:01,508 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:56:01,510 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:56:01,511 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:56:01,511 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:56:01,527 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:56:01,527 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:56:01,529 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:56:01,530 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:56:01,533 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:56:01,533 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:56:01,533 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:56:01,534 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:56:02,032 INFO celery.worker.strategy Received task: schedule_start_lesson[b0b12949-4aa3-4c17-9cec-c8351735bc54]
2016-08-17 17:56:02,033 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:56:02,034 INFO celery Scheduling start lesson tasks
2016-08-17 17:56:02,035 WARNING celery.redirected 2016-08-17 17:56:02,035 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:56:02,036 WARNING celery.redirected 2016-08-17 17:56:02,036 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:56:02,036 WARNING celery.redirected 2016-08-17 17:56:02,036 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:56:02,040 WARNING celery.redirected 2016-08-17 17:56:02,040 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:56:02,040 WARNING celery.redirected 2016-08-17 17:56:02,040 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 56, 2, 38089), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 6, 2, 38089)}
2016-08-17 17:56:02,042 WARNING celery.redirected 2016-08-17 17:56:02,042 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:56:02,043 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:56:02,054 INFO celery.worker.job Task schedule_start_lesson[b0b12949-4aa3-4c17-9cec-c8351735bc54] succeeded in 0.02099519799958216s: None
2016-08-17 17:56:02,103 INFO celery.worker.strategy Received task: schedule_clean_desktops[0bd2ea44-8df7-40db-8635-34fa3ecda5ce]
2016-08-17 17:56:02,104 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:56:02,106 WARNING celery.redirected 2016-08-17 17:56:02,106 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:56:02,107 WARNING celery.redirected 2016-08-17 17:56:02,107 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:56:02,107 WARNING celery.redirected 2016-08-17 17:56:02,107 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:56:02,110 WARNING celery.redirected 2016-08-17 17:56:02,110 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:56:02,111 WARNING celery.redirected 2016-08-17 17:56:02,111 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 55, 2, 105384), 'desktop_state_2': 'DELETED'}
2016-08-17 17:56:02,113 WARNING celery.redirected 2016-08-17 17:56:02,113 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:56:02,114 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:56:02,122 INFO celery.worker.job Task schedule_clean_desktops[0bd2ea44-8df7-40db-8635-34fa3ecda5ce] succeeded in 0.017851614000392146s: None
2016-08-17 17:56:36,520 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:56:36,520 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:56:36,520 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:56:36,520 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:56:36,526 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:56:36,526 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:56:36,527 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:56:36,527 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:57:01,514 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:57:02,118 INFO celery.worker.strategy Received task: schedule_start_lesson[61d383b8-1aba-4537-ad50-4e280011b352]
2016-08-17 17:57:02,119 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:57:02,120 INFO celery Scheduling start lesson tasks
2016-08-17 17:57:02,121 WARNING celery.redirected 2016-08-17 17:57:02,121 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:57:02,122 WARNING celery.redirected 2016-08-17 17:57:02,122 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:57:02,122 WARNING celery.redirected 2016-08-17 17:57:02,122 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:57:02,126 WARNING celery.redirected 2016-08-17 17:57:02,126 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:57:02,127 WARNING celery.redirected 2016-08-17 17:57:02,127 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 57, 2, 124292), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 7, 2, 124292)}
2016-08-17 17:57:02,131 WARNING celery.redirected 2016-08-17 17:57:02,130 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:57:02,133 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:57:02,140 INFO celery.worker.job Task schedule_start_lesson[61d383b8-1aba-4537-ad50-4e280011b352] succeeded in 0.021327729999029543s: None
2016-08-17 17:57:06,533 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:57:06,534 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:57:06,537 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:57:06,538 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:57:06,541 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:57:06,562 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:57:06,562 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:57:06,566 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:57:06,566 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:57:06,571 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:57:06,572 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:57:06,572 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:57:06,572 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:57:07,381 INFO celery.worker.strategy Received task: schedule_clean_desktops[6fc0464c-735c-4431-b1f0-a5a227be0657]
2016-08-17 17:57:07,383 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:57:07,386 WARNING celery.redirected 2016-08-17 17:57:07,385 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:57:07,389 WARNING celery.redirected 2016-08-17 17:57:07,388 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:57:07,390 WARNING celery.redirected 2016-08-17 17:57:07,390 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:57:07,396 WARNING celery.redirected 2016-08-17 17:57:07,396 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:57:07,398 WARNING celery.redirected 2016-08-17 17:57:07,398 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 56, 7, 384881)}
2016-08-17 17:57:07,401 WARNING celery.redirected 2016-08-17 17:57:07,401 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:57:07,403 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:57:07,418 INFO celery.worker.job Task schedule_clean_desktops[6fc0464c-735c-4431-b1f0-a5a227be0657] succeeded in 0.03464430500025628s: None
2016-08-17 17:57:41,559 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:57:41,560 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:57:41,561 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:57:41,561 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:57:41,575 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:57:41,575 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:57:41,576 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:57:41,576 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:58:06,569 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:58:07,082 INFO celery.worker.strategy Received task: schedule_start_lesson[cd563e33-8839-495a-b4de-042159b1bf35]
2016-08-17 17:58:07,086 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:58:07,089 INFO celery Scheduling start lesson tasks
2016-08-17 17:58:07,092 WARNING celery.redirected 2016-08-17 17:58:07,091 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:58:07,093 WARNING celery.redirected 2016-08-17 17:58:07,093 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:58:07,093 WARNING celery.redirected 2016-08-17 17:58:07,093 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:58:07,100 WARNING celery.redirected 2016-08-17 17:58:07,099 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:58:07,101 WARNING celery.redirected 2016-08-17 17:58:07,100 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 58, 7, 96373), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 8, 7, 96373)}
2016-08-17 17:58:07,104 WARNING celery.redirected 2016-08-17 17:58:07,104 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:58:07,105 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:58:07,124 INFO celery.worker.job Task schedule_start_lesson[cd563e33-8839-495a-b4de-042159b1bf35] succeeded in 0.039463515000534244s: None
2016-08-17 17:58:11,591 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:58:11,591 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:58:11,594 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:58:11,594 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:58:11,596 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:58:11,617 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:58:11,617 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:58:11,621 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:58:11,621 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:58:11,626 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:58:11,626 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:58:11,626 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:58:11,626 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:58:12,021 INFO celery.worker.strategy Received task: schedule_clean_desktops[8be52417-0a91-4970-9149-dc093d93599c]
2016-08-17 17:58:12,024 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:58:12,027 WARNING celery.redirected 2016-08-17 17:58:12,027 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:58:12,029 WARNING celery.redirected 2016-08-17 17:58:12,029 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:58:12,030 WARNING celery.redirected 2016-08-17 17:58:12,030 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:58:12,037 WARNING celery.redirected 2016-08-17 17:58:12,037 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:58:12,038 WARNING celery.redirected 2016-08-17 17:58:12,038 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 57, 12, 26024)}
2016-08-17 17:58:12,042 WARNING celery.redirected 2016-08-17 17:58:12,042 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:58:12,044 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:58:12,055 INFO celery.worker.job Task schedule_clean_desktops[8be52417-0a91-4970-9149-dc093d93599c] succeeded in 0.0318814799975371s: None
2016-08-17 17:58:46,602 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:58:46,602 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:58:46,603 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:58:46,603 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:58:46,616 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:58:46,617 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:58:46,617 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:58:46,617 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:59:11,607 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 17:59:11,766 INFO celery.worker.strategy Received task: schedule_start_lesson[b8382266-db5b-4af5-a5fb-3e5d04492227]
2016-08-17 17:59:11,772 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:59:11,778 INFO celery Scheduling start lesson tasks
2016-08-17 17:59:11,788 WARNING celery.redirected 2016-08-17 17:59:11,788 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:59:11,791 WARNING celery.redirected 2016-08-17 17:59:11,791 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:59:11,792 WARNING celery.redirected 2016-08-17 17:59:11,792 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 17:59:11,801 WARNING celery.redirected 2016-08-17 17:59:11,801 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 17:59:11,802 WARNING celery.redirected 2016-08-17 17:59:11,801 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(17, 59, 11, 795209), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 9, 11, 795209)}
2016-08-17 17:59:11,804 WARNING celery.redirected 2016-08-17 17:59:11,804 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:59:11,806 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:59:11,825 INFO celery.worker.job Task schedule_start_lesson[b8382266-db5b-4af5-a5fb-3e5d04492227] succeeded in 0.05553377999967779s: None
2016-08-17 17:59:16,636 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:59:16,636 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:59:16,638 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:59:16,639 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:59:16,641 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 17:59:16,867 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:59:16,867 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:59:16,870 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:59:16,870 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:59:16,874 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:59:16,874 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:59:16,875 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:59:16,875 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:59:17,933 INFO celery.worker.strategy Received task: schedule_clean_desktops[eab37b69-4c3b-4527-89b9-b7b24d08b0fa]
2016-08-17 17:59:17,939 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 17:59:17,958 WARNING celery.redirected 2016-08-17 17:59:17,958 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 17:59:17,962 WARNING celery.redirected 2016-08-17 17:59:17,961 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 17:59:17,962 WARNING celery.redirected 2016-08-17 17:59:17,962 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 17:59:17,975 WARNING celery.redirected 2016-08-17 17:59:17,975 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 17:59:17,977 WARNING celery.redirected 2016-08-17 17:59:17,976 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 58, 17, 946854), 'desktop_state_2': 'DELETED'}
2016-08-17 17:59:17,989 WARNING celery.redirected 2016-08-17 17:59:17,988 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 17:59:17,991 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 17:59:18,023 INFO celery.worker.job Task schedule_clean_desktops[eab37b69-4c3b-4527-89b9-b7b24d08b0fa] succeeded in 0.08640330900016124s: None
2016-08-17 17:59:51,859 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:59:51,861 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:59:51,861 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:59:51,862 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 17:59:51,867 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 17:59:51,867 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 17:59:51,867 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 17:59:51,867 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:00:16,853 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:00:18,017 INFO celery.worker.strategy Received task: schedule_start_lesson[9fa45a16-d680-47b9-b9aa-a33fc87246a6]
2016-08-17 18:00:18,020 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:00:18,022 INFO celery Scheduling start lesson tasks
2016-08-17 18:00:18,027 WARNING celery.redirected 2016-08-17 18:00:18,027 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:00:18,030 WARNING celery.redirected 2016-08-17 18:00:18,029 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:00:18,031 WARNING celery.redirected 2016-08-17 18:00:18,030 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:00:18,037 WARNING celery.redirected 2016-08-17 18:00:18,037 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:00:18,037 WARNING celery.redirected 2016-08-17 18:00:18,037 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 0, 18, 33646), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 10, 18, 33646)}
2016-08-17 18:00:18,039 WARNING celery.redirected 2016-08-17 18:00:18,039 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:00:18,040 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:00:18,053 INFO celery.worker.job Task schedule_start_lesson[9fa45a16-d680-47b9-b9aa-a33fc87246a6] succeeded in 0.034214169998449506s: None
2016-08-17 18:00:21,964 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:00:21,965 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:00:21,967 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:00:21,967 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:00:21,969 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:00:21,986 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:00:21,987 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:00:21,989 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:00:21,989 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:00:21,994 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:00:21,994 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:00:21,995 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:00:21,996 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:00:22,790 INFO celery.worker.strategy Received task: schedule_clean_desktops[051b1505-e42b-46eb-b713-1d0d26db56a7]
2016-08-17 18:00:22,793 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:00:22,801 WARNING celery.redirected 2016-08-17 18:00:22,800 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:00:22,803 WARNING celery.redirected 2016-08-17 18:00:22,803 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:00:22,804 WARNING celery.redirected 2016-08-17 18:00:22,803 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:00:22,809 WARNING celery.redirected 2016-08-17 18:00:22,809 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:00:22,809 WARNING celery.redirected 2016-08-17 18:00:22,809 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 17, 59, 22, 796597)}
2016-08-17 18:00:22,811 WARNING celery.redirected 2016-08-17 18:00:22,811 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:00:22,813 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:00:22,826 INFO celery.worker.job Task schedule_clean_desktops[051b1505-e42b-46eb-b713-1d0d26db56a7] succeeded in 0.03394817200023681s: None
2016-08-17 18:00:56,980 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:00:56,980 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:00:56,980 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:00:56,980 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:00:56,985 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:00:56,986 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:00:56,986 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:00:56,986 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:01:21,975 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:01:22,681 INFO celery.worker.strategy Received task: schedule_start_lesson[3a8375e3-0be1-4b21-b5f5-d74f8df9309e]
2016-08-17 18:01:22,682 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:01:22,683 INFO celery Scheduling start lesson tasks
2016-08-17 18:01:22,684 WARNING celery.redirected 2016-08-17 18:01:22,684 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:01:22,685 WARNING celery.redirected 2016-08-17 18:01:22,685 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:01:22,685 WARNING celery.redirected 2016-08-17 18:01:22,685 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:01:22,689 WARNING celery.redirected 2016-08-17 18:01:22,689 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:01:22,689 WARNING celery.redirected 2016-08-17 18:01:22,689 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 1, 22, 686967), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 11, 22, 686967)}
2016-08-17 18:01:22,692 WARNING celery.redirected 2016-08-17 18:01:22,692 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:01:22,693 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:01:22,700 INFO celery.worker.job Task schedule_start_lesson[3a8375e3-0be1-4b21-b5f5-d74f8df9309e] succeeded in 0.01804071200240287s: None
2016-08-17 18:01:26,996 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:01:26,996 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:01:26,998 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:01:26,998 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:01:27,001 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:01:27,017 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:01:27,017 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:01:27,019 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:01:27,020 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:01:27,024 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:01:27,025 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:01:27,025 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:01:27,025 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:01:27,472 INFO celery.worker.strategy Received task: schedule_clean_desktops[b8cb75b5-85e6-4478-9683-bc171c2442e2]
2016-08-17 18:01:27,474 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:01:27,475 WARNING celery.redirected 2016-08-17 18:01:27,475 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:01:27,476 WARNING celery.redirected 2016-08-17 18:01:27,476 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:01:27,477 WARNING celery.redirected 2016-08-17 18:01:27,476 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:01:27,480 WARNING celery.redirected 2016-08-17 18:01:27,479 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:01:27,480 WARNING celery.redirected 2016-08-17 18:01:27,480 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 0, 27, 474711), 'desktop_state_2': 'DELETED'}
2016-08-17 18:01:27,482 WARNING celery.redirected 2016-08-17 18:01:27,482 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:01:27,484 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:01:27,492 INFO celery.worker.job Task schedule_clean_desktops[b8cb75b5-85e6-4478-9683-bc171c2442e2] succeeded in 0.01839785699849017s: None
2016-08-17 18:02:02,006 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:02:02,006 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:02:02,006 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:02:02,007 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:02:02,012 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:02:02,012 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:02:02,012 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:02:02,012 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:02:22,002 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:02:23,185 INFO celery.worker.strategy Received task: schedule_start_lesson[27ff5258-7743-43a6-b3c2-faa5f3dd1893]
2016-08-17 18:02:23,187 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:02:23,188 INFO celery Scheduling start lesson tasks
2016-08-17 18:02:23,189 WARNING celery.redirected 2016-08-17 18:02:23,189 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:02:23,191 WARNING celery.redirected 2016-08-17 18:02:23,191 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:02:23,192 WARNING celery.redirected 2016-08-17 18:02:23,192 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:02:23,198 WARNING celery.redirected 2016-08-17 18:02:23,198 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:02:23,199 WARNING celery.redirected 2016-08-17 18:02:23,199 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 2, 23, 194412), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 12, 23, 194412)}
2016-08-17 18:02:23,201 WARNING celery.redirected 2016-08-17 18:02:23,201 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:02:23,202 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:02:23,210 INFO celery.worker.job Task schedule_start_lesson[27ff5258-7743-43a6-b3c2-faa5f3dd1893] succeeded in 0.02301150899802451s: None
2016-08-17 18:02:27,140 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:02:27,987 INFO celery.worker.strategy Received task: schedule_clean_desktops[c854b5c9-58cd-48da-a5a7-805fefc3403b]
2016-08-17 18:02:27,989 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:02:27,990 WARNING celery.redirected 2016-08-17 18:02:27,990 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:02:27,991 WARNING celery.redirected 2016-08-17 18:02:27,991 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:02:27,992 WARNING celery.redirected 2016-08-17 18:02:27,992 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:02:27,995 WARNING celery.redirected 2016-08-17 18:02:27,995 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:02:27,996 WARNING celery.redirected 2016-08-17 18:02:27,996 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 1, 27, 989991), 'desktop_state_2': 'DELETED'}
2016-08-17 18:02:27,998 WARNING celery.redirected 2016-08-17 18:02:27,998 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:02:28,000 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:02:28,007 INFO celery.worker.job Task schedule_clean_desktops[c854b5c9-58cd-48da-a5a7-805fefc3403b] succeeded in 0.017887083999085007s: None
2016-08-17 18:02:32,156 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:02:32,156 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:02:32,159 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:02:32,159 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:02:32,165 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:02:32,165 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:02:32,166 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:02:32,166 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:03:07,140 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:03:07,140 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:03:07,141 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:03:07,141 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:03:07,146 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:03:07,146 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:03:07,146 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:03:07,146 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:03:22,137 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:03:22,381 INFO celery.worker.strategy Received task: schedule_start_lesson[869afbc9-ddfd-451a-9187-20c73ada959f]
2016-08-17 18:03:22,382 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:03:22,382 INFO celery Scheduling start lesson tasks
2016-08-17 18:03:22,383 WARNING celery.redirected 2016-08-17 18:03:22,383 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:03:22,384 WARNING celery.redirected 2016-08-17 18:03:22,384 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:03:22,385 WARNING celery.redirected 2016-08-17 18:03:22,385 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:03:22,388 WARNING celery.redirected 2016-08-17 18:03:22,388 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:03:22,389 WARNING celery.redirected 2016-08-17 18:03:22,389 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 3, 22, 386585), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 13, 22, 386585)}
2016-08-17 18:03:22,391 WARNING celery.redirected 2016-08-17 18:03:22,391 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:03:22,392 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:03:22,400 INFO celery.worker.job Task schedule_start_lesson[869afbc9-ddfd-451a-9187-20c73ada959f] succeeded in 0.018134595000447007s: None
2016-08-17 18:03:27,151 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:03:28,607 INFO celery.worker.strategy Received task: schedule_clean_desktops[0586c0d3-4b41-4a79-b84e-d313db11cc5e]
2016-08-17 18:03:28,609 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:03:28,611 WARNING celery.redirected 2016-08-17 18:03:28,611 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:03:28,612 WARNING celery.redirected 2016-08-17 18:03:28,612 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:03:28,612 WARNING celery.redirected 2016-08-17 18:03:28,612 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:03:28,616 WARNING celery.redirected 2016-08-17 18:03:28,615 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:03:28,617 WARNING celery.redirected 2016-08-17 18:03:28,616 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 2, 28, 610424)}
2016-08-17 18:03:28,620 WARNING celery.redirected 2016-08-17 18:03:28,620 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:03:28,621 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:03:28,628 INFO celery.worker.job Task schedule_clean_desktops[0586c0d3-4b41-4a79-b84e-d313db11cc5e] succeeded in 0.019340611001098296s: None
2016-08-17 18:03:37,566 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:03:37,567 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:03:37,569 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:03:37,569 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:03:37,574 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:03:37,574 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:03:37,574 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:03:37,574 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:04:07,584 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:04:07,584 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:04:07,584 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:04:07,584 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:04:07,589 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:04:07,589 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:04:07,590 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:04:07,590 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:04:22,592 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:04:23,245 INFO celery.worker.strategy Received task: schedule_start_lesson[b93dd5ba-d966-4d04-9770-2965f3951af8]
2016-08-17 18:04:23,246 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:04:23,247 INFO celery Scheduling start lesson tasks
2016-08-17 18:04:23,248 WARNING celery.redirected 2016-08-17 18:04:23,248 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:04:23,249 WARNING celery.redirected 2016-08-17 18:04:23,249 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:04:23,250 WARNING celery.redirected 2016-08-17 18:04:23,249 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:04:23,253 WARNING celery.redirected 2016-08-17 18:04:23,253 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:04:23,254 WARNING celery.redirected 2016-08-17 18:04:23,253 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 4, 23, 251391), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 14, 23, 251391)}
2016-08-17 18:04:23,256 WARNING celery.redirected 2016-08-17 18:04:23,255 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:04:23,257 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:04:23,264 INFO celery.worker.job Task schedule_start_lesson[b93dd5ba-d966-4d04-9770-2965f3951af8] succeeded in 0.017389276003086707s: None
2016-08-17 18:04:27,612 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:04:27,980 INFO celery.worker.strategy Received task: schedule_clean_desktops[37961daa-0752-4aae-8a64-265ee4176116]
2016-08-17 18:04:27,981 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:04:27,983 WARNING celery.redirected 2016-08-17 18:04:27,982 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:04:27,983 WARNING celery.redirected 2016-08-17 18:04:27,983 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:04:27,984 WARNING celery.redirected 2016-08-17 18:04:27,984 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:04:27,987 WARNING celery.redirected 2016-08-17 18:04:27,987 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:04:27,987 WARNING celery.redirected 2016-08-17 18:04:27,987 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 3, 27, 982242)}
2016-08-17 18:04:27,989 WARNING celery.redirected 2016-08-17 18:04:27,989 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:04:27,990 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:04:27,997 INFO celery.worker.job Task schedule_clean_desktops[37961daa-0752-4aae-8a64-265ee4176116] succeeded in 0.0162786530017911s: None
2016-08-17 18:04:37,627 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:04:37,627 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:04:37,629 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:04:37,630 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:04:37,635 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:04:37,635 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:04:37,636 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:04:37,636 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:05:07,637 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:05:07,637 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:05:07,637 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:05:07,637 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:05:27,635 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:05:27,732 INFO celery.worker.strategy Received task: schedule_start_lesson[c75529c7-9bf5-4abb-9e2e-4f8298ce5e5d]
2016-08-17 18:05:27,733 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:05:27,733 INFO celery Scheduling start lesson tasks
2016-08-17 18:05:27,734 WARNING celery.redirected 2016-08-17 18:05:27,734 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:05:27,735 WARNING celery.redirected 2016-08-17 18:05:27,735 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:05:27,736 WARNING celery.redirected 2016-08-17 18:05:27,736 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:05:27,740 WARNING celery.redirected 2016-08-17 18:05:27,740 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:05:27,741 WARNING celery.redirected 2016-08-17 18:05:27,741 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 5, 27, 738187), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 15, 27, 738187)}
2016-08-17 18:05:27,743 WARNING celery.redirected 2016-08-17 18:05:27,743 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:05:27,744 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:05:27,750 INFO celery.worker.job Task schedule_start_lesson[c75529c7-9bf5-4abb-9e2e-4f8298ce5e5d] succeeded in 0.017066530999727547s: None
2016-08-17 18:05:32,657 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:05:33,698 INFO celery.worker.strategy Received task: schedule_clean_desktops[78c7be40-144d-4bc3-a110-2549ffa68e5f]
2016-08-17 18:05:33,700 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:05:33,701 WARNING celery.redirected 2016-08-17 18:05:33,701 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:05:33,702 WARNING celery.redirected 2016-08-17 18:05:33,702 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:05:33,703 WARNING celery.redirected 2016-08-17 18:05:33,703 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:05:33,706 WARNING celery.redirected 2016-08-17 18:05:33,706 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:05:33,707 WARNING celery.redirected 2016-08-17 18:05:33,707 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 4, 33, 700912), 'desktop_state_2': 'DELETED'}
2016-08-17 18:05:33,709 WARNING celery.redirected 2016-08-17 18:05:33,709 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:05:33,710 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:05:33,718 INFO celery.worker.job Task schedule_clean_desktops[78c7be40-144d-4bc3-a110-2549ffa68e5f] succeeded in 0.018133321002096636s: None
2016-08-17 18:05:37,676 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:05:37,677 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:05:37,679 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:05:37,679 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:05:37,684 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:05:37,684 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:05:37,684 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:05:37,684 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:06:12,686 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:06:12,686 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:06:12,686 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:06:12,687 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:06:12,691 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:06:12,692 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:06:12,692 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:06:12,692 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:06:32,688 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:06:33,445 INFO celery.worker.strategy Received task: schedule_start_lesson[caabd8e7-ede0-41c1-8f42-4a75e11a4b8b]
2016-08-17 18:06:33,447 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:06:33,447 INFO celery Scheduling start lesson tasks
2016-08-17 18:06:33,448 WARNING celery.redirected 2016-08-17 18:06:33,448 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:06:33,449 WARNING celery.redirected 2016-08-17 18:06:33,449 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:06:33,449 WARNING celery.redirected 2016-08-17 18:06:33,449 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:06:33,453 WARNING celery.redirected 2016-08-17 18:06:33,453 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:06:33,453 WARNING celery.redirected 2016-08-17 18:06:33,453 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 6, 33, 451089), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 16, 33, 451089)}
2016-08-17 18:06:33,455 WARNING celery.redirected 2016-08-17 18:06:33,455 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:06:33,456 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:06:33,464 INFO celery.worker.job Task schedule_start_lesson[caabd8e7-ede0-41c1-8f42-4a75e11a4b8b] succeeded in 0.017123441000876483s: None
2016-08-17 18:06:37,705 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:06:38,174 INFO celery.worker.strategy Received task: schedule_clean_desktops[6ac6d646-15a4-4fc7-9484-3eca4890bdb5]
2016-08-17 18:06:38,175 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:06:38,176 WARNING celery.redirected 2016-08-17 18:06:38,176 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:06:38,177 WARNING celery.redirected 2016-08-17 18:06:38,177 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:06:38,178 WARNING celery.redirected 2016-08-17 18:06:38,178 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:06:38,183 WARNING celery.redirected 2016-08-17 18:06:38,183 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:06:38,183 WARNING celery.redirected 2016-08-17 18:06:38,183 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 5, 38, 176021), 'desktop_state_2': 'DELETED'}
2016-08-17 18:06:38,186 WARNING celery.redirected 2016-08-17 18:06:38,186 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:06:38,187 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:06:38,193 INFO celery.worker.job Task schedule_clean_desktops[6ac6d646-15a4-4fc7-9484-3eca4890bdb5] succeeded in 0.01852444399992237s: None
2016-08-17 18:06:42,726 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:06:42,727 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:06:42,729 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:06:42,729 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:06:42,734 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:06:42,734 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:06:42,734 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:06:42,734 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:07:12,740 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:07:12,740 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:07:12,740 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:07:12,741 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:07:12,745 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:07:12,746 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:07:12,746 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:07:12,746 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:07:37,742 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:07:37,942 INFO celery.worker.strategy Received task: schedule_start_lesson[ce28b584-a819-4533-a5a7-e3dbac5ed9c8]
2016-08-17 18:07:37,944 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:07:37,944 INFO celery Scheduling start lesson tasks
2016-08-17 18:07:37,945 WARNING celery.redirected 2016-08-17 18:07:37,945 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:07:37,946 WARNING celery.redirected 2016-08-17 18:07:37,946 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:07:37,946 WARNING celery.redirected 2016-08-17 18:07:37,946 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:07:37,950 WARNING celery.redirected 2016-08-17 18:07:37,950 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:07:37,951 WARNING celery.redirected 2016-08-17 18:07:37,951 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 7, 37, 948373), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 17, 37, 948373)}
2016-08-17 18:07:37,953 WARNING celery.redirected 2016-08-17 18:07:37,952 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:07:37,954 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:07:37,960 INFO celery.worker.job Task schedule_start_lesson[ce28b584-a819-4533-a5a7-e3dbac5ed9c8] succeeded in 0.0164726069997414s: None
2016-08-17 18:07:42,762 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:07:42,763 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:07:42,765 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:07:42,765 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:07:42,767 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:07:42,893 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:07:42,893 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:07:42,895 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:07:42,896 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:07:42,899 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:07:42,899 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:07:42,899 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:07:42,900 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:07:43,943 INFO celery.worker.strategy Received task: schedule_clean_desktops[e10f7e4e-95b5-4a41-a15a-a1bd7cb0fe3b]
2016-08-17 18:07:43,944 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:07:43,946 WARNING celery.redirected 2016-08-17 18:07:43,946 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:07:43,947 WARNING celery.redirected 2016-08-17 18:07:43,946 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:07:43,947 WARNING celery.redirected 2016-08-17 18:07:43,947 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:07:43,950 WARNING celery.redirected 2016-08-17 18:07:43,950 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:07:43,951 WARNING celery.redirected 2016-08-17 18:07:43,950 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 6, 43, 945389)}
2016-08-17 18:07:43,953 WARNING celery.redirected 2016-08-17 18:07:43,953 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:07:43,955 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:07:43,962 INFO celery.worker.job Task schedule_clean_desktops[e10f7e4e-95b5-4a41-a15a-a1bd7cb0fe3b] succeeded in 0.018076028001814848s: None
2016-08-17 18:08:12,910 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:08:12,910 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:08:12,910 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:08:12,911 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:08:12,916 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:08:12,916 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:08:12,916 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:08:12,916 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:08:42,911 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:08:42,928 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:08:42,928 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:08:42,930 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:08:42,930 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:08:42,933 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:08:42,933 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:08:42,933 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:08:42,933 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:08:43,747 INFO celery.worker.strategy Received task: schedule_start_lesson[b539efdc-c369-41ce-a5f1-f17a04f71632]
2016-08-17 18:08:43,748 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:08:43,749 INFO celery Scheduling start lesson tasks
2016-08-17 18:08:43,750 WARNING celery.redirected 2016-08-17 18:08:43,749 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:08:43,751 WARNING celery.redirected 2016-08-17 18:08:43,750 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:08:43,751 WARNING celery.redirected 2016-08-17 18:08:43,751 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:08:43,754 WARNING celery.redirected 2016-08-17 18:08:43,754 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:08:43,755 WARNING celery.redirected 2016-08-17 18:08:43,755 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 8, 43, 752671), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 18, 43, 752671)}
2016-08-17 18:08:43,756 WARNING celery.redirected 2016-08-17 18:08:43,756 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:08:43,758 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:08:43,768 INFO celery.worker.job Task schedule_start_lesson[b539efdc-c369-41ce-a5f1-f17a04f71632] succeeded in 0.020017692000692477s: None
2016-08-17 18:08:47,928 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:08:48,484 INFO celery.worker.strategy Received task: schedule_clean_desktops[91f19baa-ef0a-46b2-9c33-e950c3f2b572]
2016-08-17 18:08:48,485 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:08:48,487 WARNING celery.redirected 2016-08-17 18:08:48,487 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:08:48,488 WARNING celery.redirected 2016-08-17 18:08:48,488 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:08:48,488 WARNING celery.redirected 2016-08-17 18:08:48,488 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:08:48,491 WARNING celery.redirected 2016-08-17 18:08:48,491 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:08:48,492 WARNING celery.redirected 2016-08-17 18:08:48,492 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 7, 48, 486435), 'desktop_state_2': 'DELETED'}
2016-08-17 18:08:48,495 WARNING celery.redirected 2016-08-17 18:08:48,494 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:08:48,496 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:08:48,504 INFO celery.worker.job Task schedule_clean_desktops[91f19baa-ef0a-46b2-9c33-e950c3f2b572] succeeded in 0.018371676000242587s: None
2016-08-17 18:09:12,936 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:09:12,936 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:09:12,938 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:09:12,938 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:09:12,943 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:09:12,943 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:09:12,944 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:09:12,944 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:09:47,928 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:09:47,928 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:09:47,928 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:09:47,929 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:09:47,930 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:09:47,946 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:09:47,947 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:09:47,949 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:09:47,949 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:09:47,952 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:09:47,952 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:09:47,952 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:09:47,952 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:09:48,230 INFO celery.worker.strategy Received task: schedule_start_lesson[ddfcfcb7-a42b-4abe-864c-579c9f14ace4]
2016-08-17 18:09:48,232 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:09:48,232 INFO celery Scheduling start lesson tasks
2016-08-17 18:09:48,233 WARNING celery.redirected 2016-08-17 18:09:48,233 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:09:48,234 WARNING celery.redirected 2016-08-17 18:09:48,234 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:09:48,234 WARNING celery.redirected 2016-08-17 18:09:48,234 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:09:48,238 WARNING celery.redirected 2016-08-17 18:09:48,238 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:09:48,239 WARNING celery.redirected 2016-08-17 18:09:48,239 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 9, 48, 236176), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 19, 48, 236176)}
2016-08-17 18:09:48,241 WARNING celery.redirected 2016-08-17 18:09:48,241 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:09:48,242 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:09:48,248 INFO celery.worker.job Task schedule_start_lesson[ddfcfcb7-a42b-4abe-864c-579c9f14ace4] succeeded in 0.016435940000519622s: None
2016-08-17 18:09:52,952 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:09:54,215 INFO celery.worker.strategy Received task: schedule_clean_desktops[bd672240-efc4-4e4e-ac52-fe6475702e66]
2016-08-17 18:09:54,216 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:09:54,218 WARNING celery.redirected 2016-08-17 18:09:54,218 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:09:54,219 WARNING celery.redirected 2016-08-17 18:09:54,219 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:09:54,219 WARNING celery.redirected 2016-08-17 18:09:54,219 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:09:54,222 WARNING celery.redirected 2016-08-17 18:09:54,222 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:09:54,223 WARNING celery.redirected 2016-08-17 18:09:54,223 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 8, 54, 217605), 'desktop_state_2': 'DELETED'}
2016-08-17 18:09:54,225 WARNING celery.redirected 2016-08-17 18:09:54,225 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:09:54,227 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:09:54,234 INFO celery.worker.job Task schedule_clean_desktops[bd672240-efc4-4e4e-ac52-fe6475702e66] succeeded in 0.017389017000823515s: None
2016-08-17 18:10:18,196 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:10:18,197 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:10:18,199 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:10:18,199 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:10:18,203 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:10:18,204 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:10:18,204 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:10:18,204 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:10:48,225 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:10:48,225 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:10:48,226 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:10:48,226 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:10:48,228 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:10:48,244 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:10:48,244 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:10:48,247 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:10:48,247 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:10:48,249 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:10:48,250 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:10:48,250 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:10:48,250 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:10:49,216 INFO celery.worker.strategy Received task: schedule_start_lesson[413e7868-a4c7-449a-b5c6-dafe643668fe]
2016-08-17 18:10:49,217 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:10:49,218 INFO celery Scheduling start lesson tasks
2016-08-17 18:10:49,219 WARNING celery.redirected 2016-08-17 18:10:49,218 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:10:49,219 WARNING celery.redirected 2016-08-17 18:10:49,219 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:10:49,220 WARNING celery.redirected 2016-08-17 18:10:49,220 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:10:49,224 WARNING celery.redirected 2016-08-17 18:10:49,224 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:10:49,224 WARNING celery.redirected 2016-08-17 18:10:49,224 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 10, 49, 221825), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 20, 49, 221825)}
2016-08-17 18:10:49,226 WARNING celery.redirected 2016-08-17 18:10:49,226 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:10:49,228 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:10:49,235 INFO celery.worker.job Task schedule_start_lesson[413e7868-a4c7-449a-b5c6-dafe643668fe] succeeded in 0.018580718999146484s: None
2016-08-17 18:10:53,244 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:10:53,947 INFO celery.worker.strategy Received task: schedule_clean_desktops[d37a7291-a697-42dc-b97c-46dfd99cf7d9]
2016-08-17 18:10:53,948 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:10:53,949 WARNING celery.redirected 2016-08-17 18:10:53,949 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:10:53,950 WARNING celery.redirected 2016-08-17 18:10:53,950 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:10:53,951 WARNING celery.redirected 2016-08-17 18:10:53,951 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:10:53,954 WARNING celery.redirected 2016-08-17 18:10:53,954 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:10:53,954 WARNING celery.redirected 2016-08-17 18:10:53,954 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 9, 53, 949099), 'desktop_state_2': 'DELETED'}
2016-08-17 18:10:53,956 WARNING celery.redirected 2016-08-17 18:10:53,956 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:10:53,958 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:10:53,964 INFO celery.worker.job Task schedule_clean_desktops[d37a7291-a697-42dc-b97c-46dfd99cf7d9] succeeded in 0.01657227299801889s: None
2016-08-17 18:11:18,267 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:11:18,267 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:11:18,270 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:11:18,270 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:11:18,275 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:11:18,275 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:11:18,275 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:11:18,276 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:11:48,271 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:11:48,288 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:11:48,288 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:11:48,290 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:11:48,290 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:11:48,293 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:11:48,293 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:11:48,293 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:11:48,293 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:11:48,953 INFO celery.worker.strategy Received task: schedule_start_lesson[a48e799b-5975-4a4f-b7cc-0c20c53b3d28]
2016-08-17 18:11:48,954 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:11:48,955 INFO celery Scheduling start lesson tasks
2016-08-17 18:11:48,956 WARNING celery.redirected 2016-08-17 18:11:48,955 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:11:48,957 WARNING celery.redirected 2016-08-17 18:11:48,956 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:11:48,957 WARNING celery.redirected 2016-08-17 18:11:48,957 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:11:48,960 WARNING celery.redirected 2016-08-17 18:11:48,960 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:11:48,961 WARNING celery.redirected 2016-08-17 18:11:48,961 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 11, 48, 958663), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 21, 48, 958663)}
2016-08-17 18:11:48,963 WARNING celery.redirected 2016-08-17 18:11:48,963 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:11:48,964 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:11:48,977 INFO celery.worker.job Task schedule_start_lesson[a48e799b-5975-4a4f-b7cc-0c20c53b3d28] succeeded in 0.022755074001906905s: None
2016-08-17 18:11:53,288 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:11:53,669 INFO celery.worker.strategy Received task: schedule_clean_desktops[9315b6da-3417-48a7-9602-7bd746d9b6bf]
2016-08-17 18:11:53,671 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:11:53,673 WARNING celery.redirected 2016-08-17 18:11:53,672 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:11:53,674 WARNING celery.redirected 2016-08-17 18:11:53,674 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:11:53,674 WARNING celery.redirected 2016-08-17 18:11:53,674 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:11:53,677 WARNING celery.redirected 2016-08-17 18:11:53,677 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:11:53,678 WARNING celery.redirected 2016-08-17 18:11:53,678 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 10, 53, 672210)}
2016-08-17 18:11:53,680 WARNING celery.redirected 2016-08-17 18:11:53,680 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:11:53,681 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:11:53,687 INFO celery.worker.job Task schedule_clean_desktops[9315b6da-3417-48a7-9602-7bd746d9b6bf] succeeded in 0.01663742999880924s: None
2016-08-17 18:12:18,303 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:12:18,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:12:18,305 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:12:18,306 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:12:18,310 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:12:18,310 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:12:18,311 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:12:18,311 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:12:48,303 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:12:48,320 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:12:48,321 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:12:48,323 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:12:48,323 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:12:48,326 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:12:48,326 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:12:48,326 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:12:48,326 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:12:48,697 INFO celery.worker.strategy Received task: schedule_start_lesson[4698f32e-bcbb-40b4-b440-f6e61b21609f]
2016-08-17 18:12:48,698 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:12:48,699 INFO celery Scheduling start lesson tasks
2016-08-17 18:12:48,700 WARNING celery.redirected 2016-08-17 18:12:48,700 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:12:48,701 WARNING celery.redirected 2016-08-17 18:12:48,701 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:12:48,701 WARNING celery.redirected 2016-08-17 18:12:48,701 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:12:48,705 WARNING celery.redirected 2016-08-17 18:12:48,704 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:12:48,705 WARNING celery.redirected 2016-08-17 18:12:48,705 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 12, 48, 702854), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 22, 48, 702854)}
2016-08-17 18:12:48,707 WARNING celery.redirected 2016-08-17 18:12:48,707 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:12:48,708 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:12:48,715 INFO celery.worker.job Task schedule_start_lesson[4698f32e-bcbb-40b4-b440-f6e61b21609f] succeeded in 0.01683049699931871s: None
2016-08-17 18:12:53,327 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:12:53,434 INFO celery.worker.strategy Received task: schedule_clean_desktops[14d1c7a4-e49c-4bb4-b831-ff4eb2aa0310]
2016-08-17 18:12:53,436 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:12:53,437 WARNING celery.redirected 2016-08-17 18:12:53,437 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:12:53,438 WARNING celery.redirected 2016-08-17 18:12:53,438 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:12:53,439 WARNING celery.redirected 2016-08-17 18:12:53,439 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:12:53,443 WARNING celery.redirected 2016-08-17 18:12:53,443 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:12:53,443 WARNING celery.redirected 2016-08-17 18:12:53,443 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 11, 53, 436872), 'desktop_state_2': 'DELETED'}
2016-08-17 18:12:53,445 WARNING celery.redirected 2016-08-17 18:12:53,445 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:12:53,446 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:12:53,453 INFO celery.worker.job Task schedule_clean_desktops[14d1c7a4-e49c-4bb4-b831-ff4eb2aa0310] succeeded in 0.017322969000815647s: None
2016-08-17 18:13:18,357 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:13:18,357 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:13:18,359 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:13:18,360 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:13:18,365 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:13:18,365 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:13:18,365 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:13:18,365 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:13:48,360 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:13:48,377 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:13:48,377 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:13:48,380 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:13:48,380 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:13:48,383 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:13:48,383 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:13:48,383 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:13:48,383 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:13:48,498 INFO celery.worker.strategy Received task: schedule_start_lesson[eacd8d0f-fd57-416a-aacc-ecd5bcdb211b]
2016-08-17 18:13:48,499 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:13:48,500 INFO celery Scheduling start lesson tasks
2016-08-17 18:13:48,501 WARNING celery.redirected 2016-08-17 18:13:48,500 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:13:48,501 WARNING celery.redirected 2016-08-17 18:13:48,501 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:13:48,502 WARNING celery.redirected 2016-08-17 18:13:48,502 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:13:48,505 WARNING celery.redirected 2016-08-17 18:13:48,505 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:13:48,506 WARNING celery.redirected 2016-08-17 18:13:48,506 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 13, 48, 503666), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 23, 48, 503666)}
2016-08-17 18:13:48,508 WARNING celery.redirected 2016-08-17 18:13:48,508 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:13:48,509 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:13:48,516 INFO celery.worker.job Task schedule_start_lesson[eacd8d0f-fd57-416a-aacc-ecd5bcdb211b] succeeded in 0.016851225002028514s: None
2016-08-17 18:13:53,384 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:13:54,486 INFO celery.worker.strategy Received task: schedule_clean_desktops[4a407775-2ea3-41a2-86a3-27f27ab80e51]
2016-08-17 18:13:54,487 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:13:54,488 WARNING celery.redirected 2016-08-17 18:13:54,488 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:13:54,489 WARNING celery.redirected 2016-08-17 18:13:54,489 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:13:54,489 WARNING celery.redirected 2016-08-17 18:13:54,489 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:13:54,492 WARNING celery.redirected 2016-08-17 18:13:54,492 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:13:54,493 WARNING celery.redirected 2016-08-17 18:13:54,493 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 12, 54, 487766), 'desktop_state_2': 'DELETED'}
2016-08-17 18:13:54,495 WARNING celery.redirected 2016-08-17 18:13:54,495 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:13:54,496 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:13:54,505 INFO celery.worker.job Task schedule_clean_desktops[4a407775-2ea3-41a2-86a3-27f27ab80e51] succeeded in 0.018297023001650814s: None
2016-08-17 18:14:18,422 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:14:18,422 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:14:18,425 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:14:18,425 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:14:18,430 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:14:18,430 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:14:18,430 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:14:18,431 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:14:48,449 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:14:48,449 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:14:48,449 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:14:48,449 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:14:48,451 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:14:48,467 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:14:48,467 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:14:48,470 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:14:48,470 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:14:48,473 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:14:48,473 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:14:48,473 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:14:48,473 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:14:49,520 INFO celery.worker.strategy Received task: schedule_start_lesson[675ff747-b6eb-466f-bd51-c381790e88af]
2016-08-17 18:14:49,522 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:14:49,522 INFO celery Scheduling start lesson tasks
2016-08-17 18:14:49,523 WARNING celery.redirected 2016-08-17 18:14:49,523 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:14:49,524 WARNING celery.redirected 2016-08-17 18:14:49,524 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:14:49,525 WARNING celery.redirected 2016-08-17 18:14:49,524 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:14:49,528 WARNING celery.redirected 2016-08-17 18:14:49,528 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:14:49,528 WARNING celery.redirected 2016-08-17 18:14:49,528 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 14, 49, 526237), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 24, 49, 526237)}
2016-08-17 18:14:49,531 WARNING celery.redirected 2016-08-17 18:14:49,531 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:14:49,532 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:14:49,540 INFO celery.worker.job Task schedule_start_lesson[675ff747-b6eb-466f-bd51-c381790e88af] succeeded in 0.018326027999137295s: None
2016-08-17 18:14:53,473 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:14:54,254 INFO celery.worker.strategy Received task: schedule_clean_desktops[296c52ff-099f-4a0d-99fa-b6de047b8dff]
2016-08-17 18:14:54,255 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:14:54,256 WARNING celery.redirected 2016-08-17 18:14:54,256 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:14:54,257 WARNING celery.redirected 2016-08-17 18:14:54,257 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:14:54,258 WARNING celery.redirected 2016-08-17 18:14:54,257 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:14:54,261 WARNING celery.redirected 2016-08-17 18:14:54,260 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:14:54,261 WARNING celery.redirected 2016-08-17 18:14:54,261 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 13, 54, 255934), 'desktop_state_2': 'DELETED'}
2016-08-17 18:14:54,263 WARNING celery.redirected 2016-08-17 18:14:54,263 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:14:54,265 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:14:54,272 INFO celery.worker.job Task schedule_clean_desktops[296c52ff-099f-4a0d-99fa-b6de047b8dff] succeeded in 0.017464165001001675s: None
2016-08-17 18:15:18,497 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:15:18,497 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:15:18,500 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:15:18,500 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:15:18,505 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:15:18,505 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:15:18,505 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:15:18,506 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:15:48,511 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:15:48,511 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:15:48,511 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:15:48,511 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:15:48,513 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:15:48,529 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:15:48,530 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:15:48,532 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:15:48,532 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:15:48,535 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:15:48,535 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:15:48,535 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:15:48,535 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:15:49,259 INFO celery.worker.strategy Received task: schedule_start_lesson[f7086ebd-3178-4cda-a0ce-4ae77ebeeddb]
2016-08-17 18:15:49,260 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:15:49,260 INFO celery Scheduling start lesson tasks
2016-08-17 18:15:49,261 WARNING celery.redirected 2016-08-17 18:15:49,261 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:15:49,262 WARNING celery.redirected 2016-08-17 18:15:49,262 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:15:49,263 WARNING celery.redirected 2016-08-17 18:15:49,263 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:15:49,266 WARNING celery.redirected 2016-08-17 18:15:49,266 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:15:49,267 WARNING celery.redirected 2016-08-17 18:15:49,267 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 15, 49, 264694), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 25, 49, 264694)}
2016-08-17 18:15:49,269 WARNING celery.redirected 2016-08-17 18:15:49,269 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:15:49,271 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:15:49,278 INFO celery.worker.job Task schedule_start_lesson[f7086ebd-3178-4cda-a0ce-4ae77ebeeddb] succeeded in 0.01805667100052233s: None
2016-08-17 18:15:53,539 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:15:53,975 INFO celery.worker.strategy Received task: schedule_clean_desktops[fbdfb39e-054f-4b05-b5a0-f7bd82642aff]
2016-08-17 18:15:53,976 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:15:53,978 WARNING celery.redirected 2016-08-17 18:15:53,978 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:15:53,979 WARNING celery.redirected 2016-08-17 18:15:53,979 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:15:53,979 WARNING celery.redirected 2016-08-17 18:15:53,979 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:15:53,982 WARNING celery.redirected 2016-08-17 18:15:53,982 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:15:53,983 WARNING celery.redirected 2016-08-17 18:15:53,983 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 14, 53, 977299), 'desktop_state_2': 'DELETED'}
2016-08-17 18:15:53,985 WARNING celery.redirected 2016-08-17 18:15:53,985 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:15:53,986 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:15:53,993 INFO celery.worker.job Task schedule_clean_desktops[fbdfb39e-054f-4b05-b5a0-f7bd82642aff] succeeded in 0.016747043999203015s: None
2016-08-17 18:16:18,560 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:16:18,560 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:16:18,563 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:16:18,563 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:16:18,568 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:16:18,568 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:16:18,568 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:16:18,568 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:16:53,561 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:16:53,561 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:16:53,562 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:16:53,562 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:16:53,564 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:16:53,580 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:16:53,581 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:16:53,583 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:16:53,583 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:16:53,586 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:16:53,586 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:16:53,586 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:16:53,586 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:16:53,777 INFO celery.worker.strategy Received task: schedule_start_lesson[a2c210d7-bf15-4b27-bc00-0c0b144bb485]
2016-08-17 18:16:53,778 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:16:53,779 INFO celery Scheduling start lesson tasks
2016-08-17 18:16:53,780 WARNING celery.redirected 2016-08-17 18:16:53,780 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:16:53,781 WARNING celery.redirected 2016-08-17 18:16:53,781 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:16:53,781 WARNING celery.redirected 2016-08-17 18:16:53,781 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:16:53,785 WARNING celery.redirected 2016-08-17 18:16:53,785 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:16:53,785 WARNING celery.redirected 2016-08-17 18:16:53,785 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 16, 53, 783072), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 26, 53, 783072)}
2016-08-17 18:16:53,787 WARNING celery.redirected 2016-08-17 18:16:53,787 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:16:53,788 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:16:53,794 INFO celery.worker.job Task schedule_start_lesson[a2c210d7-bf15-4b27-bc00-0c0b144bb485] succeeded in 0.015997739999875193s: None
2016-08-17 18:16:58,579 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:16:59,761 INFO celery.worker.strategy Received task: schedule_clean_desktops[371c9bff-0664-4669-bace-aa0a2a15c5f5]
2016-08-17 18:16:59,763 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:16:59,765 WARNING celery.redirected 2016-08-17 18:16:59,765 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:16:59,767 WARNING celery.redirected 2016-08-17 18:16:59,766 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:16:59,768 WARNING celery.redirected 2016-08-17 18:16:59,767 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:16:59,773 WARNING celery.redirected 2016-08-17 18:16:59,772 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:16:59,773 WARNING celery.redirected 2016-08-17 18:16:59,773 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 15, 59, 764048), 'desktop_state_2': 'DELETED'}
2016-08-17 18:16:59,776 WARNING celery.redirected 2016-08-17 18:16:59,775 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:16:59,777 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:16:59,783 INFO celery.worker.job Task schedule_clean_desktops[371c9bff-0664-4669-bace-aa0a2a15c5f5] succeeded in 0.020627904999855673s: None
2016-08-17 18:17:23,692 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:17:23,693 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:17:23,696 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:17:23,696 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:17:23,700 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:17:23,701 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:17:23,701 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:17:23,701 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:17:53,708 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:17:53,708 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:17:53,708 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:17:53,708 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:17:53,713 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:17:53,713 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:17:53,713 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:17:53,713 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:17:58,710 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:17:59,610 INFO celery.worker.strategy Received task: schedule_start_lesson[d1e2d05e-6677-42f3-adc3-d9e67a0a697b]
2016-08-17 18:17:59,611 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:17:59,612 INFO celery Scheduling start lesson tasks
2016-08-17 18:17:59,613 WARNING celery.redirected 2016-08-17 18:17:59,613 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:17:59,614 WARNING celery.redirected 2016-08-17 18:17:59,613 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:17:59,614 WARNING celery.redirected 2016-08-17 18:17:59,614 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:17:59,619 WARNING celery.redirected 2016-08-17 18:17:59,619 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:17:59,620 WARNING celery.redirected 2016-08-17 18:17:59,619 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 17, 59, 617334), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 27, 59, 617334)}
2016-08-17 18:17:59,622 WARNING celery.redirected 2016-08-17 18:17:59,622 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:17:59,623 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:17:59,631 INFO celery.worker.job Task schedule_start_lesson[d1e2d05e-6677-42f3-adc3-d9e67a0a697b] succeeded in 0.019399478002014803s: None
2016-08-17 18:18:03,733 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:18:04,352 INFO celery.worker.strategy Received task: schedule_clean_desktops[1ffff0c9-ba1b-4787-b11f-726a807d4eb2]
2016-08-17 18:18:04,354 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:18:04,355 WARNING celery.redirected 2016-08-17 18:18:04,355 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:18:04,356 WARNING celery.redirected 2016-08-17 18:18:04,356 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:18:04,357 WARNING celery.redirected 2016-08-17 18:18:04,357 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:18:04,360 WARNING celery.redirected 2016-08-17 18:18:04,360 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:18:04,360 WARNING celery.redirected 2016-08-17 18:18:04,360 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 17, 4, 354953), 'desktop_state_2': 'DELETED'}
2016-08-17 18:18:04,362 WARNING celery.redirected 2016-08-17 18:18:04,362 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:18:04,363 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:18:04,370 INFO celery.worker.job Task schedule_clean_desktops[1ffff0c9-ba1b-4787-b11f-726a807d4eb2] succeeded in 0.016033608000725508s: None
2016-08-17 18:18:23,745 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:18:23,745 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:18:23,748 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:18:23,748 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:18:23,753 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:18:23,753 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:18:23,753 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:18:23,754 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:18:58,755 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:18:58,755 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:18:58,755 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:18:58,755 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:18:58,760 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:18:58,760 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:18:58,761 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:18:58,761 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:19:03,760 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:19:04,225 INFO celery.worker.strategy Received task: schedule_start_lesson[6886eeed-0d72-452d-b4e1-c0d10eb97044]
2016-08-17 18:19:04,226 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:19:04,227 INFO celery Scheduling start lesson tasks
2016-08-17 18:19:04,228 WARNING celery.redirected 2016-08-17 18:19:04,228 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:19:04,229 WARNING celery.redirected 2016-08-17 18:19:04,229 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:19:04,230 WARNING celery.redirected 2016-08-17 18:19:04,230 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:19:04,233 WARNING celery.redirected 2016-08-17 18:19:04,233 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:19:04,234 WARNING celery.redirected 2016-08-17 18:19:04,234 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 19, 4, 231852), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 29, 4, 231852)}
2016-08-17 18:19:04,236 WARNING celery.redirected 2016-08-17 18:19:04,236 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:19:04,237 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:19:04,244 INFO celery.worker.job Task schedule_start_lesson[6886eeed-0d72-452d-b4e1-c0d10eb97044] succeeded in 0.01811161699879449s: None
2016-08-17 18:19:08,779 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:19:08,948 INFO celery.worker.strategy Received task: schedule_clean_desktops[e5aa6e6e-4807-4def-aa37-571dacb8c582]
2016-08-17 18:19:08,949 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:19:08,950 WARNING celery.redirected 2016-08-17 18:19:08,950 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:19:08,952 WARNING celery.redirected 2016-08-17 18:19:08,952 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:19:08,953 WARNING celery.redirected 2016-08-17 18:19:08,952 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:19:08,956 WARNING celery.redirected 2016-08-17 18:19:08,956 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:19:08,956 WARNING celery.redirected 2016-08-17 18:19:08,956 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 18, 8, 950067), 'desktop_state_2': 'DELETED'}
2016-08-17 18:19:08,958 WARNING celery.redirected 2016-08-17 18:19:08,958 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:19:08,959 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:19:08,966 INFO celery.worker.job Task schedule_clean_desktops[e5aa6e6e-4807-4def-aa37-571dacb8c582] succeeded in 0.01723734400002286s: None
2016-08-17 18:19:28,802 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:19:28,803 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:19:28,805 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:19:28,806 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:19:28,810 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:19:28,810 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:19:28,811 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:19:28,811 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:19:58,827 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:19:58,827 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:19:58,827 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:19:58,827 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:19:58,832 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:19:58,832 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:19:58,833 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:19:58,833 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:20:08,836 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:20:08,859 INFO celery.worker.strategy Received task: schedule_start_lesson[c2b6210f-14e5-4548-87e3-cdffe9fc202e]
2016-08-17 18:20:08,860 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:20:08,861 INFO celery Scheduling start lesson tasks
2016-08-17 18:20:08,862 WARNING celery.redirected 2016-08-17 18:20:08,862 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:20:08,863 WARNING celery.redirected 2016-08-17 18:20:08,863 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:20:08,863 WARNING celery.redirected 2016-08-17 18:20:08,863 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:20:08,868 WARNING celery.redirected 2016-08-17 18:20:08,868 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:20:08,868 WARNING celery.redirected 2016-08-17 18:20:08,868 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 20, 8, 865434), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 30, 8, 865434)}
2016-08-17 18:20:08,870 WARNING celery.redirected 2016-08-17 18:20:08,870 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:20:08,871 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:20:08,878 INFO celery.worker.job Task schedule_start_lesson[c2b6210f-14e5-4548-87e3-cdffe9fc202e] succeeded in 0.017928679000760894s: None
2016-08-17 18:20:13,854 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:20:14,855 INFO celery.worker.strategy Received task: schedule_clean_desktops[f6ba0186-5947-49eb-8442-3a6460e7a0fe]
2016-08-17 18:20:14,856 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:20:14,858 WARNING celery.redirected 2016-08-17 18:20:14,858 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:20:14,859 WARNING celery.redirected 2016-08-17 18:20:14,859 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:20:14,860 WARNING celery.redirected 2016-08-17 18:20:14,860 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:20:14,865 WARNING celery.redirected 2016-08-17 18:20:14,865 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:20:14,866 WARNING celery.redirected 2016-08-17 18:20:14,866 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 19, 14, 857556), 'desktop_state_2': 'DELETED'}
2016-08-17 18:20:14,868 WARNING celery.redirected 2016-08-17 18:20:14,868 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:20:14,869 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:20:14,875 INFO celery.worker.job Task schedule_clean_desktops[f6ba0186-5947-49eb-8442-3a6460e7a0fe] succeeded in 0.018535769999289187s: None
2016-08-17 18:20:28,862 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:20:28,862 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:20:28,865 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:20:28,865 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:20:28,870 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:20:28,870 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:20:28,870 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:20:28,870 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:20:58,872 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:20:58,872 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:20:58,872 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:20:58,872 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:20:58,878 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:20:58,878 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:20:58,878 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:20:58,878 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:21:13,871 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:21:14,692 INFO celery.worker.strategy Received task: schedule_start_lesson[ade06338-63db-46c1-a9d2-4f155acefcc4]
2016-08-17 18:21:14,693 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:21:14,694 INFO celery Scheduling start lesson tasks
2016-08-17 18:21:14,695 WARNING celery.redirected 2016-08-17 18:21:14,695 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:21:14,696 WARNING celery.redirected 2016-08-17 18:21:14,696 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:21:14,696 WARNING celery.redirected 2016-08-17 18:21:14,696 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:21:14,700 WARNING celery.redirected 2016-08-17 18:21:14,700 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:21:14,701 WARNING celery.redirected 2016-08-17 18:21:14,701 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 21, 14, 698136), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 31, 14, 698136)}
2016-08-17 18:21:14,703 WARNING celery.redirected 2016-08-17 18:21:14,703 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:21:14,704 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:21:14,710 INFO celery.worker.job Task schedule_start_lesson[ade06338-63db-46c1-a9d2-4f155acefcc4] succeeded in 0.016929645000345772s: None
2016-08-17 18:21:18,895 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:21:19,420 INFO celery.worker.strategy Received task: schedule_clean_desktops[f45c9c04-c026-455a-8aaf-9a65cbaf13dd]
2016-08-17 18:21:19,421 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:21:19,423 WARNING celery.redirected 2016-08-17 18:21:19,423 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:21:19,424 WARNING celery.redirected 2016-08-17 18:21:19,424 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:21:19,424 WARNING celery.redirected 2016-08-17 18:21:19,424 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:21:19,428 WARNING celery.redirected 2016-08-17 18:21:19,428 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:21:19,428 WARNING celery.redirected 2016-08-17 18:21:19,428 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 20, 19, 422522), 'desktop_state_2': 'DELETED'}
2016-08-17 18:21:19,430 WARNING celery.redirected 2016-08-17 18:21:19,430 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:21:19,431 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:21:19,439 INFO celery.worker.job Task schedule_clean_desktops[f45c9c04-c026-455a-8aaf-9a65cbaf13dd] succeeded in 0.01796780499716988s: None
2016-08-17 18:21:28,920 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:21:28,920 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:21:28,923 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:21:28,923 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:21:28,928 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:21:28,928 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:21:28,928 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:21:28,928 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:22:03,920 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:22:03,920 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:22:03,920 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:22:03,920 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:22:03,925 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:22:03,925 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:22:03,926 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:22:03,926 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:22:18,923 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:22:19,223 INFO celery.worker.strategy Received task: schedule_start_lesson[4b7633c3-c2af-41ec-a75e-f64e7324b14d]
2016-08-17 18:22:19,224 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:22:19,224 INFO celery Scheduling start lesson tasks
2016-08-17 18:22:19,225 WARNING celery.redirected 2016-08-17 18:22:19,225 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:22:19,226 WARNING celery.redirected 2016-08-17 18:22:19,226 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:22:19,227 WARNING celery.redirected 2016-08-17 18:22:19,227 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:22:19,230 WARNING celery.redirected 2016-08-17 18:22:19,230 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:22:19,231 WARNING celery.redirected 2016-08-17 18:22:19,230 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 22, 19, 228374), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 32, 19, 228374)}
2016-08-17 18:22:19,232 WARNING celery.redirected 2016-08-17 18:22:19,232 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:22:19,233 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:22:19,241 INFO celery.worker.job Task schedule_start_lesson[4b7633c3-c2af-41ec-a75e-f64e7324b14d] succeeded in 0.016877572998055257s: None
2016-08-17 18:22:23,936 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:22:23,956 INFO celery.worker.strategy Received task: schedule_clean_desktops[7d125dd3-b68c-4b47-98c6-eaf05122e337]
2016-08-17 18:22:23,957 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:22:23,958 WARNING celery.redirected 2016-08-17 18:22:23,958 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:22:23,959 WARNING celery.redirected 2016-08-17 18:22:23,959 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:22:23,960 WARNING celery.redirected 2016-08-17 18:22:23,959 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:22:23,964 WARNING celery.redirected 2016-08-17 18:22:23,964 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:22:23,965 WARNING celery.redirected 2016-08-17 18:22:23,965 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 21, 23, 957855)}
2016-08-17 18:22:23,967 WARNING celery.redirected 2016-08-17 18:22:23,967 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:22:23,968 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:22:23,975 INFO celery.worker.job Task schedule_clean_desktops[7d125dd3-b68c-4b47-98c6-eaf05122e337] succeeded in 0.018754928998532705s: None
2016-08-17 18:22:33,956 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:22:33,956 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:22:33,959 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:22:33,959 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:22:33,964 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:22:33,964 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:22:33,965 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:22:33,965 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:23:03,968 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:23:03,969 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:23:03,969 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:23:03,969 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:23:03,974 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:23:03,974 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:23:03,974 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:23:03,975 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:23:23,990 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:23:24,007 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:23:25,009 INFO celery.worker.strategy Received task: schedule_start_lesson[412642b0-40b7-4963-b4d4-bd2f50b02d37]
2016-08-17 18:23:25,010 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:23:25,011 INFO celery Scheduling start lesson tasks
2016-08-17 18:23:25,012 WARNING celery.redirected 2016-08-17 18:23:25,012 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:23:25,013 WARNING celery.redirected 2016-08-17 18:23:25,013 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:23:25,013 WARNING celery.redirected 2016-08-17 18:23:25,013 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:23:25,016 WARNING celery.redirected 2016-08-17 18:23:25,016 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:23:25,017 WARNING celery.redirected 2016-08-17 18:23:25,017 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 23, 25, 14839), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 33, 25, 14839)}
2016-08-17 18:23:25,020 WARNING celery.redirected 2016-08-17 18:23:25,020 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:23:25,021 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:23:25,028 INFO celery.worker.job Task schedule_start_lesson[412642b0-40b7-4963-b4d4-bd2f50b02d37] succeeded in 0.017908663001435343s: None
2016-08-17 18:23:25,077 INFO celery.worker.strategy Received task: schedule_clean_desktops[a05035fe-bffb-4520-b608-14f2181ad465]
2016-08-17 18:23:25,078 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:23:25,080 WARNING celery.redirected 2016-08-17 18:23:25,080 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:23:25,081 WARNING celery.redirected 2016-08-17 18:23:25,081 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:23:25,081 WARNING celery.redirected 2016-08-17 18:23:25,081 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:23:25,084 WARNING celery.redirected 2016-08-17 18:23:25,084 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:23:25,085 WARNING celery.redirected 2016-08-17 18:23:25,085 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 22, 25, 79651)}
2016-08-17 18:23:25,087 WARNING celery.redirected 2016-08-17 18:23:25,087 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:23:25,088 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:23:25,095 INFO celery.worker.job Task schedule_clean_desktops[a05035fe-bffb-4520-b608-14f2181ad465] succeeded in 0.01669553499959875s: None
2016-08-17 18:23:34,026 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:23:34,026 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:23:34,029 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:23:34,029 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:23:34,033 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:23:34,034 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:23:34,034 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:23:34,034 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:24:09,029 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:24:09,029 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:24:09,029 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:24:09,030 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:24:09,034 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:24:09,035 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:24:09,035 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:24:09,035 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:24:24,023 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:24:24,040 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:24:24,875 INFO celery.worker.strategy Received task: schedule_start_lesson[ad1a9f35-88fe-4ae9-bd8c-e327a39f9e21]
2016-08-17 18:24:24,877 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:24:24,877 INFO celery Scheduling start lesson tasks
2016-08-17 18:24:24,878 WARNING celery.redirected 2016-08-17 18:24:24,878 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:24:24,879 WARNING celery.redirected 2016-08-17 18:24:24,879 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:24:24,879 WARNING celery.redirected 2016-08-17 18:24:24,879 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:24:24,883 WARNING celery.redirected 2016-08-17 18:24:24,883 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:24:24,883 WARNING celery.redirected 2016-08-17 18:24:24,883 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 24, 24, 881028), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 34, 24, 881028)}
2016-08-17 18:24:24,885 WARNING celery.redirected 2016-08-17 18:24:24,885 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:24:24,886 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:24:24,894 INFO celery.worker.job Task schedule_start_lesson[ad1a9f35-88fe-4ae9-bd8c-e327a39f9e21] succeeded in 0.017543718000524677s: None
2016-08-17 18:24:24,945 INFO celery.worker.strategy Received task: schedule_clean_desktops[1fcb49d4-2fe1-477a-9015-2451ede04d66]
2016-08-17 18:24:24,947 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:24:24,948 WARNING celery.redirected 2016-08-17 18:24:24,948 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:24:24,949 WARNING celery.redirected 2016-08-17 18:24:24,949 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:24:24,950 WARNING celery.redirected 2016-08-17 18:24:24,950 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:24:24,953 WARNING celery.redirected 2016-08-17 18:24:24,953 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:24:24,954 WARNING celery.redirected 2016-08-17 18:24:24,954 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 23, 24, 947863)}
2016-08-17 18:24:24,956 WARNING celery.redirected 2016-08-17 18:24:24,956 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:24:24,957 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:24:24,964 INFO celery.worker.job Task schedule_clean_desktops[1fcb49d4-2fe1-477a-9015-2451ede04d66] succeeded in 0.017036559998814482s: None
2016-08-17 18:24:39,048 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:24:39,048 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:24:39,050 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:24:39,050 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:24:39,055 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:24:39,055 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:24:39,055 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:24:39,055 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:25:14,047 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:25:14,047 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:25:14,047 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:25:14,047 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:25:14,053 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:25:14,053 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:25:14,053 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:25:14,054 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:25:24,047 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:25:24,064 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:25:24,789 INFO celery.worker.strategy Received task: schedule_start_lesson[cfbd2f5f-f486-492e-a41c-d36391b5e0a3]
2016-08-17 18:25:24,790 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:25:24,791 INFO celery Scheduling start lesson tasks
2016-08-17 18:25:24,792 WARNING celery.redirected 2016-08-17 18:25:24,792 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:25:24,793 WARNING celery.redirected 2016-08-17 18:25:24,792 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:25:24,793 WARNING celery.redirected 2016-08-17 18:25:24,793 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:25:24,796 WARNING celery.redirected 2016-08-17 18:25:24,796 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:25:24,797 WARNING celery.redirected 2016-08-17 18:25:24,797 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 25, 24, 794762), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 35, 24, 794762)}
2016-08-17 18:25:24,799 WARNING celery.redirected 2016-08-17 18:25:24,799 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:25:24,800 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:25:24,807 INFO celery.worker.job Task schedule_start_lesson[cfbd2f5f-f486-492e-a41c-d36391b5e0a3] succeeded in 0.01698670900077559s: None
2016-08-17 18:25:24,857 INFO celery.worker.strategy Received task: schedule_clean_desktops[5257d677-71fa-4f32-8b27-286db9f8470a]
2016-08-17 18:25:24,858 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:25:24,859 WARNING celery.redirected 2016-08-17 18:25:24,859 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:25:24,860 WARNING celery.redirected 2016-08-17 18:25:24,860 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:25:24,861 WARNING celery.redirected 2016-08-17 18:25:24,861 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:25:24,864 WARNING celery.redirected 2016-08-17 18:25:24,864 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:25:24,864 WARNING celery.redirected 2016-08-17 18:25:24,864 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 24, 24, 858989)}
2016-08-17 18:25:24,866 WARNING celery.redirected 2016-08-17 18:25:24,866 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:25:24,867 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:25:24,874 INFO celery.worker.job Task schedule_clean_desktops[5257d677-71fa-4f32-8b27-286db9f8470a] succeeded in 0.01594297799965716s: None
2016-08-17 18:25:44,067 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:25:44,067 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:25:44,070 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:25:44,070 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:25:44,074 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:25:44,075 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:25:44,075 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:25:44,075 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:26:14,081 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:26:14,081 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:26:14,081 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:26:14,081 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:26:14,086 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:26:14,086 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:26:14,087 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:26:14,087 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:26:24,083 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:26:24,099 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:26:24,666 INFO celery.worker.strategy Received task: schedule_start_lesson[a69085c7-1bdd-41c5-9295-980244d0cd8c]
2016-08-17 18:26:24,667 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:26:24,667 INFO celery Scheduling start lesson tasks
2016-08-17 18:26:24,668 WARNING celery.redirected 2016-08-17 18:26:24,668 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:26:24,669 WARNING celery.redirected 2016-08-17 18:26:24,669 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:26:24,670 WARNING celery.redirected 2016-08-17 18:26:24,669 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:26:24,673 WARNING celery.redirected 2016-08-17 18:26:24,673 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:26:24,673 WARNING celery.redirected 2016-08-17 18:26:24,673 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 26, 24, 671245), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 36, 24, 671245)}
2016-08-17 18:26:24,675 WARNING celery.redirected 2016-08-17 18:26:24,675 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:26:24,676 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:26:24,684 INFO celery.worker.job Task schedule_start_lesson[a69085c7-1bdd-41c5-9295-980244d0cd8c] succeeded in 0.017391249002685072s: None
2016-08-17 18:26:24,735 INFO celery.worker.strategy Received task: schedule_clean_desktops[5482f103-5760-4dca-9b77-a4cc0cb528ae]
2016-08-17 18:26:24,736 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:26:24,737 WARNING celery.redirected 2016-08-17 18:26:24,737 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:26:24,738 WARNING celery.redirected 2016-08-17 18:26:24,738 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:26:24,738 WARNING celery.redirected 2016-08-17 18:26:24,738 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:26:24,742 WARNING celery.redirected 2016-08-17 18:26:24,742 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:26:24,742 WARNING celery.redirected 2016-08-17 18:26:24,742 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 25, 24, 736813), 'desktop_state_2': 'DELETED'}
2016-08-17 18:26:24,744 WARNING celery.redirected 2016-08-17 18:26:24,744 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:26:24,745 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:26:24,752 INFO celery.worker.job Task schedule_clean_desktops[5482f103-5760-4dca-9b77-a4cc0cb528ae] succeeded in 0.016090017998067196s: None
2016-08-17 18:26:44,114 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:26:44,114 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:26:44,116 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:26:44,116 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:26:44,121 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:26:44,121 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:26:44,122 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:26:44,122 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:27:14,124 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:27:14,124 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:27:14,125 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:27:14,125 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:27:24,115 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:27:24,131 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:27:24,565 INFO celery.worker.strategy Received task: schedule_start_lesson[a507df4b-b695-499b-aa80-8411fc5e87b6]
2016-08-17 18:27:24,566 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:27:24,567 INFO celery Scheduling start lesson tasks
2016-08-17 18:27:24,568 WARNING celery.redirected 2016-08-17 18:27:24,568 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:27:24,569 WARNING celery.redirected 2016-08-17 18:27:24,569 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:27:24,569 WARNING celery.redirected 2016-08-17 18:27:24,569 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:27:24,572 WARNING celery.redirected 2016-08-17 18:27:24,572 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:27:24,573 WARNING celery.redirected 2016-08-17 18:27:24,573 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 27, 24, 570813), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 37, 24, 570813)}
2016-08-17 18:27:24,575 WARNING celery.redirected 2016-08-17 18:27:24,575 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:27:24,576 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:27:24,583 INFO celery.worker.job Task schedule_start_lesson[a507df4b-b695-499b-aa80-8411fc5e87b6] succeeded in 0.0171359410014702s: None
2016-08-17 18:27:24,633 INFO celery.worker.strategy Received task: schedule_clean_desktops[797cb92e-1652-4ddd-8164-96c58ba355e8]
2016-08-17 18:27:24,634 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:27:24,635 WARNING celery.redirected 2016-08-17 18:27:24,635 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:27:24,636 WARNING celery.redirected 2016-08-17 18:27:24,636 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:27:24,637 WARNING celery.redirected 2016-08-17 18:27:24,637 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:27:24,640 WARNING celery.redirected 2016-08-17 18:27:24,640 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:27:24,641 WARNING celery.redirected 2016-08-17 18:27:24,641 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 26, 24, 635171)}
2016-08-17 18:27:24,643 WARNING celery.redirected 2016-08-17 18:27:24,642 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:27:24,644 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:27:24,652 INFO celery.worker.job Task schedule_clean_desktops[797cb92e-1652-4ddd-8164-96c58ba355e8] succeeded in 0.017857696999271866s: None
2016-08-17 18:27:44,154 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:27:44,154 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:27:44,156 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:27:44,157 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:27:44,161 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:27:44,162 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:27:44,162 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:27:44,162 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:28:19,156 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:28:19,156 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:28:19,157 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:28:19,157 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:28:19,162 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:28:19,162 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:28:19,162 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:28:19,162 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:28:24,159 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:28:24,177 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:28:24,582 INFO celery.worker.strategy Received task: schedule_start_lesson[7d3112f1-94e5-463a-b417-8a6dab72949b]
2016-08-17 18:28:24,583 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:28:24,583 INFO celery Scheduling start lesson tasks
2016-08-17 18:28:24,585 WARNING celery.redirected 2016-08-17 18:28:24,585 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:28:24,586 WARNING celery.redirected 2016-08-17 18:28:24,586 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:28:24,586 WARNING celery.redirected 2016-08-17 18:28:24,586 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:28:24,590 WARNING celery.redirected 2016-08-17 18:28:24,590 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:28:24,590 WARNING celery.redirected 2016-08-17 18:28:24,590 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 28, 24, 587855), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 38, 24, 587855)}
2016-08-17 18:28:24,592 WARNING celery.redirected 2016-08-17 18:28:24,592 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:28:24,594 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:28:24,600 INFO celery.worker.job Task schedule_start_lesson[7d3112f1-94e5-463a-b417-8a6dab72949b] succeeded in 0.017658467000728706s: None
2016-08-17 18:28:24,649 INFO celery.worker.strategy Received task: schedule_clean_desktops[f6016982-11c7-452a-820b-f8e92ef0f340]
2016-08-17 18:28:24,651 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:28:24,653 WARNING celery.redirected 2016-08-17 18:28:24,653 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:28:24,654 WARNING celery.redirected 2016-08-17 18:28:24,654 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:28:24,654 WARNING celery.redirected 2016-08-17 18:28:24,654 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:28:24,657 WARNING celery.redirected 2016-08-17 18:28:24,657 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:28:24,658 WARNING celery.redirected 2016-08-17 18:28:24,658 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 27, 24, 652423), 'desktop_state_2': 'DELETED'}
2016-08-17 18:28:24,660 WARNING celery.redirected 2016-08-17 18:28:24,660 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:28:24,661 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:28:24,668 INFO celery.worker.job Task schedule_clean_desktops[f6016982-11c7-452a-820b-f8e92ef0f340] succeeded in 0.01690103099826956s: None
2016-08-17 18:28:49,207 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:28:49,207 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:28:49,209 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:28:49,209 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:28:49,214 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:28:49,214 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:28:49,214 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:28:49,214 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:29:19,225 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:29:19,225 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:29:19,225 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:29:19,225 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:29:19,230 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:29:19,230 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:29:19,231 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:29:19,231 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:29:24,234 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:29:24,252 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:29:24,457 INFO celery.worker.strategy Received task: schedule_start_lesson[24ca8cf9-7588-495e-aa29-800312ff03ce]
2016-08-17 18:29:24,459 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:29:24,459 INFO celery Scheduling start lesson tasks
2016-08-17 18:29:24,460 WARNING celery.redirected 2016-08-17 18:29:24,460 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:29:24,461 WARNING celery.redirected 2016-08-17 18:29:24,461 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:29:24,461 WARNING celery.redirected 2016-08-17 18:29:24,461 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:29:24,466 WARNING celery.redirected 2016-08-17 18:29:24,466 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:29:24,467 WARNING celery.redirected 2016-08-17 18:29:24,467 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 29, 24, 464409), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 39, 24, 464409)}
2016-08-17 18:29:24,469 WARNING celery.redirected 2016-08-17 18:29:24,468 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:29:24,470 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:29:24,476 INFO celery.worker.job Task schedule_start_lesson[24ca8cf9-7588-495e-aa29-800312ff03ce] succeeded in 0.017673120000836207s: None
2016-08-17 18:29:24,528 INFO celery.worker.strategy Received task: schedule_clean_desktops[045f70ec-c95a-4ff0-af52-ee895cb817cc]
2016-08-17 18:29:24,529 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:29:24,530 WARNING celery.redirected 2016-08-17 18:29:24,530 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:29:24,531 WARNING celery.redirected 2016-08-17 18:29:24,531 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:29:24,532 WARNING celery.redirected 2016-08-17 18:29:24,532 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:29:24,535 WARNING celery.redirected 2016-08-17 18:29:24,535 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:29:24,536 WARNING celery.redirected 2016-08-17 18:29:24,536 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 28, 24, 530173), 'desktop_state_2': 'DELETED'}
2016-08-17 18:29:24,538 WARNING celery.redirected 2016-08-17 18:29:24,538 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:29:24,539 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:29:24,546 INFO celery.worker.job Task schedule_clean_desktops[045f70ec-c95a-4ff0-af52-ee895cb817cc] succeeded in 0.01684582700181636s: None
2016-08-17 18:29:49,275 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:29:49,276 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:29:49,278 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:29:49,278 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:29:49,283 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:29:49,283 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:29:49,283 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:29:49,283 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:30:24,278 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:30:24,278 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:30:24,278 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:30:24,278 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:30:24,280 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:30:24,297 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:30:24,297 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:30:24,299 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:30:24,300 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:30:24,300 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:30:24,365 INFO celery.worker.strategy Received task: schedule_start_lesson[421e4f7b-4790-4063-a7a6-b9424a3397a0]
2016-08-17 18:30:24,366 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:30:24,366 INFO celery Scheduling start lesson tasks
2016-08-17 18:30:24,367 WARNING celery.redirected 2016-08-17 18:30:24,367 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:30:24,368 WARNING celery.redirected 2016-08-17 18:30:24,368 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:30:24,369 WARNING celery.redirected 2016-08-17 18:30:24,368 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:30:24,372 WARNING celery.redirected 2016-08-17 18:30:24,372 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:30:24,372 WARNING celery.redirected 2016-08-17 18:30:24,372 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 30, 24, 370290), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 40, 24, 370290)}
2016-08-17 18:30:24,374 WARNING celery.redirected 2016-08-17 18:30:24,374 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:30:24,375 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:30:24,382 INFO celery.worker.job Task schedule_start_lesson[421e4f7b-4790-4063-a7a6-b9424a3397a0] succeeded in 0.01624342599825468s: None
2016-08-17 18:30:24,537 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:30:24,537 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:30:24,539 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:30:24,539 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:30:24,543 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:30:24,543 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:30:24,543 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:30:24,544 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:30:25,568 INFO celery.worker.strategy Received task: schedule_clean_desktops[48bd485e-649f-4c2a-94ad-c5bcafa98c3f]
2016-08-17 18:30:25,569 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:30:25,571 WARNING celery.redirected 2016-08-17 18:30:25,571 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:30:25,572 WARNING celery.redirected 2016-08-17 18:30:25,572 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:30:25,572 WARNING celery.redirected 2016-08-17 18:30:25,572 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:30:25,575 WARNING celery.redirected 2016-08-17 18:30:25,575 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:30:25,576 WARNING celery.redirected 2016-08-17 18:30:25,576 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 29, 25, 570565), 'desktop_state_2': 'DELETED'}
2016-08-17 18:30:25,578 WARNING celery.redirected 2016-08-17 18:30:25,578 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:30:25,579 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:30:25,585 INFO celery.worker.job Task schedule_clean_desktops[48bd485e-649f-4c2a-94ad-c5bcafa98c3f] succeeded in 0.01585654099835665s: None
2016-08-17 18:30:59,545 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:30:59,545 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:30:59,545 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:30:59,545 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:30:59,551 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:30:59,551 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:30:59,551 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:30:59,551 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:31:24,552 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:31:24,569 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:31:25,391 INFO celery.worker.strategy Received task: schedule_start_lesson[f964858e-b9fe-46a4-80f9-0b67020351c2]
2016-08-17 18:31:25,394 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:31:25,394 INFO celery Scheduling start lesson tasks
2016-08-17 18:31:25,395 WARNING celery.redirected 2016-08-17 18:31:25,395 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:31:25,396 WARNING celery.redirected 2016-08-17 18:31:25,396 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:31:25,397 WARNING celery.redirected 2016-08-17 18:31:25,396 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:31:25,400 WARNING celery.redirected 2016-08-17 18:31:25,400 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:31:25,401 WARNING celery.redirected 2016-08-17 18:31:25,401 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 31, 25, 398287), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 41, 25, 398287)}
2016-08-17 18:31:25,403 WARNING celery.redirected 2016-08-17 18:31:25,403 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:31:25,404 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:31:25,410 INFO celery.worker.job Task schedule_start_lesson[f964858e-b9fe-46a4-80f9-0b67020351c2] succeeded in 0.016973651003354462s: None
2016-08-17 18:31:25,462 INFO celery.worker.strategy Received task: schedule_clean_desktops[dafd5f4d-57ee-4e47-8a7d-92f9dbb03ffc]
2016-08-17 18:31:25,463 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:31:25,465 WARNING celery.redirected 2016-08-17 18:31:25,465 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:31:25,466 WARNING celery.redirected 2016-08-17 18:31:25,465 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:31:25,466 WARNING celery.redirected 2016-08-17 18:31:25,466 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:31:25,469 WARNING celery.redirected 2016-08-17 18:31:25,469 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:31:25,470 WARNING celery.redirected 2016-08-17 18:31:25,470 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 30, 25, 464393)}
2016-08-17 18:31:25,472 WARNING celery.redirected 2016-08-17 18:31:25,472 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:31:25,473 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:31:25,479 INFO celery.worker.job Task schedule_clean_desktops[dafd5f4d-57ee-4e47-8a7d-92f9dbb03ffc] succeeded in 0.016300027000397677s: None
2016-08-17 18:31:29,584 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:31:29,584 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:31:29,586 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:31:29,586 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:31:29,591 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:31:29,591 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:31:29,591 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:31:29,591 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:31:59,593 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:31:59,594 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:31:59,594 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:31:59,594 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:31:59,599 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:31:59,599 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:31:59,599 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:31:59,599 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:32:29,603 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:32:29,603 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:32:29,604 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:32:29,604 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:32:29,606 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:32:29,622 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:32:29,622 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:32:29,624 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:32:29,625 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:32:29,625 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:32:29,641 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:32:29,642 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:32:29,644 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:32:29,644 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:32:29,647 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:32:29,647 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:32:29,648 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:32:29,648 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:32:30,042 INFO celery.worker.strategy Received task: schedule_start_lesson[82b28f06-87ab-4139-b11e-660216854447]
2016-08-17 18:32:30,043 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:32:30,044 INFO celery Scheduling start lesson tasks
2016-08-17 18:32:30,045 WARNING celery.redirected 2016-08-17 18:32:30,045 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:32:30,047 WARNING celery.redirected 2016-08-17 18:32:30,046 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:32:30,047 WARNING celery.redirected 2016-08-17 18:32:30,047 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:32:30,053 WARNING celery.redirected 2016-08-17 18:32:30,053 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:32:30,054 WARNING celery.redirected 2016-08-17 18:32:30,053 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 32, 30, 49710), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 42, 30, 49710)}
2016-08-17 18:32:30,056 WARNING celery.redirected 2016-08-17 18:32:30,056 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:32:30,057 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:32:30,065 INFO celery.worker.job Task schedule_start_lesson[82b28f06-87ab-4139-b11e-660216854447] succeeded in 0.021514836000278592s: None
2016-08-17 18:32:30,113 INFO celery.worker.strategy Received task: schedule_clean_desktops[1b55451f-0b01-4e8f-8ec4-28bc26860a52]
2016-08-17 18:32:30,114 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:32:30,115 WARNING celery.redirected 2016-08-17 18:32:30,115 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:32:30,117 WARNING celery.redirected 2016-08-17 18:32:30,117 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:32:30,117 WARNING celery.redirected 2016-08-17 18:32:30,117 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:32:30,121 WARNING celery.redirected 2016-08-17 18:32:30,121 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:32:30,121 WARNING celery.redirected 2016-08-17 18:32:30,121 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 31, 30, 115172), 'desktop_state_2': 'DELETED'}
2016-08-17 18:32:30,123 WARNING celery.redirected 2016-08-17 18:32:30,123 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:32:30,124 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:32:30,131 INFO celery.worker.job Task schedule_clean_desktops[1b55451f-0b01-4e8f-8ec4-28bc26860a52] succeeded in 0.017098658998293104s: None
2016-08-17 18:32:59,649 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:32:59,649 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:32:59,650 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:32:59,650 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:32:59,655 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:32:59,655 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:32:59,655 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:32:59,655 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:33:34,652 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:33:34,652 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:33:34,652 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:33:34,653 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:33:34,655 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:33:34,960 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:33:34,961 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:33:34,963 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:33:34,963 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:33:34,963 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:33:34,980 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:33:34,980 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:33:34,982 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:33:34,982 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:33:34,985 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:33:34,985 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:33:34,986 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:33:34,986 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:33:35,982 INFO celery.worker.strategy Received task: schedule_start_lesson[376130a8-152f-477e-803c-fd91d249f29c]
2016-08-17 18:33:35,983 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:33:35,984 INFO celery Scheduling start lesson tasks
2016-08-17 18:33:35,985 WARNING celery.redirected 2016-08-17 18:33:35,984 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:33:35,985 WARNING celery.redirected 2016-08-17 18:33:35,985 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:33:35,986 WARNING celery.redirected 2016-08-17 18:33:35,986 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:33:35,989 WARNING celery.redirected 2016-08-17 18:33:35,989 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:33:35,990 WARNING celery.redirected 2016-08-17 18:33:35,990 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 33, 35, 987703), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 43, 35, 987703)}
2016-08-17 18:33:35,992 WARNING celery.redirected 2016-08-17 18:33:35,992 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:33:35,993 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:33:36,000 INFO celery.worker.job Task schedule_start_lesson[376130a8-152f-477e-803c-fd91d249f29c] succeeded in 0.016533971000171732s: None
2016-08-17 18:33:36,054 INFO celery.worker.strategy Received task: schedule_clean_desktops[a4a82885-c764-4a18-91c2-4aec4f728ae8]
2016-08-17 18:33:36,055 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:33:36,057 WARNING celery.redirected 2016-08-17 18:33:36,057 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:33:36,058 WARNING celery.redirected 2016-08-17 18:33:36,058 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:33:36,059 WARNING celery.redirected 2016-08-17 18:33:36,058 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:33:36,062 WARNING celery.redirected 2016-08-17 18:33:36,061 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:33:36,062 WARNING celery.redirected 2016-08-17 18:33:36,062 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 32, 36, 56349), 'desktop_state_2': 'DELETED'}
2016-08-17 18:33:36,064 WARNING celery.redirected 2016-08-17 18:33:36,064 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:33:36,065 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:33:36,072 INFO celery.worker.job Task schedule_clean_desktops[a4a82885-c764-4a18-91c2-4aec4f728ae8] succeeded in 0.01642336599979899s: None
2016-08-17 18:34:04,995 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:34:04,995 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:34:04,995 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:34:04,995 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:34:05,000 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:34:05,000 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:34:05,001 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:34:05,001 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:34:35,006 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:34:35,006 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:34:35,007 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:34:35,007 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:34:35,009 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:34:35,025 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:34:35,026 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:34:35,027 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:34:35,028 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:34:35,028 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:34:35,043 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:34:35,043 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:34:35,046 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:34:35,046 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:34:35,049 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:34:35,049 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:34:35,049 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:34:35,049 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:34:35,835 INFO celery.worker.strategy Received task: schedule_start_lesson[12bc846e-8c7d-4f30-8aa7-45a5ce7b9e1d]
2016-08-17 18:34:35,836 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:34:35,837 INFO celery Scheduling start lesson tasks
2016-08-17 18:34:35,838 WARNING celery.redirected 2016-08-17 18:34:35,838 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:34:35,839 WARNING celery.redirected 2016-08-17 18:34:35,839 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:34:35,839 WARNING celery.redirected 2016-08-17 18:34:35,839 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:34:35,842 WARNING celery.redirected 2016-08-17 18:34:35,842 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:34:35,843 WARNING celery.redirected 2016-08-17 18:34:35,843 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 34, 35, 840865), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 44, 35, 840865)}
2016-08-17 18:34:35,845 WARNING celery.redirected 2016-08-17 18:34:35,845 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:34:35,846 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:34:35,853 INFO celery.worker.job Task schedule_start_lesson[12bc846e-8c7d-4f30-8aa7-45a5ce7b9e1d] succeeded in 0.016833304001920624s: None
2016-08-17 18:34:35,906 INFO celery.worker.strategy Received task: schedule_clean_desktops[224d4af5-b37f-432e-9640-bb7e63615a56]
2016-08-17 18:34:35,907 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:34:35,908 WARNING celery.redirected 2016-08-17 18:34:35,908 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:34:35,909 WARNING celery.redirected 2016-08-17 18:34:35,909 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:34:35,910 WARNING celery.redirected 2016-08-17 18:34:35,910 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:34:35,913 WARNING celery.redirected 2016-08-17 18:34:35,913 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:34:35,913 WARNING celery.redirected 2016-08-17 18:34:35,913 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 33, 35, 908215)}
2016-08-17 18:34:35,915 WARNING celery.redirected 2016-08-17 18:34:35,915 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:34:35,916 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:34:35,924 INFO celery.worker.job Task schedule_clean_desktops[224d4af5-b37f-432e-9640-bb7e63615a56] succeeded in 0.016706117003195686s: None
2016-08-17 18:35:05,052 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:35:05,052 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:35:05,052 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:35:05,052 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:35:05,057 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:35:05,057 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:35:05,057 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:35:05,058 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:35:35,056 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:35:35,073 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:35:35,074 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:35:35,075 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:35:35,076 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:35:35,076 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:35:35,092 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:35:35,092 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:35:35,094 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:35:35,094 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:35:35,097 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:35:35,098 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:35:35,098 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:35:35,098 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:35:35,705 INFO celery.worker.strategy Received task: schedule_start_lesson[19038bbc-3fdb-464e-83a0-4cfa79d30d54]
2016-08-17 18:35:35,706 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:35:35,706 INFO celery Scheduling start lesson tasks
2016-08-17 18:35:35,707 WARNING celery.redirected 2016-08-17 18:35:35,707 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:35:35,708 WARNING celery.redirected 2016-08-17 18:35:35,708 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:35:35,709 WARNING celery.redirected 2016-08-17 18:35:35,708 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:35:35,712 WARNING celery.redirected 2016-08-17 18:35:35,712 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:35:35,712 WARNING celery.redirected 2016-08-17 18:35:35,712 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 35, 35, 710272), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 45, 35, 710272)}
2016-08-17 18:35:35,715 WARNING celery.redirected 2016-08-17 18:35:35,715 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:35:35,716 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:35:35,724 INFO celery.worker.job Task schedule_start_lesson[19038bbc-3fdb-464e-83a0-4cfa79d30d54] succeeded in 0.018044485001155408s: None
2016-08-17 18:35:35,774 INFO celery.worker.strategy Received task: schedule_clean_desktops[b75753e2-28c9-490b-85f0-096c596fd7c6]
2016-08-17 18:35:35,775 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:35:35,776 WARNING celery.redirected 2016-08-17 18:35:35,776 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:35:35,777 WARNING celery.redirected 2016-08-17 18:35:35,777 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:35:35,778 WARNING celery.redirected 2016-08-17 18:35:35,777 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:35:35,781 WARNING celery.redirected 2016-08-17 18:35:35,781 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:35:35,781 WARNING celery.redirected 2016-08-17 18:35:35,781 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 34, 35, 775945), 'desktop_state_2': 'DELETED'}
2016-08-17 18:35:35,784 WARNING celery.redirected 2016-08-17 18:35:35,784 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:35:35,785 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:35:35,791 INFO celery.worker.job Task schedule_clean_desktops[b75753e2-28c9-490b-85f0-096c596fd7c6] succeeded in 0.016336351000063587s: None
2016-08-17 18:36:05,103 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:36:05,103 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:36:05,103 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:36:05,103 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:36:05,108 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:36:05,108 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:36:05,109 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:36:05,109 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:36:35,108 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:36:35,124 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:36:35,125 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:36:35,126 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:36:35,126 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:36:35,127 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:36:35,146 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:36:35,146 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:36:35,148 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:36:35,148 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:36:35,151 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:36:35,151 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:36:35,152 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:36:35,152 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:36:35,626 INFO celery.worker.strategy Received task: schedule_start_lesson[e109dc91-682a-4727-b911-6acfe3c86181]
2016-08-17 18:36:35,627 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:36:35,627 INFO celery Scheduling start lesson tasks
2016-08-17 18:36:35,629 WARNING celery.redirected 2016-08-17 18:36:35,628 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:36:35,629 WARNING celery.redirected 2016-08-17 18:36:35,629 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:36:35,630 WARNING celery.redirected 2016-08-17 18:36:35,630 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:36:35,634 WARNING celery.redirected 2016-08-17 18:36:35,633 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:36:35,634 WARNING celery.redirected 2016-08-17 18:36:35,634 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 36, 35, 631967), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 46, 35, 631967)}
2016-08-17 18:36:35,636 WARNING celery.redirected 2016-08-17 18:36:35,636 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:36:35,637 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:36:35,643 INFO celery.worker.job Task schedule_start_lesson[e109dc91-682a-4727-b911-6acfe3c86181] succeeded in 0.016692311997758225s: None
2016-08-17 18:36:35,693 INFO celery.worker.strategy Received task: schedule_clean_desktops[8ea40e9f-95db-4674-ac5d-2e9cc74ddb88]
2016-08-17 18:36:35,694 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:36:35,696 WARNING celery.redirected 2016-08-17 18:36:35,696 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:36:35,697 WARNING celery.redirected 2016-08-17 18:36:35,697 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:36:35,697 WARNING celery.redirected 2016-08-17 18:36:35,697 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:36:35,701 WARNING celery.redirected 2016-08-17 18:36:35,701 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:36:35,701 WARNING celery.redirected 2016-08-17 18:36:35,701 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 35, 35, 695690), 'desktop_state_2': 'DELETED'}
2016-08-17 18:36:35,703 WARNING celery.redirected 2016-08-17 18:36:35,703 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:36:35,705 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:36:35,712 INFO celery.worker.job Task schedule_clean_desktops[8ea40e9f-95db-4674-ac5d-2e9cc74ddb88] succeeded in 0.017568028000823688s: None
2016-08-17 18:37:05,160 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:37:05,160 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:37:05,160 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:37:05,160 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:37:05,165 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:37:05,165 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:37:05,166 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:37:05,166 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:37:35,169 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:37:35,170 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:37:35,170 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:37:35,170 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:37:35,172 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:37:35,187 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:37:35,188 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:37:35,190 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:37:35,190 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:37:35,190 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:37:35,206 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:37:35,206 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:37:35,208 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:37:35,208 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:37:35,211 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:37:35,211 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:37:35,212 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:37:35,212 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:37:35,466 INFO celery.worker.strategy Received task: schedule_start_lesson[167ae841-6d6b-43aa-a9db-a3f266d997c3]
2016-08-17 18:37:35,468 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:37:35,468 INFO celery Scheduling start lesson tasks
2016-08-17 18:37:35,469 WARNING celery.redirected 2016-08-17 18:37:35,469 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:37:35,470 WARNING celery.redirected 2016-08-17 18:37:35,470 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:37:35,471 WARNING celery.redirected 2016-08-17 18:37:35,471 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:37:35,474 WARNING celery.redirected 2016-08-17 18:37:35,474 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:37:35,475 WARNING celery.redirected 2016-08-17 18:37:35,475 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 37, 35, 472614), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 47, 35, 472614)}
2016-08-17 18:37:35,477 WARNING celery.redirected 2016-08-17 18:37:35,477 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:37:35,478 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:37:35,484 INFO celery.worker.job Task schedule_start_lesson[167ae841-6d6b-43aa-a9db-a3f266d997c3] succeeded in 0.016679158001352334s: None
2016-08-17 18:37:35,533 INFO celery.worker.strategy Received task: schedule_clean_desktops[3c12a56b-5a72-48d2-b45e-478a3e4cb3e0]
2016-08-17 18:37:35,534 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:37:35,535 WARNING celery.redirected 2016-08-17 18:37:35,535 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:37:35,536 WARNING celery.redirected 2016-08-17 18:37:35,536 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:37:35,537 WARNING celery.redirected 2016-08-17 18:37:35,537 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:37:35,540 WARNING celery.redirected 2016-08-17 18:37:35,540 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:37:35,541 WARNING celery.redirected 2016-08-17 18:37:35,541 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 36, 35, 535208)}
2016-08-17 18:37:35,543 WARNING celery.redirected 2016-08-17 18:37:35,543 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:37:35,544 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:37:35,551 INFO celery.worker.job Task schedule_clean_desktops[3c12a56b-5a72-48d2-b45e-478a3e4cb3e0] succeeded in 0.017078254000807647s: None
2016-08-17 18:38:05,214 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:38:05,214 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:38:05,214 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:38:05,214 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:38:35,210 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:38:35,228 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:38:35,228 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:38:35,230 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:38:35,230 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:38:35,230 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:38:35,246 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:38:35,247 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:38:35,249 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:38:35,249 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:38:35,251 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:38:35,252 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:38:35,252 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:38:35,252 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:38:35,359 INFO celery.worker.strategy Received task: schedule_start_lesson[328ce8c5-7c42-4485-97eb-3c0f5ecc7e2b]
2016-08-17 18:38:35,361 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:38:35,361 INFO celery Scheduling start lesson tasks
2016-08-17 18:38:35,362 WARNING celery.redirected 2016-08-17 18:38:35,362 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:38:35,363 WARNING celery.redirected 2016-08-17 18:38:35,363 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:38:35,363 WARNING celery.redirected 2016-08-17 18:38:35,363 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:38:35,367 WARNING celery.redirected 2016-08-17 18:38:35,367 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:38:35,368 WARNING celery.redirected 2016-08-17 18:38:35,368 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 38, 35, 365127), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 48, 35, 365127)}
2016-08-17 18:38:35,370 WARNING celery.redirected 2016-08-17 18:38:35,370 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:38:35,371 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:38:35,377 INFO celery.worker.job Task schedule_start_lesson[328ce8c5-7c42-4485-97eb-3c0f5ecc7e2b] succeeded in 0.01660641199850943s: None
2016-08-17 18:38:35,426 INFO celery.worker.strategy Received task: schedule_clean_desktops[b4945f83-4b00-4167-9a49-2f0a446c4ee2]
2016-08-17 18:38:35,428 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:38:35,429 WARNING celery.redirected 2016-08-17 18:38:35,429 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:38:35,430 WARNING celery.redirected 2016-08-17 18:38:35,430 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:38:35,431 WARNING celery.redirected 2016-08-17 18:38:35,430 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:38:35,434 WARNING celery.redirected 2016-08-17 18:38:35,433 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:38:35,434 WARNING celery.redirected 2016-08-17 18:38:35,434 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 37, 35, 428835)}
2016-08-17 18:38:35,436 WARNING celery.redirected 2016-08-17 18:38:35,436 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:38:35,437 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:38:35,444 INFO celery.worker.job Task schedule_clean_desktops[b4945f83-4b00-4167-9a49-2f0a446c4ee2] succeeded in 0.01617543099928298s: None
2016-08-17 18:39:10,246 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:39:10,246 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:39:10,246 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:39:10,246 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:39:10,251 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:39:10,251 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:39:10,252 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:39:10,252 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:39:35,245 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:39:35,273 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:39:35,340 INFO celery.worker.strategy Received task: schedule_start_lesson[536875ba-a85f-436e-8dd5-8253e1ab3fab]
2016-08-17 18:39:35,342 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:39:35,342 INFO celery Scheduling start lesson tasks
2016-08-17 18:39:35,343 WARNING celery.redirected 2016-08-17 18:39:35,343 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:39:35,344 WARNING celery.redirected 2016-08-17 18:39:35,344 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:39:35,345 WARNING celery.redirected 2016-08-17 18:39:35,345 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:39:35,348 WARNING celery.redirected 2016-08-17 18:39:35,348 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:39:35,349 WARNING celery.redirected 2016-08-17 18:39:35,349 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 39, 35, 346440), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 49, 35, 346440)}
2016-08-17 18:39:35,351 WARNING celery.redirected 2016-08-17 18:39:35,351 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:39:35,352 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:39:35,359 INFO celery.worker.job Task schedule_start_lesson[536875ba-a85f-436e-8dd5-8253e1ab3fab] succeeded in 0.017282345001149224s: None
2016-08-17 18:39:36,543 INFO celery.worker.strategy Received task: schedule_clean_desktops[47ac9c2d-9877-4783-8c3b-2f3ffbfeacdc]
2016-08-17 18:39:36,544 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:39:36,545 WARNING celery.redirected 2016-08-17 18:39:36,545 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:39:36,546 WARNING celery.redirected 2016-08-17 18:39:36,546 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:39:36,547 WARNING celery.redirected 2016-08-17 18:39:36,547 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:39:36,550 WARNING celery.redirected 2016-08-17 18:39:36,550 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:39:36,550 WARNING celery.redirected 2016-08-17 18:39:36,550 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 38, 36, 545126), 'desktop_state_2': 'DELETED'}
2016-08-17 18:39:36,553 WARNING celery.redirected 2016-08-17 18:39:36,553 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:39:36,555 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:39:36,563 INFO celery.worker.job Task schedule_clean_desktops[47ac9c2d-9877-4783-8c3b-2f3ffbfeacdc] succeeded in 0.01912868200088269s: None
2016-08-17 18:39:40,518 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:39:40,518 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:39:40,520 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:39:40,520 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:39:40,525 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:39:40,525 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:39:40,526 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:39:40,526 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:40:10,536 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:40:10,537 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:40:10,537 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:40:10,537 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:40:10,542 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:40:10,542 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:40:10,542 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:40:10,543 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:40:35,552 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:40:35,568 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:40:36,373 INFO celery.worker.strategy Received task: schedule_start_lesson[47d53f71-6078-4d0e-a58f-31c0d9fdd0d4]
2016-08-17 18:40:36,374 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:40:36,374 INFO celery Scheduling start lesson tasks
2016-08-17 18:40:36,375 WARNING celery.redirected 2016-08-17 18:40:36,375 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:40:36,376 WARNING celery.redirected 2016-08-17 18:40:36,376 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:40:36,377 WARNING celery.redirected 2016-08-17 18:40:36,377 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:40:36,380 WARNING celery.redirected 2016-08-17 18:40:36,380 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:40:36,381 WARNING celery.redirected 2016-08-17 18:40:36,380 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 40, 36, 378411), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 50, 36, 378411)}
2016-08-17 18:40:36,382 WARNING celery.redirected 2016-08-17 18:40:36,382 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:40:36,383 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:40:36,390 INFO celery.worker.job Task schedule_start_lesson[47d53f71-6078-4d0e-a58f-31c0d9fdd0d4] succeeded in 0.016311098999722162s: None
2016-08-17 18:40:36,442 INFO celery.worker.strategy Received task: schedule_clean_desktops[f53a8ec7-c9a5-4a4e-8ab4-67707c8e1f9c]
2016-08-17 18:40:36,444 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:40:36,445 WARNING celery.redirected 2016-08-17 18:40:36,445 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:40:36,446 WARNING celery.redirected 2016-08-17 18:40:36,446 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:40:36,447 WARNING celery.redirected 2016-08-17 18:40:36,447 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:40:36,451 WARNING celery.redirected 2016-08-17 18:40:36,450 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:40:36,451 WARNING celery.redirected 2016-08-17 18:40:36,451 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 39, 36, 444810), 'desktop_state_2': 'DELETED'}
2016-08-17 18:40:36,453 WARNING celery.redirected 2016-08-17 18:40:36,453 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:40:36,454 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:40:36,460 INFO celery.worker.job Task schedule_clean_desktops[f53a8ec7-c9a5-4a4e-8ab4-67707c8e1f9c] succeeded in 0.016929355002503144s: None
2016-08-17 18:40:40,584 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:40:40,584 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:40:40,587 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:40:40,587 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:40:40,592 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:40:40,592 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:40:40,592 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:40:40,593 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:10,602 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:41:10,602 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:41:10,602 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:41:10,603 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:10,607 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:41:10,608 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:41:10,608 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:41:10,608 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:40,623 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:41:40,623 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:41:40,623 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:41:40,623 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:40,625 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:41:40,642 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:41:40,642 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:41:40,644 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:41:40,644 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:40,644 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:41:40,660 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:41:40,660 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:41:40,662 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:41:40,662 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:40,665 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:41:40,665 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:41:40,666 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:41:40,666 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:41:41,034 INFO celery.worker.strategy Received task: schedule_start_lesson[2bd859cf-93b0-4756-bc0a-8bfac5257d8e]
2016-08-17 18:41:41,036 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:41:41,036 INFO celery Scheduling start lesson tasks
2016-08-17 18:41:41,038 WARNING celery.redirected 2016-08-17 18:41:41,037 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:41:41,039 WARNING celery.redirected 2016-08-17 18:41:41,039 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:41:41,040 WARNING celery.redirected 2016-08-17 18:41:41,040 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:41:41,044 WARNING celery.redirected 2016-08-17 18:41:41,044 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:41:41,045 WARNING celery.redirected 2016-08-17 18:41:41,045 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 41, 41, 42176), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 51, 41, 42176)}
2016-08-17 18:41:41,047 WARNING celery.redirected 2016-08-17 18:41:41,047 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:41:41,048 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:41:41,054 INFO celery.worker.job Task schedule_start_lesson[2bd859cf-93b0-4756-bc0a-8bfac5257d8e] succeeded in 0.018823802001861623s: None
2016-08-17 18:41:41,106 INFO celery.worker.strategy Received task: schedule_clean_desktops[258bc790-5063-461e-9e2d-eb0f2139291b]
2016-08-17 18:41:41,107 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:41:41,109 WARNING celery.redirected 2016-08-17 18:41:41,108 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:41:41,110 WARNING celery.redirected 2016-08-17 18:41:41,109 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:41:41,110 WARNING celery.redirected 2016-08-17 18:41:41,110 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:41:41,113 WARNING celery.redirected 2016-08-17 18:41:41,113 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:41:41,113 WARNING celery.redirected 2016-08-17 18:41:41,113 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 40, 41, 108346), 'desktop_state_2': 'DELETED'}
2016-08-17 18:41:41,115 WARNING celery.redirected 2016-08-17 18:41:41,115 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:41:41,116 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:41:41,123 INFO celery.worker.job Task schedule_clean_desktops[258bc790-5063-461e-9e2d-eb0f2139291b] succeeded in 0.01565216699964367s: None
2016-08-17 18:42:10,672 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:42:10,672 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:42:10,673 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:42:10,673 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:42:10,678 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:42:10,679 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:42:10,679 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:42:10,679 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:42:40,687 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:42:40,687 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:42:40,687 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:42:40,687 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:42:40,693 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:42:40,694 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:42:40,694 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:42:40,694 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:42:45,687 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:42:45,874 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:42:46,939 INFO celery.worker.strategy Received task: schedule_start_lesson[37ed7373-c030-450c-8e9f-bf558bfbcf33]
2016-08-17 18:42:46,940 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:42:46,941 INFO celery Scheduling start lesson tasks
2016-08-17 18:42:46,941 WARNING celery.redirected 2016-08-17 18:42:46,941 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:42:46,942 WARNING celery.redirected 2016-08-17 18:42:46,942 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:42:46,943 WARNING celery.redirected 2016-08-17 18:42:46,943 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:42:46,946 WARNING celery.redirected 2016-08-17 18:42:46,946 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:42:46,947 WARNING celery.redirected 2016-08-17 18:42:46,947 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 42, 46, 944541), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 52, 46, 944541)}
2016-08-17 18:42:46,949 WARNING celery.redirected 2016-08-17 18:42:46,949 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:42:46,950 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:42:46,957 INFO celery.worker.job Task schedule_start_lesson[37ed7373-c030-450c-8e9f-bf558bfbcf33] succeeded in 0.016718865001166705s: None
2016-08-17 18:42:47,011 INFO celery.worker.strategy Received task: schedule_clean_desktops[f59e994b-bb2c-4de8-92a3-5ba85855279b]
2016-08-17 18:42:47,012 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:42:47,014 WARNING celery.redirected 2016-08-17 18:42:47,014 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:42:47,015 WARNING celery.redirected 2016-08-17 18:42:47,015 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:42:47,015 WARNING celery.redirected 2016-08-17 18:42:47,015 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:42:47,018 WARNING celery.redirected 2016-08-17 18:42:47,018 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:42:47,019 WARNING celery.redirected 2016-08-17 18:42:47,019 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 41, 47, 13601), 'desktop_state_2': 'DELETED'}
2016-08-17 18:42:47,021 WARNING celery.redirected 2016-08-17 18:42:47,021 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:42:47,022 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:42:47,030 INFO celery.worker.job Task schedule_clean_desktops[f59e994b-bb2c-4de8-92a3-5ba85855279b] succeeded in 0.017312633997789817s: None
2016-08-17 18:43:10,885 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:43:10,885 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:43:10,887 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:43:10,887 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:43:10,893 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:43:10,893 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:43:10,893 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:43:10,893 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:43:40,899 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:43:40,899 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:43:40,899 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:43:40,900 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:43:40,905 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:43:40,905 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:43:40,905 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:43:40,905 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:43:50,904 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:43:50,921 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:43:51,638 INFO celery.worker.strategy Received task: schedule_start_lesson[fcfdb7a5-c5fc-4dc0-b563-ced442b496d1]
2016-08-17 18:43:51,640 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:43:51,640 INFO celery Scheduling start lesson tasks
2016-08-17 18:43:51,641 WARNING celery.redirected 2016-08-17 18:43:51,641 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:43:51,642 WARNING celery.redirected 2016-08-17 18:43:51,642 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:43:51,642 WARNING celery.redirected 2016-08-17 18:43:51,642 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:43:51,646 WARNING celery.redirected 2016-08-17 18:43:51,646 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:43:51,646 WARNING celery.redirected 2016-08-17 18:43:51,646 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 43, 51, 644183), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 53, 51, 644183)}
2016-08-17 18:43:51,648 WARNING celery.redirected 2016-08-17 18:43:51,648 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:43:51,649 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:43:51,656 INFO celery.worker.job Task schedule_start_lesson[fcfdb7a5-c5fc-4dc0-b563-ced442b496d1] succeeded in 0.01667579199784086s: None
2016-08-17 18:43:51,706 INFO celery.worker.strategy Received task: schedule_clean_desktops[7a3b3c40-5f9f-4a83-899a-d7729f3df204]
2016-08-17 18:43:51,708 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:43:51,709 WARNING celery.redirected 2016-08-17 18:43:51,709 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:43:51,710 WARNING celery.redirected 2016-08-17 18:43:51,710 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:43:51,711 WARNING celery.redirected 2016-08-17 18:43:51,711 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:43:51,714 WARNING celery.redirected 2016-08-17 18:43:51,714 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:43:51,715 WARNING celery.redirected 2016-08-17 18:43:51,715 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 42, 51, 709084), 'desktop_state_2': 'DELETED'}
2016-08-17 18:43:51,717 WARNING celery.redirected 2016-08-17 18:43:51,717 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:43:51,718 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:43:51,724 INFO celery.worker.job Task schedule_clean_desktops[7a3b3c40-5f9f-4a83-899a-d7729f3df204] succeeded in 0.016078943001048174s: None
2016-08-17 18:44:10,942 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:44:10,942 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:44:10,944 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:44:10,944 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:44:10,949 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:44:10,949 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:44:10,950 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:44:10,950 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:44:40,961 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:44:40,962 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:44:40,962 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:44:40,962 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:44:40,967 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:44:40,967 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:44:40,967 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:44:40,968 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:44:55,969 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:44:55,986 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:44:56,337 INFO celery.worker.strategy Received task: schedule_start_lesson[b6174c43-859e-4407-a64c-8aad94a40b0e]
2016-08-17 18:44:56,338 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:44:56,339 INFO celery Scheduling start lesson tasks
2016-08-17 18:44:56,340 WARNING celery.redirected 2016-08-17 18:44:56,340 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:44:56,341 WARNING celery.redirected 2016-08-17 18:44:56,341 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:44:56,341 WARNING celery.redirected 2016-08-17 18:44:56,341 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:44:56,345 WARNING celery.redirected 2016-08-17 18:44:56,345 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:44:56,345 WARNING celery.redirected 2016-08-17 18:44:56,345 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 44, 56, 343182), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 54, 56, 343182)}
2016-08-17 18:44:56,347 WARNING celery.redirected 2016-08-17 18:44:56,347 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:44:56,348 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:44:56,355 INFO celery.worker.job Task schedule_start_lesson[b6174c43-859e-4407-a64c-8aad94a40b0e] succeeded in 0.016610675000265473s: None
2016-08-17 18:44:56,409 INFO celery.worker.strategy Received task: schedule_clean_desktops[7bc9fe86-b8fa-4ec9-848b-70992b77a044]
2016-08-17 18:44:56,410 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:44:56,412 WARNING celery.redirected 2016-08-17 18:44:56,412 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:44:56,413 WARNING celery.redirected 2016-08-17 18:44:56,413 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:44:56,413 WARNING celery.redirected 2016-08-17 18:44:56,413 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:44:56,417 WARNING celery.redirected 2016-08-17 18:44:56,417 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:44:56,417 WARNING celery.redirected 2016-08-17 18:44:56,417 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 43, 56, 411665)}
2016-08-17 18:44:56,419 WARNING celery.redirected 2016-08-17 18:44:56,419 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:44:56,420 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:44:56,427 INFO celery.worker.job Task schedule_clean_desktops[7bc9fe86-b8fa-4ec9-848b-70992b77a044] succeeded in 0.016550104999623727s: None
2016-08-17 18:45:11,012 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:45:11,012 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:45:11,015 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:45:11,015 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:45:11,019 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:45:11,020 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:45:11,020 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:45:11,020 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:45:41,023 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:45:41,023 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:45:41,024 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:45:41,024 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:45:41,029 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:45:41,029 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:45:41,029 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:45:41,029 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:45:56,029 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:45:56,045 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:45:56,295 INFO celery.worker.strategy Received task: schedule_start_lesson[9cc359a0-41e7-49fc-97c7-80621090d2ac]
2016-08-17 18:45:56,296 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:45:56,297 INFO celery Scheduling start lesson tasks
2016-08-17 18:45:56,297 WARNING celery.redirected 2016-08-17 18:45:56,297 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:45:56,298 WARNING celery.redirected 2016-08-17 18:45:56,298 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:45:56,299 WARNING celery.redirected 2016-08-17 18:45:56,299 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:45:56,302 WARNING celery.redirected 2016-08-17 18:45:56,302 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:45:56,303 WARNING celery.redirected 2016-08-17 18:45:56,303 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 45, 56, 300707), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 55, 56, 300707)}
2016-08-17 18:45:56,305 WARNING celery.redirected 2016-08-17 18:45:56,305 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:45:56,306 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:45:56,312 INFO celery.worker.job Task schedule_start_lesson[9cc359a0-41e7-49fc-97c7-80621090d2ac] succeeded in 0.016548157000215724s: None
2016-08-17 18:45:56,363 INFO celery.worker.strategy Received task: schedule_clean_desktops[a2c1c8a6-a529-470a-b856-1fc91c7ecfd9]
2016-08-17 18:45:56,364 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:45:56,366 WARNING celery.redirected 2016-08-17 18:45:56,366 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:45:56,367 WARNING celery.redirected 2016-08-17 18:45:56,367 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:45:56,367 WARNING celery.redirected 2016-08-17 18:45:56,367 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:45:56,370 WARNING celery.redirected 2016-08-17 18:45:56,370 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:45:56,371 WARNING celery.redirected 2016-08-17 18:45:56,371 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 44, 56, 365138)}
2016-08-17 18:45:56,373 WARNING celery.redirected 2016-08-17 18:45:56,373 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:45:56,374 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:45:56,381 INFO celery.worker.job Task schedule_clean_desktops[a2c1c8a6-a529-470a-b856-1fc91c7ecfd9] succeeded in 0.016877586000191513s: None
2016-08-17 18:46:11,061 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:46:11,062 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:46:11,064 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:46:11,064 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:46:11,069 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:46:11,069 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:46:11,069 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:46:11,069 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:46:46,062 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:46:46,063 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:46:46,063 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:46:46,063 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:46:46,068 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:46:46,068 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:46:46,069 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:46:46,069 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:46:56,064 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:46:56,081 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:46:56,152 INFO celery.worker.strategy Received task: schedule_start_lesson[94fd070b-0451-4b4b-9935-323892411782]
2016-08-17 18:46:56,154 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:46:56,154 INFO celery Scheduling start lesson tasks
2016-08-17 18:46:56,155 WARNING celery.redirected 2016-08-17 18:46:56,155 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:46:56,156 WARNING celery.redirected 2016-08-17 18:46:56,156 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:46:56,156 WARNING celery.redirected 2016-08-17 18:46:56,156 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:46:56,160 WARNING celery.redirected 2016-08-17 18:46:56,160 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:46:56,161 WARNING celery.redirected 2016-08-17 18:46:56,161 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 46, 56, 158518), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 56, 56, 158518)}
2016-08-17 18:46:56,163 WARNING celery.redirected 2016-08-17 18:46:56,163 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:46:56,164 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:46:56,170 INFO celery.worker.job Task schedule_start_lesson[94fd070b-0451-4b4b-9935-323892411782] succeeded in 0.01621688399973209s: None
2016-08-17 18:46:57,349 INFO celery.worker.strategy Received task: schedule_clean_desktops[3fef683f-8f6b-4aa9-ac52-58723a09a7d3]
2016-08-17 18:46:57,350 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:46:57,351 WARNING celery.redirected 2016-08-17 18:46:57,351 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:46:57,353 WARNING celery.redirected 2016-08-17 18:46:57,353 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:46:57,353 WARNING celery.redirected 2016-08-17 18:46:57,353 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:46:57,356 WARNING celery.redirected 2016-08-17 18:46:57,356 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:46:57,357 WARNING celery.redirected 2016-08-17 18:46:57,357 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 45, 57, 351107)}
2016-08-17 18:46:57,359 WARNING celery.redirected 2016-08-17 18:46:57,359 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:46:57,361 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:46:57,367 INFO celery.worker.job Task schedule_clean_desktops[3fef683f-8f6b-4aa9-ac52-58723a09a7d3] succeeded in 0.01763141999981599s: None
2016-08-17 18:47:16,328 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:47:16,328 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:47:16,331 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:47:16,331 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:47:16,336 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:47:16,336 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:47:16,336 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:47:16,336 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:47:51,328 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:47:51,328 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:47:51,329 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:47:51,329 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:47:51,334 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:47:51,334 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:47:51,334 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:47:51,334 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:47:56,329 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:47:56,345 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:47:57,137 INFO celery.worker.strategy Received task: schedule_start_lesson[853cc760-740a-4366-b389-6cd8e3df7d1b]
2016-08-17 18:47:57,138 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:47:57,139 INFO celery Scheduling start lesson tasks
2016-08-17 18:47:57,139 WARNING celery.redirected 2016-08-17 18:47:57,139 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:47:57,140 WARNING celery.redirected 2016-08-17 18:47:57,140 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:47:57,141 WARNING celery.redirected 2016-08-17 18:47:57,141 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:47:57,145 WARNING celery.redirected 2016-08-17 18:47:57,145 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:47:57,145 WARNING celery.redirected 2016-08-17 18:47:57,145 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 47, 57, 142948), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 57, 57, 142948)}
2016-08-17 18:47:57,147 WARNING celery.redirected 2016-08-17 18:47:57,147 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:47:57,148 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:47:57,154 INFO celery.worker.job Task schedule_start_lesson[853cc760-740a-4366-b389-6cd8e3df7d1b] succeeded in 0.016603408002993092s: None
2016-08-17 18:47:57,207 INFO celery.worker.strategy Received task: schedule_clean_desktops[5dcce5a3-407d-4ca9-ab37-35f3e24c3924]
2016-08-17 18:47:57,208 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:47:57,209 WARNING celery.redirected 2016-08-17 18:47:57,209 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:47:57,210 WARNING celery.redirected 2016-08-17 18:47:57,210 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:47:57,210 WARNING celery.redirected 2016-08-17 18:47:57,210 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:47:57,213 WARNING celery.redirected 2016-08-17 18:47:57,213 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:47:57,214 WARNING celery.redirected 2016-08-17 18:47:57,214 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 46, 57, 208783), 'desktop_state_2': 'DELETED'}
2016-08-17 18:47:57,216 WARNING celery.redirected 2016-08-17 18:47:57,216 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:47:57,217 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:47:57,223 INFO celery.worker.job Task schedule_clean_desktops[5dcce5a3-407d-4ca9-ab37-35f3e24c3924] succeeded in 0.015578462000121363s: None
2016-08-17 18:48:21,367 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:48:21,367 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:48:21,370 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:48:21,370 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:48:21,375 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:48:21,375 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:48:21,375 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:48:21,375 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:48:51,387 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:48:51,387 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:48:51,387 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:48:51,388 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:48:51,392 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:48:51,393 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:48:51,393 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:48:51,393 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:48:56,392 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:48:56,409 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:48:57,025 INFO celery.worker.strategy Received task: schedule_start_lesson[a667d2a5-90d8-4054-8fc0-992f22f0234d]
2016-08-17 18:48:57,027 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:48:57,027 INFO celery Scheduling start lesson tasks
2016-08-17 18:48:57,028 WARNING celery.redirected 2016-08-17 18:48:57,028 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:48:57,029 WARNING celery.redirected 2016-08-17 18:48:57,029 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:48:57,029 WARNING celery.redirected 2016-08-17 18:48:57,029 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:48:57,034 WARNING celery.redirected 2016-08-17 18:48:57,034 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:48:57,035 WARNING celery.redirected 2016-08-17 18:48:57,034 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 48, 57, 31091), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 58, 57, 31091)}
2016-08-17 18:48:57,037 WARNING celery.redirected 2016-08-17 18:48:57,037 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:48:57,038 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:48:57,045 INFO celery.worker.job Task schedule_start_lesson[a667d2a5-90d8-4054-8fc0-992f22f0234d] succeeded in 0.018787944998621242s: None
2016-08-17 18:48:57,095 INFO celery.worker.strategy Received task: schedule_clean_desktops[8a4b1250-08d0-40de-94c5-f586a8ddb23e]
2016-08-17 18:48:57,096 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:48:57,098 WARNING celery.redirected 2016-08-17 18:48:57,098 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:48:57,099 WARNING celery.redirected 2016-08-17 18:48:57,099 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:48:57,099 WARNING celery.redirected 2016-08-17 18:48:57,099 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:48:57,102 WARNING celery.redirected 2016-08-17 18:48:57,102 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:48:57,103 WARNING celery.redirected 2016-08-17 18:48:57,103 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 47, 57, 97247), 'desktop_state_2': 'DELETED'}
2016-08-17 18:48:57,105 WARNING celery.redirected 2016-08-17 18:48:57,105 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:48:57,106 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:48:57,113 INFO celery.worker.job Task schedule_clean_desktops[8a4b1250-08d0-40de-94c5-f586a8ddb23e] succeeded in 0.017050589998689247s: None
2016-08-17 18:49:21,439 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:49:21,439 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:49:21,442 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:49:21,442 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:49:21,447 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:49:21,447 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:49:21,448 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:49:21,448 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:49:56,437 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:49:56,438 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:49:56,438 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:49:56,438 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:49:56,440 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:49:56,456 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:49:56,457 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:49:56,459 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:49:56,459 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:49:56,460 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:49:56,477 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:49:56,477 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:49:56,479 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:49:56,479 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:49:56,482 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:49:56,482 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:49:56,482 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:49:56,482 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:49:56,947 INFO celery.worker.strategy Received task: schedule_start_lesson[5022c2f3-0e99-4ed6-b03c-1bc035682589]
2016-08-17 18:49:56,949 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:49:56,949 INFO celery Scheduling start lesson tasks
2016-08-17 18:49:56,950 WARNING celery.redirected 2016-08-17 18:49:56,950 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:49:56,951 WARNING celery.redirected 2016-08-17 18:49:56,951 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:49:56,952 WARNING celery.redirected 2016-08-17 18:49:56,951 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:49:56,956 WARNING celery.redirected 2016-08-17 18:49:56,955 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:49:56,956 WARNING celery.redirected 2016-08-17 18:49:56,956 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 49, 56, 953495), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(18, 59, 56, 953495)}
2016-08-17 18:49:56,958 WARNING celery.redirected 2016-08-17 18:49:56,958 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:49:56,959 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:49:56,966 INFO celery.worker.job Task schedule_start_lesson[5022c2f3-0e99-4ed6-b03c-1bc035682589] succeeded in 0.017195651998918038s: None
2016-08-17 18:49:57,020 INFO celery.worker.strategy Received task: schedule_clean_desktops[9084d456-5f21-442e-9606-d8a3f78b3635]
2016-08-17 18:49:57,021 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:49:57,022 WARNING celery.redirected 2016-08-17 18:49:57,022 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:49:57,024 WARNING celery.redirected 2016-08-17 18:49:57,023 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:49:57,024 WARNING celery.redirected 2016-08-17 18:49:57,024 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:49:57,027 WARNING celery.redirected 2016-08-17 18:49:57,027 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:49:57,028 WARNING celery.redirected 2016-08-17 18:49:57,028 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 48, 57, 21951), 'desktop_state_2': 'DELETED'}
2016-08-17 18:49:57,030 WARNING celery.redirected 2016-08-17 18:49:57,030 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:49:57,031 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:49:57,037 INFO celery.worker.job Task schedule_clean_desktops[9084d456-5f21-442e-9606-d8a3f78b3635] succeeded in 0.01647633199900156s: None
2016-08-17 18:50:26,491 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:50:26,491 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:50:26,491 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:50:26,491 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:50:26,497 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:50:26,497 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:50:26,497 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:50:26,497 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:50:56,491 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:50:56,508 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:50:56,508 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:50:56,510 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:50:56,510 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:50:56,510 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:50:56,527 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:50:56,527 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:50:56,529 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:50:56,529 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:50:56,531 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:50:56,531 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:50:56,532 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:50:56,532 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:50:56,801 INFO celery.worker.strategy Received task: schedule_start_lesson[15bdd854-fa4e-49aa-9bcf-5381a92d774b]
2016-08-17 18:50:56,802 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:50:56,803 INFO celery Scheduling start lesson tasks
2016-08-17 18:50:56,804 WARNING celery.redirected 2016-08-17 18:50:56,804 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:50:56,805 WARNING celery.redirected 2016-08-17 18:50:56,805 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:50:56,805 WARNING celery.redirected 2016-08-17 18:50:56,805 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:50:56,809 WARNING celery.redirected 2016-08-17 18:50:56,809 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:50:56,810 WARNING celery.redirected 2016-08-17 18:50:56,809 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 50, 56, 807294), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 0, 56, 807294)}
2016-08-17 18:50:56,811 WARNING celery.redirected 2016-08-17 18:50:56,811 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:50:56,812 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:50:56,873 INFO celery.worker.strategy Received task: schedule_clean_desktops[d641b620-8da1-4e23-8875-6354bc3c629d]
2016-08-17 18:50:56,875 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:50:56,877 WARNING celery.redirected 2016-08-17 18:50:56,877 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:50:56,879 WARNING celery.redirected 2016-08-17 18:50:56,879 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:50:56,880 WARNING celery.redirected 2016-08-17 18:50:56,880 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:50:56,885 WARNING celery.redirected 2016-08-17 18:50:56,885 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:50:56,886 WARNING celery.redirected 2016-08-17 18:50:56,886 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 49, 56, 876572)}
2016-08-17 18:50:56,889 WARNING celery.redirected 2016-08-17 18:50:56,889 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:50:56,890 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:50:56,899 INFO celery.worker.job Task schedule_clean_desktops[d641b620-8da1-4e23-8875-6354bc3c629d] succeeded in 0.024263726998469792s: None
2016-08-17 18:50:56,944 INFO celery.worker.job Task schedule_start_lesson[15bdd854-fa4e-49aa-9bcf-5381a92d774b] succeeded in 0.1421659549996548s: None
2016-08-17 18:51:26,536 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:51:26,536 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:51:26,536 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:51:26,537 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:51:26,541 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:51:26,542 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:51:26,542 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:51:26,542 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:51:56,532 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:51:56,549 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:51:56,550 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:51:56,551 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:51:56,552 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:51:56,555 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:51:56,555 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:51:56,555 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:51:56,555 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:51:56,665 INFO celery.worker.strategy Received task: schedule_start_lesson[ce1654c8-3203-4579-92b4-b76bf5a9b982]
2016-08-17 18:51:56,667 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:51:56,667 INFO celery Scheduling start lesson tasks
2016-08-17 18:51:56,668 WARNING celery.redirected 2016-08-17 18:51:56,668 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:51:56,669 WARNING celery.redirected 2016-08-17 18:51:56,669 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:51:56,670 WARNING celery.redirected 2016-08-17 18:51:56,670 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:51:56,673 WARNING celery.redirected 2016-08-17 18:51:56,673 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:51:56,674 WARNING celery.redirected 2016-08-17 18:51:56,674 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 51, 56, 671531), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 1, 56, 671531)}
2016-08-17 18:51:56,676 WARNING celery.redirected 2016-08-17 18:51:56,676 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:51:56,677 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:51:56,683 INFO celery.worker.job Task schedule_start_lesson[ce1654c8-3203-4579-92b4-b76bf5a9b982] succeeded in 0.01671564099888201s: None
2016-08-17 18:52:01,550 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:52:02,669 INFO celery.worker.strategy Received task: schedule_clean_desktops[dbdabd6b-40c2-4b02-91c3-8a6f0b32b054]
2016-08-17 18:52:02,670 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:52:02,671 WARNING celery.redirected 2016-08-17 18:52:02,671 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:52:02,672 WARNING celery.redirected 2016-08-17 18:52:02,672 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:52:02,673 WARNING celery.redirected 2016-08-17 18:52:02,673 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:52:02,676 WARNING celery.redirected 2016-08-17 18:52:02,676 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:52:02,676 WARNING celery.redirected 2016-08-17 18:52:02,676 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 51, 2, 671034)}
2016-08-17 18:52:02,678 WARNING celery.redirected 2016-08-17 18:52:02,678 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:52:02,679 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:52:02,688 INFO celery.worker.job Task schedule_clean_desktops[dbdabd6b-40c2-4b02-91c3-8a6f0b32b054] succeeded in 0.01783392400102457s: None
2016-08-17 18:52:26,622 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:52:26,622 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:52:26,624 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:52:26,624 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:52:26,629 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:52:26,630 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:52:26,630 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:52:26,630 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:53:01,629 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:53:01,629 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:53:01,629 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:53:01,629 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:53:01,631 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:53:01,648 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:53:01,648 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:53:01,650 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:53:01,650 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:53:01,653 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:53:01,653 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:53:01,653 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:53:01,653 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:53:02,456 INFO celery.worker.strategy Received task: schedule_start_lesson[de4f6aec-845e-45f4-84e5-1ae1c1d0c692]
2016-08-17 18:53:02,458 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:53:02,458 INFO celery Scheduling start lesson tasks
2016-08-17 18:53:02,459 WARNING celery.redirected 2016-08-17 18:53:02,459 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:53:02,460 WARNING celery.redirected 2016-08-17 18:53:02,460 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:53:02,460 WARNING celery.redirected 2016-08-17 18:53:02,460 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:53:02,465 WARNING celery.redirected 2016-08-17 18:53:02,464 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:53:02,465 WARNING celery.redirected 2016-08-17 18:53:02,465 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 53, 2, 462216), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 3, 2, 462216)}
2016-08-17 18:53:02,468 WARNING celery.redirected 2016-08-17 18:53:02,468 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:53:02,469 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:53:02,476 INFO celery.worker.job Task schedule_start_lesson[de4f6aec-845e-45f4-84e5-1ae1c1d0c692] succeeded in 0.018702363999182126s: None
2016-08-17 18:53:06,656 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:53:07,194 INFO celery.worker.strategy Received task: schedule_clean_desktops[b2176b54-2d29-4d24-b21e-a283ab2a8183]
2016-08-17 18:53:07,195 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:53:07,196 WARNING celery.redirected 2016-08-17 18:53:07,196 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:53:07,197 WARNING celery.redirected 2016-08-17 18:53:07,197 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:53:07,198 WARNING celery.redirected 2016-08-17 18:53:07,198 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:53:07,201 WARNING celery.redirected 2016-08-17 18:53:07,201 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:53:07,202 WARNING celery.redirected 2016-08-17 18:53:07,202 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 52, 7, 196180)}
2016-08-17 18:53:07,205 WARNING celery.redirected 2016-08-17 18:53:07,204 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:53:07,206 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:53:07,215 INFO celery.worker.job Task schedule_clean_desktops[b2176b54-2d29-4d24-b21e-a283ab2a8183] succeeded in 0.020331407999037765s: None
2016-08-17 18:53:31,675 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:53:31,675 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:53:31,678 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:53:31,678 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:53:31,683 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:53:31,683 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:53:31,683 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:53:31,683 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:54:01,684 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:54:01,684 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:54:01,684 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:54:01,684 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:54:06,680 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:54:07,060 INFO celery.worker.strategy Received task: schedule_start_lesson[a71a6eaa-e8e5-48ad-bdad-5f0e90cf88d3]
2016-08-17 18:54:07,062 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:54:07,062 INFO celery Scheduling start lesson tasks
2016-08-17 18:54:07,063 WARNING celery.redirected 2016-08-17 18:54:07,063 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:54:07,064 WARNING celery.redirected 2016-08-17 18:54:07,064 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:54:07,064 WARNING celery.redirected 2016-08-17 18:54:07,064 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:54:07,068 WARNING celery.redirected 2016-08-17 18:54:07,068 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:54:07,068 WARNING celery.redirected 2016-08-17 18:54:07,068 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 54, 7, 66095), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 4, 7, 66095)}
2016-08-17 18:54:07,070 WARNING celery.redirected 2016-08-17 18:54:07,070 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:54:07,071 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:54:07,078 INFO celery.worker.job Task schedule_start_lesson[a71a6eaa-e8e5-48ad-bdad-5f0e90cf88d3] succeeded in 0.0166514049997204s: None
2016-08-17 18:54:11,699 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:54:11,801 INFO celery.worker.strategy Received task: schedule_clean_desktops[fcde9929-dcde-4813-b39f-dc660c0cf5a5]
2016-08-17 18:54:11,802 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:54:11,803 WARNING celery.redirected 2016-08-17 18:54:11,803 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:54:11,804 WARNING celery.redirected 2016-08-17 18:54:11,804 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:54:11,805 WARNING celery.redirected 2016-08-17 18:54:11,805 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:54:11,808 WARNING celery.redirected 2016-08-17 18:54:11,808 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:54:11,809 WARNING celery.redirected 2016-08-17 18:54:11,809 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 53, 11, 803191), 'desktop_state_2': 'DELETED'}
2016-08-17 18:54:11,810 WARNING celery.redirected 2016-08-17 18:54:11,810 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:54:11,812 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:54:11,819 INFO celery.worker.job Task schedule_clean_desktops[fcde9929-dcde-4813-b39f-dc660c0cf5a5] succeeded in 0.016660523000609828s: None
2016-08-17 18:54:31,727 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:54:31,728 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:54:31,730 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:54:31,730 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:54:31,735 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:54:31,735 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:54:31,735 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:54:31,735 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:55:01,740 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:55:01,740 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:55:01,741 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:55:01,741 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:55:01,746 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:55:01,746 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:55:01,746 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:55:01,746 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:55:11,737 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:55:12,847 INFO celery.worker.strategy Received task: schedule_start_lesson[928606f3-c3d9-4b7d-80f0-298655aea703]
2016-08-17 18:55:12,849 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:55:12,849 INFO celery Scheduling start lesson tasks
2016-08-17 18:55:12,850 WARNING celery.redirected 2016-08-17 18:55:12,850 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:55:12,851 WARNING celery.redirected 2016-08-17 18:55:12,851 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:55:12,851 WARNING celery.redirected 2016-08-17 18:55:12,851 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:55:12,857 WARNING celery.redirected 2016-08-17 18:55:12,856 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:55:12,857 WARNING celery.redirected 2016-08-17 18:55:12,857 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 55, 12, 854381), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 5, 12, 854381)}
2016-08-17 18:55:12,859 WARNING celery.redirected 2016-08-17 18:55:12,859 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:55:12,860 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:55:12,866 INFO celery.worker.job Task schedule_start_lesson[928606f3-c3d9-4b7d-80f0-298655aea703] succeeded in 0.0179383870017773s: None
2016-08-17 18:55:16,777 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:55:17,565 INFO celery.worker.strategy Received task: schedule_clean_desktops[bddf999f-cf65-40d3-96a9-2231e42b0aed]
2016-08-17 18:55:17,566 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:55:17,568 WARNING celery.redirected 2016-08-17 18:55:17,568 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:55:17,569 WARNING celery.redirected 2016-08-17 18:55:17,569 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:55:17,569 WARNING celery.redirected 2016-08-17 18:55:17,569 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:55:17,573 WARNING celery.redirected 2016-08-17 18:55:17,572 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:55:17,573 WARNING celery.redirected 2016-08-17 18:55:17,573 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 54, 17, 567591)}
2016-08-17 18:55:17,575 WARNING celery.redirected 2016-08-17 18:55:17,575 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:55:17,576 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:55:17,583 INFO celery.worker.job Task schedule_clean_desktops[bddf999f-cf65-40d3-96a9-2231e42b0aed] succeeded in 0.017155310000816826s: None
2016-08-17 18:55:31,795 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:55:31,795 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:55:31,797 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:55:31,798 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:55:31,802 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:55:31,802 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:55:31,803 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:55:31,803 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:56:01,811 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:56:01,811 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:56:01,811 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:56:01,812 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:56:01,817 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:56:01,817 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:56:01,817 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:56:01,817 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:56:16,828 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:56:17,380 INFO celery.worker.strategy Received task: schedule_start_lesson[4ea3896d-8bf7-4003-9113-4a6e475bc672]
2016-08-17 18:56:17,381 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:56:17,382 INFO celery Scheduling start lesson tasks
2016-08-17 18:56:17,383 WARNING celery.redirected 2016-08-17 18:56:17,383 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:56:17,384 WARNING celery.redirected 2016-08-17 18:56:17,384 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:56:17,384 WARNING celery.redirected 2016-08-17 18:56:17,384 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:56:17,388 WARNING celery.redirected 2016-08-17 18:56:17,388 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:56:17,389 WARNING celery.redirected 2016-08-17 18:56:17,389 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 56, 17, 386103), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 6, 17, 386103)}
2016-08-17 18:56:17,392 WARNING celery.redirected 2016-08-17 18:56:17,391 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:56:17,393 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:56:17,399 INFO celery.worker.job Task schedule_start_lesson[4ea3896d-8bf7-4003-9113-4a6e475bc672] succeeded in 0.018212222999864025s: None
2016-08-17 18:56:21,846 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:56:22,116 INFO celery.worker.strategy Received task: schedule_clean_desktops[278d720c-d023-410e-9169-f0132c1dee4a]
2016-08-17 18:56:22,118 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:56:22,119 WARNING celery.redirected 2016-08-17 18:56:22,119 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:56:22,120 WARNING celery.redirected 2016-08-17 18:56:22,120 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:56:22,121 WARNING celery.redirected 2016-08-17 18:56:22,121 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:56:22,124 WARNING celery.redirected 2016-08-17 18:56:22,124 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:56:22,124 WARNING celery.redirected 2016-08-17 18:56:22,124 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 55, 22, 118854), 'desktop_state_2': 'DELETED'}
2016-08-17 18:56:22,126 WARNING celery.redirected 2016-08-17 18:56:22,126 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:56:22,127 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:56:22,134 INFO celery.worker.job Task schedule_clean_desktops[278d720c-d023-410e-9169-f0132c1dee4a] succeeded in 0.016143007997015957s: None
2016-08-17 18:56:31,863 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:56:31,863 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:56:31,865 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:56:31,866 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:56:31,871 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:56:31,871 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:56:31,871 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:56:31,871 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:57:01,882 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:57:01,882 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:57:01,883 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:57:01,883 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:57:01,888 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:57:01,888 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:57:01,889 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:57:01,889 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:57:21,894 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:57:22,043 INFO celery.worker.strategy Received task: schedule_start_lesson[e7e3dd86-c316-404c-95c4-0c9c9cbaf718]
2016-08-17 18:57:22,045 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:57:22,045 INFO celery Scheduling start lesson tasks
2016-08-17 18:57:22,046 WARNING celery.redirected 2016-08-17 18:57:22,046 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:57:22,047 WARNING celery.redirected 2016-08-17 18:57:22,047 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:57:22,047 WARNING celery.redirected 2016-08-17 18:57:22,047 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:57:22,051 WARNING celery.redirected 2016-08-17 18:57:22,051 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:57:22,051 WARNING celery.redirected 2016-08-17 18:57:22,051 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 57, 22, 49095), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 7, 22, 49095)}
2016-08-17 18:57:22,150 WARNING celery.redirected 2016-08-17 18:57:22,150 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:57:22,151 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:57:22,158 INFO celery.worker.job Task schedule_start_lesson[e7e3dd86-c316-404c-95c4-0c9c9cbaf718] succeeded in 0.11366388600072241s: None
2016-08-17 18:57:26,986 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:57:28,029 INFO celery.worker.strategy Received task: schedule_clean_desktops[aaa92514-9083-4a50-967e-f25723b7746a]
2016-08-17 18:57:28,030 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:57:28,032 WARNING celery.redirected 2016-08-17 18:57:28,031 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:57:28,032 WARNING celery.redirected 2016-08-17 18:57:28,032 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:57:28,033 WARNING celery.redirected 2016-08-17 18:57:28,033 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:57:28,036 WARNING celery.redirected 2016-08-17 18:57:28,036 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:57:28,036 WARNING celery.redirected 2016-08-17 18:57:28,036 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 56, 28, 31179), 'desktop_state_2': 'DELETED'}
2016-08-17 18:57:28,040 WARNING celery.redirected 2016-08-17 18:57:28,039 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:57:28,041 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:57:28,047 INFO celery.worker.job Task schedule_clean_desktops[aaa92514-9083-4a50-967e-f25723b7746a] succeeded in 0.01731783099967288s: None
2016-08-17 18:57:32,004 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:57:32,004 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:57:32,006 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:57:32,006 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:57:32,011 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:57:32,011 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:57:32,012 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:57:32,012 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:58:02,013 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:58:02,013 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:58:02,014 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:58:02,014 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:58:22,009 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:58:23,050 INFO celery.worker.strategy Received task: schedule_start_lesson[869ed19f-7dd0-4ee8-bf65-06a12b485079]
2016-08-17 18:58:23,051 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:58:23,051 INFO celery Scheduling start lesson tasks
2016-08-17 18:58:23,052 WARNING celery.redirected 2016-08-17 18:58:23,052 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:58:23,053 WARNING celery.redirected 2016-08-17 18:58:23,053 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:58:23,054 WARNING celery.redirected 2016-08-17 18:58:23,053 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:58:23,057 WARNING celery.redirected 2016-08-17 18:58:23,057 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:58:23,058 WARNING celery.redirected 2016-08-17 18:58:23,058 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 58, 23, 55654), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 8, 23, 55654)}
2016-08-17 18:58:23,060 WARNING celery.redirected 2016-08-17 18:58:23,060 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:58:23,062 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:58:23,069 INFO celery.worker.job Task schedule_start_lesson[869ed19f-7dd0-4ee8-bf65-06a12b485079] succeeded in 0.018373913000687025s: None
2016-08-17 18:58:27,027 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:58:27,782 INFO celery.worker.strategy Received task: schedule_clean_desktops[e7f2be7a-865b-4fdd-a2f5-3e87688817c6]
2016-08-17 18:58:27,783 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:58:27,785 WARNING celery.redirected 2016-08-17 18:58:27,785 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:58:27,786 WARNING celery.redirected 2016-08-17 18:58:27,786 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:58:27,786 WARNING celery.redirected 2016-08-17 18:58:27,786 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:58:27,790 WARNING celery.redirected 2016-08-17 18:58:27,789 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:58:27,790 WARNING celery.redirected 2016-08-17 18:58:27,790 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 57, 27, 784384)}
2016-08-17 18:58:27,793 WARNING celery.redirected 2016-08-17 18:58:27,793 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:58:27,794 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:58:27,801 INFO celery.worker.job Task schedule_clean_desktops[e7f2be7a-865b-4fdd-a2f5-3e87688817c6] succeeded in 0.018037902998912614s: None
2016-08-17 18:58:32,049 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:58:32,049 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:58:32,051 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:58:32,052 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:58:32,056 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:58:32,057 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:58:32,057 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:58:32,057 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:59:02,065 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:59:02,065 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:59:02,065 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:59:02,065 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:59:02,070 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:59:02,070 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:59:02,071 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:59:02,071 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:59:22,067 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 18:59:22,765 INFO celery.worker.strategy Received task: schedule_start_lesson[1c5da121-8bbe-4bfc-8a3a-0f3e7dcececc]
2016-08-17 18:59:22,766 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:59:22,767 INFO celery Scheduling start lesson tasks
2016-08-17 18:59:22,768 WARNING celery.redirected 2016-08-17 18:59:22,767 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:59:22,769 WARNING celery.redirected 2016-08-17 18:59:22,768 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:59:22,769 WARNING celery.redirected 2016-08-17 18:59:22,769 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 18:59:22,773 WARNING celery.redirected 2016-08-17 18:59:22,773 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 18:59:22,774 WARNING celery.redirected 2016-08-17 18:59:22,773 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(18, 59, 22, 770834), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 9, 22, 770834)}
2016-08-17 18:59:22,776 WARNING celery.redirected 2016-08-17 18:59:22,776 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:59:22,777 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:59:22,785 INFO celery.worker.job Task schedule_start_lesson[1c5da121-8bbe-4bfc-8a3a-0f3e7dcececc] succeeded in 0.018493788000341738s: None
2016-08-17 18:59:27,090 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 18:59:27,490 INFO celery.worker.strategy Received task: schedule_clean_desktops[82987282-5d17-4282-88ab-b6c5089666e7]
2016-08-17 18:59:27,491 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 18:59:27,493 WARNING celery.redirected 2016-08-17 18:59:27,492 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 18:59:27,493 WARNING celery.redirected 2016-08-17 18:59:27,493 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 18:59:27,494 WARNING celery.redirected 2016-08-17 18:59:27,494 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 18:59:27,497 WARNING celery.redirected 2016-08-17 18:59:27,497 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 18:59:27,498 WARNING celery.redirected 2016-08-17 18:59:27,498 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 58, 27, 492257)}
2016-08-17 18:59:27,500 WARNING celery.redirected 2016-08-17 18:59:27,500 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 18:59:27,501 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 18:59:27,508 INFO celery.worker.job Task schedule_clean_desktops[82987282-5d17-4282-88ab-b6c5089666e7] succeeded in 0.016630828999041114s: None
2016-08-17 18:59:32,110 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:59:32,110 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:59:32,113 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:59:32,113 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 18:59:32,118 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 18:59:32,118 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 18:59:32,118 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 18:59:32,118 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:00:02,119 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:00:02,120 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:00:02,120 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:00:02,120 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:00:22,118 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:00:22,586 INFO celery.worker.strategy Received task: schedule_start_lesson[534874e5-2e40-432c-97fd-450fb6202853]
2016-08-17 19:00:22,587 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:00:22,587 INFO celery Scheduling start lesson tasks
2016-08-17 19:00:22,593 WARNING celery.redirected 2016-08-17 19:00:22,592 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:00:22,594 WARNING celery.redirected 2016-08-17 19:00:22,593 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:00:22,594 WARNING celery.redirected 2016-08-17 19:00:22,594 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:00:22,599 WARNING celery.redirected 2016-08-17 19:00:22,599 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:00:22,600 WARNING celery.redirected 2016-08-17 19:00:22,600 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 0, 22, 595922), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 10, 22, 595922)}
2016-08-17 19:00:22,602 WARNING celery.redirected 2016-08-17 19:00:22,601 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:00:22,602 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:00:22,609 INFO celery.worker.job Task schedule_start_lesson[534874e5-2e40-432c-97fd-450fb6202853] succeeded in 0.021798935002152575s: None
2016-08-17 19:00:27,142 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:00:27,301 INFO celery.worker.strategy Received task: schedule_clean_desktops[56881770-2e99-472e-a005-f629109df147]
2016-08-17 19:00:27,302 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:00:27,306 WARNING celery.redirected 2016-08-17 19:00:27,306 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:00:27,307 WARNING celery.redirected 2016-08-17 19:00:27,307 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:00:27,307 WARNING celery.redirected 2016-08-17 19:00:27,307 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:00:27,310 WARNING celery.redirected 2016-08-17 19:00:27,310 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:00:27,311 WARNING celery.redirected 2016-08-17 19:00:27,311 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 18, 59, 27, 303061), 'desktop_state_2': 'DELETED'}
2016-08-17 19:00:27,313 WARNING celery.redirected 2016-08-17 19:00:27,313 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:00:27,314 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:00:27,321 INFO celery.worker.job Task schedule_clean_desktops[56881770-2e99-472e-a005-f629109df147] succeeded in 0.01929053800267866s: None
2016-08-17 19:00:32,155 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:00:32,155 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:00:32,158 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:00:32,158 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:00:32,163 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:00:32,163 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:00:32,163 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:00:32,163 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:01:07,154 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:01:07,154 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:01:07,154 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:01:07,154 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:01:07,159 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:01:07,159 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:01:07,160 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:01:07,160 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:01:22,150 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:01:22,331 INFO celery.worker.strategy Received task: schedule_start_lesson[d7830555-ba08-4273-8a73-d304e59da3fe]
2016-08-17 19:01:22,332 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:01:22,333 INFO celery Scheduling start lesson tasks
2016-08-17 19:01:22,335 WARNING celery.redirected 2016-08-17 19:01:22,335 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:01:22,336 WARNING celery.redirected 2016-08-17 19:01:22,336 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:01:22,337 WARNING celery.redirected 2016-08-17 19:01:22,337 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:01:22,341 WARNING celery.redirected 2016-08-17 19:01:22,340 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:01:22,341 WARNING celery.redirected 2016-08-17 19:01:22,341 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 1, 22, 338562), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 11, 22, 338562)}
2016-08-17 19:01:22,343 WARNING celery.redirected 2016-08-17 19:01:22,343 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:01:22,344 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:01:22,350 INFO celery.worker.job Task schedule_start_lesson[d7830555-ba08-4273-8a73-d304e59da3fe] succeeded in 0.01835910000227159s: None
2016-08-17 19:01:27,166 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:01:28,335 INFO celery.worker.strategy Received task: schedule_clean_desktops[7f2bf887-cbbd-4e07-8a1c-440d40ab90c3]
2016-08-17 19:01:28,337 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:01:28,340 WARNING celery.redirected 2016-08-17 19:01:28,340 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:01:28,341 WARNING celery.redirected 2016-08-17 19:01:28,341 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:01:28,341 WARNING celery.redirected 2016-08-17 19:01:28,341 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:01:28,345 WARNING celery.redirected 2016-08-17 19:01:28,344 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:01:28,345 WARNING celery.redirected 2016-08-17 19:01:28,345 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 0, 28, 337867), 'desktop_state_2': 'DELETED'}
2016-08-17 19:01:28,348 WARNING celery.redirected 2016-08-17 19:01:28,348 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:01:28,349 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:01:28,356 INFO celery.worker.job Task schedule_clean_desktops[7f2bf887-cbbd-4e07-8a1c-440d40ab90c3] succeeded in 0.01948861399796442s: None
2016-08-17 19:01:37,258 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:01:37,258 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:01:37,260 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:01:37,260 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:01:37,265 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:01:37,265 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:01:37,265 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:01:37,265 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:02:07,271 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:02:07,272 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:02:07,272 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:02:07,272 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:02:07,277 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:02:07,277 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:02:07,277 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:02:07,277 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:02:22,269 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:02:23,389 INFO celery.worker.strategy Received task: schedule_start_lesson[f19df34b-cfd6-4ebe-bb2a-b3f97cf88de0]
2016-08-17 19:02:23,391 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:02:23,392 INFO celery Scheduling start lesson tasks
2016-08-17 19:02:23,393 WARNING celery.redirected 2016-08-17 19:02:23,392 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:02:23,394 WARNING celery.redirected 2016-08-17 19:02:23,393 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:02:23,394 WARNING celery.redirected 2016-08-17 19:02:23,394 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:02:23,397 WARNING celery.redirected 2016-08-17 19:02:23,397 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:02:23,398 WARNING celery.redirected 2016-08-17 19:02:23,398 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 2, 23, 395751), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 12, 23, 395751)}
2016-08-17 19:02:23,401 WARNING celery.redirected 2016-08-17 19:02:23,400 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:02:23,402 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:02:23,507 INFO celery.worker.job Task schedule_start_lesson[f19df34b-cfd6-4ebe-bb2a-b3f97cf88de0] succeeded in 0.11633831899962388s: None
2016-08-17 19:02:27,335 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:02:28,140 INFO celery.worker.strategy Received task: schedule_clean_desktops[e245706f-44dc-416e-9e72-f6a50f4a9c63]
2016-08-17 19:02:28,141 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:02:28,143 WARNING celery.redirected 2016-08-17 19:02:28,143 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:02:28,144 WARNING celery.redirected 2016-08-17 19:02:28,144 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:02:28,144 WARNING celery.redirected 2016-08-17 19:02:28,144 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:02:28,147 WARNING celery.redirected 2016-08-17 19:02:28,147 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:02:28,148 WARNING celery.redirected 2016-08-17 19:02:28,148 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 1, 28, 142493)}
2016-08-17 19:02:28,150 WARNING celery.redirected 2016-08-17 19:02:28,150 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:02:28,152 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:02:28,158 INFO celery.worker.job Task schedule_clean_desktops[e245706f-44dc-416e-9e72-f6a50f4a9c63] succeeded in 0.017036537999956636s: None
2016-08-17 19:02:37,353 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:02:37,354 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:02:37,356 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:02:37,356 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:02:37,361 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:02:37,361 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:02:37,362 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:02:37,362 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:03:12,356 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:03:12,357 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:03:12,357 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:03:12,357 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:03:12,363 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:03:12,363 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:03:12,364 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:03:12,364 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:03:22,360 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:03:23,141 INFO celery.worker.strategy Received task: schedule_start_lesson[0475f6d0-e365-4a98-9656-864c966f4fc7]
2016-08-17 19:03:23,142 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:03:23,142 INFO celery Scheduling start lesson tasks
2016-08-17 19:03:23,144 WARNING celery.redirected 2016-08-17 19:03:23,143 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:03:23,145 WARNING celery.redirected 2016-08-17 19:03:23,144 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:03:23,145 WARNING celery.redirected 2016-08-17 19:03:23,145 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:03:23,149 WARNING celery.redirected 2016-08-17 19:03:23,149 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:03:23,150 WARNING celery.redirected 2016-08-17 19:03:23,150 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 3, 23, 146903), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 13, 23, 146903)}
2016-08-17 19:03:23,153 WARNING celery.redirected 2016-08-17 19:03:23,153 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:03:23,154 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:03:23,160 INFO celery.worker.job Task schedule_start_lesson[0475f6d0-e365-4a98-9656-864c966f4fc7] succeeded in 0.018364694002229953s: None
2016-08-17 19:03:27,378 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:03:27,869 INFO celery.worker.strategy Received task: schedule_clean_desktops[1d18e194-d084-4809-896a-68c4e308e2f7]
2016-08-17 19:03:27,870 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:03:27,871 WARNING celery.redirected 2016-08-17 19:03:27,871 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:03:27,872 WARNING celery.redirected 2016-08-17 19:03:27,872 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:03:27,873 WARNING celery.redirected 2016-08-17 19:03:27,873 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:03:27,876 WARNING celery.redirected 2016-08-17 19:03:27,876 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:03:27,876 WARNING celery.redirected 2016-08-17 19:03:27,876 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 2, 27, 871001), 'desktop_state_2': 'DELETED'}
2016-08-17 19:03:27,879 WARNING celery.redirected 2016-08-17 19:03:27,879 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:03:27,880 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:03:27,886 INFO celery.worker.job Task schedule_clean_desktops[1d18e194-d084-4809-896a-68c4e308e2f7] succeeded in 0.01673413000025903s: None
2016-08-17 19:03:42,386 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:03:42,386 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:03:42,389 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:03:42,389 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:03:42,394 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:03:42,395 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:03:42,395 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:03:42,395 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:04:17,387 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:04:17,387 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:04:17,387 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:04:17,388 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:04:17,393 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:04:17,393 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:04:17,393 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:04:17,394 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:04:22,387 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:04:22,909 INFO celery.worker.strategy Received task: schedule_start_lesson[dc5f06f5-6d4b-4d54-b708-7796ac0c2d0a]
2016-08-17 19:04:22,910 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:04:22,911 INFO celery Scheduling start lesson tasks
2016-08-17 19:04:22,912 WARNING celery.redirected 2016-08-17 19:04:22,912 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:04:22,913 WARNING celery.redirected 2016-08-17 19:04:22,913 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:04:22,913 WARNING celery.redirected 2016-08-17 19:04:22,913 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:04:22,917 WARNING celery.redirected 2016-08-17 19:04:22,917 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:04:22,917 WARNING celery.redirected 2016-08-17 19:04:22,917 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 4, 22, 914994), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 14, 22, 914994)}
2016-08-17 19:04:22,920 WARNING celery.redirected 2016-08-17 19:04:22,919 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:04:22,921 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:04:22,928 INFO celery.worker.job Task schedule_start_lesson[dc5f06f5-6d4b-4d54-b708-7796ac0c2d0a] succeeded in 0.0179357480010367s: None
2016-08-17 19:04:27,411 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:04:27,639 INFO celery.worker.strategy Received task: schedule_clean_desktops[4ec99817-26fd-4d6c-b801-bbd71b98f6d8]
2016-08-17 19:04:27,641 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:04:27,642 WARNING celery.redirected 2016-08-17 19:04:27,642 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:04:27,643 WARNING celery.redirected 2016-08-17 19:04:27,643 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:04:27,644 WARNING celery.redirected 2016-08-17 19:04:27,644 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:04:27,647 WARNING celery.redirected 2016-08-17 19:04:27,647 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:04:27,647 WARNING celery.redirected 2016-08-17 19:04:27,647 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 3, 27, 641738)}
2016-08-17 19:04:27,649 WARNING celery.redirected 2016-08-17 19:04:27,649 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:04:27,650 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:04:27,657 INFO celery.worker.job Task schedule_clean_desktops[4ec99817-26fd-4d6c-b801-bbd71b98f6d8] succeeded in 0.01638795500184642s: None
2016-08-17 19:04:47,416 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:04:47,417 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:04:47,419 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:04:47,419 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:04:47,424 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:04:47,424 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:04:47,425 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:04:47,425 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:05:17,426 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:05:17,427 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:05:17,427 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:05:17,427 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:05:17,432 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:05:17,432 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:05:17,432 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:05:17,433 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:05:22,433 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:05:22,664 INFO celery.worker.strategy Received task: schedule_start_lesson[7d156bfd-1971-496e-aa61-2704d8e32b6f]
2016-08-17 19:05:22,665 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:05:22,665 INFO celery Scheduling start lesson tasks
2016-08-17 19:05:22,666 WARNING celery.redirected 2016-08-17 19:05:22,666 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:05:22,667 WARNING celery.redirected 2016-08-17 19:05:22,667 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:05:22,668 WARNING celery.redirected 2016-08-17 19:05:22,668 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:05:22,672 WARNING celery.redirected 2016-08-17 19:05:22,672 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:05:22,672 WARNING celery.redirected 2016-08-17 19:05:22,672 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 5, 22, 669500), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 15, 22, 669500)}
2016-08-17 19:05:22,674 WARNING celery.redirected 2016-08-17 19:05:22,674 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:05:22,675 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:05:22,682 INFO celery.worker.job Task schedule_start_lesson[7d156bfd-1971-496e-aa61-2704d8e32b6f] succeeded in 0.016894745000172406s: None
2016-08-17 19:05:27,453 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:05:28,661 INFO celery.worker.strategy Received task: schedule_clean_desktops[502abe9b-8ab4-4512-9054-a027e79c4522]
2016-08-17 19:05:28,662 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:05:28,664 WARNING celery.redirected 2016-08-17 19:05:28,663 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:05:28,664 WARNING celery.redirected 2016-08-17 19:05:28,664 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:05:28,665 WARNING celery.redirected 2016-08-17 19:05:28,665 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:05:28,668 WARNING celery.redirected 2016-08-17 19:05:28,668 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:05:28,668 WARNING celery.redirected 2016-08-17 19:05:28,668 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 4, 28, 663286)}
2016-08-17 19:05:28,672 WARNING celery.redirected 2016-08-17 19:05:28,671 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:05:28,673 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:05:28,680 INFO celery.worker.job Task schedule_clean_desktops[502abe9b-8ab4-4512-9054-a027e79c4522] succeeded in 0.017826630999479676s: None
2016-08-17 19:05:47,614 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:05:47,614 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:05:47,617 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:05:47,617 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:05:47,622 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:05:47,622 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:05:47,622 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:05:47,622 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:06:17,633 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:06:17,634 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:06:17,634 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:06:17,634 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:06:17,639 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:06:17,639 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:06:17,639 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:06:17,639 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:06:22,636 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:06:23,738 INFO celery.worker.strategy Received task: schedule_start_lesson[b3e4ec4b-686c-46c7-96dd-acdd85a27444]
2016-08-17 19:06:23,739 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:06:23,739 INFO celery Scheduling start lesson tasks
2016-08-17 19:06:23,740 WARNING celery.redirected 2016-08-17 19:06:23,740 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:06:23,741 WARNING celery.redirected 2016-08-17 19:06:23,741 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:06:23,742 WARNING celery.redirected 2016-08-17 19:06:23,742 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:06:23,746 WARNING celery.redirected 2016-08-17 19:06:23,746 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:06:23,747 WARNING celery.redirected 2016-08-17 19:06:23,747 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 6, 23, 743722), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 16, 23, 743722)}
2016-08-17 19:06:23,748 WARNING celery.redirected 2016-08-17 19:06:23,748 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:06:23,749 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:06:23,756 INFO celery.worker.job Task schedule_start_lesson[b3e4ec4b-686c-46c7-96dd-acdd85a27444] succeeded in 0.016850078998686513s: None
2016-08-17 19:06:27,660 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:06:28,479 INFO celery.worker.strategy Received task: schedule_clean_desktops[009e1ad4-400f-47a1-9050-a66bfe58b414]
2016-08-17 19:06:28,480 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:06:28,482 WARNING celery.redirected 2016-08-17 19:06:28,482 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:06:28,483 WARNING celery.redirected 2016-08-17 19:06:28,483 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:06:28,483 WARNING celery.redirected 2016-08-17 19:06:28,483 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:06:28,486 WARNING celery.redirected 2016-08-17 19:06:28,486 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:06:28,487 WARNING celery.redirected 2016-08-17 19:06:28,487 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 5, 28, 481303)}
2016-08-17 19:06:28,490 WARNING celery.redirected 2016-08-17 19:06:28,490 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:06:28,492 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:06:28,498 INFO celery.worker.job Task schedule_clean_desktops[009e1ad4-400f-47a1-9050-a66bfe58b414] succeeded in 0.018392097001196817s: None
2016-08-17 19:06:47,677 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:06:47,677 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:06:47,680 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:06:47,680 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:06:47,685 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:06:47,685 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:06:47,685 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:06:47,685 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:07:22,680 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:07:22,680 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:07:22,680 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:07:22,680 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:07:22,685 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:07:22,685 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:07:22,686 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:07:22,686 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:07:27,689 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:07:28,261 INFO celery.worker.strategy Received task: schedule_start_lesson[436b2072-d668-4965-bd0d-f92dbe847770]
2016-08-17 19:07:28,262 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:07:28,262 INFO celery Scheduling start lesson tasks
2016-08-17 19:07:28,263 WARNING celery.redirected 2016-08-17 19:07:28,263 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:07:28,264 WARNING celery.redirected 2016-08-17 19:07:28,264 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:07:28,265 WARNING celery.redirected 2016-08-17 19:07:28,265 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:07:28,269 WARNING celery.redirected 2016-08-17 19:07:28,268 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:07:28,269 WARNING celery.redirected 2016-08-17 19:07:28,269 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 7, 28, 266514), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 17, 28, 266514)}
2016-08-17 19:07:28,272 WARNING celery.redirected 2016-08-17 19:07:28,272 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:07:28,274 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:07:28,281 INFO celery.worker.job Task schedule_start_lesson[436b2072-d668-4965-bd0d-f92dbe847770] succeeded in 0.019037726997339632s: None
2016-08-17 19:07:32,712 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:07:33,004 INFO celery.worker.strategy Received task: schedule_clean_desktops[c0285ec6-4018-4fab-9a2c-3ed9dd760a18]
2016-08-17 19:07:33,005 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:07:33,006 WARNING celery.redirected 2016-08-17 19:07:33,006 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:07:33,007 WARNING celery.redirected 2016-08-17 19:07:33,007 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:07:33,008 WARNING celery.redirected 2016-08-17 19:07:33,008 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:07:33,011 WARNING celery.redirected 2016-08-17 19:07:33,011 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:07:33,012 WARNING celery.redirected 2016-08-17 19:07:33,011 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 6, 33, 5921)}
2016-08-17 19:07:33,014 WARNING celery.redirected 2016-08-17 19:07:33,014 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:07:33,015 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:07:33,021 INFO celery.worker.job Task schedule_clean_desktops[c0285ec6-4018-4fab-9a2c-3ed9dd760a18] succeeded in 0.016686668001057114s: None
2016-08-17 19:07:52,730 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:07:52,730 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:07:52,733 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:07:52,733 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:07:52,738 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:07:52,738 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:07:52,738 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:07:52,738 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:08:27,730 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:08:27,730 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:08:27,730 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:08:27,730 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:08:27,735 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:08:27,735 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:08:27,736 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:08:27,736 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:08:32,731 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:08:32,870 INFO celery.worker.strategy Received task: schedule_start_lesson[c40ec2d7-3271-4cd6-8443-d0b0c24a70d1]
2016-08-17 19:08:32,872 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:08:32,873 INFO celery Scheduling start lesson tasks
2016-08-17 19:08:32,874 WARNING celery.redirected 2016-08-17 19:08:32,874 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:08:32,875 WARNING celery.redirected 2016-08-17 19:08:32,875 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:08:32,875 WARNING celery.redirected 2016-08-17 19:08:32,875 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:08:32,879 WARNING celery.redirected 2016-08-17 19:08:32,879 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:08:32,880 WARNING celery.redirected 2016-08-17 19:08:32,880 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 8, 32, 877003), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 18, 32, 877003)}
2016-08-17 19:08:32,882 WARNING celery.redirected 2016-08-17 19:08:32,882 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:08:32,883 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:08:32,889 INFO celery.worker.job Task schedule_start_lesson[c40ec2d7-3271-4cd6-8443-d0b0c24a70d1] succeeded in 0.01734768100141082s: None
2016-08-17 19:08:37,748 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:08:38,886 INFO celery.worker.strategy Received task: schedule_clean_desktops[26899254-c61b-4814-89c4-a76ae052478a]
2016-08-17 19:08:38,887 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:08:38,889 WARNING celery.redirected 2016-08-17 19:08:38,889 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:08:38,890 WARNING celery.redirected 2016-08-17 19:08:38,889 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:08:38,890 WARNING celery.redirected 2016-08-17 19:08:38,890 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:08:38,893 WARNING celery.redirected 2016-08-17 19:08:38,893 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:08:38,894 WARNING celery.redirected 2016-08-17 19:08:38,893 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 7, 38, 888370)}
2016-08-17 19:08:38,895 WARNING celery.redirected 2016-08-17 19:08:38,895 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:08:38,897 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:08:38,904 INFO celery.worker.job Task schedule_clean_desktops[26899254-c61b-4814-89c4-a76ae052478a] succeeded in 0.017260886997974012s: None
2016-08-17 19:08:57,837 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:08:57,837 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:08:57,839 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:08:57,840 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:08:57,845 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:08:57,845 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:08:57,845 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:08:57,845 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:09:27,853 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:09:27,853 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:09:27,854 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:09:27,854 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:09:27,859 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:09:27,859 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:09:27,859 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:09:27,859 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:09:37,865 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:09:38,698 INFO celery.worker.strategy Received task: schedule_start_lesson[da38d7ae-e63a-4459-92ff-b09a866e1465]
2016-08-17 19:09:38,699 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:09:38,700 INFO celery Scheduling start lesson tasks
2016-08-17 19:09:38,701 WARNING celery.redirected 2016-08-17 19:09:38,701 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:09:38,702 WARNING celery.redirected 2016-08-17 19:09:38,702 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:09:38,702 WARNING celery.redirected 2016-08-17 19:09:38,702 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:09:38,706 WARNING celery.redirected 2016-08-17 19:09:38,706 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:09:38,706 WARNING celery.redirected 2016-08-17 19:09:38,706 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 9, 38, 703969), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 19, 38, 703969)}
2016-08-17 19:09:38,709 WARNING celery.redirected 2016-08-17 19:09:38,709 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:09:38,711 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:09:38,718 INFO celery.worker.job Task schedule_start_lesson[da38d7ae-e63a-4459-92ff-b09a866e1465] succeeded in 0.018768627000099514s: None
2016-08-17 19:09:42,888 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:09:43,427 INFO celery.worker.strategy Received task: schedule_clean_desktops[abb52841-b778-4ac3-a2ef-580efddcb25f]
2016-08-17 19:09:43,429 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:09:43,430 WARNING celery.redirected 2016-08-17 19:09:43,430 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:09:43,431 WARNING celery.redirected 2016-08-17 19:09:43,431 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:09:43,432 WARNING celery.redirected 2016-08-17 19:09:43,431 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:09:43,435 WARNING celery.redirected 2016-08-17 19:09:43,434 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:09:43,435 WARNING celery.redirected 2016-08-17 19:09:43,435 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 8, 43, 429828), 'desktop_state_2': 'DELETED'}
2016-08-17 19:09:43,437 WARNING celery.redirected 2016-08-17 19:09:43,437 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:09:43,439 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:09:43,445 INFO celery.worker.job Task schedule_clean_desktops[abb52841-b778-4ac3-a2ef-580efddcb25f] succeeded in 0.016729585000575753s: None
2016-08-17 19:09:57,903 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:09:57,903 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:09:57,906 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:09:57,906 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:09:57,911 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:09:57,911 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:09:57,911 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:09:57,911 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:10:27,920 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:10:27,920 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:10:27,921 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:10:27,921 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:10:27,926 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:10:27,926 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:10:27,926 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:10:27,926 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:10:42,921 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:10:43,295 INFO celery.worker.strategy Received task: schedule_start_lesson[ce750dc0-77f5-4d11-808d-40f3814eadc2]
2016-08-17 19:10:43,296 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:10:43,297 INFO celery Scheduling start lesson tasks
2016-08-17 19:10:43,298 WARNING celery.redirected 2016-08-17 19:10:43,297 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:10:43,298 WARNING celery.redirected 2016-08-17 19:10:43,298 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:10:43,299 WARNING celery.redirected 2016-08-17 19:10:43,299 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:10:43,303 WARNING celery.redirected 2016-08-17 19:10:43,303 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:10:43,303 WARNING celery.redirected 2016-08-17 19:10:43,303 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 10, 43, 300881), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 20, 43, 300881)}
2016-08-17 19:10:43,306 WARNING celery.redirected 2016-08-17 19:10:43,305 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:10:43,307 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:10:43,313 INFO celery.worker.job Task schedule_start_lesson[ce750dc0-77f5-4d11-808d-40f3814eadc2] succeeded in 0.01732910600185278s: None
2016-08-17 19:10:47,942 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:10:48,031 INFO celery.worker.strategy Received task: schedule_clean_desktops[f44d8fab-adcd-4cfd-b40b-369adaae8ddc]
2016-08-17 19:10:48,033 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:10:48,034 WARNING celery.redirected 2016-08-17 19:10:48,034 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:10:48,035 WARNING celery.redirected 2016-08-17 19:10:48,035 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:10:48,036 WARNING celery.redirected 2016-08-17 19:10:48,036 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:10:48,039 WARNING celery.redirected 2016-08-17 19:10:48,039 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:10:48,040 WARNING celery.redirected 2016-08-17 19:10:48,039 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 9, 48, 33936), 'desktop_state_2': 'DELETED'}
2016-08-17 19:10:48,042 WARNING celery.redirected 2016-08-17 19:10:48,041 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:10:48,043 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:10:48,051 INFO celery.worker.job Task schedule_clean_desktops[f44d8fab-adcd-4cfd-b40b-369adaae8ddc] succeeded in 0.01829804099907051s: None
2016-08-17 19:10:57,953 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:10:57,954 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:10:57,956 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:10:57,956 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:10:57,961 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:10:57,961 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:10:57,961 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:10:57,962 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:11:32,959 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:11:32,959 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:11:32,959 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:11:32,959 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:11:32,964 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:11:32,964 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:11:32,964 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:11:32,964 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:11:47,961 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:11:48,125 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:11:49,175 INFO celery.worker.strategy Received task: schedule_start_lesson[d4f4481d-261e-4b90-8856-d5f5b18e528e]
2016-08-17 19:11:49,176 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:11:49,177 INFO celery Scheduling start lesson tasks
2016-08-17 19:11:49,178 WARNING celery.redirected 2016-08-17 19:11:49,178 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:11:49,179 WARNING celery.redirected 2016-08-17 19:11:49,179 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:11:49,179 WARNING celery.redirected 2016-08-17 19:11:49,179 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:11:49,183 WARNING celery.redirected 2016-08-17 19:11:49,183 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:11:49,184 WARNING celery.redirected 2016-08-17 19:11:49,184 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 11, 49, 180974), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 21, 49, 180974)}
2016-08-17 19:11:49,186 WARNING celery.redirected 2016-08-17 19:11:49,186 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:11:49,188 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:11:49,195 INFO celery.worker.job Task schedule_start_lesson[d4f4481d-261e-4b90-8856-d5f5b18e528e] succeeded in 0.01832487999854493s: None
2016-08-17 19:11:49,249 INFO celery.worker.strategy Received task: schedule_clean_desktops[c5744b51-55d5-4b75-9941-ac7a22526fbf]
2016-08-17 19:11:49,251 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:11:49,252 WARNING celery.redirected 2016-08-17 19:11:49,252 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:11:49,254 WARNING celery.redirected 2016-08-17 19:11:49,253 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:11:49,255 WARNING celery.redirected 2016-08-17 19:11:49,254 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:11:49,259 WARNING celery.redirected 2016-08-17 19:11:49,259 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:11:49,260 WARNING celery.redirected 2016-08-17 19:11:49,260 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 10, 49, 252238), 'desktop_state_2': 'DELETED'}
2016-08-17 19:11:49,263 WARNING celery.redirected 2016-08-17 19:11:49,263 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:11:49,265 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:11:49,274 INFO celery.worker.job Task schedule_clean_desktops[c5744b51-55d5-4b75-9941-ac7a22526fbf] succeeded in 0.02272475499921711s: None
2016-08-17 19:12:03,141 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:12:03,141 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:12:03,145 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:12:03,146 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:12:03,160 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:12:03,160 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:12:03,161 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:12:03,161 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:12:33,161 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:12:33,162 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:12:33,162 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:12:33,162 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:12:33,168 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:12:33,168 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:12:33,169 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:12:33,169 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:12:48,163 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:12:48,190 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:12:48,400 INFO celery.worker.strategy Received task: schedule_start_lesson[ba3a6631-df16-47b1-9d80-7cadb3c14e9d]
2016-08-17 19:12:48,405 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:12:48,406 INFO celery Scheduling start lesson tasks
2016-08-17 19:12:48,410 WARNING celery.redirected 2016-08-17 19:12:48,409 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:12:48,412 WARNING celery.redirected 2016-08-17 19:12:48,412 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:12:48,412 WARNING celery.redirected 2016-08-17 19:12:48,412 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:12:48,419 WARNING celery.redirected 2016-08-17 19:12:48,419 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:12:48,421 WARNING celery.redirected 2016-08-17 19:12:48,420 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 12, 48, 414451), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 22, 48, 414451)}
2016-08-17 19:12:48,425 WARNING celery.redirected 2016-08-17 19:12:48,425 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:12:48,428 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:12:48,440 INFO celery.worker.job Task schedule_start_lesson[ba3a6631-df16-47b1-9d80-7cadb3c14e9d] succeeded in 0.035241730001871474s: None
2016-08-17 19:12:48,513 INFO celery.worker.strategy Received task: schedule_clean_desktops[62b7eede-642d-4611-9d03-177ad11a016a]
2016-08-17 19:12:48,515 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:12:48,517 WARNING celery.redirected 2016-08-17 19:12:48,516 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:12:48,519 WARNING celery.redirected 2016-08-17 19:12:48,518 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:12:48,519 WARNING celery.redirected 2016-08-17 19:12:48,519 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:12:48,525 WARNING celery.redirected 2016-08-17 19:12:48,524 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:12:48,525 WARNING celery.redirected 2016-08-17 19:12:48,525 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 11, 48, 515943)}
2016-08-17 19:12:48,530 WARNING celery.redirected 2016-08-17 19:12:48,530 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:12:48,532 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:12:48,541 INFO celery.worker.job Task schedule_clean_desktops[62b7eede-642d-4611-9d03-177ad11a016a] succeeded in 0.025937848000467056s: None
2016-08-17 19:13:03,209 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:13:03,210 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:13:03,213 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:13:03,213 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:13:03,220 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:13:03,220 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:13:03,221 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:13:03,221 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:13:38,213 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:13:38,213 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:13:38,214 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:13:38,214 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:13:38,223 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:13:38,224 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:13:38,225 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:13:38,225 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:13:48,221 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:13:48,241 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:13:48,435 INFO celery.worker.strategy Received task: schedule_start_lesson[c07adf30-7096-42e0-a436-2e137ca18033]
2016-08-17 19:13:48,436 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:13:48,437 INFO celery Scheduling start lesson tasks
2016-08-17 19:13:48,439 WARNING celery.redirected 2016-08-17 19:13:48,439 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:13:48,441 WARNING celery.redirected 2016-08-17 19:13:48,441 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:13:48,444 WARNING celery.redirected 2016-08-17 19:13:48,442 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:13:48,450 WARNING celery.redirected 2016-08-17 19:13:48,449 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:13:48,450 WARNING celery.redirected 2016-08-17 19:13:48,450 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 13, 48, 445752), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 23, 48, 445752)}
2016-08-17 19:13:48,454 WARNING celery.redirected 2016-08-17 19:13:48,453 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:13:48,455 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:13:48,466 INFO celery.worker.job Task schedule_start_lesson[c07adf30-7096-42e0-a436-2e137ca18033] succeeded in 0.030234656998800347s: None
2016-08-17 19:13:48,539 INFO celery.worker.strategy Received task: schedule_clean_desktops[20edc696-07ae-4f1b-ab2a-d240aed86436]
2016-08-17 19:13:48,542 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:13:48,545 WARNING celery.redirected 2016-08-17 19:13:48,545 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:13:48,547 WARNING celery.redirected 2016-08-17 19:13:48,547 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:13:48,548 WARNING celery.redirected 2016-08-17 19:13:48,547 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:13:48,553 WARNING celery.redirected 2016-08-17 19:13:48,553 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:13:48,554 WARNING celery.redirected 2016-08-17 19:13:48,554 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 12, 48, 544299), 'desktop_state_2': 'DELETED'}
2016-08-17 19:13:48,557 WARNING celery.redirected 2016-08-17 19:13:48,557 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:13:48,558 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:13:48,567 INFO celery.worker.job Task schedule_clean_desktops[20edc696-07ae-4f1b-ab2a-d240aed86436] succeeded in 0.02480290099992999s: None
2016-08-17 19:14:08,267 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:14:08,267 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:14:08,271 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:14:08,271 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:14:08,278 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:14:08,279 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:14:08,279 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:14:08,279 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:14:43,258 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:14:43,258 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:14:43,258 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:14:43,259 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:14:43,265 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:14:43,265 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:14:43,265 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:14:43,266 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:14:48,263 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:14:48,287 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:14:49,270 INFO celery.worker.strategy Received task: schedule_start_lesson[402c2724-54c3-4b1e-891d-d590ab46bdc8]
2016-08-17 19:14:49,272 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:14:49,273 INFO celery Scheduling start lesson tasks
2016-08-17 19:14:49,274 WARNING celery.redirected 2016-08-17 19:14:49,273 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:14:49,275 WARNING celery.redirected 2016-08-17 19:14:49,274 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:14:49,275 WARNING celery.redirected 2016-08-17 19:14:49,275 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:14:49,279 WARNING celery.redirected 2016-08-17 19:14:49,279 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:14:49,280 WARNING celery.redirected 2016-08-17 19:14:49,279 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 14, 49, 276767), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 24, 49, 276767)}
2016-08-17 19:14:49,282 WARNING celery.redirected 2016-08-17 19:14:49,282 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:14:49,284 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:14:49,295 INFO celery.worker.job Task schedule_start_lesson[402c2724-54c3-4b1e-891d-d590ab46bdc8] succeeded in 0.022907783000846393s: None
2016-08-17 19:14:49,368 INFO celery.worker.strategy Received task: schedule_clean_desktops[2333aa1f-9c89-43f0-ba6d-a382a88bb058]
2016-08-17 19:14:49,370 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:14:49,371 WARNING celery.redirected 2016-08-17 19:14:49,371 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:14:49,372 WARNING celery.redirected 2016-08-17 19:14:49,372 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:14:49,373 WARNING celery.redirected 2016-08-17 19:14:49,373 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:14:49,381 WARNING celery.redirected 2016-08-17 19:14:49,380 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:14:49,382 WARNING celery.redirected 2016-08-17 19:14:49,382 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 13, 49, 371135), 'desktop_state_2': 'DELETED'}
2016-08-17 19:14:49,387 WARNING celery.redirected 2016-08-17 19:14:49,387 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:14:49,389 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:14:49,400 INFO celery.worker.job Task schedule_clean_desktops[2333aa1f-9c89-43f0-ba6d-a382a88bb058] succeeded in 0.03051559300001827s: None
2016-08-17 19:15:13,306 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:15:13,306 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:15:13,312 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:15:13,312 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:15:13,322 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:15:13,323 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:15:13,323 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:15:13,323 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:15:48,308 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:15:48,308 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:15:48,308 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:15:48,309 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:15:48,311 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:15:48,337 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:15:48,337 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:15:48,341 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:15:48,341 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:15:48,341 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:15:48,364 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:15:48,365 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:15:48,370 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:15:48,370 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:15:48,373 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:15:48,374 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:15:48,374 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:15:48,374 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:15:48,806 INFO celery.worker.strategy Received task: schedule_start_lesson[2e067aee-89cf-4aaa-971f-501011a06df6]
2016-08-17 19:15:48,809 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:15:48,811 INFO celery Scheduling start lesson tasks
2016-08-17 19:15:48,814 WARNING celery.redirected 2016-08-17 19:15:48,814 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:15:48,815 WARNING celery.redirected 2016-08-17 19:15:48,815 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:15:48,816 WARNING celery.redirected 2016-08-17 19:15:48,816 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:15:48,821 WARNING celery.redirected 2016-08-17 19:15:48,821 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:15:48,822 WARNING celery.redirected 2016-08-17 19:15:48,822 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 15, 48, 818151), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 25, 48, 818151)}
2016-08-17 19:15:48,824 WARNING celery.redirected 2016-08-17 19:15:48,824 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:15:48,829 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:15:48,845 INFO celery.worker.job Task schedule_start_lesson[2e067aee-89cf-4aaa-971f-501011a06df6] succeeded in 0.03657105499951285s: None
2016-08-17 19:15:48,911 INFO celery.worker.strategy Received task: schedule_clean_desktops[81f58f39-271e-4076-b908-8a2f7e55e28b]
2016-08-17 19:15:48,913 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:15:48,915 WARNING celery.redirected 2016-08-17 19:15:48,915 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:15:48,917 WARNING celery.redirected 2016-08-17 19:15:48,916 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:15:48,917 WARNING celery.redirected 2016-08-17 19:15:48,917 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:15:48,925 WARNING celery.redirected 2016-08-17 19:15:48,924 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:15:48,926 WARNING celery.redirected 2016-08-17 19:15:48,925 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 14, 48, 914305), 'desktop_state_2': 'DELETED'}
2016-08-17 19:15:48,935 WARNING celery.redirected 2016-08-17 19:15:48,934 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:15:48,937 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:15:48,950 INFO celery.worker.job Task schedule_clean_desktops[81f58f39-271e-4076-b908-8a2f7e55e28b] succeeded in 0.037500070000533015s: None
2016-08-17 19:16:23,359 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:16:23,359 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:16:23,359 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:16:23,360 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:16:23,368 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:16:23,368 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:16:23,368 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:16:23,369 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:16:48,353 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:16:48,532 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:16:49,630 INFO celery.worker.strategy Received task: schedule_start_lesson[5ebdb582-89b6-4447-b95c-3274672fb748]
2016-08-17 19:16:49,631 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:16:49,632 INFO celery Scheduling start lesson tasks
2016-08-17 19:16:49,633 WARNING celery.redirected 2016-08-17 19:16:49,633 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:16:49,634 WARNING celery.redirected 2016-08-17 19:16:49,634 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:16:49,635 WARNING celery.redirected 2016-08-17 19:16:49,635 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:16:49,640 WARNING celery.redirected 2016-08-17 19:16:49,640 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:16:49,641 WARNING celery.redirected 2016-08-17 19:16:49,641 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 16, 49, 636929), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 26, 49, 636929)}
2016-08-17 19:16:49,645 WARNING celery.redirected 2016-08-17 19:16:49,645 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:16:49,658 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:16:49,683 INFO celery.worker.job Task schedule_start_lesson[5ebdb582-89b6-4447-b95c-3274672fb748] succeeded in 0.05192721099956543s: None
2016-08-17 19:16:49,766 INFO celery.worker.strategy Received task: schedule_clean_desktops[dbc9186e-06a7-4d0a-84e2-c581c5950a17]
2016-08-17 19:16:49,769 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:16:49,772 WARNING celery.redirected 2016-08-17 19:16:49,772 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:16:49,773 WARNING celery.redirected 2016-08-17 19:16:49,773 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:16:49,774 WARNING celery.redirected 2016-08-17 19:16:49,774 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:16:49,779 WARNING celery.redirected 2016-08-17 19:16:49,779 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:16:49,780 WARNING celery.redirected 2016-08-17 19:16:49,780 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 15, 49, 771294)}
2016-08-17 19:16:49,784 WARNING celery.redirected 2016-08-17 19:16:49,783 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:16:49,785 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:16:50,016 INFO celery.worker.job Task schedule_clean_desktops[dbc9186e-06a7-4d0a-84e2-c581c5950a17] succeeded in 0.24780859199745464s: None
2016-08-17 19:16:53,559 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:16:53,560 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:16:53,563 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:16:53,563 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:16:53,569 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:16:53,570 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:16:53,571 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:16:53,572 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:17:28,553 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:17:28,554 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:17:28,555 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:17:28,555 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:17:28,562 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:17:28,562 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:17:28,563 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:17:28,563 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:17:48,555 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:17:49,741 INFO celery.worker.strategy Received task: schedule_start_lesson[aeabf234-6791-4070-a61e-91e61db80a2d]
2016-08-17 19:17:49,743 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:17:49,743 INFO celery Scheduling start lesson tasks
2016-08-17 19:17:49,744 WARNING celery.redirected 2016-08-17 19:17:49,744 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:17:49,745 WARNING celery.redirected 2016-08-17 19:17:49,745 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:17:49,746 WARNING celery.redirected 2016-08-17 19:17:49,746 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:17:49,751 WARNING celery.redirected 2016-08-17 19:17:49,751 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:17:49,752 WARNING celery.redirected 2016-08-17 19:17:49,752 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 17, 49, 747952), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 27, 49, 747952)}
2016-08-17 19:17:49,755 WARNING celery.redirected 2016-08-17 19:17:49,755 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:17:49,757 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:17:49,769 INFO celery.worker.job Task schedule_start_lesson[aeabf234-6791-4070-a61e-91e61db80a2d] succeeded in 0.026099170001543825s: None
2016-08-17 19:17:53,675 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:17:54,612 INFO celery.worker.strategy Received task: schedule_clean_desktops[6b356195-99ce-4a42-a902-8b2d8c84497a]
2016-08-17 19:17:54,614 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:17:54,616 WARNING celery.redirected 2016-08-17 19:17:54,615 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:17:54,617 WARNING celery.redirected 2016-08-17 19:17:54,617 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:17:54,618 WARNING celery.redirected 2016-08-17 19:17:54,618 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:17:54,622 WARNING celery.redirected 2016-08-17 19:17:54,621 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:17:54,622 WARNING celery.redirected 2016-08-17 19:17:54,622 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 16, 54, 614893)}
2016-08-17 19:17:54,625 WARNING celery.redirected 2016-08-17 19:17:54,625 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:17:54,627 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:17:54,638 INFO celery.worker.job Task schedule_clean_desktops[6b356195-99ce-4a42-a902-8b2d8c84497a] succeeded in 0.024576024003181374s: None
2016-08-17 19:17:58,691 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:17:58,692 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:17:58,694 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:17:58,695 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:17:58,702 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:17:58,702 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:17:58,702 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:17:58,703 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:18:33,690 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:18:33,690 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:18:33,691 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:18:33,691 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:18:33,697 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:18:33,697 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:18:33,697 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:18:33,697 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:18:53,681 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:18:53,975 INFO celery.worker.strategy Received task: schedule_start_lesson[757cdb68-5886-45ea-8d7f-759bda2d9eec]
2016-08-17 19:18:53,977 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:18:53,978 INFO celery Scheduling start lesson tasks
2016-08-17 19:18:53,979 WARNING celery.redirected 2016-08-17 19:18:53,978 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:18:53,980 WARNING celery.redirected 2016-08-17 19:18:53,980 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:18:53,980 WARNING celery.redirected 2016-08-17 19:18:53,980 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:18:53,985 WARNING celery.redirected 2016-08-17 19:18:53,985 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:18:53,986 WARNING celery.redirected 2016-08-17 19:18:53,985 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 18, 53, 982237), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 28, 53, 982237)}
2016-08-17 19:18:53,987 WARNING celery.redirected 2016-08-17 19:18:53,987 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:18:53,988 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:18:53,995 INFO celery.worker.job Task schedule_start_lesson[757cdb68-5886-45ea-8d7f-759bda2d9eec] succeeded in 0.018137614002625924s: None
2016-08-17 19:18:58,702 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:18:58,925 INFO celery.worker.strategy Received task: schedule_clean_desktops[bc620add-69cd-4f14-bc04-c89de7f5396f]
2016-08-17 19:18:58,928 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:18:58,929 WARNING celery.redirected 2016-08-17 19:18:58,929 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:18:58,931 WARNING celery.redirected 2016-08-17 19:18:58,930 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:18:58,931 WARNING celery.redirected 2016-08-17 19:18:58,931 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:18:58,935 WARNING celery.redirected 2016-08-17 19:18:58,934 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:18:58,935 WARNING celery.redirected 2016-08-17 19:18:58,935 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 17, 58, 929104), 'desktop_state_2': 'DELETED'}
2016-08-17 19:18:58,937 WARNING celery.redirected 2016-08-17 19:18:58,937 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:18:58,938 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:18:58,952 INFO celery.worker.job Task schedule_clean_desktops[bc620add-69cd-4f14-bc04-c89de7f5396f] succeeded in 0.024175964001187822s: None
2016-08-17 19:19:03,748 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:19:03,748 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:19:03,751 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:19:03,751 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:19:03,758 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:19:03,758 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:19:03,758 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:19:03,758 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:19:33,759 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:19:33,760 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:19:33,761 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:19:33,761 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:19:58,749 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:19:59,521 INFO celery.worker.strategy Received task: schedule_start_lesson[dc5ea931-d3c4-4302-9ecb-3fbb2d8ddf20]
2016-08-17 19:19:59,525 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:19:59,525 INFO celery Scheduling start lesson tasks
2016-08-17 19:19:59,527 WARNING celery.redirected 2016-08-17 19:19:59,527 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:19:59,529 WARNING celery.redirected 2016-08-17 19:19:59,528 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:19:59,530 WARNING celery.redirected 2016-08-17 19:19:59,530 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:19:59,538 WARNING celery.redirected 2016-08-17 19:19:59,537 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:19:59,538 WARNING celery.redirected 2016-08-17 19:19:59,538 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 19, 59, 532785), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 29, 59, 532785)}
2016-08-17 19:19:59,542 WARNING celery.redirected 2016-08-17 19:19:59,542 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:19:59,543 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:19:59,560 INFO celery.worker.job Task schedule_start_lesson[dc5ea931-d3c4-4302-9ecb-3fbb2d8ddf20] succeeded in 0.03505410599973402s: None
2016-08-17 19:20:03,773 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:20:03,774 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:20:03,783 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:20:03,784 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:20:03,788 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:20:03,822 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:20:03,823 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:20:03,832 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:20:03,832 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:20:03,838 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:20:03,839 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:20:03,839 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:20:03,840 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:20:04,480 INFO celery.worker.strategy Received task: schedule_clean_desktops[09d63ee3-9f26-4990-b8f6-9e0c674f14c7]
2016-08-17 19:20:04,482 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:20:04,484 WARNING celery.redirected 2016-08-17 19:20:04,484 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:20:04,485 WARNING celery.redirected 2016-08-17 19:20:04,485 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:20:04,485 WARNING celery.redirected 2016-08-17 19:20:04,485 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:20:04,489 WARNING celery.redirected 2016-08-17 19:20:04,489 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:20:04,490 WARNING celery.redirected 2016-08-17 19:20:04,489 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 19, 4, 483215), 'desktop_state_2': 'DELETED'}
2016-08-17 19:20:04,492 WARNING celery.redirected 2016-08-17 19:20:04,492 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:20:04,493 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:20:04,500 INFO celery.worker.job Task schedule_clean_desktops[09d63ee3-9f26-4990-b8f6-9e0c674f14c7] succeeded in 0.01885924200178124s: None
2016-08-17 19:20:38,821 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:20:38,823 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:20:38,825 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:20:38,825 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:20:38,833 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:20:38,833 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:20:38,833 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:20:38,834 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:21:03,810 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:21:04,043 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:21:05,081 INFO celery.worker.strategy Received task: schedule_start_lesson[b08a8052-e496-4c0b-b5d2-fb9b3d78fba7]
2016-08-17 19:21:05,082 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:21:05,083 INFO celery Scheduling start lesson tasks
2016-08-17 19:21:05,084 WARNING celery.redirected 2016-08-17 19:21:05,083 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:21:05,085 WARNING celery.redirected 2016-08-17 19:21:05,085 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:21:05,085 WARNING celery.redirected 2016-08-17 19:21:05,085 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:21:05,090 WARNING celery.redirected 2016-08-17 19:21:05,089 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:21:05,090 WARNING celery.redirected 2016-08-17 19:21:05,090 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 21, 5, 86963), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 31, 5, 86963)}
2016-08-17 19:21:05,092 WARNING celery.redirected 2016-08-17 19:21:05,092 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:21:05,093 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:21:05,100 INFO celery.worker.job Task schedule_start_lesson[b08a8052-e496-4c0b-b5d2-fb9b3d78fba7] succeeded in 0.01854011899922625s: None
2016-08-17 19:21:05,155 INFO celery.worker.strategy Received task: schedule_clean_desktops[366722b5-1510-4c25-82c5-75c16722906d]
2016-08-17 19:21:05,157 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:21:05,159 WARNING celery.redirected 2016-08-17 19:21:05,158 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:21:05,160 WARNING celery.redirected 2016-08-17 19:21:05,160 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:21:05,160 WARNING celery.redirected 2016-08-17 19:21:05,160 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:21:05,164 WARNING celery.redirected 2016-08-17 19:21:05,164 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:21:05,165 WARNING celery.redirected 2016-08-17 19:21:05,165 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 20, 5, 157932)}
2016-08-17 19:21:05,169 WARNING celery.redirected 2016-08-17 19:21:05,168 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:21:05,171 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:21:05,178 INFO celery.worker.job Task schedule_clean_desktops[366722b5-1510-4c25-82c5-75c16722906d] succeeded in 0.021731975000875536s: None
2016-08-17 19:21:09,060 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:21:09,061 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:21:09,063 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:21:09,063 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:21:09,068 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:21:09,068 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:21:09,069 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:21:09,069 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:21:44,054 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:21:44,054 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:21:44,055 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:21:44,055 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:21:44,060 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:21:44,060 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:21:44,060 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:21:44,061 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:22:04,049 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:22:04,069 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:22:04,555 INFO celery.worker.strategy Received task: schedule_start_lesson[356384e1-528f-47ed-a374-f5ce0f1a3995]
2016-08-17 19:22:04,557 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:22:04,558 INFO celery Scheduling start lesson tasks
2016-08-17 19:22:04,559 WARNING celery.redirected 2016-08-17 19:22:04,559 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:22:04,560 WARNING celery.redirected 2016-08-17 19:22:04,560 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:22:04,561 WARNING celery.redirected 2016-08-17 19:22:04,561 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:22:04,570 WARNING celery.redirected 2016-08-17 19:22:04,569 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:22:04,570 WARNING celery.redirected 2016-08-17 19:22:04,570 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 22, 4, 564181), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 32, 4, 564181)}
2016-08-17 19:22:04,572 WARNING celery.redirected 2016-08-17 19:22:04,572 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:22:04,573 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:22:04,581 INFO celery.worker.job Task schedule_start_lesson[356384e1-528f-47ed-a374-f5ce0f1a3995] succeeded in 0.024351005999051267s: None
2016-08-17 19:22:04,637 INFO celery.worker.strategy Received task: schedule_clean_desktops[5e7f6c6f-1fb6-4c64-b859-994024eaac4a]
2016-08-17 19:22:04,639 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:22:04,641 WARNING celery.redirected 2016-08-17 19:22:04,641 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:22:04,642 WARNING celery.redirected 2016-08-17 19:22:04,642 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:22:04,643 WARNING celery.redirected 2016-08-17 19:22:04,643 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:22:04,647 WARNING celery.redirected 2016-08-17 19:22:04,647 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:22:04,647 WARNING celery.redirected 2016-08-17 19:22:04,647 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 21, 4, 640212)}
2016-08-17 19:22:04,649 WARNING celery.redirected 2016-08-17 19:22:04,649 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:22:04,651 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:22:04,660 INFO celery.worker.job Task schedule_clean_desktops[5e7f6c6f-1fb6-4c64-b859-994024eaac4a] succeeded in 0.02116398200087133s: None
2016-08-17 19:22:14,094 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:22:14,095 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:22:14,098 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:22:14,098 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:22:14,109 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:22:14,110 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:22:14,110 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:22:14,110 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:22:49,096 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:22:49,096 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:22:49,097 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:22:49,097 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:22:49,104 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:22:49,105 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:22:49,105 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:22:49,105 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:23:04,096 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:23:04,119 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:23:04,306 INFO celery.worker.strategy Received task: schedule_start_lesson[c977a228-f0ad-4c9b-82fb-4bb3575a263f]
2016-08-17 19:23:04,308 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:23:04,308 INFO celery Scheduling start lesson tasks
2016-08-17 19:23:04,310 WARNING celery.redirected 2016-08-17 19:23:04,310 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:23:04,312 WARNING celery.redirected 2016-08-17 19:23:04,312 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:23:04,313 WARNING celery.redirected 2016-08-17 19:23:04,312 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:23:04,319 WARNING celery.redirected 2016-08-17 19:23:04,319 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:23:04,320 WARNING celery.redirected 2016-08-17 19:23:04,320 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 23, 4, 315317), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 33, 4, 315317)}
2016-08-17 19:23:04,324 WARNING celery.redirected 2016-08-17 19:23:04,324 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:23:04,326 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:23:04,339 INFO celery.worker.job Task schedule_start_lesson[c977a228-f0ad-4c9b-82fb-4bb3575a263f] succeeded in 0.03142501099864603s: None
2016-08-17 19:23:04,410 INFO celery.worker.strategy Received task: schedule_clean_desktops[f022b7de-de5c-44ca-ac99-2e7b7837a189]
2016-08-17 19:23:04,412 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:23:04,414 WARNING celery.redirected 2016-08-17 19:23:04,413 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:23:04,415 WARNING celery.redirected 2016-08-17 19:23:04,414 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:23:04,415 WARNING celery.redirected 2016-08-17 19:23:04,415 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:23:04,419 WARNING celery.redirected 2016-08-17 19:23:04,418 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:23:04,419 WARNING celery.redirected 2016-08-17 19:23:04,419 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 22, 4, 413114), 'desktop_state_2': 'DELETED'}
2016-08-17 19:23:04,422 WARNING celery.redirected 2016-08-17 19:23:04,422 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:23:04,424 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:23:04,439 INFO celery.worker.job Task schedule_clean_desktops[f022b7de-de5c-44ca-ac99-2e7b7837a189] succeeded in 0.02696951899997657s: None
2016-08-17 19:23:19,141 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:23:19,141 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:23:19,148 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:23:19,149 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:23:19,154 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:23:19,155 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:23:19,155 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:23:19,155 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:23:54,147 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:23:54,148 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:23:54,149 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:23:54,149 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:23:54,159 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:23:54,160 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:23:54,161 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:23:54,161 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:24:04,155 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:24:04,178 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:24:04,469 INFO celery.worker.strategy Received task: schedule_start_lesson[c58d38e1-05a7-4a4d-bf7b-0463b2472e24]
2016-08-17 19:24:04,470 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:24:04,471 INFO celery Scheduling start lesson tasks
2016-08-17 19:24:04,472 WARNING celery.redirected 2016-08-17 19:24:04,472 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:24:04,473 WARNING celery.redirected 2016-08-17 19:24:04,473 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:24:04,473 WARNING celery.redirected 2016-08-17 19:24:04,473 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:24:04,477 WARNING celery.redirected 2016-08-17 19:24:04,477 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:24:04,478 WARNING celery.redirected 2016-08-17 19:24:04,477 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 24, 4, 475098), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 34, 4, 475098)}
2016-08-17 19:24:04,481 WARNING celery.redirected 2016-08-17 19:24:04,480 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:24:04,482 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:24:04,496 INFO celery.worker.job Task schedule_start_lesson[c58d38e1-05a7-4a4d-bf7b-0463b2472e24] succeeded in 0.025965569002437405s: None
2016-08-17 19:24:04,549 INFO celery.worker.strategy Received task: schedule_clean_desktops[d50ecd80-0651-4d55-a707-d86dcfa3a366]
2016-08-17 19:24:04,551 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:24:04,553 WARNING celery.redirected 2016-08-17 19:24:04,553 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:24:04,554 WARNING celery.redirected 2016-08-17 19:24:04,554 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:24:04,555 WARNING celery.redirected 2016-08-17 19:24:04,555 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:24:04,558 WARNING celery.redirected 2016-08-17 19:24:04,558 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:24:04,559 WARNING celery.redirected 2016-08-17 19:24:04,559 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 23, 4, 552185), 'desktop_state_2': 'DELETED'}
2016-08-17 19:24:04,561 WARNING celery.redirected 2016-08-17 19:24:04,560 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:24:04,562 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:24:04,573 INFO celery.worker.job Task schedule_clean_desktops[d50ecd80-0651-4d55-a707-d86dcfa3a366] succeeded in 0.02238543400017079s: None
2016-08-17 19:24:24,187 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:24:24,188 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:24:24,191 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:24:24,191 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:24:24,196 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:24:24,196 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:24:24,196 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:24:24,196 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:24:59,181 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:24:59,182 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:24:59,183 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:24:59,183 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:24:59,188 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:24:59,188 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:24:59,188 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:24:59,189 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:25:04,186 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:25:04,203 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:25:04,443 INFO celery.worker.strategy Received task: schedule_start_lesson[8656f2da-589f-4cc9-9c33-fb9b9cee6925]
2016-08-17 19:25:04,447 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:25:04,450 INFO celery Scheduling start lesson tasks
2016-08-17 19:25:04,455 WARNING celery.redirected 2016-08-17 19:25:04,454 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:25:04,457 WARNING celery.redirected 2016-08-17 19:25:04,456 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:25:04,457 WARNING celery.redirected 2016-08-17 19:25:04,457 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:25:04,463 WARNING celery.redirected 2016-08-17 19:25:04,462 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:25:04,463 WARNING celery.redirected 2016-08-17 19:25:04,463 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 25, 4, 459615), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 35, 4, 459615)}
2016-08-17 19:25:04,465 WARNING celery.redirected 2016-08-17 19:25:04,465 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:25:04,466 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:25:04,478 INFO celery.worker.job Task schedule_start_lesson[8656f2da-589f-4cc9-9c33-fb9b9cee6925] succeeded in 0.03329409099751501s: None
2016-08-17 19:25:04,575 INFO celery.worker.strategy Received task: schedule_clean_desktops[ef5e9140-7ce8-477e-9085-5606504dc604]
2016-08-17 19:25:04,582 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:25:04,602 WARNING celery.redirected 2016-08-17 19:25:04,601 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:25:04,605 WARNING celery.redirected 2016-08-17 19:25:04,605 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:25:04,605 WARNING celery.redirected 2016-08-17 19:25:04,605 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:25:04,611 WARNING celery.redirected 2016-08-17 19:25:04,610 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:25:04,612 WARNING celery.redirected 2016-08-17 19:25:04,611 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 24, 4, 592311), 'desktop_state_2': 'DELETED'}
2016-08-17 19:25:04,617 WARNING celery.redirected 2016-08-17 19:25:04,616 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:25:04,618 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:25:04,629 INFO celery.worker.job Task schedule_clean_desktops[ef5e9140-7ce8-477e-9085-5606504dc604] succeeded in 0.05085433700151043s: None
2016-08-17 19:25:29,204 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:25:29,205 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:25:29,208 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:25:29,208 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:25:29,213 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:25:29,213 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:25:29,214 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:25:29,214 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:26:04,191 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:26:04,192 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:26:04,192 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:26:04,193 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:26:04,195 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:26:04,213 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:26:04,213 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:26:04,215 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:26:04,215 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:26:04,215 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:26:04,233 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:26:04,233 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:26:04,236 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:26:04,236 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:26:04,239 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:26:04,240 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:26:04,240 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:26:04,240 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:26:05,103 INFO celery.worker.strategy Received task: schedule_start_lesson[def2423f-4746-4ce1-8ffa-eb107c6f0360]
2016-08-17 19:26:05,109 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:26:05,116 INFO celery Scheduling start lesson tasks
2016-08-17 19:26:05,126 WARNING celery.redirected 2016-08-17 19:26:05,125 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:26:05,130 WARNING celery.redirected 2016-08-17 19:26:05,129 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:26:05,130 WARNING celery.redirected 2016-08-17 19:26:05,130 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:26:05,142 WARNING celery.redirected 2016-08-17 19:26:05,141 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:26:05,142 WARNING celery.redirected 2016-08-17 19:26:05,142 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 26, 5, 134372), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 36, 5, 134372)}
2016-08-17 19:26:05,146 WARNING celery.redirected 2016-08-17 19:26:05,145 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:26:05,148 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:26:05,169 INFO celery.worker.job Task schedule_start_lesson[def2423f-4746-4ce1-8ffa-eb107c6f0360] succeeded in 0.06339957199816126s: None
2016-08-17 19:26:05,189 INFO celery.worker.strategy Received task: schedule_clean_desktops[bf3a7a6d-4862-46aa-a45b-51c13e06b0b1]
2016-08-17 19:26:05,193 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:26:05,202 WARNING celery.redirected 2016-08-17 19:26:05,202 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:26:05,206 WARNING celery.redirected 2016-08-17 19:26:05,206 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:26:05,207 WARNING celery.redirected 2016-08-17 19:26:05,207 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:26:05,214 WARNING celery.redirected 2016-08-17 19:26:05,214 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:26:05,215 WARNING celery.redirected 2016-08-17 19:26:05,215 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 25, 5, 195182), 'desktop_state_2': 'DELETED'}
2016-08-17 19:26:05,218 WARNING celery.redirected 2016-08-17 19:26:05,217 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:26:05,220 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:26:05,241 INFO celery.worker.job Task schedule_clean_desktops[bf3a7a6d-4862-46aa-a45b-51c13e06b0b1] succeeded in 0.04803716400056146s: None
2016-08-17 19:26:39,224 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:26:39,225 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:26:39,226 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:26:39,226 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:26:39,233 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:26:39,233 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:26:39,233 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:26:39,234 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:27:04,218 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:27:04,239 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:27:05,078 INFO celery.worker.strategy Received task: schedule_start_lesson[763fd4e9-a371-4f25-8e09-a2800e83962c]
2016-08-17 19:27:05,079 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:27:05,081 INFO celery Scheduling start lesson tasks
2016-08-17 19:27:05,082 WARNING celery.redirected 2016-08-17 19:27:05,082 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:27:05,083 WARNING celery.redirected 2016-08-17 19:27:05,083 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:27:05,083 WARNING celery.redirected 2016-08-17 19:27:05,083 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:27:05,090 WARNING celery.redirected 2016-08-17 19:27:05,090 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:27:05,091 WARNING celery.redirected 2016-08-17 19:27:05,091 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 27, 5, 85022), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 37, 5, 85022)}
2016-08-17 19:27:05,093 WARNING celery.redirected 2016-08-17 19:27:05,093 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:27:05,094 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:27:05,103 INFO celery.worker.job Task schedule_start_lesson[763fd4e9-a371-4f25-8e09-a2800e83962c] succeeded in 0.023817309000151s: None
2016-08-17 19:27:05,153 INFO celery.worker.strategy Received task: schedule_clean_desktops[5feaa039-9af0-4829-988e-c1636eba2165]
2016-08-17 19:27:05,154 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:27:05,156 WARNING celery.redirected 2016-08-17 19:27:05,156 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:27:05,157 WARNING celery.redirected 2016-08-17 19:27:05,157 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:27:05,158 WARNING celery.redirected 2016-08-17 19:27:05,158 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:27:05,162 WARNING celery.redirected 2016-08-17 19:27:05,162 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:27:05,163 WARNING celery.redirected 2016-08-17 19:27:05,163 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 26, 5, 155688)}
2016-08-17 19:27:05,166 WARNING celery.redirected 2016-08-17 19:27:05,165 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:27:05,167 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:27:05,177 INFO celery.worker.job Task schedule_clean_desktops[5feaa039-9af0-4829-988e-c1636eba2165] succeeded in 0.02269345500099007s: None
2016-08-17 19:27:09,257 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:27:09,258 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:27:09,260 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:27:09,260 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:27:09,265 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:27:09,265 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:27:09,266 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:27:09,266 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:27:44,253 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:27:44,253 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:27:44,253 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:27:44,253 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:27:44,259 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:27:44,259 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:27:44,260 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:27:44,260 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:28:04,252 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:28:04,286 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:28:04,757 INFO celery.worker.strategy Received task: schedule_start_lesson[2f5c8e3b-fe43-4c16-afa6-8c46bf7bc592]
2016-08-17 19:28:04,759 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:28:04,759 INFO celery Scheduling start lesson tasks
2016-08-17 19:28:04,760 WARNING celery.redirected 2016-08-17 19:28:04,760 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:28:04,761 WARNING celery.redirected 2016-08-17 19:28:04,761 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:28:04,762 WARNING celery.redirected 2016-08-17 19:28:04,762 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:28:04,765 WARNING celery.redirected 2016-08-17 19:28:04,765 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:28:04,766 WARNING celery.redirected 2016-08-17 19:28:04,766 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 28, 4, 763481), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 38, 4, 763481)}
2016-08-17 19:28:04,768 WARNING celery.redirected 2016-08-17 19:28:04,768 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:28:04,769 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:28:04,777 INFO celery.worker.job Task schedule_start_lesson[2f5c8e3b-fe43-4c16-afa6-8c46bf7bc592] succeeded in 0.018412812998576555s: None
2016-08-17 19:28:04,829 INFO celery.worker.strategy Received task: schedule_clean_desktops[3f5bb62b-f7a1-4807-abd4-80dde6ebf9dc]
2016-08-17 19:28:04,830 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:28:04,832 WARNING celery.redirected 2016-08-17 19:28:04,832 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:28:04,834 WARNING celery.redirected 2016-08-17 19:28:04,834 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:28:04,834 WARNING celery.redirected 2016-08-17 19:28:04,834 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:28:04,840 WARNING celery.redirected 2016-08-17 19:28:04,840 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:28:04,841 WARNING celery.redirected 2016-08-17 19:28:04,841 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 27, 4, 831514), 'desktop_state_2': 'DELETED'}
2016-08-17 19:28:04,843 WARNING celery.redirected 2016-08-17 19:28:04,843 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:28:04,845 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:28:04,852 INFO celery.worker.job Task schedule_clean_desktops[3f5bb62b-f7a1-4807-abd4-80dde6ebf9dc] succeeded in 0.022196840000106022s: None
2016-08-17 19:28:14,302 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:28:14,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:28:14,305 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:28:14,305 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:28:14,310 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:28:14,310 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:28:14,311 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:28:14,311 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:28:49,296 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:28:49,296 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:28:49,296 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:28:49,296 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:28:49,302 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:28:49,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:28:49,303 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:28:49,303 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:29:04,296 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:29:04,316 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:29:04,993 INFO celery.worker.strategy Received task: schedule_start_lesson[d4a85434-c1a1-4f09-8b58-92c21cbc710d]
2016-08-17 19:29:04,996 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:29:04,997 INFO celery Scheduling start lesson tasks
2016-08-17 19:29:05,000 WARNING celery.redirected 2016-08-17 19:29:04,999 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:29:05,002 WARNING celery.redirected 2016-08-17 19:29:05,002 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:29:05,004 WARNING celery.redirected 2016-08-17 19:29:05,003 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:29:05,011 WARNING celery.redirected 2016-08-17 19:29:05,011 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:29:05,012 WARNING celery.redirected 2016-08-17 19:29:05,012 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 29, 5, 7932), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 39, 5, 7932)}
2016-08-17 19:29:05,016 WARNING celery.redirected 2016-08-17 19:29:05,016 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:29:05,018 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:29:05,042 INFO celery.worker.job Task schedule_start_lesson[d4a85434-c1a1-4f09-8b58-92c21cbc710d] succeeded in 0.046388498001761036s: None
2016-08-17 19:29:05,107 INFO celery.worker.strategy Received task: schedule_clean_desktops[6eb86966-b218-471d-ab5d-861fe028578d]
2016-08-17 19:29:05,109 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:29:05,111 WARNING celery.redirected 2016-08-17 19:29:05,111 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:29:05,113 WARNING celery.redirected 2016-08-17 19:29:05,112 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:29:05,114 WARNING celery.redirected 2016-08-17 19:29:05,113 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:29:05,119 WARNING celery.redirected 2016-08-17 19:29:05,119 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:29:05,120 WARNING celery.redirected 2016-08-17 19:29:05,119 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 28, 5, 110172), 'desktop_state_2': 'DELETED'}
2016-08-17 19:29:05,122 WARNING celery.redirected 2016-08-17 19:29:05,122 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:29:05,123 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:29:05,133 INFO celery.worker.job Task schedule_clean_desktops[6eb86966-b218-471d-ab5d-861fe028578d] succeeded in 0.023728770000161603s: None
2016-08-17 19:29:19,341 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:29:19,341 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:29:19,343 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:29:19,344 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:29:19,350 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:29:19,351 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:29:19,351 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:29:19,351 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:29:54,323 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:29:54,323 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:29:54,323 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:29:54,323 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:29:54,332 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:29:54,332 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:29:54,333 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:29:54,333 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:30:04,323 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:30:04,340 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:30:05,294 INFO celery.worker.strategy Received task: schedule_start_lesson[4f1534a7-ddbb-4352-9ee8-ac96d7e3b635]
2016-08-17 19:30:05,295 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:30:05,296 INFO celery Scheduling start lesson tasks
2016-08-17 19:30:05,297 WARNING celery.redirected 2016-08-17 19:30:05,297 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:30:05,298 WARNING celery.redirected 2016-08-17 19:30:05,298 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:30:05,299 WARNING celery.redirected 2016-08-17 19:30:05,299 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:30:05,303 WARNING celery.redirected 2016-08-17 19:30:05,303 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:30:05,304 WARNING celery.redirected 2016-08-17 19:30:05,304 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 30, 5, 300647), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 40, 5, 300647)}
2016-08-17 19:30:05,306 WARNING celery.redirected 2016-08-17 19:30:05,306 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:30:05,307 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:30:05,314 INFO celery.worker.job Task schedule_start_lesson[4f1534a7-ddbb-4352-9ee8-ac96d7e3b635] succeeded in 0.018481215000065276s: None
2016-08-17 19:30:05,401 INFO celery.worker.strategy Received task: schedule_clean_desktops[67133ec2-f41a-43b8-bcec-3de45d444687]
2016-08-17 19:30:05,404 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:30:05,406 WARNING celery.redirected 2016-08-17 19:30:05,406 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:30:05,412 WARNING celery.redirected 2016-08-17 19:30:05,411 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:30:05,415 WARNING celery.redirected 2016-08-17 19:30:05,414 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:30:05,433 WARNING celery.redirected 2016-08-17 19:30:05,431 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:30:05,436 WARNING celery.redirected 2016-08-17 19:30:05,435 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 29, 5, 405715)}
2016-08-17 19:30:05,444 WARNING celery.redirected 2016-08-17 19:30:05,444 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:30:05,447 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:30:05,468 INFO celery.worker.job Task schedule_clean_desktops[67133ec2-f41a-43b8-bcec-3de45d444687] succeeded in 0.06413365900152712s: None
2016-08-17 19:30:24,352 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:30:24,352 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:30:24,354 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:30:24,355 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:30:24,359 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:30:24,359 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:30:24,360 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:30:24,360 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:30:59,350 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:30:59,351 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:30:59,352 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:30:59,352 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:30:59,358 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:30:59,358 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:30:59,359 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:30:59,359 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:31:04,355 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:31:04,424 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:31:05,192 INFO celery.worker.strategy Received task: schedule_start_lesson[09d2237b-e894-4817-a6c9-0ebb693f437a]
2016-08-17 19:31:05,195 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:31:05,197 INFO celery Scheduling start lesson tasks
2016-08-17 19:31:05,198 WARNING celery.redirected 2016-08-17 19:31:05,198 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:31:05,199 WARNING celery.redirected 2016-08-17 19:31:05,199 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:31:05,199 WARNING celery.redirected 2016-08-17 19:31:05,199 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:31:05,204 WARNING celery.redirected 2016-08-17 19:31:05,204 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:31:05,206 WARNING celery.redirected 2016-08-17 19:31:05,206 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 31, 5, 200883), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 41, 5, 200883)}
2016-08-17 19:31:05,215 WARNING celery.redirected 2016-08-17 19:31:05,214 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:31:05,221 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:31:05,241 INFO celery.worker.job Task schedule_start_lesson[09d2237b-e894-4817-a6c9-0ebb693f437a] succeeded in 0.04641482800070662s: None
2016-08-17 19:31:05,297 INFO celery.worker.strategy Received task: schedule_clean_desktops[13d775d6-396f-47bb-84b1-295f34a73f27]
2016-08-17 19:31:05,298 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:31:05,300 WARNING celery.redirected 2016-08-17 19:31:05,300 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:31:05,301 WARNING celery.redirected 2016-08-17 19:31:05,301 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:31:05,302 WARNING celery.redirected 2016-08-17 19:31:05,302 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:31:05,306 WARNING celery.redirected 2016-08-17 19:31:05,305 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:31:05,308 WARNING celery.redirected 2016-08-17 19:31:05,307 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 30, 5, 299680), 'desktop_state_2': 'DELETED'}
2016-08-17 19:31:05,313 WARNING celery.redirected 2016-08-17 19:31:05,312 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:31:05,314 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:31:05,321 INFO celery.worker.job Task schedule_clean_desktops[13d775d6-396f-47bb-84b1-295f34a73f27] succeeded in 0.02231895600198186s: None
2016-08-17 19:31:29,454 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:31:29,455 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:31:29,457 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:31:29,458 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:31:29,463 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:31:29,463 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:31:29,463 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:31:29,463 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:32:04,447 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:32:04,448 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:32:04,448 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:32:04,448 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:32:04,450 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:32:04,468 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:32:04,468 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:32:04,470 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:32:04,470 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:32:04,471 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:32:04,487 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:32:04,487 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:32:04,489 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:32:04,490 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:32:04,492 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:32:04,493 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:32:04,493 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:32:04,493 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:32:04,592 INFO celery.worker.strategy Received task: schedule_start_lesson[40d07163-3da7-4e37-b8ff-1b5d08fe0861]
2016-08-17 19:32:04,594 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:32:04,594 INFO celery Scheduling start lesson tasks
2016-08-17 19:32:04,595 WARNING celery.redirected 2016-08-17 19:32:04,595 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:32:04,596 WARNING celery.redirected 2016-08-17 19:32:04,596 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:32:04,597 WARNING celery.redirected 2016-08-17 19:32:04,597 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:32:04,600 WARNING celery.redirected 2016-08-17 19:32:04,600 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:32:04,601 WARNING celery.redirected 2016-08-17 19:32:04,601 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 32, 4, 598566), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 42, 4, 598566)}
2016-08-17 19:32:04,603 WARNING celery.redirected 2016-08-17 19:32:04,603 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:32:04,604 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:32:04,611 INFO celery.worker.job Task schedule_start_lesson[40d07163-3da7-4e37-b8ff-1b5d08fe0861] succeeded in 0.017752130999724614s: None
2016-08-17 19:32:04,665 INFO celery.worker.strategy Received task: schedule_clean_desktops[8a459cfe-1be7-478b-90fe-895dc1d2a941]
2016-08-17 19:32:04,666 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:32:04,667 WARNING celery.redirected 2016-08-17 19:32:04,667 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:32:04,669 WARNING celery.redirected 2016-08-17 19:32:04,668 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:32:04,669 WARNING celery.redirected 2016-08-17 19:32:04,669 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:32:04,672 WARNING celery.redirected 2016-08-17 19:32:04,672 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:32:04,673 WARNING celery.redirected 2016-08-17 19:32:04,673 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 31, 4, 667013), 'desktop_state_2': 'DELETED'}
2016-08-17 19:32:04,675 WARNING celery.redirected 2016-08-17 19:32:04,675 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:32:04,676 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:32:04,683 INFO celery.worker.job Task schedule_clean_desktops[8a459cfe-1be7-478b-90fe-895dc1d2a941] succeeded in 0.01721074899978703s: None
2016-08-17 19:32:39,472 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:32:39,472 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:32:39,472 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:32:39,473 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:32:39,478 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:32:39,478 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:32:39,478 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:32:39,479 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:33:04,458 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:33:04,477 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:33:04,808 INFO celery.worker.strategy Received task: schedule_start_lesson[dd42b91e-9434-47ad-ac44-b0fdb64f8c57]
2016-08-17 19:33:04,809 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:33:04,810 INFO celery Scheduling start lesson tasks
2016-08-17 19:33:04,811 WARNING celery.redirected 2016-08-17 19:33:04,811 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:33:04,812 WARNING celery.redirected 2016-08-17 19:33:04,812 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:33:04,813 WARNING celery.redirected 2016-08-17 19:33:04,813 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:33:04,817 WARNING celery.redirected 2016-08-17 19:33:04,817 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:33:04,818 WARNING celery.redirected 2016-08-17 19:33:04,818 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 33, 4, 814920), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 43, 4, 814920)}
2016-08-17 19:33:04,821 WARNING celery.redirected 2016-08-17 19:33:04,820 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:33:04,822 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:33:04,832 INFO celery.worker.job Task schedule_start_lesson[dd42b91e-9434-47ad-ac44-b0fdb64f8c57] succeeded in 0.022361285002261866s: None
2016-08-17 19:33:04,883 INFO celery.worker.strategy Received task: schedule_clean_desktops[a73e0166-805d-402f-9bca-6ff3ce3b42c7]
2016-08-17 19:33:04,885 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:33:04,886 WARNING celery.redirected 2016-08-17 19:33:04,886 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:33:04,888 WARNING celery.redirected 2016-08-17 19:33:04,888 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:33:04,888 WARNING celery.redirected 2016-08-17 19:33:04,888 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:33:04,892 WARNING celery.redirected 2016-08-17 19:33:04,892 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:33:04,892 WARNING celery.redirected 2016-08-17 19:33:04,892 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 32, 4, 885753)}
2016-08-17 19:33:04,895 WARNING celery.redirected 2016-08-17 19:33:04,894 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:33:04,896 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:33:04,903 INFO celery.worker.job Task schedule_clean_desktops[a73e0166-805d-402f-9bca-6ff3ce3b42c7] succeeded in 0.01850549699884141s: None
2016-08-17 19:33:09,492 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:33:09,492 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:33:09,495 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:33:09,495 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:33:09,501 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:33:09,501 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:33:09,501 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:33:09,501 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:33:44,474 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:33:44,474 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:33:44,475 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:33:44,475 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:33:44,481 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:33:44,481 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:33:44,482 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:33:44,482 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:34:04,468 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:34:04,489 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:34:04,712 INFO celery.worker.strategy Received task: schedule_start_lesson[0ff58348-9b3e-47b9-9e06-cc029a635af6]
2016-08-17 19:34:04,714 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:34:04,715 INFO celery Scheduling start lesson tasks
2016-08-17 19:34:04,716 WARNING celery.redirected 2016-08-17 19:34:04,716 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:34:04,718 WARNING celery.redirected 2016-08-17 19:34:04,718 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:34:04,720 WARNING celery.redirected 2016-08-17 19:34:04,720 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:34:04,726 WARNING celery.redirected 2016-08-17 19:34:04,726 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:34:04,726 WARNING celery.redirected 2016-08-17 19:34:04,726 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 34, 4, 722717), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 44, 4, 722717)}
2016-08-17 19:34:04,728 WARNING celery.redirected 2016-08-17 19:34:04,728 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:34:04,730 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:34:04,741 INFO celery.worker.job Task schedule_start_lesson[0ff58348-9b3e-47b9-9e06-cc029a635af6] succeeded in 0.027728617998945992s: None
2016-08-17 19:34:04,794 INFO celery.worker.strategy Received task: schedule_clean_desktops[fc99baf4-6b07-4242-aa4b-a147250bd5f8]
2016-08-17 19:34:04,795 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:34:04,797 WARNING celery.redirected 2016-08-17 19:34:04,797 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:34:04,799 WARNING celery.redirected 2016-08-17 19:34:04,798 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:34:04,800 WARNING celery.redirected 2016-08-17 19:34:04,799 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:34:04,806 WARNING celery.redirected 2016-08-17 19:34:04,806 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:34:04,807 WARNING celery.redirected 2016-08-17 19:34:04,807 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 33, 4, 796431)}
2016-08-17 19:34:04,810 WARNING celery.redirected 2016-08-17 19:34:04,810 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:34:04,811 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:34:04,819 INFO celery.worker.job Task schedule_clean_desktops[fc99baf4-6b07-4242-aa4b-a147250bd5f8] succeeded in 0.024127367996698013s: None
2016-08-17 19:34:14,509 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:34:14,509 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:34:14,512 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:34:14,512 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:34:14,517 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:34:14,517 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:34:14,518 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:34:14,518 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:34:49,494 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:34:49,494 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:34:49,494 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:34:49,494 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:34:49,499 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:34:49,499 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:34:49,499 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:34:49,500 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:35:04,489 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:35:04,509 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:35:05,116 INFO celery.worker.strategy Received task: schedule_start_lesson[8903c9bd-ec31-4e8f-a9e1-75dbdafe91e7]
2016-08-17 19:35:05,118 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:35:05,119 INFO celery Scheduling start lesson tasks
2016-08-17 19:35:05,121 WARNING celery.redirected 2016-08-17 19:35:05,121 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:35:05,124 WARNING celery.redirected 2016-08-17 19:35:05,122 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:35:05,129 WARNING celery.redirected 2016-08-17 19:35:05,128 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:35:05,135 WARNING celery.redirected 2016-08-17 19:35:05,135 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:35:05,136 WARNING celery.redirected 2016-08-17 19:35:05,135 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 35, 5, 131406), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 45, 5, 131406)}
2016-08-17 19:35:05,138 WARNING celery.redirected 2016-08-17 19:35:05,138 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:35:05,140 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:35:05,149 INFO celery.worker.job Task schedule_start_lesson[8903c9bd-ec31-4e8f-a9e1-75dbdafe91e7] succeeded in 0.03116937999948277s: None
2016-08-17 19:35:05,210 INFO celery.worker.strategy Received task: schedule_clean_desktops[4a5fe593-7805-4975-92e8-545141c162e2]
2016-08-17 19:35:05,213 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:35:05,214 WARNING celery.redirected 2016-08-17 19:35:05,214 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:35:05,216 WARNING celery.redirected 2016-08-17 19:35:05,215 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:35:05,216 WARNING celery.redirected 2016-08-17 19:35:05,216 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:35:05,220 WARNING celery.redirected 2016-08-17 19:35:05,220 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:35:05,221 WARNING celery.redirected 2016-08-17 19:35:05,221 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 34, 5, 213946)}
2016-08-17 19:35:05,224 WARNING celery.redirected 2016-08-17 19:35:05,224 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:35:05,226 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:35:05,236 INFO celery.worker.job Task schedule_clean_desktops[4a5fe593-7805-4975-92e8-545141c162e2] succeeded in 0.02398674800133449s: None
2016-08-17 19:35:19,526 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:35:19,526 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:35:19,529 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:35:19,529 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:35:19,535 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:35:19,535 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:35:19,535 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:35:19,536 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:35:54,514 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:35:54,514 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:35:54,515 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:35:54,515 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:35:54,521 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:35:54,521 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:35:54,522 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:35:54,522 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:36:04,513 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:36:05,371 INFO celery.worker.strategy Received task: schedule_start_lesson[fc8a2abf-9748-4369-9e17-4460e2f5a764]
2016-08-17 19:36:05,372 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:36:05,373 INFO celery Scheduling start lesson tasks
2016-08-17 19:36:05,374 WARNING celery.redirected 2016-08-17 19:36:05,374 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:36:05,375 WARNING celery.redirected 2016-08-17 19:36:05,375 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:36:05,376 WARNING celery.redirected 2016-08-17 19:36:05,375 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:36:05,380 WARNING celery.redirected 2016-08-17 19:36:05,379 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:36:05,380 WARNING celery.redirected 2016-08-17 19:36:05,380 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 36, 5, 377469), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 46, 5, 377469)}
2016-08-17 19:36:05,383 WARNING celery.redirected 2016-08-17 19:36:05,383 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:36:05,384 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:36:05,392 INFO celery.worker.job Task schedule_start_lesson[fc8a2abf-9748-4369-9e17-4460e2f5a764] succeeded in 0.02013734700085479s: None
2016-08-17 19:36:09,529 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:36:10,179 INFO celery.worker.strategy Received task: schedule_clean_desktops[8dfcae60-a1cb-44d4-a06c-1a5e60dd9b60]
2016-08-17 19:36:10,180 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:36:10,182 WARNING celery.redirected 2016-08-17 19:36:10,182 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:36:10,183 WARNING celery.redirected 2016-08-17 19:36:10,183 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:36:10,184 WARNING celery.redirected 2016-08-17 19:36:10,183 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:36:10,187 WARNING celery.redirected 2016-08-17 19:36:10,187 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:36:10,188 WARNING celery.redirected 2016-08-17 19:36:10,188 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 35, 10, 181555)}
2016-08-17 19:36:10,190 WARNING celery.redirected 2016-08-17 19:36:10,190 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:36:10,191 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:36:10,199 INFO celery.worker.job Task schedule_clean_desktops[8dfcae60-a1cb-44d4-a06c-1a5e60dd9b60] succeeded in 0.018404481001198292s: None
2016-08-17 19:36:24,543 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:36:24,543 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:36:24,545 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:36:24,546 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:36:24,552 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:36:24,552 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:36:24,552 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:36:24,552 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:36:59,526 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:36:59,527 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:36:59,527 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:36:59,527 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:36:59,534 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:36:59,534 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:36:59,534 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:36:59,534 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:37:09,530 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:37:09,917 INFO celery.worker.strategy Received task: schedule_start_lesson[8e349f77-116c-4bec-8286-b3d44bb48efb]
2016-08-17 19:37:09,918 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:37:09,919 INFO celery Scheduling start lesson tasks
2016-08-17 19:37:09,921 WARNING celery.redirected 2016-08-17 19:37:09,921 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:37:09,922 WARNING celery.redirected 2016-08-17 19:37:09,922 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:37:09,922 WARNING celery.redirected 2016-08-17 19:37:09,922 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:37:09,927 WARNING celery.redirected 2016-08-17 19:37:09,927 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:37:09,928 WARNING celery.redirected 2016-08-17 19:37:09,928 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 37, 9, 924323), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 47, 9, 924323)}
2016-08-17 19:37:09,930 WARNING celery.redirected 2016-08-17 19:37:09,930 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:37:09,932 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:37:09,939 INFO celery.worker.job Task schedule_start_lesson[8e349f77-116c-4bec-8286-b3d44bb48efb] succeeded in 0.02126920399678056s: None
2016-08-17 19:37:14,547 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:37:14,722 INFO celery.worker.strategy Received task: schedule_clean_desktops[24776b61-fecb-45f0-be6d-0b0999fbae81]
2016-08-17 19:37:14,723 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:37:14,724 WARNING celery.redirected 2016-08-17 19:37:14,724 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:37:14,726 WARNING celery.redirected 2016-08-17 19:37:14,726 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:37:14,727 WARNING celery.redirected 2016-08-17 19:37:14,726 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:37:14,730 WARNING celery.redirected 2016-08-17 19:37:14,730 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:37:14,730 WARNING celery.redirected 2016-08-17 19:37:14,730 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 36, 14, 724001)}
2016-08-17 19:37:14,733 WARNING celery.redirected 2016-08-17 19:37:14,733 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:37:14,734 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:37:14,740 INFO celery.worker.job Task schedule_clean_desktops[24776b61-fecb-45f0-be6d-0b0999fbae81] succeeded in 0.017412606997822877s: None
2016-08-17 19:37:29,562 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:37:29,565 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:37:29,569 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:37:29,569 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:37:29,579 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:37:29,579 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:37:29,580 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:37:29,580 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:38:04,566 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:38:04,566 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:38:04,567 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:38:04,567 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:38:04,573 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:38:04,573 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:38:04,574 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:38:04,574 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:38:14,566 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:38:15,513 INFO celery.worker.strategy Received task: schedule_start_lesson[b2a9fee3-91bc-43f2-9f41-122202fb82da]
2016-08-17 19:38:15,515 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:38:15,516 INFO celery Scheduling start lesson tasks
2016-08-17 19:38:15,517 WARNING celery.redirected 2016-08-17 19:38:15,517 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:38:15,518 WARNING celery.redirected 2016-08-17 19:38:15,518 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:38:15,518 WARNING celery.redirected 2016-08-17 19:38:15,518 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:38:15,522 WARNING celery.redirected 2016-08-17 19:38:15,522 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:38:15,523 WARNING celery.redirected 2016-08-17 19:38:15,523 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 38, 15, 520474), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 48, 15, 520474)}
2016-08-17 19:38:15,525 WARNING celery.redirected 2016-08-17 19:38:15,525 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:38:15,526 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:38:15,534 INFO celery.worker.job Task schedule_start_lesson[b2a9fee3-91bc-43f2-9f41-122202fb82da] succeeded in 0.01943256499725976s: None
2016-08-17 19:38:19,585 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:38:20,357 INFO celery.worker.strategy Received task: schedule_clean_desktops[5c373d9b-8c70-4ade-b405-b38abed537b2]
2016-08-17 19:38:20,359 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:38:20,360 WARNING celery.redirected 2016-08-17 19:38:20,360 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:38:20,362 WARNING celery.redirected 2016-08-17 19:38:20,362 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:38:20,363 WARNING celery.redirected 2016-08-17 19:38:20,363 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:38:20,367 WARNING celery.redirected 2016-08-17 19:38:20,367 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:38:20,368 WARNING celery.redirected 2016-08-17 19:38:20,368 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 37, 20, 359718)}
2016-08-17 19:38:20,371 WARNING celery.redirected 2016-08-17 19:38:20,370 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:38:20,372 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:38:20,379 INFO celery.worker.job Task schedule_clean_desktops[5c373d9b-8c70-4ade-b405-b38abed537b2] succeeded in 0.020634275002521463s: None
2016-08-17 19:38:34,604 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:38:34,604 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:38:34,607 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:38:34,608 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:38:34,615 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:38:34,616 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:38:34,616 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:38:34,617 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:39:09,597 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:39:09,597 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:39:09,598 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:39:09,598 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:39:09,603 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:39:09,604 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:39:09,604 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:39:09,604 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:39:19,600 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:39:20,347 INFO celery.worker.strategy Received task: schedule_start_lesson[21a55c63-c8d6-49c3-9356-10d099233574]
2016-08-17 19:39:20,349 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:39:20,350 INFO celery Scheduling start lesson tasks
2016-08-17 19:39:20,351 WARNING celery.redirected 2016-08-17 19:39:20,351 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:39:20,352 WARNING celery.redirected 2016-08-17 19:39:20,352 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:39:20,352 WARNING celery.redirected 2016-08-17 19:39:20,352 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:39:20,356 WARNING celery.redirected 2016-08-17 19:39:20,356 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:39:20,357 WARNING celery.redirected 2016-08-17 19:39:20,357 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 39, 20, 354035), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 49, 20, 354035)}
2016-08-17 19:39:20,359 WARNING celery.redirected 2016-08-17 19:39:20,359 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:39:20,361 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:39:20,368 INFO celery.worker.job Task schedule_start_lesson[21a55c63-c8d6-49c3-9356-10d099233574] succeeded in 0.018951582002046052s: None
2016-08-17 19:39:24,620 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:39:25,152 INFO celery.worker.strategy Received task: schedule_clean_desktops[5648331a-889e-4e1c-a334-2d717bf7c044]
2016-08-17 19:39:25,153 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:39:25,155 WARNING celery.redirected 2016-08-17 19:39:25,155 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:39:25,156 WARNING celery.redirected 2016-08-17 19:39:25,156 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:39:25,156 WARNING celery.redirected 2016-08-17 19:39:25,156 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:39:25,160 WARNING celery.redirected 2016-08-17 19:39:25,160 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:39:25,160 WARNING celery.redirected 2016-08-17 19:39:25,160 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 38, 25, 154503)}
2016-08-17 19:39:25,164 WARNING celery.redirected 2016-08-17 19:39:25,164 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:39:25,165 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:39:25,172 INFO celery.worker.job Task schedule_clean_desktops[5648331a-889e-4e1c-a334-2d717bf7c044] succeeded in 0.018642789000296034s: None
2016-08-17 19:39:39,634 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:39:39,635 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:39:39,638 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:39:39,638 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:39:39,642 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:39:39,643 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:39:39,643 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:39:39,643 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:40:14,624 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:40:14,624 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:40:14,624 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:40:14,625 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:40:14,631 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:40:14,631 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:40:14,632 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:40:14,632 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:40:24,626 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:40:25,290 INFO celery.worker.strategy Received task: schedule_start_lesson[a9d6437d-7312-434f-8123-2dc783139f1e]
2016-08-17 19:40:25,291 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:40:25,292 INFO celery Scheduling start lesson tasks
2016-08-17 19:40:25,293 WARNING celery.redirected 2016-08-17 19:40:25,293 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:40:25,295 WARNING celery.redirected 2016-08-17 19:40:25,294 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:40:25,295 WARNING celery.redirected 2016-08-17 19:40:25,295 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:40:25,302 WARNING celery.redirected 2016-08-17 19:40:25,302 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:40:25,303 WARNING celery.redirected 2016-08-17 19:40:25,303 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 40, 25, 297995), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 50, 25, 297995)}
2016-08-17 19:40:25,306 WARNING celery.redirected 2016-08-17 19:40:25,306 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:40:25,307 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:40:25,316 INFO celery.worker.job Task schedule_start_lesson[a9d6437d-7312-434f-8123-2dc783139f1e] succeeded in 0.024706154999876162s: None
2016-08-17 19:40:29,646 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:40:30,108 INFO celery.worker.strategy Received task: schedule_clean_desktops[761990c6-f885-4934-a005-06410471dedd]
2016-08-17 19:40:30,109 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:40:30,111 WARNING celery.redirected 2016-08-17 19:40:30,111 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:40:30,113 WARNING celery.redirected 2016-08-17 19:40:30,113 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:40:30,114 WARNING celery.redirected 2016-08-17 19:40:30,113 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:40:30,119 WARNING celery.redirected 2016-08-17 19:40:30,118 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:40:30,119 WARNING celery.redirected 2016-08-17 19:40:30,119 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 39, 30, 110443), 'desktop_state_2': 'DELETED'}
2016-08-17 19:40:30,122 WARNING celery.redirected 2016-08-17 19:40:30,122 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:40:30,123 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:40:30,133 INFO celery.worker.job Task schedule_clean_desktops[761990c6-f885-4934-a005-06410471dedd] succeeded in 0.02382617900002515s: None
2016-08-17 19:40:44,667 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:40:44,668 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:40:44,671 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:40:44,672 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:40:44,678 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:40:44,678 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:40:44,678 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:40:44,678 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:41:19,671 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:41:19,671 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:41:19,672 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:41:19,672 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:41:19,680 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:41:19,680 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:41:19,680 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:41:19,681 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:41:29,677 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:41:30,723 INFO celery.worker.strategy Received task: schedule_start_lesson[105fc007-341d-4d6a-8c2a-b5d25bac61f5]
2016-08-17 19:41:30,725 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:41:30,726 INFO celery Scheduling start lesson tasks
2016-08-17 19:41:30,728 WARNING celery.redirected 2016-08-17 19:41:30,727 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:41:30,730 WARNING celery.redirected 2016-08-17 19:41:30,729 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:41:30,731 WARNING celery.redirected 2016-08-17 19:41:30,731 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:41:30,737 WARNING celery.redirected 2016-08-17 19:41:30,737 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:41:30,738 WARNING celery.redirected 2016-08-17 19:41:30,738 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 41, 30, 733835), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 51, 30, 733835)}
2016-08-17 19:41:30,740 WARNING celery.redirected 2016-08-17 19:41:30,740 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:41:30,741 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:41:30,749 INFO celery.worker.job Task schedule_start_lesson[105fc007-341d-4d6a-8c2a-b5d25bac61f5] succeeded in 0.024472295997838955s: None
2016-08-17 19:41:34,701 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:41:35,571 INFO celery.worker.strategy Received task: schedule_clean_desktops[b931a187-3062-4659-be36-6a76e1aa73d4]
2016-08-17 19:41:35,573 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:41:35,576 WARNING celery.redirected 2016-08-17 19:41:35,576 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:41:35,578 WARNING celery.redirected 2016-08-17 19:41:35,578 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:41:35,579 WARNING celery.redirected 2016-08-17 19:41:35,579 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:41:35,587 WARNING celery.redirected 2016-08-17 19:41:35,586 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:41:35,588 WARNING celery.redirected 2016-08-17 19:41:35,588 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 40, 35, 574842)}
2016-08-17 19:41:35,591 WARNING celery.redirected 2016-08-17 19:41:35,591 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:41:35,594 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:41:35,610 INFO celery.worker.job Task schedule_clean_desktops[b931a187-3062-4659-be36-6a76e1aa73d4] succeeded in 0.037167033999139676s: None
2016-08-17 19:41:49,716 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:41:49,716 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:41:49,720 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:41:49,720 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:41:49,726 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:41:49,726 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:41:49,726 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:41:49,727 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:42:24,710 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:42:24,710 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:42:24,710 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:42:24,711 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:42:24,717 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:42:24,717 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:42:24,718 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:42:24,718 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:42:34,714 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:42:35,703 INFO celery.worker.strategy Received task: schedule_start_lesson[1a332291-7b0f-40ea-844b-4a7ce20fb90f]
2016-08-17 19:42:35,710 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:42:35,713 INFO celery Scheduling start lesson tasks
2016-08-17 19:42:35,715 WARNING celery.redirected 2016-08-17 19:42:35,715 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:42:35,716 WARNING celery.redirected 2016-08-17 19:42:35,716 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:42:35,716 WARNING celery.redirected 2016-08-17 19:42:35,716 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:42:35,721 WARNING celery.redirected 2016-08-17 19:42:35,721 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:42:35,722 WARNING celery.redirected 2016-08-17 19:42:35,722 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 42, 35, 718259), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 52, 35, 718259)}
2016-08-17 19:42:35,726 WARNING celery.redirected 2016-08-17 19:42:35,726 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:42:35,728 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:42:35,740 INFO celery.worker.job Task schedule_start_lesson[1a332291-7b0f-40ea-844b-4a7ce20fb90f] succeeded in 0.030606388001615414s: None
2016-08-17 19:42:39,739 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:42:40,691 INFO celery.worker.strategy Received task: schedule_clean_desktops[26f5b762-6da0-4382-a680-16d8fde395ec]
2016-08-17 19:42:40,693 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:42:40,695 WARNING celery.redirected 2016-08-17 19:42:40,695 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:42:40,697 WARNING celery.redirected 2016-08-17 19:42:40,697 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:42:40,698 WARNING celery.redirected 2016-08-17 19:42:40,697 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:42:40,701 WARNING celery.redirected 2016-08-17 19:42:40,701 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:42:40,702 WARNING celery.redirected 2016-08-17 19:42:40,702 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 41, 40, 694421), 'desktop_state_2': 'DELETED'}
2016-08-17 19:42:40,704 WARNING celery.redirected 2016-08-17 19:42:40,704 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:42:40,705 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:42:40,712 INFO celery.worker.job Task schedule_clean_desktops[26f5b762-6da0-4382-a680-16d8fde395ec] succeeded in 0.019248749998951098s: None
2016-08-17 19:42:54,754 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:42:54,754 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:42:54,757 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:42:54,758 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:42:54,763 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:42:54,763 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:42:54,763 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:42:54,763 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:43:29,744 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:43:29,744 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:43:29,744 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:43:29,744 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:43:29,750 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:43:29,750 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:43:29,750 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:43:29,750 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:43:39,745 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:43:40,792 INFO celery.worker.strategy Received task: schedule_start_lesson[c701954f-97bc-4a4d-b60b-0c3808730bfb]
2016-08-17 19:43:40,795 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:43:40,795 INFO celery Scheduling start lesson tasks
2016-08-17 19:43:40,797 WARNING celery.redirected 2016-08-17 19:43:40,796 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:43:40,798 WARNING celery.redirected 2016-08-17 19:43:40,798 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:43:40,799 WARNING celery.redirected 2016-08-17 19:43:40,799 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:43:40,806 WARNING celery.redirected 2016-08-17 19:43:40,806 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:43:40,807 WARNING celery.redirected 2016-08-17 19:43:40,807 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 43, 40, 803655), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 53, 40, 803655)}
2016-08-17 19:43:40,809 WARNING celery.redirected 2016-08-17 19:43:40,809 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:43:40,810 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:43:40,817 INFO celery.worker.job Task schedule_start_lesson[c701954f-97bc-4a4d-b60b-0c3808730bfb] succeeded in 0.023014522004814353s: None
2016-08-17 19:43:44,766 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:43:45,777 INFO celery.worker.strategy Received task: schedule_clean_desktops[8afc80b0-4448-4569-8d7c-85bcfe3344ba]
2016-08-17 19:43:45,779 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:43:45,781 WARNING celery.redirected 2016-08-17 19:43:45,781 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:43:45,783 WARNING celery.redirected 2016-08-17 19:43:45,782 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:43:45,784 WARNING celery.redirected 2016-08-17 19:43:45,783 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:43:45,788 WARNING celery.redirected 2016-08-17 19:43:45,787 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:43:45,789 WARNING celery.redirected 2016-08-17 19:43:45,788 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 42, 45, 780933), 'desktop_state_2': 'DELETED'}
2016-08-17 19:43:45,791 WARNING celery.redirected 2016-08-17 19:43:45,791 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:43:45,792 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:43:45,807 INFO celery.worker.job Task schedule_clean_desktops[8afc80b0-4448-4569-8d7c-85bcfe3344ba] succeeded in 0.027630716002022382s: None
2016-08-17 19:43:59,790 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:43:59,790 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:43:59,793 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:43:59,793 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:43:59,799 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:43:59,799 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:43:59,800 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:43:59,801 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:44:34,783 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:44:34,783 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:44:34,784 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:44:34,784 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:44:34,790 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:44:34,790 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:44:34,790 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:44:34,791 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:44:44,788 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:44:45,930 INFO celery.worker.strategy Received task: schedule_start_lesson[3ad6f94d-1638-49be-ae61-bd90555f86d8]
2016-08-17 19:44:45,931 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:44:45,932 INFO celery Scheduling start lesson tasks
2016-08-17 19:44:45,933 WARNING celery.redirected 2016-08-17 19:44:45,933 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:44:45,934 WARNING celery.redirected 2016-08-17 19:44:45,934 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:44:45,935 WARNING celery.redirected 2016-08-17 19:44:45,935 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:44:45,941 WARNING celery.redirected 2016-08-17 19:44:45,941 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:44:45,942 WARNING celery.redirected 2016-08-17 19:44:45,942 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 44, 45, 937523), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 54, 45, 937523)}
2016-08-17 19:44:45,945 WARNING celery.redirected 2016-08-17 19:44:45,945 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:44:45,946 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:44:45,953 INFO celery.worker.job Task schedule_start_lesson[3ad6f94d-1638-49be-ae61-bd90555f86d8] succeeded in 0.02243272300256649s: None
2016-08-17 19:44:49,870 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:44:50,733 INFO celery.worker.strategy Received task: schedule_clean_desktops[406e5d92-2815-453c-b33f-4ece7f52b591]
2016-08-17 19:44:50,734 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:44:50,736 WARNING celery.redirected 2016-08-17 19:44:50,736 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:44:50,737 WARNING celery.redirected 2016-08-17 19:44:50,737 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:44:50,738 WARNING celery.redirected 2016-08-17 19:44:50,738 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:44:50,742 WARNING celery.redirected 2016-08-17 19:44:50,742 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:44:50,743 WARNING celery.redirected 2016-08-17 19:44:50,743 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 43, 50, 735224)}
2016-08-17 19:44:50,746 WARNING celery.redirected 2016-08-17 19:44:50,746 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:44:50,747 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:44:50,754 INFO celery.worker.job Task schedule_clean_desktops[406e5d92-2815-453c-b33f-4ece7f52b591] succeeded in 0.019906800000171643s: None
2016-08-17 19:45:04,883 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:45:04,883 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:45:04,887 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:45:04,887 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:45:04,893 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:45:04,893 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:45:04,893 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:45:04,893 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:45:39,876 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:45:39,876 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:45:39,877 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:45:39,877 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:45:39,882 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:45:39,882 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:45:39,883 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:45:39,883 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:45:49,880 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:45:50,541 INFO celery.worker.strategy Received task: schedule_start_lesson[2e920b5e-5e63-43e5-b2e6-39ec90e13511]
2016-08-17 19:45:50,543 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:45:50,544 INFO celery Scheduling start lesson tasks
2016-08-17 19:45:50,545 WARNING celery.redirected 2016-08-17 19:45:50,545 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:45:50,547 WARNING celery.redirected 2016-08-17 19:45:50,547 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:45:50,547 WARNING celery.redirected 2016-08-17 19:45:50,547 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:45:50,552 WARNING celery.redirected 2016-08-17 19:45:50,552 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:45:50,553 WARNING celery.redirected 2016-08-17 19:45:50,553 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 45, 50, 549378), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 55, 50, 549378)}
2016-08-17 19:45:50,555 WARNING celery.redirected 2016-08-17 19:45:50,555 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:45:50,556 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:45:50,563 INFO celery.worker.job Task schedule_start_lesson[2e920b5e-5e63-43e5-b2e6-39ec90e13511] succeeded in 0.02030255299905548s: None
2016-08-17 19:45:54,900 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:45:55,390 INFO celery.worker.strategy Received task: schedule_clean_desktops[513c08df-48ed-4efe-ab03-68faaf03935c]
2016-08-17 19:45:55,394 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:45:55,396 WARNING celery.redirected 2016-08-17 19:45:55,395 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:45:55,397 WARNING celery.redirected 2016-08-17 19:45:55,397 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:45:55,397 WARNING celery.redirected 2016-08-17 19:45:55,397 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:45:55,402 WARNING celery.redirected 2016-08-17 19:45:55,402 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:45:55,403 WARNING celery.redirected 2016-08-17 19:45:55,403 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 44, 55, 394841)}
2016-08-17 19:45:55,405 WARNING celery.redirected 2016-08-17 19:45:55,405 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:45:55,407 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:45:55,417 INFO celery.worker.job Task schedule_clean_desktops[513c08df-48ed-4efe-ab03-68faaf03935c] succeeded in 0.023995581002964173s: None
2016-08-17 19:46:09,913 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:46:09,914 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:46:09,918 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:46:09,918 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:46:09,931 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:46:09,931 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:46:09,931 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:46:09,931 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:46:44,926 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:46:44,927 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:46:44,927 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:46:44,928 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:46:44,936 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:46:44,936 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:46:44,936 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:46:44,937 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:46:54,933 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:46:55,642 INFO celery.worker.strategy Received task: schedule_start_lesson[ac42b6c0-2ac9-4182-9189-53ffb32b1520]
2016-08-17 19:46:55,643 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:46:55,644 INFO celery Scheduling start lesson tasks
2016-08-17 19:46:55,645 WARNING celery.redirected 2016-08-17 19:46:55,645 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:46:55,646 WARNING celery.redirected 2016-08-17 19:46:55,646 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:46:55,647 WARNING celery.redirected 2016-08-17 19:46:55,647 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:46:55,651 WARNING celery.redirected 2016-08-17 19:46:55,651 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:46:55,652 WARNING celery.redirected 2016-08-17 19:46:55,652 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 46, 55, 648795), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 56, 55, 648795)}
2016-08-17 19:46:55,654 WARNING celery.redirected 2016-08-17 19:46:55,654 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:46:55,655 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:46:55,664 INFO celery.worker.job Task schedule_start_lesson[ac42b6c0-2ac9-4182-9189-53ffb32b1520] succeeded in 0.021176057001866866s: None
2016-08-17 19:46:59,953 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:47:00,596 INFO celery.worker.strategy Received task: schedule_clean_desktops[d88e8c6d-41f0-4a7f-9ff6-7654c6906a2b]
2016-08-17 19:47:00,598 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:47:00,600 WARNING celery.redirected 2016-08-17 19:47:00,600 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:47:00,601 WARNING celery.redirected 2016-08-17 19:47:00,601 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:47:00,601 WARNING celery.redirected 2016-08-17 19:47:00,601 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:47:00,606 WARNING celery.redirected 2016-08-17 19:47:00,605 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:47:00,606 WARNING celery.redirected 2016-08-17 19:47:00,606 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 46, 0, 599228)}
2016-08-17 19:47:00,608 WARNING celery.redirected 2016-08-17 19:47:00,608 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:47:00,609 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:47:00,617 INFO celery.worker.job Task schedule_clean_desktops[d88e8c6d-41f0-4a7f-9ff6-7654c6906a2b] succeeded in 0.019564308000553865s: None
2016-08-17 19:47:14,970 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:47:14,970 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:47:14,974 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:47:14,974 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:47:14,980 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:47:14,980 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:47:14,980 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:47:14,980 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:47:49,970 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:47:49,970 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:47:49,970 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:47:49,971 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:47:49,978 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:47:49,979 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:47:49,979 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:47:49,979 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:47:59,972 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:48:00,897 INFO celery.worker.strategy Received task: schedule_start_lesson[19a01211-335b-4961-b51d-820e3b05a084]
2016-08-17 19:48:00,899 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:48:00,900 INFO celery Scheduling start lesson tasks
2016-08-17 19:48:00,901 WARNING celery.redirected 2016-08-17 19:48:00,901 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:48:00,903 WARNING celery.redirected 2016-08-17 19:48:00,903 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:48:00,903 WARNING celery.redirected 2016-08-17 19:48:00,903 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:48:00,907 WARNING celery.redirected 2016-08-17 19:48:00,907 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:48:00,908 WARNING celery.redirected 2016-08-17 19:48:00,908 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 48, 0, 905290), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 58, 0, 905290)}
2016-08-17 19:48:00,910 WARNING celery.redirected 2016-08-17 19:48:00,910 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:48:00,911 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:48:00,919 INFO celery.worker.job Task schedule_start_lesson[19a01211-335b-4961-b51d-820e3b05a084] succeeded in 0.020550353001453914s: None
2016-08-17 19:48:04,997 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:48:05,847 INFO celery.worker.strategy Received task: schedule_clean_desktops[5ef09f44-66f6-4ae0-b9c3-32c347b670ae]
2016-08-17 19:48:05,848 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:48:05,851 WARNING celery.redirected 2016-08-17 19:48:05,851 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:48:05,852 WARNING celery.redirected 2016-08-17 19:48:05,852 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:48:05,853 WARNING celery.redirected 2016-08-17 19:48:05,853 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:48:05,858 WARNING celery.redirected 2016-08-17 19:48:05,858 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:48:05,859 WARNING celery.redirected 2016-08-17 19:48:05,859 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 47, 5, 849989)}
2016-08-17 19:48:05,866 WARNING celery.redirected 2016-08-17 19:48:05,865 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:48:05,867 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:48:05,876 INFO celery.worker.job Task schedule_clean_desktops[5ef09f44-66f6-4ae0-b9c3-32c347b670ae] succeeded in 0.028092819004086778s: None
2016-08-17 19:48:20,013 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:48:20,013 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:48:20,017 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:48:20,017 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:48:20,023 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:48:20,023 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:48:20,023 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:48:20,024 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:48:55,007 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:48:55,007 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:48:55,007 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:48:55,008 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:48:55,012 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:48:55,012 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:48:55,013 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:48:55,013 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:49:00,009 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:49:00,806 INFO celery.worker.strategy Received task: schedule_start_lesson[39092e8e-9c7d-4cdb-9928-966731966703]
2016-08-17 19:49:00,808 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:49:00,808 INFO celery Scheduling start lesson tasks
2016-08-17 19:49:00,810 WARNING celery.redirected 2016-08-17 19:49:00,809 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:49:00,811 WARNING celery.redirected 2016-08-17 19:49:00,810 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:49:00,811 WARNING celery.redirected 2016-08-17 19:49:00,811 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:49:00,816 WARNING celery.redirected 2016-08-17 19:49:00,815 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:49:00,816 WARNING celery.redirected 2016-08-17 19:49:00,816 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 49, 0, 813651), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(19, 59, 0, 813651)}
2016-08-17 19:49:00,818 WARNING celery.redirected 2016-08-17 19:49:00,818 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:49:00,819 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:49:00,829 INFO celery.worker.job Task schedule_start_lesson[39092e8e-9c7d-4cdb-9928-966731966703] succeeded in 0.021066238994535524s: None
2016-08-17 19:49:05,032 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:49:05,793 INFO celery.worker.strategy Received task: schedule_clean_desktops[da0ce2f0-7444-4535-8700-87cc971c47ee]
2016-08-17 19:49:05,795 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:49:05,797 WARNING celery.redirected 2016-08-17 19:49:05,797 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:49:05,799 WARNING celery.redirected 2016-08-17 19:49:05,799 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:49:05,800 WARNING celery.redirected 2016-08-17 19:49:05,800 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:49:05,805 WARNING celery.redirected 2016-08-17 19:49:05,805 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:49:05,805 WARNING celery.redirected 2016-08-17 19:49:05,805 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 48, 5, 796619)}
2016-08-17 19:49:05,807 WARNING celery.redirected 2016-08-17 19:49:05,807 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:49:05,809 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:49:05,821 INFO celery.worker.job Task schedule_clean_desktops[da0ce2f0-7444-4535-8700-87cc971c47ee] succeeded in 0.0252625600041938s: None
2016-08-17 19:49:25,049 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:49:25,049 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:49:25,052 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:49:25,053 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:49:25,059 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:49:25,059 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:49:25,060 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:49:25,060 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:50:00,049 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:50:00,050 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:50:00,050 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:50:00,050 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:50:00,052 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:50:00,115 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:50:00,116 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:50:00,118 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:50:00,119 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:50:00,122 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:50:00,122 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:50:00,122 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:50:00,122 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:50:01,187 INFO celery.worker.strategy Received task: schedule_start_lesson[9b78e048-3cca-4f0e-8a13-41e26d98eda5]
2016-08-17 19:50:01,188 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:50:01,189 INFO celery Scheduling start lesson tasks
2016-08-17 19:50:01,190 WARNING celery.redirected 2016-08-17 19:50:01,190 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:50:01,191 WARNING celery.redirected 2016-08-17 19:50:01,191 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:50:01,192 WARNING celery.redirected 2016-08-17 19:50:01,192 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:50:01,198 WARNING celery.redirected 2016-08-17 19:50:01,198 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:50:01,199 WARNING celery.redirected 2016-08-17 19:50:01,199 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 50, 1, 194481), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 0, 1, 194481)}
2016-08-17 19:50:01,202 WARNING celery.redirected 2016-08-17 19:50:01,202 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:50:01,203 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:50:01,211 INFO celery.worker.job Task schedule_start_lesson[9b78e048-3cca-4f0e-8a13-41e26d98eda5] succeeded in 0.022718140004144516s: None
2016-08-17 19:50:05,123 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:50:06,131 INFO celery.worker.strategy Received task: schedule_clean_desktops[dcd68ba4-504c-4fcb-96e7-2f96a4fee150]
2016-08-17 19:50:06,133 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:50:06,135 WARNING celery.redirected 2016-08-17 19:50:06,134 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:50:06,136 WARNING celery.redirected 2016-08-17 19:50:06,135 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:50:06,136 WARNING celery.redirected 2016-08-17 19:50:06,136 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:50:06,140 WARNING celery.redirected 2016-08-17 19:50:06,139 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:50:06,140 WARNING celery.redirected 2016-08-17 19:50:06,140 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 49, 6, 134358), 'desktop_state_2': 'DELETED'}
2016-08-17 19:50:06,143 WARNING celery.redirected 2016-08-17 19:50:06,143 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:50:06,145 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:50:06,159 INFO celery.worker.job Task schedule_clean_desktops[dcd68ba4-504c-4fcb-96e7-2f96a4fee150] succeeded in 0.025540541006193962s: None
2016-08-17 19:50:30,138 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:50:30,138 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:50:30,142 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:50:30,143 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:50:30,155 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:50:30,155 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:50:30,156 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:50:30,156 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:51:00,149 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:51:00,174 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:51:00,174 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:51:00,177 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:51:00,177 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:51:00,181 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:51:00,181 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:51:00,181 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:51:00,181 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:51:00,774 INFO celery.worker.strategy Received task: schedule_start_lesson[6a964400-98d6-42af-a52e-d380e5a5f30b]
2016-08-17 19:51:00,775 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:51:00,776 INFO celery Scheduling start lesson tasks
2016-08-17 19:51:00,777 WARNING celery.redirected 2016-08-17 19:51:00,777 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:51:00,778 WARNING celery.redirected 2016-08-17 19:51:00,778 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:51:00,778 WARNING celery.redirected 2016-08-17 19:51:00,778 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:51:00,782 WARNING celery.redirected 2016-08-17 19:51:00,782 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:51:00,783 WARNING celery.redirected 2016-08-17 19:51:00,783 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 51, 0, 779983), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 1, 0, 779983)}
2016-08-17 19:51:00,785 WARNING celery.redirected 2016-08-17 19:51:00,785 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:51:00,786 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:51:00,798 INFO celery.worker.job Task schedule_start_lesson[6a964400-98d6-42af-a52e-d380e5a5f30b] succeeded in 0.02308968700526748s: None
2016-08-17 19:51:05,178 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:51:05,760 INFO celery.worker.strategy Received task: schedule_clean_desktops[00a77467-ea6c-44a1-92e7-851a7f6bd2a9]
2016-08-17 19:51:05,761 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:51:05,762 WARNING celery.redirected 2016-08-17 19:51:05,762 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:51:05,764 WARNING celery.redirected 2016-08-17 19:51:05,763 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:51:05,764 WARNING celery.redirected 2016-08-17 19:51:05,764 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:51:05,770 WARNING celery.redirected 2016-08-17 19:51:05,769 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:51:05,771 WARNING celery.redirected 2016-08-17 19:51:05,770 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 50, 5, 762026)}
2016-08-17 19:51:05,775 WARNING celery.redirected 2016-08-17 19:51:05,775 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:51:05,776 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:51:05,784 INFO celery.worker.job Task schedule_clean_desktops[00a77467-ea6c-44a1-92e7-851a7f6bd2a9] succeeded in 0.0238216130019282s: None
2016-08-17 19:51:30,192 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:51:30,192 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:51:30,199 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:51:30,200 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:51:30,206 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:51:30,206 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:51:30,207 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:51:30,207 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:52:00,190 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:52:00,211 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:52:00,211 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:52:00,216 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:52:00,216 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:52:00,220 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:52:00,220 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:52:00,220 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:52:00,220 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:52:01,000 INFO celery.worker.strategy Received task: schedule_start_lesson[a2a154a4-ba7c-4c63-80af-7660f8dd879d]
2016-08-17 19:52:01,001 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:52:01,002 INFO celery Scheduling start lesson tasks
2016-08-17 19:52:01,003 WARNING celery.redirected 2016-08-17 19:52:01,003 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:52:01,005 WARNING celery.redirected 2016-08-17 19:52:01,005 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:52:01,006 WARNING celery.redirected 2016-08-17 19:52:01,005 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:52:01,011 WARNING celery.redirected 2016-08-17 19:52:01,010 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:52:01,011 WARNING celery.redirected 2016-08-17 19:52:01,011 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 52, 1, 7772), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 2, 1, 7772)}
2016-08-17 19:52:01,013 WARNING celery.redirected 2016-08-17 19:52:01,013 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:52:01,014 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:52:01,021 INFO celery.worker.job Task schedule_start_lesson[a2a154a4-ba7c-4c63-80af-7660f8dd879d] succeeded in 0.019454839995887596s: None
2016-08-17 19:52:05,218 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:52:05,865 INFO celery.worker.strategy Received task: schedule_clean_desktops[e6268589-fced-452e-9b21-376c87a1d6a4]
2016-08-17 19:52:05,867 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:52:05,868 WARNING celery.redirected 2016-08-17 19:52:05,868 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:52:05,869 WARNING celery.redirected 2016-08-17 19:52:05,869 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:52:05,870 WARNING celery.redirected 2016-08-17 19:52:05,870 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:52:05,874 WARNING celery.redirected 2016-08-17 19:52:05,873 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:52:05,874 WARNING celery.redirected 2016-08-17 19:52:05,874 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 51, 5, 868056)}
2016-08-17 19:52:05,876 WARNING celery.redirected 2016-08-17 19:52:05,876 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:52:05,877 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:52:05,884 INFO celery.worker.job Task schedule_clean_desktops[e6268589-fced-452e-9b21-376c87a1d6a4] succeeded in 0.017078807002690155s: None
2016-08-17 19:52:30,225 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:52:30,225 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:52:30,228 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:52:30,228 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:52:30,235 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:52:30,235 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:52:30,236 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:52:30,236 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:53:00,225 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:53:00,256 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:53:00,257 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:53:00,261 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:53:00,262 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:53:00,266 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:53:00,266 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:53:00,266 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:53:00,266 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:53:01,242 INFO celery.worker.strategy Received task: schedule_start_lesson[e5c55288-0a43-4cea-8e9b-9c1c01a1b172]
2016-08-17 19:53:01,244 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:53:01,245 INFO celery Scheduling start lesson tasks
2016-08-17 19:53:01,247 WARNING celery.redirected 2016-08-17 19:53:01,246 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:53:01,248 WARNING celery.redirected 2016-08-17 19:53:01,248 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:53:01,249 WARNING celery.redirected 2016-08-17 19:53:01,249 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:53:01,256 WARNING celery.redirected 2016-08-17 19:53:01,255 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:53:01,257 WARNING celery.redirected 2016-08-17 19:53:01,256 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 53, 1, 251969), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 3, 1, 251969)}
2016-08-17 19:53:01,263 WARNING celery.redirected 2016-08-17 19:53:01,262 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:53:01,264 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:53:01,274 INFO celery.worker.job Task schedule_start_lesson[e5c55288-0a43-4cea-8e9b-9c1c01a1b172] succeeded in 0.029916209998191334s: None
2016-08-17 19:53:05,264 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:53:06,286 INFO celery.worker.strategy Received task: schedule_clean_desktops[2972e9ed-8890-4874-9692-05f6d59aedac]
2016-08-17 19:53:06,288 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:53:06,290 WARNING celery.redirected 2016-08-17 19:53:06,290 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:53:06,291 WARNING celery.redirected 2016-08-17 19:53:06,291 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:53:06,292 WARNING celery.redirected 2016-08-17 19:53:06,292 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:53:06,298 WARNING celery.redirected 2016-08-17 19:53:06,297 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:53:06,299 WARNING celery.redirected 2016-08-17 19:53:06,298 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 52, 6, 289399)}
2016-08-17 19:53:06,302 WARNING celery.redirected 2016-08-17 19:53:06,302 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:53:06,306 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:53:06,318 INFO celery.worker.job Task schedule_clean_desktops[2972e9ed-8890-4874-9692-05f6d59aedac] succeeded in 0.030900550998921972s: None
2016-08-17 19:53:30,280 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:53:30,280 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:53:30,283 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:53:30,283 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:53:30,289 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:53:30,289 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:53:30,289 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:53:30,289 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:54:00,273 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:54:00,291 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:54:00,291 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:54:00,295 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:54:00,295 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:54:00,299 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:54:00,299 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:54:00,300 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:54:00,300 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:54:00,520 INFO celery.worker.strategy Received task: schedule_start_lesson[717855b2-cf21-4fea-b9e5-41663c2c9edc]
2016-08-17 19:54:00,521 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:54:00,522 INFO celery Scheduling start lesson tasks
2016-08-17 19:54:00,523 WARNING celery.redirected 2016-08-17 19:54:00,523 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:54:00,524 WARNING celery.redirected 2016-08-17 19:54:00,524 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:54:00,524 WARNING celery.redirected 2016-08-17 19:54:00,524 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:54:00,529 WARNING celery.redirected 2016-08-17 19:54:00,528 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:54:00,529 WARNING celery.redirected 2016-08-17 19:54:00,529 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 54, 0, 526442), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 4, 0, 526442)}
2016-08-17 19:54:00,531 WARNING celery.redirected 2016-08-17 19:54:00,531 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:54:00,532 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:54:00,540 INFO celery.worker.job Task schedule_start_lesson[717855b2-cf21-4fea-b9e5-41663c2c9edc] succeeded in 0.018390513003396336s: None
2016-08-17 19:54:05,296 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:54:05,320 INFO celery.worker.strategy Received task: schedule_clean_desktops[613c3886-d91c-4548-96f7-4abbeb56aa3a]
2016-08-17 19:54:05,322 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:54:05,324 WARNING celery.redirected 2016-08-17 19:54:05,324 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:54:05,326 WARNING celery.redirected 2016-08-17 19:54:05,326 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:54:05,327 WARNING celery.redirected 2016-08-17 19:54:05,327 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:54:05,332 WARNING celery.redirected 2016-08-17 19:54:05,331 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:54:05,332 WARNING celery.redirected 2016-08-17 19:54:05,332 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 53, 5, 323546)}
2016-08-17 19:54:05,334 WARNING celery.redirected 2016-08-17 19:54:05,334 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:54:05,335 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:54:05,343 INFO celery.worker.job Task schedule_clean_desktops[613c3886-d91c-4548-96f7-4abbeb56aa3a] succeeded in 0.021058937003544997s: None
2016-08-17 19:54:30,308 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:54:30,308 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:54:30,311 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:54:30,311 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:54:30,316 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:54:30,316 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:54:30,317 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:54:30,317 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:55:00,295 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:55:00,318 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:55:00,318 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:55:00,323 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:55:00,323 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:55:00,330 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:55:00,330 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:55:00,330 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:55:00,331 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:55:01,178 INFO celery.worker.strategy Received task: schedule_start_lesson[1265637c-64a2-4df8-b32f-aed1f3bd69fb]
2016-08-17 19:55:01,181 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:55:01,182 INFO celery Scheduling start lesson tasks
2016-08-17 19:55:01,183 WARNING celery.redirected 2016-08-17 19:55:01,183 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:55:01,184 WARNING celery.redirected 2016-08-17 19:55:01,184 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:55:01,184 WARNING celery.redirected 2016-08-17 19:55:01,184 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:55:01,190 WARNING celery.redirected 2016-08-17 19:55:01,190 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:55:01,191 WARNING celery.redirected 2016-08-17 19:55:01,191 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 55, 1, 187008), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 5, 1, 187008)}
2016-08-17 19:55:01,194 WARNING celery.redirected 2016-08-17 19:55:01,194 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:55:01,195 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:55:01,207 INFO celery.worker.job Task schedule_start_lesson[1265637c-64a2-4df8-b32f-aed1f3bd69fb] succeeded in 0.02620978999766521s: None
2016-08-17 19:55:05,326 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:55:06,142 INFO celery.worker.strategy Received task: schedule_clean_desktops[6efe5cc4-bdad-43e3-8672-f8e35570db70]
2016-08-17 19:55:06,144 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:55:06,146 WARNING celery.redirected 2016-08-17 19:55:06,146 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:55:06,148 WARNING celery.redirected 2016-08-17 19:55:06,147 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:55:06,148 WARNING celery.redirected 2016-08-17 19:55:06,148 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:55:06,154 WARNING celery.redirected 2016-08-17 19:55:06,153 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:55:06,154 WARNING celery.redirected 2016-08-17 19:55:06,154 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 54, 6, 145331)}
2016-08-17 19:55:06,158 WARNING celery.redirected 2016-08-17 19:55:06,158 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:55:06,162 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:55:06,172 INFO celery.worker.job Task schedule_clean_desktops[6efe5cc4-bdad-43e3-8672-f8e35570db70] succeeded in 0.02813195899943821s: None
2016-08-17 19:55:30,342 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:55:30,343 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:55:30,345 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:55:30,345 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:55:30,353 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:55:30,353 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:55:30,353 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:55:30,353 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:56:00,337 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:56:00,356 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:56:00,357 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:56:00,360 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:56:00,361 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:56:00,367 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:56:00,368 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:56:00,368 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:56:00,368 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:56:00,554 INFO celery.worker.strategy Received task: schedule_start_lesson[8f0c67e5-da2b-46d6-8872-6f19ffe94697]
2016-08-17 19:56:00,558 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:56:00,559 INFO celery Scheduling start lesson tasks
2016-08-17 19:56:00,560 WARNING celery.redirected 2016-08-17 19:56:00,560 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:56:00,565 WARNING celery.redirected 2016-08-17 19:56:00,564 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:56:00,566 WARNING celery.redirected 2016-08-17 19:56:00,565 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:56:00,570 WARNING celery.redirected 2016-08-17 19:56:00,570 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:56:00,571 WARNING celery.redirected 2016-08-17 19:56:00,571 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 56, 0, 567941), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 6, 0, 567941)}
2016-08-17 19:56:00,573 WARNING celery.redirected 2016-08-17 19:56:00,573 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:56:00,575 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:56:00,587 INFO celery.worker.job Task schedule_start_lesson[8f0c67e5-da2b-46d6-8872-6f19ffe94697] succeeded in 0.029282457995577715s: None
2016-08-17 19:56:05,367 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:56:05,561 INFO celery.worker.strategy Received task: schedule_clean_desktops[b73df734-6faa-4947-8df3-8aa2aac8cd01]
2016-08-17 19:56:05,565 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:56:05,568 WARNING celery.redirected 2016-08-17 19:56:05,568 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:56:05,569 WARNING celery.redirected 2016-08-17 19:56:05,569 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:56:05,570 WARNING celery.redirected 2016-08-17 19:56:05,570 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:56:05,574 WARNING celery.redirected 2016-08-17 19:56:05,574 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:56:05,574 WARNING celery.redirected 2016-08-17 19:56:05,574 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 55, 5, 567811)}
2016-08-17 19:56:05,576 WARNING celery.redirected 2016-08-17 19:56:05,576 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:56:05,578 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:56:05,585 INFO celery.worker.job Task schedule_clean_desktops[b73df734-6faa-4947-8df3-8aa2aac8cd01] succeeded in 0.02029473400034476s: None
2016-08-17 19:56:30,376 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:56:30,376 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:56:30,378 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:56:30,379 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:56:30,384 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:56:30,384 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:56:30,384 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:56:30,385 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:57:00,368 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:57:00,424 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:57:00,424 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:57:00,426 INFO celery.worker.strategy Received task: schedule_start_lesson[57623590-c6af-4835-844c-2f790cea4e0f]
2016-08-17 19:57:00,427 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:57:00,428 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:57:00,428 INFO celery Scheduling start lesson tasks
2016-08-17 19:57:00,428 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:57:00,429 WARNING celery.redirected 2016-08-17 19:57:00,429 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:57:00,430 WARNING celery.redirected 2016-08-17 19:57:00,430 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:57:00,431 WARNING celery.redirected 2016-08-17 19:57:00,431 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:57:00,432 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:57:00,432 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:57:00,433 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:57:00,433 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:57:00,436 WARNING celery.redirected 2016-08-17 19:57:00,436 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:57:00,437 WARNING celery.redirected 2016-08-17 19:57:00,437 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 57, 0, 433326), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 7, 0, 433326)}
2016-08-17 19:57:00,440 WARNING celery.redirected 2016-08-17 19:57:00,439 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:57:00,441 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:57:00,450 INFO celery.worker.job Task schedule_start_lesson[57623590-c6af-4835-844c-2f790cea4e0f] succeeded in 0.02308302700112108s: None
2016-08-17 19:57:05,430 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:57:06,504 INFO celery.worker.strategy Received task: schedule_clean_desktops[caca2382-4546-48b5-a9cf-699fd8b459ef]
2016-08-17 19:57:06,505 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:57:06,507 WARNING celery.redirected 2016-08-17 19:57:06,507 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:57:06,508 WARNING celery.redirected 2016-08-17 19:57:06,508 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:57:06,509 WARNING celery.redirected 2016-08-17 19:57:06,509 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:57:06,512 WARNING celery.redirected 2016-08-17 19:57:06,512 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:57:06,513 WARNING celery.redirected 2016-08-17 19:57:06,513 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 56, 6, 506879)}
2016-08-17 19:57:06,515 WARNING celery.redirected 2016-08-17 19:57:06,515 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:57:06,517 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:57:06,525 INFO celery.worker.job Task schedule_clean_desktops[caca2382-4546-48b5-a9cf-699fd8b459ef] succeeded in 0.019904692999261897s: None
2016-08-17 19:57:30,441 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:57:30,441 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:57:30,444 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:57:30,444 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:57:30,449 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:57:30,449 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:57:30,450 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:57:30,450 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:58:00,431 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:58:00,457 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:58:00,457 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:58:00,461 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:58:00,462 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:58:01,320 INFO celery.worker.strategy Received task: schedule_start_lesson[40fcd6cc-169d-43c5-94bb-84c038da0420]
2016-08-17 19:58:01,322 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:58:01,323 INFO celery Scheduling start lesson tasks
2016-08-17 19:58:01,324 WARNING celery.redirected 2016-08-17 19:58:01,324 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:58:01,325 WARNING celery.redirected 2016-08-17 19:58:01,325 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:58:01,326 WARNING celery.redirected 2016-08-17 19:58:01,326 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:58:01,331 WARNING celery.redirected 2016-08-17 19:58:01,331 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:58:01,332 WARNING celery.redirected 2016-08-17 19:58:01,332 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 58, 1, 327634), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 8, 1, 327634)}
2016-08-17 19:58:01,335 WARNING celery.redirected 2016-08-17 19:58:01,334 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:58:01,336 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:58:01,344 INFO celery.worker.job Task schedule_start_lesson[40fcd6cc-169d-43c5-94bb-84c038da0420] succeeded in 0.021783773001516238s: None
2016-08-17 19:58:05,460 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:58:06,124 INFO celery.worker.strategy Received task: schedule_clean_desktops[faf43e1c-ae19-4492-9c7c-b9736ab9b53f]
2016-08-17 19:58:06,126 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:58:06,128 WARNING celery.redirected 2016-08-17 19:58:06,127 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:58:06,128 WARNING celery.redirected 2016-08-17 19:58:06,128 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:58:06,129 WARNING celery.redirected 2016-08-17 19:58:06,129 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:58:06,132 WARNING celery.redirected 2016-08-17 19:58:06,132 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:58:06,133 WARNING celery.redirected 2016-08-17 19:58:06,133 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 57, 6, 127307), 'desktop_state_2': 'DELETED'}
2016-08-17 19:58:06,136 WARNING celery.redirected 2016-08-17 19:58:06,135 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:58:06,137 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:58:06,143 INFO celery.worker.job Task schedule_clean_desktops[faf43e1c-ae19-4492-9c7c-b9736ab9b53f] succeeded in 0.017311206000158563s: None
2016-08-17 19:58:30,466 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:58:30,467 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:58:30,470 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:58:30,470 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:58:30,475 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:58:30,475 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:58:30,476 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:58:30,476 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:59:00,457 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 19:59:00,480 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:59:00,480 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:59:00,482 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:59:00,483 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:59:00,848 INFO celery.worker.strategy Received task: schedule_start_lesson[7c1fd6da-cfdb-424d-8393-90b3dace134b]
2016-08-17 19:59:00,849 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:59:00,850 INFO celery Scheduling start lesson tasks
2016-08-17 19:59:00,851 WARNING celery.redirected 2016-08-17 19:59:00,851 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:59:00,852 WARNING celery.redirected 2016-08-17 19:59:00,852 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:59:00,852 WARNING celery.redirected 2016-08-17 19:59:00,852 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 19:59:00,857 WARNING celery.redirected 2016-08-17 19:59:00,857 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 19:59:00,857 WARNING celery.redirected 2016-08-17 19:59:00,857 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(19, 59, 0, 854408), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 9, 0, 854408)}
2016-08-17 19:59:00,859 WARNING celery.redirected 2016-08-17 19:59:00,859 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:59:00,860 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:59:00,867 INFO celery.worker.job Task schedule_start_lesson[7c1fd6da-cfdb-424d-8393-90b3dace134b] succeeded in 0.01819849299499765s: None
2016-08-17 19:59:05,480 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 19:59:05,658 INFO celery.worker.strategy Received task: schedule_clean_desktops[de178e32-3d4a-4d1a-a2ee-4b5f19028342]
2016-08-17 19:59:05,659 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 19:59:05,660 WARNING celery.redirected 2016-08-17 19:59:05,660 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 19:59:05,662 WARNING celery.redirected 2016-08-17 19:59:05,661 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 19:59:05,662 WARNING celery.redirected 2016-08-17 19:59:05,662 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 19:59:05,665 WARNING celery.redirected 2016-08-17 19:59:05,665 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 19:59:05,666 WARNING celery.redirected 2016-08-17 19:59:05,666 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 58, 5, 660149)}
2016-08-17 19:59:05,668 WARNING celery.redirected 2016-08-17 19:59:05,668 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 19:59:05,669 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 19:59:05,675 INFO celery.worker.job Task schedule_clean_desktops[de178e32-3d4a-4d1a-a2ee-4b5f19028342] succeeded in 0.016686145994754042s: None
2016-08-17 19:59:30,485 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:59:30,485 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:59:30,487 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:59:30,488 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 19:59:30,493 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 19:59:30,493 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 19:59:30,493 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 19:59:30,493 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:00:00,476 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:00:00,501 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:00:00,501 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:00:00,503 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:00:00,504 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:00:00,507 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:00:00,508 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:00:00,508 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:00:00,508 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:00:01,500 INFO celery.worker.strategy Received task: schedule_start_lesson[f9ed009e-3745-42f8-bea5-83686a9e0a9a]
2016-08-17 20:00:01,501 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:00:01,502 INFO celery Scheduling start lesson tasks
2016-08-17 20:00:01,503 WARNING celery.redirected 2016-08-17 20:00:01,503 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:00:01,504 WARNING celery.redirected 2016-08-17 20:00:01,504 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:00:01,504 WARNING celery.redirected 2016-08-17 20:00:01,504 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:00:01,508 WARNING celery.redirected 2016-08-17 20:00:01,508 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:00:01,508 WARNING celery.redirected 2016-08-17 20:00:01,508 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 0, 1, 506011), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 10, 1, 506011)}
2016-08-17 20:00:01,511 WARNING celery.redirected 2016-08-17 20:00:01,511 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:00:01,512 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:00:01,523 INFO celery.worker.job Task schedule_start_lesson[f9ed009e-3745-42f8-bea5-83686a9e0a9a] succeeded in 0.02166689700243296s: None
2016-08-17 20:00:05,504 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:00:06,294 INFO celery.worker.strategy Received task: schedule_clean_desktops[d311dc17-edf1-4212-aeb9-3617159b01d4]
2016-08-17 20:00:06,296 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:00:06,297 WARNING celery.redirected 2016-08-17 20:00:06,297 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:00:06,298 WARNING celery.redirected 2016-08-17 20:00:06,298 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:00:06,299 WARNING celery.redirected 2016-08-17 20:00:06,298 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:00:06,302 WARNING celery.redirected 2016-08-17 20:00:06,302 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:00:06,302 WARNING celery.redirected 2016-08-17 20:00:06,302 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 19, 59, 6, 296888)}
2016-08-17 20:00:06,304 WARNING celery.redirected 2016-08-17 20:00:06,304 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:00:06,306 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:00:06,312 INFO celery.worker.job Task schedule_clean_desktops[d311dc17-edf1-4212-aeb9-3617159b01d4] succeeded in 0.016331958999217022s: None
2016-08-17 20:00:30,514 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:00:30,515 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:00:30,517 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:00:30,517 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:00:30,522 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:00:30,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:00:30,523 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:00:30,523 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:01:00,505 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:01:00,524 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:01:00,524 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:01:00,526 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:01:00,527 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:01:00,530 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:01:00,530 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:01:00,531 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:01:00,531 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:01:01,076 INFO celery.worker.strategy Received task: schedule_start_lesson[2765af49-63dd-40d1-99d9-432cd5101e6e]
2016-08-17 20:01:01,077 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:01:01,078 INFO celery Scheduling start lesson tasks
2016-08-17 20:01:01,079 WARNING celery.redirected 2016-08-17 20:01:01,079 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:01:01,080 WARNING celery.redirected 2016-08-17 20:01:01,080 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:01,081 WARNING celery.redirected 2016-08-17 20:01:01,081 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:01:01,084 WARNING celery.redirected 2016-08-17 20:01:01,084 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:01:01,085 WARNING celery.redirected 2016-08-17 20:01:01,085 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 1, 1, 82666), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 11, 1, 82666)}
2016-08-17 20:01:01,087 WARNING celery.redirected 2016-08-17 20:01:01,087 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:01:01,088 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:01:01,096 INFO celery.worker.job Task schedule_start_lesson[2765af49-63dd-40d1-99d9-432cd5101e6e] succeeded in 0.018209751993708778s: None
2016-08-17 20:01:10,525 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:01:10,730 INFO celery.worker.strategy Received task: schedule_clean_desktops[7abc9f79-c76b-4938-9fda-f7f0d1d56e65]
2016-08-17 20:01:10,733 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:01:10,736 WARNING celery.redirected 2016-08-17 20:01:10,736 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:01:10,738 WARNING celery.redirected 2016-08-17 20:01:10,738 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:10,739 WARNING celery.redirected 2016-08-17 20:01:10,739 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:01:10,744 WARNING celery.redirected 2016-08-17 20:01:10,743 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:01:10,744 WARNING celery.redirected 2016-08-17 20:01:10,744 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 0, 10, 734936)}
2016-08-17 20:01:10,751 WARNING celery.redirected 2016-08-17 20:01:10,751 INFO sqlalchemy.engine.base.Engine UPDATE desktops SET updated_at=%(updated_at)s, desktop_state=%(desktop_state)s WHERE desktops.id = %(desktops_id)s
2016-08-17 20:01:10,752 WARNING celery.redirected 2016-08-17 20:01:10,752 INFO sqlalchemy.engine.base.Engine {'updated_at': datetime.datetime(2016, 8, 17, 20, 1, 10, 751116), 'desktops_id': 2, 'desktop_state': 'DELETING'}
2016-08-17 20:01:10,756 WARNING celery.redirected 2016-08-17 20:01:10,756 INFO sqlalchemy.engine.base.Engine INSERT INTO desktop_tasks (created_at, updated_at, action, state, result, stage, stage_chain, retries, enabled, context) VALUES (%(created_at)s, %(updated_at)s, %(action)s, %(state)s, %(result)s, %(stage)s, %(stage_chain)s, %(retries)s, %(enabled)s, %(context)s)
2016-08-17 20:01:10,757 WARNING celery.redirected 2016-08-17 20:01:10,756 INFO sqlalchemy.engine.base.Engine {'retries': 0, 'action': 'DELETE', 'enabled': 1, 'stage': 'DELETE', 'context': '{"desktop": 2, "course": 2, "vm": "6639577f-360f-4e52-b68d-8ed67dab83a9"}', 'state': 'PENDING', 'result': '', 'updated_at': datetime.datetime(2016, 8, 17, 20, 1, 10, 755694), 'stage_chain': '["DELETE"]', 'created_at': datetime.datetime(2016, 8, 17, 20, 1, 10, 755577)}
2016-08-17 20:01:10,760 WARNING celery.redirected 2016-08-17 20:01:10,760 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:01:10,764 WARNING celery.redirected 2016-08-17 20:01:10,763 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:01:10,766 WARNING celery.redirected 2016-08-17 20:01:10,765 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 20:01:10,767 WARNING celery.redirected 2016-08-17 20:01:10,766 INFO sqlalchemy.engine.base.Engine {'param_1': 12}
2016-08-17 20:01:10,771 WARNING celery.redirected 2016-08-17 20:01:10,771 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:10,772 WARNING celery.redirected 2016-08-17 20:01:10,772 INFO sqlalchemy.engine.base.Engine {'id_1': 12, 'param_1': 1}
2016-08-17 20:01:10,977 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:01:10,977 WARNING celery.redirected 2016-08-17 20:01:10,977 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:01:10,986 INFO celery.worker.job Task schedule_clean_desktops[7abc9f79-c76b-4938-9fda-f7f0d1d56e65] succeeded in 0.2535024200042244s: None
2016-08-17 20:01:12,037 INFO celery.worker.strategy Received task: delete_desktop[d34c2eae-26a7-45ef-85ee-bc09b86a4f91] eta:[2016-08-17 12:01:11.794243+00:00]
2016-08-17 20:01:12,039 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:01:12,042 WARNING celery.redirected 2016-08-17 20:01:12,041 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:01:12,043 WARNING celery.redirected 2016-08-17 20:01:12,043 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:12,043 WARNING celery.redirected 2016-08-17 20:01:12,043 INFO sqlalchemy.engine.base.Engine {'id_1': 12, 'param_1': 1}
2016-08-17 20:01:12,046 WARNING celery.redirected 2016-08-17 20:01:12,046 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 20:01:12,046 WARNING celery.redirected 2016-08-17 20:01:12,046 INFO sqlalchemy.engine.base.Engine {'param_1': 12}
2016-08-17 20:01:12,051 WARNING celery.redirected 2016-08-17 20:01:12,051 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:12,052 WARNING celery.redirected 2016-08-17 20:01:12,052 INFO sqlalchemy.engine.base.Engine {'id_1': 2, 'param_1': 1}
2016-08-17 20:01:12,055 INFO celery Delete desktop for <DesktopTask 12>
2016-08-17 20:01:12,913 WARNING celery.redirected 2016-08-17 20:01:12,912 INFO sqlalchemy.engine.base.Engine DELETE FROM desktops WHERE desktops.id = %(id_1)s
2016-08-17 20:01:12,913 WARNING celery.redirected 2016-08-17 20:01:12,913 INFO sqlalchemy.engine.base.Engine {'id_1': 2}
2016-08-17 20:01:12,916 WARNING celery.redirected 2016-08-17 20:01:12,916 INFO sqlalchemy.engine.base.Engine UPDATE desktop_tasks SET updated_at=%(updated_at)s, state=%(state)s, result=%(result)s WHERE desktop_tasks.id = %(desktop_tasks_id)s
2016-08-17 20:01:12,917 WARNING celery.redirected 2016-08-17 20:01:12,917 INFO sqlalchemy.engine.base.Engine {'state': 'FINISHED', 'result': 'SUCCESS', 'updated_at': datetime.datetime(2016, 8, 17, 20, 1, 12, 916155), 'desktop_tasks_id': 12}
2016-08-17 20:01:12,918 WARNING celery.redirected 2016-08-17 20:01:12,918 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:01:12,920 WARNING celery.redirected 2016-08-17 20:01:12,920 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:01:12,921 WARNING celery.redirected 2016-08-17 20:01:12,921 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 20:01:12,921 WARNING celery.redirected 2016-08-17 20:01:12,921 INFO sqlalchemy.engine.base.Engine {'param_1': 12}
2016-08-17 20:01:12,923 INFO celery Delete desktop for <DesktopTask 12>, success
2016-08-17 20:01:12,923 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:01:12,924 WARNING celery.redirected 2016-08-17 20:01:12,924 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:01:12,938 INFO celery.worker.job Task delete_desktop[d34c2eae-26a7-45ef-85ee-bc09b86a4f91] succeeded in 0.8990805149951484s: None
2016-08-17 20:01:13,253 INFO celery.worker.strategy Received task: set_desktop_state[db111190-ffc1-4e2f-b8cb-a7b275b91021]
2016-08-17 20:01:13,254 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:01:13,256 WARNING celery.redirected 2016-08-17 20:01:13,256 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:01:13,257 WARNING celery.redirected 2016-08-17 20:01:13,257 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:13,258 WARNING celery.redirected 2016-08-17 20:01:13,258 INFO sqlalchemy.engine.base.Engine {'id_1': 12, 'param_1': 1}
2016-08-17 20:01:13,261 WARNING celery.redirected 2016-08-17 20:01:13,261 INFO sqlalchemy.engine.base.Engine SELECT desktop_tasks.id AS desktop_tasks_id, desktop_tasks.created_at AS desktop_tasks_created_at, desktop_tasks.updated_at AS desktop_tasks_updated_at, desktop_tasks.action AS desktop_tasks_action, desktop_tasks.state AS desktop_tasks_state, desktop_tasks.result AS desktop_tasks_result, desktop_tasks.stage AS desktop_tasks_stage, desktop_tasks.stage_chain AS desktop_tasks_stage_chain, desktop_tasks.retries AS desktop_tasks_retries, desktop_tasks.enabled AS desktop_tasks_enabled, desktop_tasks.context AS desktop_tasks_context 
FROM desktop_tasks 
WHERE desktop_tasks.id = %(param_1)s
2016-08-17 20:01:13,262 WARNING celery.redirected 2016-08-17 20:01:13,262 INFO sqlalchemy.engine.base.Engine {'param_1': 12}
2016-08-17 20:01:13,265 WARNING celery.redirected 2016-08-17 20:01:13,265 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.id = %(id_1)s 
 LIMIT %(param_1)s
2016-08-17 20:01:13,265 WARNING celery.redirected 2016-08-17 20:01:13,265 INFO sqlalchemy.engine.base.Engine {'id_1': 2, 'param_1': 1}
2016-08-17 20:01:13,267 WARNING celery Could not set desktop state for <DesktopTask 12>, desktop not exists
2016-08-17 20:01:13,267 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:01:13,268 WARNING celery.redirected 2016-08-17 20:01:13,267 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:01:13,275 INFO celery.worker.job Task set_desktop_state[db111190-ffc1-4e2f-b8cb-a7b275b91021] succeeded in 0.020968745004211087s: None
2016-08-17 20:01:30,549 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:01:30,549 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:01:30,551 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:01:30,552 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:01:30,557 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:01:30,557 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:01:30,557 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:01:30,557 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:02:00,571 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:02:00,572 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:02:00,572 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:02:00,572 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:02:00,578 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:02:00,578 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:02:00,579 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:02:00,579 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:02:05,581 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:02:05,793 INFO celery.worker.strategy Received task: schedule_start_lesson[d431570c-a713-4392-8caf-cc568f152f1e]
2016-08-17 20:02:05,795 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:02:05,796 INFO celery Scheduling start lesson tasks
2016-08-17 20:02:05,797 WARNING celery.redirected 2016-08-17 20:02:05,796 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:02:05,798 WARNING celery.redirected 2016-08-17 20:02:05,797 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:02:05,798 WARNING celery.redirected 2016-08-17 20:02:05,798 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:02:05,802 WARNING celery.redirected 2016-08-17 20:02:05,801 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:02:05,802 WARNING celery.redirected 2016-08-17 20:02:05,802 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 2, 5, 799928), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 12, 5, 799928)}
2016-08-17 20:02:05,804 WARNING celery.redirected 2016-08-17 20:02:05,804 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:02:05,805 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:02:05,812 INFO celery.worker.job Task schedule_start_lesson[d431570c-a713-4392-8caf-cc568f152f1e] succeeded in 0.01776086100289831s: None
2016-08-17 20:02:15,599 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:02:16,797 INFO celery.worker.strategy Received task: schedule_clean_desktops[9ecf8226-3c6a-45e1-83b2-4a54dfe97948]
2016-08-17 20:02:16,798 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:02:16,800 WARNING celery.redirected 2016-08-17 20:02:16,800 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:02:16,801 WARNING celery.redirected 2016-08-17 20:02:16,801 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:02:16,801 WARNING celery.redirected 2016-08-17 20:02:16,801 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:02:16,804 WARNING celery.redirected 2016-08-17 20:02:16,804 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:02:16,805 WARNING celery.redirected 2016-08-17 20:02:16,805 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 1, 16, 799361), 'desktop_state_2': 'DELETED'}
2016-08-17 20:02:16,807 WARNING celery.redirected 2016-08-17 20:02:16,807 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:02:16,808 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:02:16,815 INFO celery.worker.job Task schedule_clean_desktops[9ecf8226-3c6a-45e1-83b2-4a54dfe97948] succeeded in 0.01724419600213878s: None
2016-08-17 20:02:30,760 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:02:30,761 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:02:30,764 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:02:30,764 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:02:30,769 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:02:30,769 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:02:30,769 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:02:30,770 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:03:00,784 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:03:00,784 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:03:00,785 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:03:00,785 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:03:00,793 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:03:00,793 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:03:00,793 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:03:00,793 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:03:10,795 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:03:11,774 INFO celery.worker.strategy Received task: schedule_start_lesson[4fef43ae-ccf6-4461-87bc-395ed285d392]
2016-08-17 20:03:11,776 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:03:11,776 INFO celery Scheduling start lesson tasks
2016-08-17 20:03:11,777 WARNING celery.redirected 2016-08-17 20:03:11,777 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:03:11,779 WARNING celery.redirected 2016-08-17 20:03:11,778 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:03:11,779 WARNING celery.redirected 2016-08-17 20:03:11,779 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:03:11,783 WARNING celery.redirected 2016-08-17 20:03:11,783 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:03:11,784 WARNING celery.redirected 2016-08-17 20:03:11,783 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 3, 11, 781233), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 13, 11, 781233)}
2016-08-17 20:03:11,786 WARNING celery.redirected 2016-08-17 20:03:11,786 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:03:11,788 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:03:11,796 INFO celery.worker.job Task schedule_start_lesson[4fef43ae-ccf6-4461-87bc-395ed285d392] succeeded in 0.02005069300503237s: None
2016-08-17 20:03:20,816 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:03:21,486 INFO celery.worker.strategy Received task: schedule_clean_desktops[c5347b2f-510b-435f-9364-e39aea2c0c68]
2016-08-17 20:03:21,487 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:03:21,490 WARNING celery.redirected 2016-08-17 20:03:21,489 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:03:21,491 WARNING celery.redirected 2016-08-17 20:03:21,491 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:03:21,492 WARNING celery.redirected 2016-08-17 20:03:21,492 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:03:21,496 WARNING celery.redirected 2016-08-17 20:03:21,496 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:03:21,497 WARNING celery.redirected 2016-08-17 20:03:21,497 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 2, 21, 488871)}
2016-08-17 20:03:21,500 WARNING celery.redirected 2016-08-17 20:03:21,500 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:03:21,501 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:03:21,512 INFO celery.worker.job Task schedule_clean_desktops[c5347b2f-510b-435f-9364-e39aea2c0c68] succeeded in 0.024656574001710396s: None
2016-08-17 20:03:30,834 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:03:30,834 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:03:30,838 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:03:30,838 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:03:30,843 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:03:30,843 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:03:30,843 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:03:30,844 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:04:00,849 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:04:00,850 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:04:00,850 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:04:00,850 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:04:00,855 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:04:00,855 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:04:00,856 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:04:00,856 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:04:15,852 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:04:16,425 INFO celery.worker.strategy Received task: schedule_start_lesson[fb42972b-1933-4a3d-8c07-75f796346b92]
2016-08-17 20:04:16,426 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:04:16,427 INFO celery Scheduling start lesson tasks
2016-08-17 20:04:16,428 WARNING celery.redirected 2016-08-17 20:04:16,427 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:04:16,429 WARNING celery.redirected 2016-08-17 20:04:16,428 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:04:16,429 WARNING celery.redirected 2016-08-17 20:04:16,429 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:04:16,433 WARNING celery.redirected 2016-08-17 20:04:16,433 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:04:16,433 WARNING celery.redirected 2016-08-17 20:04:16,433 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 4, 16, 431085), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 14, 16, 431085)}
2016-08-17 20:04:16,436 WARNING celery.redirected 2016-08-17 20:04:16,436 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:04:16,437 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:04:16,445 INFO celery.worker.job Task schedule_start_lesson[fb42972b-1933-4a3d-8c07-75f796346b92] succeeded in 0.019171970001480076s: None
2016-08-17 20:04:25,874 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:04:26,156 INFO celery.worker.strategy Received task: schedule_clean_desktops[7d0a6664-ecda-4b08-8309-41bf5a179c99]
2016-08-17 20:04:26,158 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:04:26,161 WARNING celery.redirected 2016-08-17 20:04:26,160 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:04:26,163 WARNING celery.redirected 2016-08-17 20:04:26,162 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:04:26,163 WARNING celery.redirected 2016-08-17 20:04:26,163 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:04:26,170 WARNING celery.redirected 2016-08-17 20:04:26,169 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:04:26,171 WARNING celery.redirected 2016-08-17 20:04:26,170 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 3, 26, 159663)}
2016-08-17 20:04:26,174 WARNING celery.redirected 2016-08-17 20:04:26,174 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:04:26,175 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:04:26,185 INFO celery.worker.job Task schedule_clean_desktops[7d0a6664-ecda-4b08-8309-41bf5a179c99] succeeded in 0.027080438994744327s: None
2016-08-17 20:04:30,891 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:04:30,891 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:04:30,894 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:04:30,894 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:04:30,899 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:04:30,899 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:04:30,899 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:04:30,899 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:05:00,902 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:05:00,902 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:05:00,903 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:05:00,903 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:05:00,908 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:05:00,908 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:05:00,908 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:05:00,908 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:05:20,906 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:05:21,076 INFO celery.worker.strategy Received task: schedule_start_lesson[b5d228bf-54b6-47a4-a8bb-c1a54ca73006]
2016-08-17 20:05:21,077 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:05:21,078 INFO celery Scheduling start lesson tasks
2016-08-17 20:05:21,079 WARNING celery.redirected 2016-08-17 20:05:21,079 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:05:21,080 WARNING celery.redirected 2016-08-17 20:05:21,080 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:05:21,080 WARNING celery.redirected 2016-08-17 20:05:21,080 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:05:21,084 WARNING celery.redirected 2016-08-17 20:05:21,084 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:05:21,085 WARNING celery.redirected 2016-08-17 20:05:21,085 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 5, 21, 82085), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 15, 21, 82085)}
2016-08-17 20:05:21,087 WARNING celery.redirected 2016-08-17 20:05:21,087 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:05:21,088 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:05:21,095 INFO celery.worker.job Task schedule_start_lesson[b5d228bf-54b6-47a4-a8bb-c1a54ca73006] succeeded in 0.017380835000949446s: None
2016-08-17 20:05:30,927 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:05:30,928 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:05:30,931 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:05:30,931 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:05:30,934 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:05:31,000 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:05:31,000 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:05:31,002 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:05:31,003 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:05:31,006 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:05:31,007 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:05:31,007 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:05:31,007 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:05:32,063 INFO celery.worker.strategy Received task: schedule_clean_desktops[148f9f5e-b24e-4e5a-8f32-ebf5541672db]
2016-08-17 20:05:32,064 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:05:32,066 WARNING celery.redirected 2016-08-17 20:05:32,066 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:05:32,067 WARNING celery.redirected 2016-08-17 20:05:32,067 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:05:32,067 WARNING celery.redirected 2016-08-17 20:05:32,067 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:05:32,071 WARNING celery.redirected 2016-08-17 20:05:32,071 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:05:32,071 WARNING celery.redirected 2016-08-17 20:05:32,071 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 4, 32, 65583)}
2016-08-17 20:05:32,074 WARNING celery.redirected 2016-08-17 20:05:32,074 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:05:32,075 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:05:32,084 INFO celery.worker.job Task schedule_clean_desktops[148f9f5e-b24e-4e5a-8f32-ebf5541672db] succeeded in 0.01981264099595137s: None
2016-08-17 20:06:01,008 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:06:01,008 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:06:01,009 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:06:01,010 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:06:21,016 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:06:22,068 INFO celery.worker.strategy Received task: schedule_start_lesson[8e908177-f342-4cf4-9748-9f2ff34938d8]
2016-08-17 20:06:22,069 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:06:22,070 INFO celery Scheduling start lesson tasks
2016-08-17 20:06:22,071 WARNING celery.redirected 2016-08-17 20:06:22,071 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:06:22,072 WARNING celery.redirected 2016-08-17 20:06:22,072 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:06:22,072 WARNING celery.redirected 2016-08-17 20:06:22,072 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:06:22,077 WARNING celery.redirected 2016-08-17 20:06:22,076 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:06:22,077 WARNING celery.redirected 2016-08-17 20:06:22,077 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 6, 22, 74148), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 16, 22, 74148)}
2016-08-17 20:06:22,080 WARNING celery.redirected 2016-08-17 20:06:22,080 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:06:22,081 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:06:22,088 INFO celery.worker.job Task schedule_start_lesson[8e908177-f342-4cf4-9748-9f2ff34938d8] succeeded in 0.018913129999418743s: None
2016-08-17 20:06:31,043 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:06:31,043 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:06:31,045 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:06:31,046 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:06:31,048 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:06:31,065 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:06:31,065 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:06:31,067 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:06:31,067 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:06:31,070 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:06:31,070 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:06:31,071 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:06:31,071 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:06:31,765 INFO celery.worker.strategy Received task: schedule_clean_desktops[98bf397c-1f2c-42da-81be-9cba074457d9]
2016-08-17 20:06:31,767 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:06:31,770 WARNING celery.redirected 2016-08-17 20:06:31,769 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:06:31,771 WARNING celery.redirected 2016-08-17 20:06:31,771 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:06:31,772 WARNING celery.redirected 2016-08-17 20:06:31,772 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:06:31,777 WARNING celery.redirected 2016-08-17 20:06:31,777 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:06:31,778 WARNING celery.redirected 2016-08-17 20:06:31,778 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 5, 31, 768734)}
2016-08-17 20:06:31,781 WARNING celery.redirected 2016-08-17 20:06:31,781 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:06:31,783 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:06:31,794 INFO celery.worker.job Task schedule_clean_desktops[98bf397c-1f2c-42da-81be-9cba074457d9] succeeded in 0.02693508900119923s: None
2016-08-17 20:07:06,066 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:07:06,066 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:07:06,067 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:07:06,067 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:07:06,072 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:07:06,072 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:07:06,072 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:07:06,072 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:07:21,071 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:07:21,858 INFO celery.worker.strategy Received task: schedule_start_lesson[7bef0c9c-3c2a-4d37-9aa8-494358e2fdf0]
2016-08-17 20:07:21,859 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:07:21,859 INFO celery Scheduling start lesson tasks
2016-08-17 20:07:21,860 WARNING celery.redirected 2016-08-17 20:07:21,860 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:07:21,861 WARNING celery.redirected 2016-08-17 20:07:21,861 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:07:21,862 WARNING celery.redirected 2016-08-17 20:07:21,862 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:07:21,866 WARNING celery.redirected 2016-08-17 20:07:21,865 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:07:21,866 WARNING celery.redirected 2016-08-17 20:07:21,866 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 7, 21, 863630), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 17, 21, 863630)}
2016-08-17 20:07:21,869 WARNING celery.redirected 2016-08-17 20:07:21,868 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:07:21,870 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:07:21,876 INFO celery.worker.job Task schedule_start_lesson[7bef0c9c-3c2a-4d37-9aa8-494358e2fdf0] succeeded in 0.017322792002232745s: None
2016-08-17 20:07:31,088 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:07:31,584 INFO celery.worker.strategy Received task: schedule_clean_desktops[16d72150-fd4c-4360-bbc6-f3e489a9c075]
2016-08-17 20:07:31,586 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:07:31,588 WARNING celery.redirected 2016-08-17 20:07:31,588 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:07:31,589 WARNING celery.redirected 2016-08-17 20:07:31,589 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:07:31,590 WARNING celery.redirected 2016-08-17 20:07:31,590 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:07:31,595 WARNING celery.redirected 2016-08-17 20:07:31,595 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:07:31,596 WARNING celery.redirected 2016-08-17 20:07:31,596 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 6, 31, 587369), 'desktop_state_2': 'DELETED'}
2016-08-17 20:07:31,599 WARNING celery.redirected 2016-08-17 20:07:31,599 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:07:31,600 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:07:31,608 INFO celery.worker.job Task schedule_clean_desktops[16d72150-fd4c-4360-bbc6-f3e489a9c075] succeeded in 0.021689838999009226s: None
2016-08-17 20:07:36,107 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:07:36,107 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:07:36,110 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:07:36,110 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:07:36,115 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:07:36,115 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:07:36,116 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:07:36,116 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:08:06,117 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:08:06,117 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:08:06,118 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:08:06,118 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:08:06,123 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:08:06,124 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:08:06,124 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:08:06,124 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:08:21,124 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:08:21,696 INFO celery.worker.strategy Received task: schedule_start_lesson[32edd6f3-cb99-421b-bfb5-bad1b64975ef]
2016-08-17 20:08:21,698 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:08:21,698 INFO celery Scheduling start lesson tasks
2016-08-17 20:08:21,699 WARNING celery.redirected 2016-08-17 20:08:21,699 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:08:21,701 WARNING celery.redirected 2016-08-17 20:08:21,700 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:08:21,701 WARNING celery.redirected 2016-08-17 20:08:21,701 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:08:21,707 WARNING celery.redirected 2016-08-17 20:08:21,706 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:08:21,708 WARNING celery.redirected 2016-08-17 20:08:21,707 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 8, 21, 703327), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 18, 21, 703327)}
2016-08-17 20:08:21,711 WARNING celery.redirected 2016-08-17 20:08:21,710 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:08:21,712 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:08:21,724 INFO celery.worker.job Task schedule_start_lesson[32edd6f3-cb99-421b-bfb5-bad1b64975ef] succeeded in 0.026368483995611314s: None
2016-08-17 20:08:31,150 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:08:31,428 INFO celery.worker.strategy Received task: schedule_clean_desktops[31df2793-a4cd-4954-8c57-867b86bf7c87]
2016-08-17 20:08:31,430 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:08:31,432 WARNING celery.redirected 2016-08-17 20:08:31,432 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:08:31,433 WARNING celery.redirected 2016-08-17 20:08:31,433 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:08:31,433 WARNING celery.redirected 2016-08-17 20:08:31,433 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:08:31,437 WARNING celery.redirected 2016-08-17 20:08:31,437 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:08:31,438 WARNING celery.redirected 2016-08-17 20:08:31,437 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 7, 31, 431274)}
2016-08-17 20:08:31,440 WARNING celery.redirected 2016-08-17 20:08:31,440 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:08:31,441 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:08:31,447 INFO celery.worker.job Task schedule_clean_desktops[31df2793-a4cd-4954-8c57-867b86bf7c87] succeeded in 0.01758314500330016s: None
2016-08-17 20:08:36,170 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:08:36,171 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:08:36,173 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:08:36,173 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:08:36,179 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:08:36,179 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:08:36,180 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:08:36,180 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:09:11,177 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:09:11,177 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:09:11,177 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:09:11,178 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:09:11,183 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:09:11,183 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:09:11,183 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:09:11,183 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:09:21,174 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:09:21,513 INFO celery.worker.strategy Received task: schedule_start_lesson[8cbd99f5-f34a-4976-a0b3-5fb604dba70e]
2016-08-17 20:09:21,514 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:09:21,515 INFO celery Scheduling start lesson tasks
2016-08-17 20:09:21,516 WARNING celery.redirected 2016-08-17 20:09:21,516 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:09:21,517 WARNING celery.redirected 2016-08-17 20:09:21,517 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:09:21,517 WARNING celery.redirected 2016-08-17 20:09:21,517 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:09:21,521 WARNING celery.redirected 2016-08-17 20:09:21,521 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:09:21,522 WARNING celery.redirected 2016-08-17 20:09:21,522 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 9, 21, 519324), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 19, 21, 519324)}
2016-08-17 20:09:21,524 WARNING celery.redirected 2016-08-17 20:09:21,524 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:09:21,525 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:09:21,532 INFO celery.worker.job Task schedule_start_lesson[8cbd99f5-f34a-4976-a0b3-5fb604dba70e] succeeded in 0.018514556002628524s: None
2016-08-17 20:09:31,194 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:09:31,215 INFO celery.worker.strategy Received task: schedule_clean_desktops[6d14e1fc-fab9-408f-8e41-6288da6d816a]
2016-08-17 20:09:31,217 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:09:31,218 WARNING celery.redirected 2016-08-17 20:09:31,218 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:09:31,219 WARNING celery.redirected 2016-08-17 20:09:31,219 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:09:31,220 WARNING celery.redirected 2016-08-17 20:09:31,220 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:09:31,225 WARNING celery.redirected 2016-08-17 20:09:31,225 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:09:31,225 WARNING celery.redirected 2016-08-17 20:09:31,225 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 8, 31, 217918), 'desktop_state_2': 'DELETED'}
2016-08-17 20:09:31,227 WARNING celery.redirected 2016-08-17 20:09:31,227 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:09:31,229 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:09:31,236 INFO celery.worker.job Task schedule_clean_desktops[6d14e1fc-fab9-408f-8e41-6288da6d816a] succeeded in 0.018980931003170554s: None
2016-08-17 20:09:41,223 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:09:41,224 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:09:41,226 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:09:41,226 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:09:41,232 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:09:41,232 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:09:41,232 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:09:41,233 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:10:11,245 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:10:11,245 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:10:11,245 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:10:11,246 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:10:11,251 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:10:11,251 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:10:11,251 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:10:11,252 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:10:21,252 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:10:22,373 INFO celery.worker.strategy Received task: schedule_start_lesson[2cb8bb50-057f-4322-b0da-192087cd7aff]
2016-08-17 20:10:22,375 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:10:22,375 INFO celery Scheduling start lesson tasks
2016-08-17 20:10:22,376 WARNING celery.redirected 2016-08-17 20:10:22,376 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:10:22,377 WARNING celery.redirected 2016-08-17 20:10:22,377 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:10:22,378 WARNING celery.redirected 2016-08-17 20:10:22,377 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:10:22,381 WARNING celery.redirected 2016-08-17 20:10:22,381 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:10:22,382 WARNING celery.redirected 2016-08-17 20:10:22,382 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 10, 22, 379328), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 20, 22, 379328)}
2016-08-17 20:10:22,384 WARNING celery.redirected 2016-08-17 20:10:22,384 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:10:22,386 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:10:22,396 INFO celery.worker.job Task schedule_start_lesson[2cb8bb50-057f-4322-b0da-192087cd7aff] succeeded in 0.021480000999872573s: None
2016-08-17 20:10:31,315 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:10:32,099 INFO celery.worker.strategy Received task: schedule_clean_desktops[0f25bfc2-ec4d-4872-a94e-2396cb262f83]
2016-08-17 20:10:32,100 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:10:32,102 WARNING celery.redirected 2016-08-17 20:10:32,102 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:10:32,104 WARNING celery.redirected 2016-08-17 20:10:32,104 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:10:32,105 WARNING celery.redirected 2016-08-17 20:10:32,104 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:10:32,108 WARNING celery.redirected 2016-08-17 20:10:32,108 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:10:32,109 WARNING celery.redirected 2016-08-17 20:10:32,109 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 9, 32, 101618)}
2016-08-17 20:10:32,111 WARNING celery.redirected 2016-08-17 20:10:32,111 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:10:32,112 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:10:32,118 INFO celery.worker.job Task schedule_clean_desktops[0f25bfc2-ec4d-4872-a94e-2396cb262f83] succeeded in 0.018162891996325925s: None
2016-08-17 20:10:41,332 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:10:41,332 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:10:41,335 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:10:41,335 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:10:41,341 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:10:41,341 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:10:41,342 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:10:41,342 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:11:11,351 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:11:11,351 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:11:11,351 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:11:11,351 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:11:11,358 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:11:11,359 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:11:11,360 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:11:11,360 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:11:21,362 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:11:22,293 INFO celery.worker.strategy Received task: schedule_start_lesson[5c4bcee1-b73b-4ac6-b13b-3767e2c6d985]
2016-08-17 20:11:22,295 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:11:22,295 INFO celery Scheduling start lesson tasks
2016-08-17 20:11:22,296 WARNING celery.redirected 2016-08-17 20:11:22,296 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:11:22,297 WARNING celery.redirected 2016-08-17 20:11:22,297 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:11:22,298 WARNING celery.redirected 2016-08-17 20:11:22,298 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:11:22,302 WARNING celery.redirected 2016-08-17 20:11:22,302 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:11:22,302 WARNING celery.redirected 2016-08-17 20:11:22,302 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 11, 22, 299889), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 21, 22, 299889)}
2016-08-17 20:11:22,306 WARNING celery.redirected 2016-08-17 20:11:22,306 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:11:22,307 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:11:22,314 INFO celery.worker.job Task schedule_start_lesson[5c4bcee1-b73b-4ac6-b13b-3767e2c6d985] succeeded in 0.01908571700187167s: None
2016-08-17 20:11:31,390 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:11:32,007 INFO celery.worker.strategy Received task: schedule_clean_desktops[55f5b01a-374b-4cb9-9cb7-f483e27f5cf8]
2016-08-17 20:11:32,009 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:11:32,011 WARNING celery.redirected 2016-08-17 20:11:32,011 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:11:32,012 WARNING celery.redirected 2016-08-17 20:11:32,012 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:11:32,012 WARNING celery.redirected 2016-08-17 20:11:32,012 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:11:32,016 WARNING celery.redirected 2016-08-17 20:11:32,016 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:11:32,017 WARNING celery.redirected 2016-08-17 20:11:32,017 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 10, 32, 10156), 'desktop_state_2': 'DELETED'}
2016-08-17 20:11:32,020 WARNING celery.redirected 2016-08-17 20:11:32,020 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:11:32,021 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:11:32,029 INFO celery.worker.job Task schedule_clean_desktops[55f5b01a-374b-4cb9-9cb7-f483e27f5cf8] succeeded in 0.020577163006237242s: None
2016-08-17 20:11:41,416 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:11:41,416 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:11:41,418 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:11:41,418 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:11:41,423 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:11:41,423 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:11:41,424 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:11:41,424 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:12:11,429 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:12:11,429 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:12:11,430 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:12:11,430 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:12:11,435 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:12:11,436 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:12:11,436 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:12:11,436 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:12:21,439 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:12:22,153 INFO celery.worker.strategy Received task: schedule_start_lesson[071b9ff8-b43d-40fe-ab08-f9edcecc6e29]
2016-08-17 20:12:22,154 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:12:22,155 INFO celery Scheduling start lesson tasks
2016-08-17 20:12:22,156 WARNING celery.redirected 2016-08-17 20:12:22,156 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:12:22,157 WARNING celery.redirected 2016-08-17 20:12:22,156 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:12:22,157 WARNING celery.redirected 2016-08-17 20:12:22,157 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:12:22,161 WARNING celery.redirected 2016-08-17 20:12:22,160 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:12:22,161 WARNING celery.redirected 2016-08-17 20:12:22,161 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 12, 22, 158819), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 22, 22, 158819)}
2016-08-17 20:12:22,164 WARNING celery.redirected 2016-08-17 20:12:22,164 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:12:22,165 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:12:22,173 INFO celery.worker.job Task schedule_start_lesson[071b9ff8-b43d-40fe-ab08-f9edcecc6e29] succeeded in 0.019177221998688765s: None
2016-08-17 20:12:31,465 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:12:31,903 INFO celery.worker.strategy Received task: schedule_clean_desktops[2c3127e8-3b9d-455a-86e7-4a87440d997a]
2016-08-17 20:12:31,905 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:12:31,907 WARNING celery.redirected 2016-08-17 20:12:31,907 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:12:31,909 WARNING celery.redirected 2016-08-17 20:12:31,908 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:12:31,909 WARNING celery.redirected 2016-08-17 20:12:31,909 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:12:31,914 WARNING celery.redirected 2016-08-17 20:12:31,914 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:12:31,914 WARNING celery.redirected 2016-08-17 20:12:31,914 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 11, 31, 906210), 'desktop_state_2': 'DELETED'}
2016-08-17 20:12:31,917 WARNING celery.redirected 2016-08-17 20:12:31,917 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:12:31,918 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:12:31,930 INFO celery.worker.job Task schedule_clean_desktops[2c3127e8-3b9d-455a-86e7-4a87440d997a] succeeded in 0.0250416509952629s: None
2016-08-17 20:12:41,491 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:12:41,491 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:12:41,494 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:12:41,494 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:12:41,500 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:12:41,500 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:12:41,500 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:12:41,500 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:13:11,510 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:13:11,510 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:13:11,510 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:13:11,511 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:13:11,517 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:13:11,517 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:13:11,518 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:13:11,518 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:13:21,519 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:13:21,951 INFO celery.worker.strategy Received task: schedule_start_lesson[5a793bdc-4ffc-4882-9f1b-5ee653843bae]
2016-08-17 20:13:21,952 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:13:21,953 INFO celery Scheduling start lesson tasks
2016-08-17 20:13:21,954 WARNING celery.redirected 2016-08-17 20:13:21,954 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:13:21,955 WARNING celery.redirected 2016-08-17 20:13:21,955 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:13:21,956 WARNING celery.redirected 2016-08-17 20:13:21,956 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:13:21,960 WARNING celery.redirected 2016-08-17 20:13:21,959 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:13:21,960 WARNING celery.redirected 2016-08-17 20:13:21,960 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 13, 21, 957744), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 23, 21, 957744)}
2016-08-17 20:13:21,962 WARNING celery.redirected 2016-08-17 20:13:21,962 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:13:21,963 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:13:21,970 INFO celery.worker.job Task schedule_start_lesson[5a793bdc-4ffc-4882-9f1b-5ee653843bae] succeeded in 0.01778114299668232s: None
2016-08-17 20:13:31,541 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:13:31,656 INFO celery.worker.strategy Received task: schedule_clean_desktops[97765257-5312-443d-aa07-1e335f5ac435]
2016-08-17 20:13:31,657 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:13:31,658 WARNING celery.redirected 2016-08-17 20:13:31,658 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:13:31,659 WARNING celery.redirected 2016-08-17 20:13:31,659 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:13:31,660 WARNING celery.redirected 2016-08-17 20:13:31,660 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:13:31,663 WARNING celery.redirected 2016-08-17 20:13:31,663 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:13:31,663 WARNING celery.redirected 2016-08-17 20:13:31,663 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 12, 31, 658077), 'desktop_state_2': 'DELETED'}
2016-08-17 20:13:31,666 WARNING celery.redirected 2016-08-17 20:13:31,665 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:13:31,667 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:13:31,673 INFO celery.worker.job Task schedule_clean_desktops[97765257-5312-443d-aa07-1e335f5ac435] succeeded in 0.016419702995335683s: None
2016-08-17 20:13:41,561 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:13:41,561 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:13:41,564 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:13:41,564 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:13:41,569 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:13:41,569 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:13:41,569 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:13:41,569 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:14:11,581 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:14:11,581 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:14:11,582 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:14:11,582 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:14:11,588 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:14:11,588 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:14:11,589 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:14:11,589 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:14:26,589 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:14:26,634 INFO celery.worker.strategy Received task: schedule_start_lesson[0c893431-f5c3-45dc-bf64-f2821781c65a]
2016-08-17 20:14:26,635 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:14:26,636 INFO celery Scheduling start lesson tasks
2016-08-17 20:14:26,637 WARNING celery.redirected 2016-08-17 20:14:26,637 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:14:26,638 WARNING celery.redirected 2016-08-17 20:14:26,638 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:14:26,639 WARNING celery.redirected 2016-08-17 20:14:26,638 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:14:26,643 WARNING celery.redirected 2016-08-17 20:14:26,643 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:14:26,644 WARNING celery.redirected 2016-08-17 20:14:26,644 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 14, 26, 640969), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 24, 26, 640969)}
2016-08-17 20:14:26,646 WARNING celery.redirected 2016-08-17 20:14:26,646 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:14:26,647 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:14:26,654 INFO celery.worker.job Task schedule_start_lesson[0c893431-f5c3-45dc-bf64-f2821781c65a] succeeded in 0.018362712995440233s: None
2016-08-17 20:14:36,633 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:14:37,616 INFO celery.worker.strategy Received task: schedule_clean_desktops[5ba2178d-52a8-406c-9e27-d49d9b7af729]
2016-08-17 20:14:37,618 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:14:37,620 WARNING celery.redirected 2016-08-17 20:14:37,619 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:14:37,621 WARNING celery.redirected 2016-08-17 20:14:37,620 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:14:37,621 WARNING celery.redirected 2016-08-17 20:14:37,621 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:14:37,624 WARNING celery.redirected 2016-08-17 20:14:37,624 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:14:37,625 WARNING celery.redirected 2016-08-17 20:14:37,625 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 13, 37, 619245), 'desktop_state_2': 'DELETED'}
2016-08-17 20:14:37,627 WARNING celery.redirected 2016-08-17 20:14:37,627 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:14:37,628 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:14:37,635 INFO celery.worker.job Task schedule_clean_desktops[5ba2178d-52a8-406c-9e27-d49d9b7af729] succeeded in 0.01689369700034149s: None
2016-08-17 20:14:41,653 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:14:41,653 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:14:41,655 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:14:41,656 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:14:41,660 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:14:41,661 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:14:41,661 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:14:41,661 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:15:16,657 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:15:16,658 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:15:16,658 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:15:16,658 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:15:16,663 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:15:16,663 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:15:16,664 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:15:16,664 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:15:31,671 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:15:32,634 INFO celery.worker.strategy Received task: schedule_start_lesson[b17c642a-cc1b-4c73-8fab-e8ea8d4a083c]
2016-08-17 20:15:32,636 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:15:32,636 INFO celery Scheduling start lesson tasks
2016-08-17 20:15:32,637 WARNING celery.redirected 2016-08-17 20:15:32,637 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:15:32,638 WARNING celery.redirected 2016-08-17 20:15:32,638 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:15:32,639 WARNING celery.redirected 2016-08-17 20:15:32,639 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:15:32,643 WARNING celery.redirected 2016-08-17 20:15:32,643 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:15:32,644 WARNING celery.redirected 2016-08-17 20:15:32,644 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 15, 32, 640709), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 25, 32, 640709)}
2016-08-17 20:15:32,647 WARNING celery.redirected 2016-08-17 20:15:32,646 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:15:32,649 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:15:32,657 INFO celery.worker.job Task schedule_start_lesson[b17c642a-cc1b-4c73-8fab-e8ea8d4a083c] succeeded in 0.021056917001260445s: None
2016-08-17 20:15:41,698 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:15:42,320 INFO celery.worker.strategy Received task: schedule_clean_desktops[e66776aa-3a03-4122-a04a-d71414894470]
2016-08-17 20:15:42,321 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:15:42,323 WARNING celery.redirected 2016-08-17 20:15:42,323 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:15:42,325 WARNING celery.redirected 2016-08-17 20:15:42,324 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:15:42,325 WARNING celery.redirected 2016-08-17 20:15:42,325 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:15:42,331 WARNING celery.redirected 2016-08-17 20:15:42,331 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:15:42,332 WARNING celery.redirected 2016-08-17 20:15:42,331 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 14, 42, 322357), 'desktop_state_2': 'DELETED'}
2016-08-17 20:15:42,335 WARNING celery.redirected 2016-08-17 20:15:42,334 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:15:42,336 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:15:42,345 INFO celery.worker.job Task schedule_clean_desktops[e66776aa-3a03-4122-a04a-d71414894470] succeeded in 0.02436485299404012s: None
2016-08-17 20:15:46,724 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:15:46,724 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:15:46,726 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:15:46,727 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:15:46,731 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:15:46,732 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:15:46,732 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:15:46,732 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:16:16,739 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:16:16,739 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:16:16,740 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:16:16,740 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:16:16,745 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:16:16,745 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:16:16,746 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:16:16,746 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:16:36,749 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:16:37,338 INFO celery.worker.strategy Received task: schedule_start_lesson[5a098e57-fac8-4b5b-8832-2a7d5b7dd4e1]
2016-08-17 20:16:37,339 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:16:37,340 INFO celery Scheduling start lesson tasks
2016-08-17 20:16:37,341 WARNING celery.redirected 2016-08-17 20:16:37,341 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:16:37,342 WARNING celery.redirected 2016-08-17 20:16:37,342 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:16:37,343 WARNING celery.redirected 2016-08-17 20:16:37,342 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:16:37,347 WARNING celery.redirected 2016-08-17 20:16:37,347 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:16:37,348 WARNING celery.redirected 2016-08-17 20:16:37,348 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 16, 37, 344408), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 26, 37, 344408)}
2016-08-17 20:16:37,351 WARNING celery.redirected 2016-08-17 20:16:37,350 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:16:37,352 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:16:37,359 INFO celery.worker.job Task schedule_start_lesson[5a098e57-fac8-4b5b-8832-2a7d5b7dd4e1] succeeded in 0.02004033900448121s: None
2016-08-17 20:16:46,769 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:16:46,770 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:16:46,772 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:16:46,772 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:16:46,774 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:16:46,792 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:16:46,792 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:16:46,794 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:16:46,795 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:16:46,798 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:16:46,798 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:16:46,798 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:16:46,799 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:16:47,068 INFO celery.worker.strategy Received task: schedule_clean_desktops[a69525eb-1fa1-4988-ac82-97e6ff38d76b]
2016-08-17 20:16:47,069 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:16:47,071 WARNING celery.redirected 2016-08-17 20:16:47,071 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:16:47,072 WARNING celery.redirected 2016-08-17 20:16:47,072 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:16:47,073 WARNING celery.redirected 2016-08-17 20:16:47,073 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:16:47,077 WARNING celery.redirected 2016-08-17 20:16:47,076 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:16:47,077 WARNING celery.redirected 2016-08-17 20:16:47,077 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 15, 47, 70752)}
2016-08-17 20:16:47,079 WARNING celery.redirected 2016-08-17 20:16:47,079 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:16:47,080 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:16:47,088 INFO celery.worker.job Task schedule_clean_desktops[a69525eb-1fa1-4988-ac82-97e6ff38d76b] succeeded in 0.018593687993416097s: None
2016-08-17 20:17:16,808 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:17:16,809 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:17:16,809 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:17:16,809 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:17:16,814 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:17:16,815 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:17:16,815 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:17:16,815 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:17:41,808 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:17:42,051 INFO celery.worker.strategy Received task: schedule_start_lesson[d10a8baf-c814-46ef-9393-92ee1b84ccff]
2016-08-17 20:17:42,052 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:17:42,052 INFO celery Scheduling start lesson tasks
2016-08-17 20:17:42,053 WARNING celery.redirected 2016-08-17 20:17:42,053 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:17:42,054 WARNING celery.redirected 2016-08-17 20:17:42,054 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:17:42,055 WARNING celery.redirected 2016-08-17 20:17:42,055 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:17:42,059 WARNING celery.redirected 2016-08-17 20:17:42,058 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:17:42,059 WARNING celery.redirected 2016-08-17 20:17:42,059 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 17, 42, 56714), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 27, 42, 56714)}
2016-08-17 20:17:42,061 WARNING celery.redirected 2016-08-17 20:17:42,061 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:17:42,062 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:17:42,069 INFO celery.worker.job Task schedule_start_lesson[d10a8baf-c814-46ef-9393-92ee1b84ccff] succeeded in 0.017373394999594893s: None
2016-08-17 20:17:46,831 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:17:46,831 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:17:46,833 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:17:46,833 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:17:46,838 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:17:46,839 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:17:46,839 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:17:46,839 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:17:51,841 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:17:53,060 INFO celery.worker.strategy Received task: schedule_clean_desktops[844e41ae-203d-472b-9103-f81632541f37]
2016-08-17 20:17:53,061 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:17:53,063 WARNING celery.redirected 2016-08-17 20:17:53,062 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:17:53,064 WARNING celery.redirected 2016-08-17 20:17:53,064 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:17:53,064 WARNING celery.redirected 2016-08-17 20:17:53,064 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:17:53,068 WARNING celery.redirected 2016-08-17 20:17:53,067 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:17:53,068 WARNING celery.redirected 2016-08-17 20:17:53,068 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 16, 53, 62280), 'desktop_state_2': 'DELETED'}
2016-08-17 20:17:53,071 WARNING celery.redirected 2016-08-17 20:17:53,071 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:17:53,072 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:17:53,082 INFO celery.worker.job Task schedule_clean_desktops[844e41ae-203d-472b-9103-f81632541f37] succeeded in 0.02113556899712421s: None
2016-08-17 20:18:17,013 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:18:17,013 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:18:17,015 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:18:17,016 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:18:17,021 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:18:17,021 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:18:17,021 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:18:17,021 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:18:42,025 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:18:43,170 INFO celery.worker.strategy Received task: schedule_start_lesson[af083d47-79c3-4957-8f41-75fa362262f8]
2016-08-17 20:18:43,173 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:18:43,174 INFO celery Scheduling start lesson tasks
2016-08-17 20:18:43,175 WARNING celery.redirected 2016-08-17 20:18:43,175 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:18:43,177 WARNING celery.redirected 2016-08-17 20:18:43,177 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:18:43,177 WARNING celery.redirected 2016-08-17 20:18:43,177 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:18:43,183 WARNING celery.redirected 2016-08-17 20:18:43,183 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:18:43,184 WARNING celery.redirected 2016-08-17 20:18:43,184 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 18, 43, 179592), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 28, 43, 179592)}
2016-08-17 20:18:43,188 WARNING celery.redirected 2016-08-17 20:18:43,188 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:18:43,189 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:18:43,201 INFO celery.worker.job Task schedule_start_lesson[af083d47-79c3-4957-8f41-75fa362262f8] succeeded in 0.028244291002920363s: None
2016-08-17 20:18:47,122 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:18:47,122 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:18:47,126 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:18:47,127 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:18:47,134 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:18:47,134 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:18:47,135 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:18:47,135 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:18:52,137 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:18:52,869 INFO celery.worker.strategy Received task: schedule_clean_desktops[9b40538b-11d8-48fe-a81e-c2745ba2255e]
2016-08-17 20:18:52,870 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:18:52,872 WARNING celery.redirected 2016-08-17 20:18:52,871 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:18:52,873 WARNING celery.redirected 2016-08-17 20:18:52,872 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:18:52,873 WARNING celery.redirected 2016-08-17 20:18:52,873 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:18:52,877 WARNING celery.redirected 2016-08-17 20:18:52,877 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:18:52,878 WARNING celery.redirected 2016-08-17 20:18:52,878 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 17, 52, 871206), 'desktop_state_2': 'DELETED'}
2016-08-17 20:18:52,881 WARNING celery.redirected 2016-08-17 20:18:52,881 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:18:52,883 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:18:52,889 INFO celery.worker.job Task schedule_clean_desktops[9b40538b-11d8-48fe-a81e-c2745ba2255e] succeeded in 0.019263018999481574s: None
2016-08-17 20:19:17,158 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:19:17,159 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:19:17,161 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:19:17,161 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:19:17,166 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:19:17,167 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:19:17,167 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:19:17,167 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:19:42,170 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:19:42,870 INFO celery.worker.strategy Received task: schedule_start_lesson[16ac8a21-0a6c-43c3-9515-f81ce7dae901]
2016-08-17 20:19:42,872 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:19:42,872 INFO celery Scheduling start lesson tasks
2016-08-17 20:19:42,873 WARNING celery.redirected 2016-08-17 20:19:42,873 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:19:42,874 WARNING celery.redirected 2016-08-17 20:19:42,874 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:19:42,875 WARNING celery.redirected 2016-08-17 20:19:42,875 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:19:42,879 WARNING celery.redirected 2016-08-17 20:19:42,879 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:19:42,879 WARNING celery.redirected 2016-08-17 20:19:42,879 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 19, 42, 876492), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 29, 42, 876492)}
2016-08-17 20:19:42,882 WARNING celery.redirected 2016-08-17 20:19:42,882 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:19:42,883 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:19:42,891 INFO celery.worker.job Task schedule_start_lesson[16ac8a21-0a6c-43c3-9515-f81ce7dae901] succeeded in 0.019247832002292853s: None
2016-08-17 20:19:47,192 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:19:47,192 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:19:47,195 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:19:47,195 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:19:47,200 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:19:47,200 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:19:47,200 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:19:47,201 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:19:52,200 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:19:52,577 INFO celery.worker.strategy Received task: schedule_clean_desktops[21a586c6-a07b-4d41-83fc-9cb9df30c9ef]
2016-08-17 20:19:52,579 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:19:52,580 WARNING celery.redirected 2016-08-17 20:19:52,580 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:19:52,581 WARNING celery.redirected 2016-08-17 20:19:52,581 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:19:52,582 WARNING celery.redirected 2016-08-17 20:19:52,582 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:19:52,585 WARNING celery.redirected 2016-08-17 20:19:52,585 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:19:52,586 WARNING celery.redirected 2016-08-17 20:19:52,585 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 18, 52, 579769), 'desktop_state_2': 'DELETED'}
2016-08-17 20:19:52,588 WARNING celery.redirected 2016-08-17 20:19:52,588 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:19:52,589 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:19:52,596 INFO celery.worker.job Task schedule_clean_desktops[21a586c6-a07b-4d41-83fc-9cb9df30c9ef] succeeded in 0.017547757997817826s: None
2016-08-17 20:20:17,231 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:20:17,232 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:20:17,234 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:20:17,234 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:20:17,239 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:20:17,239 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:20:17,240 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:20:17,240 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:20:42,252 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:20:42,705 INFO celery.worker.strategy Received task: schedule_start_lesson[f5994ff5-d8c8-49c3-8f42-21bf01a517e3]
2016-08-17 20:20:42,707 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:20:42,707 INFO celery Scheduling start lesson tasks
2016-08-17 20:20:42,708 WARNING celery.redirected 2016-08-17 20:20:42,708 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:20:42,709 WARNING celery.redirected 2016-08-17 20:20:42,709 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:20:42,710 WARNING celery.redirected 2016-08-17 20:20:42,710 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:20:42,714 WARNING celery.redirected 2016-08-17 20:20:42,713 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:20:42,714 WARNING celery.redirected 2016-08-17 20:20:42,714 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 20, 42, 712016), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 30, 42, 712016)}
2016-08-17 20:20:42,716 WARNING celery.redirected 2016-08-17 20:20:42,716 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:20:42,717 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:20:42,725 INFO celery.worker.job Task schedule_start_lesson[f5994ff5-d8c8-49c3-8f42-21bf01a517e3] succeeded in 0.018099278000590857s: None
2016-08-17 20:20:47,272 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:20:47,272 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:20:47,274 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:20:47,274 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:20:47,279 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:20:47,280 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:20:47,280 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:20:47,280 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:20:52,282 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:20:52,411 INFO celery.worker.strategy Received task: schedule_clean_desktops[04f0bcc6-e9f7-43b9-9d9d-6330b34408b7]
2016-08-17 20:20:52,413 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:20:52,414 WARNING celery.redirected 2016-08-17 20:20:52,414 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:20:52,415 WARNING celery.redirected 2016-08-17 20:20:52,415 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:20:52,415 WARNING celery.redirected 2016-08-17 20:20:52,415 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:20:52,419 WARNING celery.redirected 2016-08-17 20:20:52,418 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:20:52,419 WARNING celery.redirected 2016-08-17 20:20:52,419 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 19, 52, 413845), 'desktop_state_2': 'DELETED'}
2016-08-17 20:20:52,421 WARNING celery.redirected 2016-08-17 20:20:52,421 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:20:52,422 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:20:52,430 INFO celery.worker.job Task schedule_clean_desktops[04f0bcc6-e9f7-43b9-9d9d-6330b34408b7] succeeded in 0.017638467994402163s: None
2016-08-17 20:21:17,312 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:21:17,313 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:21:17,315 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:21:17,315 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:21:17,320 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:21:17,321 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:21:17,321 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:21:17,321 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:21:42,332 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:21:42,557 INFO celery.worker.strategy Received task: schedule_start_lesson[f6a4a35c-0729-4d8f-b6ef-137db630e4b8]
2016-08-17 20:21:42,558 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:21:42,559 INFO celery Scheduling start lesson tasks
2016-08-17 20:21:42,560 WARNING celery.redirected 2016-08-17 20:21:42,560 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:21:42,561 WARNING celery.redirected 2016-08-17 20:21:42,561 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:21:42,562 WARNING celery.redirected 2016-08-17 20:21:42,562 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:21:42,567 WARNING celery.redirected 2016-08-17 20:21:42,567 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:21:42,567 WARNING celery.redirected 2016-08-17 20:21:42,567 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 21, 42, 564604), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 31, 42, 564604)}
2016-08-17 20:21:42,570 WARNING celery.redirected 2016-08-17 20:21:42,570 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:21:42,572 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:21:42,583 INFO celery.worker.job Task schedule_start_lesson[f6a4a35c-0729-4d8f-b6ef-137db630e4b8] succeeded in 0.025218254995706957s: None
2016-08-17 20:21:47,358 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:21:47,358 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:21:47,361 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:21:47,361 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:21:47,366 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:21:47,366 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:21:47,367 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:21:47,367 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:21:52,366 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:21:53,548 INFO celery.worker.strategy Received task: schedule_clean_desktops[bfb5375c-54ac-461b-bfa1-100cb780ca5d]
2016-08-17 20:21:53,550 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:21:53,552 WARNING celery.redirected 2016-08-17 20:21:53,551 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:21:53,553 WARNING celery.redirected 2016-08-17 20:21:53,553 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:21:53,553 WARNING celery.redirected 2016-08-17 20:21:53,553 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:21:53,557 WARNING celery.redirected 2016-08-17 20:21:53,557 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:21:53,558 WARNING celery.redirected 2016-08-17 20:21:53,557 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 20, 53, 550992), 'desktop_state_2': 'DELETED'}
2016-08-17 20:21:53,560 WARNING celery.redirected 2016-08-17 20:21:53,560 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:21:53,561 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:21:53,569 INFO celery.worker.job Task schedule_clean_desktops[bfb5375c-54ac-461b-bfa1-100cb780ca5d] succeeded in 0.019107427004200872s: None
2016-08-17 20:22:17,491 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:22:17,491 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:22:17,494 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:22:17,494 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:22:17,499 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:22:17,499 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:22:17,500 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:22:17,500 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:22:42,506 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:22:43,693 INFO celery.worker.strategy Received task: schedule_start_lesson[ce368b6e-0941-4e34-a9d9-0129cbcac82b]
2016-08-17 20:22:43,695 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:22:43,695 INFO celery Scheduling start lesson tasks
2016-08-17 20:22:43,696 WARNING celery.redirected 2016-08-17 20:22:43,696 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:22:43,698 WARNING celery.redirected 2016-08-17 20:22:43,697 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:22:43,698 WARNING celery.redirected 2016-08-17 20:22:43,698 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:22:43,702 WARNING celery.redirected 2016-08-17 20:22:43,702 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:22:43,702 WARNING celery.redirected 2016-08-17 20:22:43,702 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 22, 43, 700208), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 32, 43, 700208)}
2016-08-17 20:22:43,705 WARNING celery.redirected 2016-08-17 20:22:43,705 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:22:43,706 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:22:43,713 INFO celery.worker.job Task schedule_start_lesson[ce368b6e-0941-4e34-a9d9-0129cbcac82b] succeeded in 0.018871531006880105s: None
2016-08-17 20:22:47,640 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:22:47,640 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:22:47,643 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:22:47,643 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:22:47,648 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:22:47,648 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:22:47,649 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:22:47,649 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:22:52,651 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:22:53,385 INFO celery.worker.strategy Received task: schedule_clean_desktops[540f1911-aa76-4d0a-8468-ecc0ce8a56c2]
2016-08-17 20:22:53,387 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:22:53,388 WARNING celery.redirected 2016-08-17 20:22:53,388 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:22:53,389 WARNING celery.redirected 2016-08-17 20:22:53,389 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:22:53,390 WARNING celery.redirected 2016-08-17 20:22:53,390 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:22:53,394 WARNING celery.redirected 2016-08-17 20:22:53,394 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:22:53,395 WARNING celery.redirected 2016-08-17 20:22:53,395 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 21, 53, 387884)}
2016-08-17 20:22:53,398 WARNING celery.redirected 2016-08-17 20:22:53,398 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:22:53,400 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:22:53,409 INFO celery.worker.job Task schedule_clean_desktops[540f1911-aa76-4d0a-8468-ecc0ce8a56c2] succeeded in 0.022618846996920183s: None
2016-08-17 20:23:17,675 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:23:17,675 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:23:17,678 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:23:17,678 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:23:17,683 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:23:17,683 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:23:17,683 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:23:17,683 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:23:47,676 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:23:47,694 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:23:47,695 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:23:47,697 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:23:47,697 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:23:47,700 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:23:47,700 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:23:47,700 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:23:47,701 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:23:48,273 INFO celery.worker.strategy Received task: schedule_start_lesson[9178412e-83ea-4744-917c-a63b495ab4f1]
2016-08-17 20:23:48,274 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:23:48,275 INFO celery Scheduling start lesson tasks
2016-08-17 20:23:48,276 WARNING celery.redirected 2016-08-17 20:23:48,275 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:23:48,277 WARNING celery.redirected 2016-08-17 20:23:48,277 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:23:48,277 WARNING celery.redirected 2016-08-17 20:23:48,277 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:23:48,281 WARNING celery.redirected 2016-08-17 20:23:48,281 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:23:48,281 WARNING celery.redirected 2016-08-17 20:23:48,281 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 23, 48, 279127), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 33, 48, 279127)}
2016-08-17 20:23:48,284 WARNING celery.redirected 2016-08-17 20:23:48,283 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:23:48,285 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:23:48,292 INFO celery.worker.job Task schedule_start_lesson[9178412e-83ea-4744-917c-a63b495ab4f1] succeeded in 0.017868914997961838s: None
2016-08-17 20:23:57,701 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:23:57,979 INFO celery.worker.strategy Received task: schedule_clean_desktops[86c1fc5d-bedc-4668-9b9a-179dfb1d7fe7]
2016-08-17 20:23:57,981 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:23:57,982 WARNING celery.redirected 2016-08-17 20:23:57,982 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:23:57,984 WARNING celery.redirected 2016-08-17 20:23:57,984 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:23:57,985 WARNING celery.redirected 2016-08-17 20:23:57,984 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:23:57,989 WARNING celery.redirected 2016-08-17 20:23:57,989 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:23:57,989 WARNING celery.redirected 2016-08-17 20:23:57,989 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 22, 57, 981951)}
2016-08-17 20:23:57,993 WARNING celery.redirected 2016-08-17 20:23:57,992 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:23:57,994 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:23:58,005 INFO celery.worker.job Task schedule_clean_desktops[86c1fc5d-bedc-4668-9b9a-179dfb1d7fe7] succeeded in 0.024753363999479916s: None
2016-08-17 20:24:17,729 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:24:17,730 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:24:17,732 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:24:17,732 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:24:17,737 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:24:17,737 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:24:17,737 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:24:17,738 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:24:47,740 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:24:47,741 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:24:47,741 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:24:47,741 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:24:47,746 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:24:47,747 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:24:47,747 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:24:47,747 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:24:52,745 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:24:52,964 INFO celery.worker.strategy Received task: schedule_start_lesson[5404e819-2921-44d2-9b35-d7fb138b546d]
2016-08-17 20:24:52,966 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:24:52,967 INFO celery Scheduling start lesson tasks
2016-08-17 20:24:52,968 WARNING celery.redirected 2016-08-17 20:24:52,968 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:24:52,969 WARNING celery.redirected 2016-08-17 20:24:52,969 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:24:52,969 WARNING celery.redirected 2016-08-17 20:24:52,969 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:24:52,975 WARNING celery.redirected 2016-08-17 20:24:52,975 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:24:52,975 WARNING celery.redirected 2016-08-17 20:24:52,975 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 24, 52, 971423), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 34, 52, 971423)}
2016-08-17 20:24:52,977 WARNING celery.redirected 2016-08-17 20:24:52,977 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:24:52,978 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:24:52,985 INFO celery.worker.job Task schedule_start_lesson[5404e819-2921-44d2-9b35-d7fb138b546d] succeeded in 0.018515969000873156s: None
2016-08-17 20:25:02,766 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:25:02,838 INFO celery.worker.strategy Received task: schedule_clean_desktops[af4a2742-b325-4900-abdf-6fcd00ff9fc9]
2016-08-17 20:25:02,839 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:25:02,841 WARNING celery.redirected 2016-08-17 20:25:02,841 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:25:02,842 WARNING celery.redirected 2016-08-17 20:25:02,842 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:25:02,843 WARNING celery.redirected 2016-08-17 20:25:02,843 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:25:02,847 WARNING celery.redirected 2016-08-17 20:25:02,846 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:25:02,847 WARNING celery.redirected 2016-08-17 20:25:02,847 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 24, 2, 840602), 'desktop_state_2': 'DELETED'}
2016-08-17 20:25:02,850 WARNING celery.redirected 2016-08-17 20:25:02,850 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:25:02,851 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:25:02,858 INFO celery.worker.job Task schedule_clean_desktops[af4a2742-b325-4900-abdf-6fcd00ff9fc9] succeeded in 0.018595739995362237s: None
2016-08-17 20:25:17,842 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:25:17,843 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:25:17,845 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:25:17,845 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:25:17,851 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:25:17,851 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:25:17,851 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:25:17,851 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:25:52,845 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:25:52,845 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:25:52,846 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:25:52,846 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:25:52,851 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:25:52,852 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:25:52,852 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:25:52,852 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:25:57,848 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:25:57,908 INFO celery.worker.strategy Received task: schedule_start_lesson[0bb20c9a-aebf-4ef4-9330-40904f4e9455]
2016-08-17 20:25:57,910 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:25:57,910 INFO celery Scheduling start lesson tasks
2016-08-17 20:25:57,911 WARNING celery.redirected 2016-08-17 20:25:57,911 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:25:57,913 WARNING celery.redirected 2016-08-17 20:25:57,913 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:25:57,914 WARNING celery.redirected 2016-08-17 20:25:57,914 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:25:57,918 WARNING celery.redirected 2016-08-17 20:25:57,918 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:25:57,919 WARNING celery.redirected 2016-08-17 20:25:57,919 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 25, 57, 915962), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 35, 57, 915962)}
2016-08-17 20:25:57,921 WARNING celery.redirected 2016-08-17 20:25:57,921 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:25:57,922 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:25:57,929 INFO celery.worker.job Task schedule_start_lesson[0bb20c9a-aebf-4ef4-9330-40904f4e9455] succeeded in 0.01908234699658351s: None
2016-08-17 20:26:07,904 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:26:08,944 INFO celery.worker.strategy Received task: schedule_clean_desktops[bf674242-33b3-4edf-84d2-109d855b3230]
2016-08-17 20:26:08,945 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:26:08,948 WARNING celery.redirected 2016-08-17 20:26:08,947 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:26:08,949 WARNING celery.redirected 2016-08-17 20:26:08,949 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:26:08,950 WARNING celery.redirected 2016-08-17 20:26:08,950 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:26:08,955 WARNING celery.redirected 2016-08-17 20:26:08,954 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:26:08,956 WARNING celery.redirected 2016-08-17 20:26:08,955 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 25, 8, 946833), 'desktop_state_2': 'DELETED'}
2016-08-17 20:26:08,959 WARNING celery.redirected 2016-08-17 20:26:08,958 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:26:08,960 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:26:08,972 INFO celery.worker.job Task schedule_clean_desktops[bf674242-33b3-4edf-84d2-109d855b3230] succeeded in 0.02676326600339962s: None
2016-08-17 20:26:22,927 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:26:22,927 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:26:22,931 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:26:22,932 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:26:22,941 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:26:22,942 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:26:22,942 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:26:22,943 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:26:52,954 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:26:52,955 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:26:52,955 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:26:52,956 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:26:52,967 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:26:52,967 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:26:52,968 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:26:52,968 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:27:02,962 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:27:03,128 INFO celery.worker.strategy Received task: schedule_start_lesson[f0ca86b2-7b95-4af7-95c4-e18ac05756a6]
2016-08-17 20:27:03,130 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:27:03,130 INFO celery Scheduling start lesson tasks
2016-08-17 20:27:03,131 WARNING celery.redirected 2016-08-17 20:27:03,131 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:27:03,132 WARNING celery.redirected 2016-08-17 20:27:03,132 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:27:03,133 WARNING celery.redirected 2016-08-17 20:27:03,133 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:27:03,136 WARNING celery.redirected 2016-08-17 20:27:03,136 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:27:03,137 WARNING celery.redirected 2016-08-17 20:27:03,137 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 27, 3, 134714), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 37, 3, 134714)}
2016-08-17 20:27:03,140 WARNING celery.redirected 2016-08-17 20:27:03,140 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:27:03,142 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:27:03,158 INFO celery.worker.job Task schedule_start_lesson[f0ca86b2-7b95-4af7-95c4-e18ac05756a6] succeeded in 0.02803533000405878s: None
2016-08-17 20:27:12,982 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:27:13,249 INFO celery.worker.strategy Received task: schedule_clean_desktops[deba8d5d-bcc3-439f-b719-cb541bb168ca]
2016-08-17 20:27:13,254 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:27:13,260 WARNING celery.redirected 2016-08-17 20:27:13,260 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:27:13,262 WARNING celery.redirected 2016-08-17 20:27:13,261 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:27:13,263 WARNING celery.redirected 2016-08-17 20:27:13,262 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:27:13,268 WARNING celery.redirected 2016-08-17 20:27:13,268 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:27:13,269 WARNING celery.redirected 2016-08-17 20:27:13,269 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 26, 13, 257205)}
2016-08-17 20:27:13,274 WARNING celery.redirected 2016-08-17 20:27:13,274 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:27:13,277 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:27:13,292 INFO celery.worker.job Task schedule_clean_desktops[deba8d5d-bcc3-439f-b719-cb541bb168ca] succeeded in 0.037932351006020326s: None
2016-08-17 20:27:22,999 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:27:22,999 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:27:23,002 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:27:23,003 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:27:23,008 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:27:23,009 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:27:23,009 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:27:23,009 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:27:57,995 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:27:57,995 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:27:57,995 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:27:57,995 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:27:58,003 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:27:58,004 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:27:58,004 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:27:58,004 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:28:03,009 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:28:03,699 INFO celery.worker.strategy Received task: schedule_start_lesson[f1886dfc-d60f-4f8f-ab61-038ab81ceb50]
2016-08-17 20:28:03,701 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:28:03,701 INFO celery Scheduling start lesson tasks
2016-08-17 20:28:03,703 WARNING celery.redirected 2016-08-17 20:28:03,703 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:28:03,706 WARNING celery.redirected 2016-08-17 20:28:03,705 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:28:03,707 WARNING celery.redirected 2016-08-17 20:28:03,706 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:28:03,719 WARNING celery.redirected 2016-08-17 20:28:03,718 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:28:03,719 WARNING celery.redirected 2016-08-17 20:28:03,719 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 28, 3, 712123), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 38, 3, 712123)}
2016-08-17 20:28:03,723 WARNING celery.redirected 2016-08-17 20:28:03,722 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:28:03,725 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:28:03,734 INFO celery.worker.job Task schedule_start_lesson[f1886dfc-d60f-4f8f-ab61-038ab81ceb50] succeeded in 0.033840540003438946s: None
2016-08-17 20:28:13,036 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:28:13,662 INFO celery.worker.strategy Received task: schedule_clean_desktops[1f699eb0-43ce-4a9f-8afe-37a8d236f598]
2016-08-17 20:28:13,663 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:28:13,665 WARNING celery.redirected 2016-08-17 20:28:13,665 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:28:13,667 WARNING celery.redirected 2016-08-17 20:28:13,667 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:28:13,668 WARNING celery.redirected 2016-08-17 20:28:13,668 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:28:13,677 WARNING celery.redirected 2016-08-17 20:28:13,675 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:28:13,679 WARNING celery.redirected 2016-08-17 20:28:13,679 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 27, 13, 664609), 'desktop_state_2': 'DELETED'}
2016-08-17 20:28:13,682 WARNING celery.redirected 2016-08-17 20:28:13,682 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:28:13,683 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:28:13,691 INFO celery.worker.job Task schedule_clean_desktops[1f699eb0-43ce-4a9f-8afe-37a8d236f598] succeeded in 0.02810898500320036s: None
2016-08-17 20:28:28,050 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:28:28,050 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:28:28,056 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:28:28,056 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:28:28,061 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:28:28,061 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:28:28,062 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:28:28,062 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:29:03,046 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:29:03,046 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:29:03,047 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:29:03,047 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:29:03,049 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:29:03,070 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:29:03,070 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:29:03,077 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:29:03,077 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:29:03,082 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:29:03,083 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:29:03,083 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:29:03,083 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:29:03,690 INFO celery.worker.strategy Received task: schedule_start_lesson[9f6aa983-bb4b-4615-9f02-d8593a925d6f]
2016-08-17 20:29:03,692 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:29:03,692 INFO celery Scheduling start lesson tasks
2016-08-17 20:29:03,693 WARNING celery.redirected 2016-08-17 20:29:03,693 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:29:03,694 WARNING celery.redirected 2016-08-17 20:29:03,694 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:29:03,695 WARNING celery.redirected 2016-08-17 20:29:03,695 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:29:03,698 WARNING celery.redirected 2016-08-17 20:29:03,698 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:29:03,699 WARNING celery.redirected 2016-08-17 20:29:03,699 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 29, 3, 696495), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 39, 3, 696495)}
2016-08-17 20:29:03,701 WARNING celery.redirected 2016-08-17 20:29:03,701 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:29:03,705 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:29:03,719 INFO celery.worker.job Task schedule_start_lesson[9f6aa983-bb4b-4615-9f02-d8593a925d6f] succeeded in 0.027749646003940143s: None
2016-08-17 20:29:13,080 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:29:13,617 INFO celery.worker.strategy Received task: schedule_clean_desktops[20f71ce0-aaa7-4554-8eec-ca6f58b65307]
2016-08-17 20:29:13,620 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:29:13,621 WARNING celery.redirected 2016-08-17 20:29:13,621 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:29:13,622 WARNING celery.redirected 2016-08-17 20:29:13,622 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:29:13,622 WARNING celery.redirected 2016-08-17 20:29:13,622 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:29:13,628 WARNING celery.redirected 2016-08-17 20:29:13,628 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:29:13,629 WARNING celery.redirected 2016-08-17 20:29:13,629 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 28, 13, 620773)}
2016-08-17 20:29:13,634 WARNING celery.redirected 2016-08-17 20:29:13,634 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:29:13,637 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:29:13,644 INFO celery.worker.job Task schedule_clean_desktops[20f71ce0-aaa7-4554-8eec-ca6f58b65307] succeeded in 0.024851339003362227s: None
2016-08-17 20:29:33,094 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:29:33,095 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:29:33,099 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:29:33,099 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:29:33,105 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:29:33,106 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:29:33,106 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:29:33,106 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:30:03,084 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:30:03,108 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:30:03,108 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:30:03,111 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:30:03,111 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:30:03,115 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:30:03,115 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:30:03,116 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:30:03,116 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:30:04,035 INFO celery.worker.strategy Received task: schedule_start_lesson[53f2da2f-eb3a-4f0c-98c8-458df3287d6f]
2016-08-17 20:30:04,037 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:30:04,037 INFO celery Scheduling start lesson tasks
2016-08-17 20:30:04,038 WARNING celery.redirected 2016-08-17 20:30:04,038 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:30:04,039 WARNING celery.redirected 2016-08-17 20:30:04,039 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:30:04,040 WARNING celery.redirected 2016-08-17 20:30:04,039 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:30:04,044 WARNING celery.redirected 2016-08-17 20:30:04,044 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:30:04,044 WARNING celery.redirected 2016-08-17 20:30:04,044 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 30, 4, 41539), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 40, 4, 41539)}
2016-08-17 20:30:04,047 WARNING celery.redirected 2016-08-17 20:30:04,046 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:30:04,048 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:30:04,059 INFO celery.worker.job Task schedule_start_lesson[53f2da2f-eb3a-4f0c-98c8-458df3287d6f] succeeded in 0.02230306300043594s: None
2016-08-17 20:30:13,116 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:30:14,026 INFO celery.worker.strategy Received task: schedule_clean_desktops[01b8ad02-2fb5-44a1-8376-c504512a2e6f]
2016-08-17 20:30:14,033 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:30:14,035 WARNING celery.redirected 2016-08-17 20:30:14,035 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:30:14,037 WARNING celery.redirected 2016-08-17 20:30:14,036 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:30:14,038 WARNING celery.redirected 2016-08-17 20:30:14,037 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:30:14,042 WARNING celery.redirected 2016-08-17 20:30:14,041 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:30:14,042 WARNING celery.redirected 2016-08-17 20:30:14,042 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 29, 14, 34638), 'desktop_state_2': 'DELETED'}
2016-08-17 20:30:14,045 WARNING celery.redirected 2016-08-17 20:30:14,044 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:30:14,049 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:30:14,060 INFO celery.worker.job Task schedule_clean_desktops[01b8ad02-2fb5-44a1-8376-c504512a2e6f] succeeded in 0.027392242998757865s: None
2016-08-17 20:30:33,130 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:30:33,130 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:30:33,134 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:30:33,134 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:30:33,140 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:30:33,140 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:30:33,140 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:30:33,141 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:31:03,128 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:31:03,152 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:31:03,152 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:31:03,155 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:31:03,155 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:31:03,158 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:31:03,158 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:31:03,158 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:31:03,159 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:31:04,182 INFO celery.worker.strategy Received task: schedule_start_lesson[7292d71e-a20e-43bc-93bb-4b4a9b80a2fd]
2016-08-17 20:31:04,183 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:31:04,184 INFO celery Scheduling start lesson tasks
2016-08-17 20:31:04,186 WARNING celery.redirected 2016-08-17 20:31:04,185 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:31:04,187 WARNING celery.redirected 2016-08-17 20:31:04,187 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:31:04,188 WARNING celery.redirected 2016-08-17 20:31:04,188 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:31:04,197 WARNING celery.redirected 2016-08-17 20:31:04,196 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:31:04,199 WARNING celery.redirected 2016-08-17 20:31:04,198 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 31, 4, 193143), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 41, 4, 193143)}
2016-08-17 20:31:04,202 WARNING celery.redirected 2016-08-17 20:31:04,202 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:31:04,203 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:31:04,210 INFO celery.worker.job Task schedule_start_lesson[7292d71e-a20e-43bc-93bb-4b4a9b80a2fd] succeeded in 0.02678463899792405s: None
2016-08-17 20:31:13,154 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:31:14,119 INFO celery.worker.strategy Received task: schedule_clean_desktops[5a9ab07b-9506-400d-ab76-fd94a05a77f4]
2016-08-17 20:31:14,121 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:31:14,124 WARNING celery.redirected 2016-08-17 20:31:14,123 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:31:14,126 WARNING celery.redirected 2016-08-17 20:31:14,126 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:31:14,127 WARNING celery.redirected 2016-08-17 20:31:14,127 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:31:14,132 WARNING celery.redirected 2016-08-17 20:31:14,132 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:31:14,133 WARNING celery.redirected 2016-08-17 20:31:14,133 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 30, 14, 122529), 'desktop_state_2': 'DELETED'}
2016-08-17 20:31:14,139 WARNING celery.redirected 2016-08-17 20:31:14,138 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:31:14,140 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:31:14,148 INFO celery.worker.job Task schedule_clean_desktops[5a9ab07b-9506-400d-ab76-fd94a05a77f4] succeeded in 0.027309712997521274s: None
2016-08-17 20:31:33,173 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:31:33,174 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:31:33,177 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:31:33,177 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:31:33,187 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:31:33,188 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:31:33,188 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:31:33,188 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:32:03,177 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:32:03,237 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:32:03,238 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:32:03,244 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:32:03,245 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:32:03,250 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:32:03,250 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:32:03,251 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:32:03,251 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:32:04,296 INFO celery.worker.strategy Received task: schedule_start_lesson[a11e9f9b-bf9e-4b21-abd5-18eac7dca391]
2016-08-17 20:32:04,298 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:32:04,298 INFO celery Scheduling start lesson tasks
2016-08-17 20:32:04,300 WARNING celery.redirected 2016-08-17 20:32:04,300 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:32:04,302 WARNING celery.redirected 2016-08-17 20:32:04,302 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:32:04,303 WARNING celery.redirected 2016-08-17 20:32:04,302 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:32:04,311 WARNING celery.redirected 2016-08-17 20:32:04,311 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:32:04,312 WARNING celery.redirected 2016-08-17 20:32:04,311 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 32, 4, 306745), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 42, 4, 306745)}
2016-08-17 20:32:04,314 WARNING celery.redirected 2016-08-17 20:32:04,314 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:32:04,315 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:32:04,330 INFO celery.worker.job Task schedule_start_lesson[a11e9f9b-bf9e-4b21-abd5-18eac7dca391] succeeded in 0.03214233700418845s: None
2016-08-17 20:32:13,265 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:32:13,727 INFO celery.worker.strategy Received task: schedule_clean_desktops[25f8a14c-1c96-4075-b3e1-84675432c862]
2016-08-17 20:32:13,731 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:32:13,736 WARNING celery.redirected 2016-08-17 20:32:13,735 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:32:13,741 WARNING celery.redirected 2016-08-17 20:32:13,741 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:32:13,743 WARNING celery.redirected 2016-08-17 20:32:13,743 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:32:13,753 WARNING celery.redirected 2016-08-17 20:32:13,753 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:32:13,755 WARNING celery.redirected 2016-08-17 20:32:13,754 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 31, 13, 733075), 'desktop_state_2': 'DELETED'}
2016-08-17 20:32:13,762 WARNING celery.redirected 2016-08-17 20:32:13,761 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:32:13,770 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:32:13,797 INFO celery.worker.job Task schedule_clean_desktops[25f8a14c-1c96-4075-b3e1-84675432c862] succeeded in 0.06616107900481438s: None
2016-08-17 20:32:33,299 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:32:33,300 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:32:33,303 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:32:33,303 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:32:33,308 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:32:33,309 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:32:33,309 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:32:33,309 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:33:03,295 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:33:03,313 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:33:03,314 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:33:03,316 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:33:03,316 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:33:03,321 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:33:03,321 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:33:03,322 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:33:03,322 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:33:04,002 INFO celery.worker.strategy Received task: schedule_start_lesson[b3e83d08-4ef8-44d5-8585-07d6fa1cae78]
2016-08-17 20:33:04,003 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:33:04,004 INFO celery Scheduling start lesson tasks
2016-08-17 20:33:04,005 WARNING celery.redirected 2016-08-17 20:33:04,005 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:33:04,006 WARNING celery.redirected 2016-08-17 20:33:04,006 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:33:04,006 WARNING celery.redirected 2016-08-17 20:33:04,006 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:33:04,012 WARNING celery.redirected 2016-08-17 20:33:04,011 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:33:04,012 WARNING celery.redirected 2016-08-17 20:33:04,012 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 33, 4, 8827), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 43, 4, 8827)}
2016-08-17 20:33:04,015 WARNING celery.redirected 2016-08-17 20:33:04,015 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:33:04,016 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:33:04,028 INFO celery.worker.job Task schedule_start_lesson[b3e83d08-4ef8-44d5-8585-07d6fa1cae78] succeeded in 0.02462791600555647s: None
2016-08-17 20:33:13,320 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:33:13,674 INFO celery.worker.strategy Received task: schedule_clean_desktops[311a4417-aeab-49b6-b868-60303b0a2c26]
2016-08-17 20:33:13,676 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:33:13,678 WARNING celery.redirected 2016-08-17 20:33:13,678 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:33:13,680 WARNING celery.redirected 2016-08-17 20:33:13,680 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:33:13,681 WARNING celery.redirected 2016-08-17 20:33:13,681 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:33:13,686 WARNING celery.redirected 2016-08-17 20:33:13,686 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:33:13,687 WARNING celery.redirected 2016-08-17 20:33:13,687 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 32, 13, 677497)}
2016-08-17 20:33:13,692 WARNING celery.redirected 2016-08-17 20:33:13,691 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:33:13,695 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:33:13,708 INFO celery.worker.job Task schedule_clean_desktops[311a4417-aeab-49b6-b868-60303b0a2c26] succeeded in 0.03183064199401997s: None
2016-08-17 20:33:33,369 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:33:33,369 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:33:33,375 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:33:33,375 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:33:33,381 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:33:33,381 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:33:33,381 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:33:33,382 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:34:03,373 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:34:03,400 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:34:03,401 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:34:03,403 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:34:03,403 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:34:03,406 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:34:03,407 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:34:03,407 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:34:03,407 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:34:03,901 INFO celery.worker.strategy Received task: schedule_start_lesson[f57701c8-cd63-492c-aaf2-e26a35fa3795]
2016-08-17 20:34:03,904 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:34:03,907 INFO celery Scheduling start lesson tasks
2016-08-17 20:34:03,908 WARNING celery.redirected 2016-08-17 20:34:03,908 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:34:03,909 WARNING celery.redirected 2016-08-17 20:34:03,909 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:34:03,910 WARNING celery.redirected 2016-08-17 20:34:03,910 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:34:03,915 WARNING celery.redirected 2016-08-17 20:34:03,915 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:34:03,916 WARNING celery.redirected 2016-08-17 20:34:03,916 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 34, 3, 912156), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 44, 3, 912156)}
2016-08-17 20:34:03,919 WARNING celery.redirected 2016-08-17 20:34:03,919 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:34:03,921 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:34:03,934 INFO celery.worker.job Task schedule_start_lesson[f57701c8-cd63-492c-aaf2-e26a35fa3795] succeeded in 0.030357233998074662s: None
2016-08-17 20:34:13,399 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:34:13,910 INFO celery.worker.strategy Received task: schedule_clean_desktops[0fdeedc1-fb39-487e-9d63-064d6230b8a1]
2016-08-17 20:34:13,916 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:34:13,922 WARNING celery.redirected 2016-08-17 20:34:13,922 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:34:13,924 WARNING celery.redirected 2016-08-17 20:34:13,924 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:34:13,925 WARNING celery.redirected 2016-08-17 20:34:13,925 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:34:13,932 WARNING celery.redirected 2016-08-17 20:34:13,931 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:34:13,932 WARNING celery.redirected 2016-08-17 20:34:13,932 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 33, 13, 919200)}
2016-08-17 20:34:13,936 WARNING celery.redirected 2016-08-17 20:34:13,936 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:34:13,940 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:34:13,951 INFO celery.worker.job Task schedule_clean_desktops[0fdeedc1-fb39-487e-9d63-064d6230b8a1] succeeded in 0.03453416399861453s: None
2016-08-17 20:34:33,420 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:34:33,420 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:34:33,425 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:34:33,426 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:34:33,431 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:34:33,431 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:34:33,431 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:34:33,431 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:35:03,410 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:35:03,433 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:35:03,434 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:35:03,439 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:35:03,439 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:35:03,446 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:35:03,446 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:35:03,447 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:35:03,447 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:35:04,501 INFO celery.worker.strategy Received task: schedule_start_lesson[94b5cd02-31c5-4268-928b-254c426add71]
2016-08-17 20:35:04,503 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:35:04,504 INFO celery Scheduling start lesson tasks
2016-08-17 20:35:04,505 WARNING celery.redirected 2016-08-17 20:35:04,505 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:35:04,506 WARNING celery.redirected 2016-08-17 20:35:04,506 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:35:04,507 WARNING celery.redirected 2016-08-17 20:35:04,506 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:35:04,511 WARNING celery.redirected 2016-08-17 20:35:04,510 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:35:04,511 WARNING celery.redirected 2016-08-17 20:35:04,511 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 35, 4, 508377), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 45, 4, 508377)}
2016-08-17 20:35:04,513 WARNING celery.redirected 2016-08-17 20:35:04,513 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:35:04,514 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:35:04,521 INFO celery.worker.job Task schedule_start_lesson[94b5cd02-31c5-4268-928b-254c426add71] succeeded in 0.018594676999782678s: None
2016-08-17 20:35:13,442 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:35:14,237 INFO celery.worker.strategy Received task: schedule_clean_desktops[6cd8fc0f-73a2-4e99-b715-ebb0f0b7385b]
2016-08-17 20:35:14,238 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:35:14,240 WARNING celery.redirected 2016-08-17 20:35:14,240 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:35:14,242 WARNING celery.redirected 2016-08-17 20:35:14,242 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:35:14,243 WARNING celery.redirected 2016-08-17 20:35:14,243 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:35:14,249 WARNING celery.redirected 2016-08-17 20:35:14,249 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:35:14,250 WARNING celery.redirected 2016-08-17 20:35:14,250 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 34, 14, 239598)}
2016-08-17 20:35:14,252 WARNING celery.redirected 2016-08-17 20:35:14,252 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:35:14,253 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:35:14,259 INFO celery.worker.job Task schedule_clean_desktops[6cd8fc0f-73a2-4e99-b715-ebb0f0b7385b] succeeded in 0.021335156001441646s: None
2016-08-17 20:35:33,449 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:35:33,449 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:35:33,453 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:35:33,453 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:35:33,461 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:35:33,462 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:35:33,462 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:35:33,462 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:36:03,441 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:36:03,461 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:36:03,461 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:36:03,463 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:36:03,464 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:36:03,468 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:36:03,468 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:36:03,469 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:36:03,469 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:36:04,381 INFO celery.worker.strategy Received task: schedule_start_lesson[3b4d9bce-6531-424a-b91b-4365c322a1d9]
2016-08-17 20:36:04,382 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:36:04,382 INFO celery Scheduling start lesson tasks
2016-08-17 20:36:04,384 WARNING celery.redirected 2016-08-17 20:36:04,384 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:36:04,386 WARNING celery.redirected 2016-08-17 20:36:04,386 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:36:04,387 WARNING celery.redirected 2016-08-17 20:36:04,387 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:36:04,392 WARNING celery.redirected 2016-08-17 20:36:04,392 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:36:04,393 WARNING celery.redirected 2016-08-17 20:36:04,393 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 36, 4, 389487), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 46, 4, 389487)}
2016-08-17 20:36:04,396 WARNING celery.redirected 2016-08-17 20:36:04,395 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:36:04,397 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:36:04,411 INFO celery.worker.job Task schedule_start_lesson[3b4d9bce-6531-424a-b91b-4365c322a1d9] succeeded in 0.02931008699670201s: None
2016-08-17 20:36:13,467 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:36:14,391 INFO celery.worker.strategy Received task: schedule_clean_desktops[bef8941c-fa9f-4401-bac0-d731879f9cc7]
2016-08-17 20:36:14,392 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:36:14,394 WARNING celery.redirected 2016-08-17 20:36:14,394 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:36:14,396 WARNING celery.redirected 2016-08-17 20:36:14,396 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:36:14,396 WARNING celery.redirected 2016-08-17 20:36:14,396 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:36:14,402 WARNING celery.redirected 2016-08-17 20:36:14,402 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:36:14,403 WARNING celery.redirected 2016-08-17 20:36:14,403 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 35, 14, 393596), 'desktop_state_2': 'DELETED'}
2016-08-17 20:36:14,407 WARNING celery.redirected 2016-08-17 20:36:14,407 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:36:14,409 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:36:14,420 INFO celery.worker.job Task schedule_clean_desktops[bef8941c-fa9f-4401-bac0-d731879f9cc7] succeeded in 0.027792649998445995s: None
2016-08-17 20:36:33,482 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:36:33,482 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:36:33,485 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:36:33,486 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:36:33,491 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:36:33,491 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:36:33,492 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:36:33,492 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:37:03,479 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:37:03,568 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:37:03,569 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:37:03,572 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:37:03,573 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:37:03,578 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:37:03,579 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:37:03,580 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:37:03,580 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:37:04,652 INFO celery.worker.strategy Received task: schedule_start_lesson[3a9fc97f-733f-4061-83f2-07710de4e9d8]
2016-08-17 20:37:04,659 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:37:04,660 INFO celery Scheduling start lesson tasks
2016-08-17 20:37:04,664 WARNING celery.redirected 2016-08-17 20:37:04,663 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:37:04,665 WARNING celery.redirected 2016-08-17 20:37:04,665 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:37:04,666 WARNING celery.redirected 2016-08-17 20:37:04,666 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:37:04,670 WARNING celery.redirected 2016-08-17 20:37:04,669 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:37:04,670 WARNING celery.redirected 2016-08-17 20:37:04,670 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 37, 4, 667702), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 47, 4, 667702)}
2016-08-17 20:37:04,672 WARNING celery.redirected 2016-08-17 20:37:04,672 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:37:04,673 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:37:04,682 INFO celery.worker.job Task schedule_start_lesson[3a9fc97f-733f-4061-83f2-07710de4e9d8] succeeded in 0.0229843319975771s: None
2016-08-17 20:37:13,574 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:37:14,621 INFO celery.worker.strategy Received task: schedule_clean_desktops[9b50500c-f372-48bf-aefd-8924ab047f47]
2016-08-17 20:37:14,622 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:37:14,624 WARNING celery.redirected 2016-08-17 20:37:14,624 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:37:14,625 WARNING celery.redirected 2016-08-17 20:37:14,625 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:37:14,626 WARNING celery.redirected 2016-08-17 20:37:14,626 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:37:14,629 WARNING celery.redirected 2016-08-17 20:37:14,629 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:37:14,630 WARNING celery.redirected 2016-08-17 20:37:14,630 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 36, 14, 623519)}
2016-08-17 20:37:14,634 WARNING celery.redirected 2016-08-17 20:37:14,633 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:37:14,642 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:37:14,655 INFO celery.worker.job Task schedule_clean_desktops[9b50500c-f372-48bf-aefd-8924ab047f47] succeeded in 0.03256581399909919s: None
2016-08-17 20:37:33,594 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:37:33,595 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:37:33,600 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:37:33,601 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:37:33,610 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:37:33,610 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:37:33,611 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:37:33,611 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:38:03,598 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:38:03,620 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:38:03,620 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:38:03,623 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:38:03,623 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:38:03,627 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:38:03,627 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:38:03,627 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:38:03,627 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:38:03,759 INFO celery.worker.strategy Received task: schedule_start_lesson[76894b6c-357b-4178-9062-11640be38fe8]
2016-08-17 20:38:03,760 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:38:03,761 INFO celery Scheduling start lesson tasks
2016-08-17 20:38:03,763 WARNING celery.redirected 2016-08-17 20:38:03,763 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:38:03,765 WARNING celery.redirected 2016-08-17 20:38:03,765 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:38:03,766 WARNING celery.redirected 2016-08-17 20:38:03,766 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:38:03,775 WARNING celery.redirected 2016-08-17 20:38:03,775 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:38:03,776 WARNING celery.redirected 2016-08-17 20:38:03,776 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 38, 3, 769727), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 48, 3, 769727)}
2016-08-17 20:38:03,778 WARNING celery.redirected 2016-08-17 20:38:03,777 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:38:03,779 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:38:03,791 INFO celery.worker.job Task schedule_start_lesson[76894b6c-357b-4178-9062-11640be38fe8] succeeded in 0.0302678959997138s: None
2016-08-17 20:38:18,620 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:38:18,785 INFO celery.worker.strategy Received task: schedule_clean_desktops[c99c36ee-192b-43a3-803c-43761c4e3b7d]
2016-08-17 20:38:18,786 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:38:18,789 WARNING celery.redirected 2016-08-17 20:38:18,788 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:38:18,790 WARNING celery.redirected 2016-08-17 20:38:18,790 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:38:18,791 WARNING celery.redirected 2016-08-17 20:38:18,791 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:38:18,797 WARNING celery.redirected 2016-08-17 20:38:18,796 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:38:18,798 WARNING celery.redirected 2016-08-17 20:38:18,798 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 37, 18, 787944)}
2016-08-17 20:38:18,804 WARNING celery.redirected 2016-08-17 20:38:18,803 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:38:18,806 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:38:18,816 INFO celery.worker.job Task schedule_clean_desktops[c99c36ee-192b-43a3-803c-43761c4e3b7d] succeeded in 0.029612626000016462s: None
2016-08-17 20:38:33,647 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:38:33,648 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:38:33,653 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:38:33,654 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:38:33,660 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:38:33,660 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:38:33,661 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:38:33,661 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:39:08,651 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:39:08,652 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:39:08,652 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:39:08,653 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:39:08,658 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:39:08,676 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:39:08,677 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:39:08,679 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:39:08,679 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:39:08,683 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:39:08,683 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:39:08,684 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:39:08,684 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:39:09,022 INFO celery.worker.strategy Received task: schedule_start_lesson[fd3c1d6e-f994-427e-872c-40241e23eccc]
2016-08-17 20:39:09,023 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:39:09,024 INFO celery Scheduling start lesson tasks
2016-08-17 20:39:09,025 WARNING celery.redirected 2016-08-17 20:39:09,025 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:39:09,026 WARNING celery.redirected 2016-08-17 20:39:09,026 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:39:09,027 WARNING celery.redirected 2016-08-17 20:39:09,026 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:39:09,031 WARNING celery.redirected 2016-08-17 20:39:09,030 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:39:09,031 WARNING celery.redirected 2016-08-17 20:39:09,031 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 39, 9, 28726), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 49, 9, 28726)}
2016-08-17 20:39:09,034 WARNING celery.redirected 2016-08-17 20:39:09,034 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:39:09,036 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:39:09,046 INFO celery.worker.job Task schedule_start_lesson[fd3c1d6e-f994-427e-872c-40241e23eccc] succeeded in 0.022667504999844823s: None
2016-08-17 20:39:23,680 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:39:23,990 INFO celery.worker.strategy Received task: schedule_clean_desktops[5783712e-c62b-4763-8191-e338e250a8b1]
2016-08-17 20:39:23,992 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:39:23,997 WARNING celery.redirected 2016-08-17 20:39:23,997 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:39:23,999 WARNING celery.redirected 2016-08-17 20:39:23,999 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:39:24,000 WARNING celery.redirected 2016-08-17 20:39:24,000 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:39:24,005 WARNING celery.redirected 2016-08-17 20:39:24,005 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:39:24,006 WARNING celery.redirected 2016-08-17 20:39:24,006 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 38, 23, 995206)}
2016-08-17 20:39:24,008 WARNING celery.redirected 2016-08-17 20:39:24,008 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:39:24,009 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:39:24,017 INFO celery.worker.job Task schedule_clean_desktops[5783712e-c62b-4763-8191-e338e250a8b1] succeeded in 0.02449600699765142s: None
2016-08-17 20:39:38,701 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:39:38,702 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:39:38,706 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:39:38,706 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:39:38,711 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:39:38,711 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:39:38,712 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:39:38,712 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:40:13,702 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:40:13,702 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:40:13,703 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:40:13,703 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:40:13,706 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:40:13,726 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:40:13,727 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:40:13,732 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:40:13,732 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:40:13,736 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:40:13,737 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:40:13,737 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:40:13,737 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:40:14,250 INFO celery.worker.strategy Received task: schedule_start_lesson[2376ccc6-7bd4-4b08-84ce-9423a9392aad]
2016-08-17 20:40:14,252 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:40:14,252 INFO celery Scheduling start lesson tasks
2016-08-17 20:40:14,255 WARNING celery.redirected 2016-08-17 20:40:14,254 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:40:14,257 WARNING celery.redirected 2016-08-17 20:40:14,257 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:40:14,258 WARNING celery.redirected 2016-08-17 20:40:14,257 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:40:14,267 WARNING celery.redirected 2016-08-17 20:40:14,266 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:40:14,268 WARNING celery.redirected 2016-08-17 20:40:14,267 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 40, 14, 261257), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 50, 14, 261257)}
2016-08-17 20:40:14,269 WARNING celery.redirected 2016-08-17 20:40:14,269 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:40:14,271 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:40:14,281 INFO celery.worker.job Task schedule_start_lesson[2376ccc6-7bd4-4b08-84ce-9423a9392aad] succeeded in 0.02956840399565408s: None
2016-08-17 20:40:28,738 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:40:29,342 INFO celery.worker.strategy Received task: schedule_clean_desktops[2f3e5b35-e95a-4977-b701-bf3a32082e76]
2016-08-17 20:40:29,345 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:40:29,347 WARNING celery.redirected 2016-08-17 20:40:29,346 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:40:29,347 WARNING celery.redirected 2016-08-17 20:40:29,347 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:40:29,348 WARNING celery.redirected 2016-08-17 20:40:29,348 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:40:29,353 WARNING celery.redirected 2016-08-17 20:40:29,353 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:40:29,354 WARNING celery.redirected 2016-08-17 20:40:29,354 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 39, 29, 346271)}
2016-08-17 20:40:29,357 WARNING celery.redirected 2016-08-17 20:40:29,357 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:40:29,359 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:40:29,373 INFO celery.worker.job Task schedule_clean_desktops[2f3e5b35-e95a-4977-b701-bf3a32082e76] succeeded in 0.028205552000144962s: None
2016-08-17 20:40:43,756 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:40:43,756 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:40:43,761 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:40:43,761 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:40:43,769 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:40:43,770 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:40:43,770 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:40:43,770 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:41:18,751 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:41:18,751 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:41:18,752 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:41:18,752 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:41:18,754 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:41:18,780 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:41:18,780 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:41:18,783 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:41:18,783 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:41:18,787 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:41:18,787 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:41:18,788 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:41:18,788 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:41:19,537 INFO celery.worker.strategy Received task: schedule_start_lesson[a90bb8ba-b3c3-43f3-86cd-f07f2d0c0f13]
2016-08-17 20:41:19,538 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:41:19,539 INFO celery Scheduling start lesson tasks
2016-08-17 20:41:19,540 WARNING celery.redirected 2016-08-17 20:41:19,540 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:41:19,542 WARNING celery.redirected 2016-08-17 20:41:19,542 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:41:19,543 WARNING celery.redirected 2016-08-17 20:41:19,543 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:41:19,552 WARNING celery.redirected 2016-08-17 20:41:19,551 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:41:19,554 WARNING celery.redirected 2016-08-17 20:41:19,553 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 41, 19, 545833), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 51, 19, 545833)}
2016-08-17 20:41:19,557 WARNING celery.redirected 2016-08-17 20:41:19,556 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:41:19,558 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:41:19,569 INFO celery.worker.job Task schedule_start_lesson[a90bb8ba-b3c3-43f3-86cd-f07f2d0c0f13] succeeded in 0.030407366997678764s: None
2016-08-17 20:41:33,785 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:41:34,681 INFO celery.worker.strategy Received task: schedule_clean_desktops[eb1e9006-0c5b-46f6-b897-77d216fd9e28]
2016-08-17 20:41:34,684 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:41:34,688 WARNING celery.redirected 2016-08-17 20:41:34,688 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:41:34,690 WARNING celery.redirected 2016-08-17 20:41:34,690 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:41:34,691 WARNING celery.redirected 2016-08-17 20:41:34,691 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:41:34,695 WARNING celery.redirected 2016-08-17 20:41:34,694 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:41:34,695 WARNING celery.redirected 2016-08-17 20:41:34,695 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 40, 34, 687592)}
2016-08-17 20:41:34,698 WARNING celery.redirected 2016-08-17 20:41:34,698 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:41:34,699 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:41:34,708 INFO celery.worker.job Task schedule_clean_desktops[eb1e9006-0c5b-46f6-b897-77d216fd9e28] succeeded in 0.02441888500470668s: None
2016-08-17 20:41:48,807 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:41:48,807 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:41:48,810 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:41:48,810 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:41:48,818 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:41:48,819 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:41:48,819 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:41:48,819 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:42:23,803 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:42:23,803 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:42:23,803 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:42:23,804 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:42:23,806 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:42:23,829 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:42:23,830 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:42:23,832 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:42:23,832 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:42:23,837 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:42:23,837 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:42:23,838 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:42:23,838 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:42:24,251 INFO celery.worker.strategy Received task: schedule_start_lesson[536e2c2a-ecdd-4d0f-bf2b-6ae0a95b58e2]
2016-08-17 20:42:24,255 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:42:24,257 INFO celery Scheduling start lesson tasks
2016-08-17 20:42:24,259 WARNING celery.redirected 2016-08-17 20:42:24,258 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:42:24,261 WARNING celery.redirected 2016-08-17 20:42:24,260 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:42:24,262 WARNING celery.redirected 2016-08-17 20:42:24,261 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:42:24,266 WARNING celery.redirected 2016-08-17 20:42:24,266 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:42:24,267 WARNING celery.redirected 2016-08-17 20:42:24,267 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 42, 24, 263696), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 52, 24, 263696)}
2016-08-17 20:42:24,272 WARNING celery.redirected 2016-08-17 20:42:24,272 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:42:24,274 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:42:24,286 INFO celery.worker.job Task schedule_start_lesson[536e2c2a-ecdd-4d0f-bf2b-6ae0a95b58e2] succeeded in 0.031155699005466886s: None
2016-08-17 20:42:38,823 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:42:39,319 INFO celery.worker.strategy Received task: schedule_clean_desktops[e5c10e3a-af53-4042-9943-bcd6430ad38a]
2016-08-17 20:42:39,321 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:42:39,323 WARNING celery.redirected 2016-08-17 20:42:39,323 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:42:39,324 WARNING celery.redirected 2016-08-17 20:42:39,324 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:42:39,325 WARNING celery.redirected 2016-08-17 20:42:39,325 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:42:39,329 WARNING celery.redirected 2016-08-17 20:42:39,329 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:42:39,329 WARNING celery.redirected 2016-08-17 20:42:39,329 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 41, 39, 322595)}
2016-08-17 20:42:39,331 WARNING celery.redirected 2016-08-17 20:42:39,331 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:42:39,332 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:42:39,339 INFO celery.worker.job Task schedule_clean_desktops[e5c10e3a-af53-4042-9943-bcd6430ad38a] succeeded in 0.018381303001660854s: None
2016-08-17 20:42:53,844 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:42:53,844 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:42:53,854 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:42:53,855 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:42:53,863 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:42:53,863 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:42:53,863 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:42:53,863 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:43:28,846 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:43:28,846 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:43:28,846 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:43:28,847 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:43:28,849 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:43:28,869 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:43:28,869 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:43:28,872 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:43:28,872 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:43:28,875 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:43:28,875 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:43:28,876 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:43:28,876 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:43:29,504 INFO celery.worker.strategy Received task: schedule_start_lesson[e5680544-8a9d-48bc-926d-66a38a3798cd]
2016-08-17 20:43:29,506 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:43:29,507 INFO celery Scheduling start lesson tasks
2016-08-17 20:43:29,508 WARNING celery.redirected 2016-08-17 20:43:29,508 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:43:29,509 WARNING celery.redirected 2016-08-17 20:43:29,509 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:43:29,510 WARNING celery.redirected 2016-08-17 20:43:29,510 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:43:29,516 WARNING celery.redirected 2016-08-17 20:43:29,515 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:43:29,516 WARNING celery.redirected 2016-08-17 20:43:29,516 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 43, 29, 512512), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 53, 29, 512512)}
2016-08-17 20:43:29,519 WARNING celery.redirected 2016-08-17 20:43:29,519 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:43:29,521 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:43:29,529 INFO celery.worker.job Task schedule_start_lesson[e5680544-8a9d-48bc-926d-66a38a3798cd] succeeded in 0.02285511200170731s: None
2016-08-17 20:43:43,869 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:43:44,594 INFO celery.worker.strategy Received task: schedule_clean_desktops[b0fc33bc-fedb-40a9-a61c-cee6811411bf]
2016-08-17 20:43:44,596 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:43:44,599 WARNING celery.redirected 2016-08-17 20:43:44,598 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:43:44,600 WARNING celery.redirected 2016-08-17 20:43:44,600 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:43:44,601 WARNING celery.redirected 2016-08-17 20:43:44,601 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:43:44,610 WARNING celery.redirected 2016-08-17 20:43:44,609 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:43:44,611 WARNING celery.redirected 2016-08-17 20:43:44,611 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 42, 44, 597628)}
2016-08-17 20:43:44,615 WARNING celery.redirected 2016-08-17 20:43:44,614 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:43:44,616 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:43:44,628 INFO celery.worker.job Task schedule_clean_desktops[b0fc33bc-fedb-40a9-a61c-cee6811411bf] succeeded in 0.03188167899497785s: None
2016-08-17 20:43:58,878 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:43:58,878 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:43:58,882 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:43:58,882 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:43:58,887 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:43:58,887 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:43:58,888 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:43:58,888 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:44:33,872 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:44:33,872 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:44:33,873 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:44:33,873 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:44:33,875 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:44:33,891 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:44:33,891 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:44:33,895 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:44:33,895 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:44:33,902 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:44:33,902 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:44:33,903 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:44:33,903 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:44:34,840 INFO celery.worker.strategy Received task: schedule_start_lesson[352ca76f-9095-42d2-8c06-50fe3a8c1d19]
2016-08-17 20:44:34,841 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:44:34,842 INFO celery Scheduling start lesson tasks
2016-08-17 20:44:34,843 WARNING celery.redirected 2016-08-17 20:44:34,843 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:44:34,844 WARNING celery.redirected 2016-08-17 20:44:34,844 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:44:34,845 WARNING celery.redirected 2016-08-17 20:44:34,845 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:44:34,851 WARNING celery.redirected 2016-08-17 20:44:34,850 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:44:34,851 WARNING celery.redirected 2016-08-17 20:44:34,851 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 44, 34, 847677), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 54, 34, 847677)}
2016-08-17 20:44:34,854 WARNING celery.redirected 2016-08-17 20:44:34,854 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:44:34,858 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:44:34,870 INFO celery.worker.job Task schedule_start_lesson[352ca76f-9095-42d2-8c06-50fe3a8c1d19] succeeded in 0.029200750999734737s: None
2016-08-17 20:44:48,900 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:44:49,800 INFO celery.worker.strategy Received task: schedule_clean_desktops[6b983282-2d07-4eaa-8cab-ba8900665e90]
2016-08-17 20:44:49,802 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:44:49,805 WARNING celery.redirected 2016-08-17 20:44:49,804 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:44:49,807 WARNING celery.redirected 2016-08-17 20:44:49,806 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:44:49,809 WARNING celery.redirected 2016-08-17 20:44:49,808 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:44:49,816 WARNING celery.redirected 2016-08-17 20:44:49,815 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:44:49,817 WARNING celery.redirected 2016-08-17 20:44:49,816 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 43, 49, 803970)}
2016-08-17 20:44:49,819 WARNING celery.redirected 2016-08-17 20:44:49,819 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:44:49,820 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:44:49,828 INFO celery.worker.job Task schedule_clean_desktops[6b983282-2d07-4eaa-8cab-ba8900665e90] succeeded in 0.025574737002898473s: None
2016-08-17 20:45:03,927 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:45:03,928 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:45:03,931 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:45:03,931 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:45:03,936 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:45:03,936 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:45:03,936 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:45:03,936 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:45:38,924 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:45:38,924 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:45:38,924 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:45:38,925 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:45:38,927 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:45:38,948 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:45:38,948 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:45:38,951 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:45:38,952 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:45:38,955 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:45:38,956 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:45:38,956 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:45:38,956 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:45:39,533 INFO celery.worker.strategy Received task: schedule_start_lesson[4126ecb0-47cb-400d-b932-8b3ae3a7f6d6]
2016-08-17 20:45:39,535 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:45:39,536 INFO celery Scheduling start lesson tasks
2016-08-17 20:45:39,538 WARNING celery.redirected 2016-08-17 20:45:39,537 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:45:39,539 WARNING celery.redirected 2016-08-17 20:45:39,539 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:45:39,540 WARNING celery.redirected 2016-08-17 20:45:39,540 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:45:39,547 WARNING celery.redirected 2016-08-17 20:45:39,547 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:45:39,548 WARNING celery.redirected 2016-08-17 20:45:39,548 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 45, 39, 542105), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 55, 39, 542105)}
2016-08-17 20:45:39,551 WARNING celery.redirected 2016-08-17 20:45:39,551 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:45:39,553 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:45:39,566 INFO celery.worker.job Task schedule_start_lesson[4126ecb0-47cb-400d-b932-8b3ae3a7f6d6] succeeded in 0.031274804001441225s: None
2016-08-17 20:45:53,950 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:45:54,814 INFO celery.worker.strategy Received task: schedule_clean_desktops[9721221b-c827-41ae-84a2-7d8e83db1bcb]
2016-08-17 20:45:54,818 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:45:54,820 WARNING celery.redirected 2016-08-17 20:45:54,820 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:45:54,821 WARNING celery.redirected 2016-08-17 20:45:54,821 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:45:54,822 WARNING celery.redirected 2016-08-17 20:45:54,822 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:45:54,826 WARNING celery.redirected 2016-08-17 20:45:54,826 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:45:54,826 WARNING celery.redirected 2016-08-17 20:45:54,826 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 44, 54, 820135), 'desktop_state_2': 'DELETED'}
2016-08-17 20:45:54,828 WARNING celery.redirected 2016-08-17 20:45:54,828 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:45:54,830 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:45:54,846 INFO celery.worker.job Task schedule_clean_desktops[9721221b-c827-41ae-84a2-7d8e83db1bcb] succeeded in 0.02783128099690657s: None
2016-08-17 20:46:08,976 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:46:08,976 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:46:08,979 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:46:08,979 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:46:08,987 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:46:08,987 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:46:08,987 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:46:08,988 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:46:43,975 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:46:43,975 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:46:43,975 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:46:43,975 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:46:43,977 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:46:43,994 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:46:43,995 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:46:43,997 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:46:43,997 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:46:44,001 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:46:44,001 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:46:44,001 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:46:44,001 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:46:44,774 INFO celery.worker.strategy Received task: schedule_start_lesson[983c665d-844e-45d6-a554-79bcef2e1e50]
2016-08-17 20:46:44,779 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:46:44,780 INFO celery Scheduling start lesson tasks
2016-08-17 20:46:44,781 WARNING celery.redirected 2016-08-17 20:46:44,781 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:46:44,782 WARNING celery.redirected 2016-08-17 20:46:44,782 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:46:44,783 WARNING celery.redirected 2016-08-17 20:46:44,783 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:46:44,787 WARNING celery.redirected 2016-08-17 20:46:44,787 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:46:44,788 WARNING celery.redirected 2016-08-17 20:46:44,787 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 46, 44, 784821), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 56, 44, 784821)}
2016-08-17 20:46:44,789 WARNING celery.redirected 2016-08-17 20:46:44,789 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:46:44,791 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:46:44,801 INFO celery.worker.job Task schedule_start_lesson[983c665d-844e-45d6-a554-79bcef2e1e50] succeeded in 0.02295276999939233s: None
2016-08-17 20:46:58,993 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:46:59,762 INFO celery.worker.strategy Received task: schedule_clean_desktops[d0c7b183-175d-4e92-b363-3d8157a47c10]
2016-08-17 20:46:59,764 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:46:59,766 WARNING celery.redirected 2016-08-17 20:46:59,766 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:46:59,768 WARNING celery.redirected 2016-08-17 20:46:59,768 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:46:59,769 WARNING celery.redirected 2016-08-17 20:46:59,769 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:46:59,774 WARNING celery.redirected 2016-08-17 20:46:59,773 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:46:59,774 WARNING celery.redirected 2016-08-17 20:46:59,774 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 45, 59, 765756), 'desktop_state_2': 'DELETED'}
2016-08-17 20:46:59,776 WARNING celery.redirected 2016-08-17 20:46:59,776 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:46:59,781 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:46:59,793 INFO celery.worker.job Task schedule_clean_desktops[d0c7b183-175d-4e92-b363-3d8157a47c10] succeeded in 0.02854843500244897s: None
2016-08-17 20:47:14,013 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:47:14,014 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:47:14,017 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:47:14,017 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:47:14,029 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:47:14,030 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:47:14,030 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:47:14,030 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:47:44,024 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:47:44,042 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:47:44,042 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:47:44,045 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:47:44,045 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:47:44,048 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:47:44,049 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:47:44,049 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:47:44,049 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:47:45,138 INFO celery.worker.strategy Received task: schedule_start_lesson[33f2bb16-5e2e-43f4-886f-fe59fd9bcf7a]
2016-08-17 20:47:45,139 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:47:45,140 INFO celery Scheduling start lesson tasks
2016-08-17 20:47:45,141 WARNING celery.redirected 2016-08-17 20:47:45,141 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:47:45,142 WARNING celery.redirected 2016-08-17 20:47:45,142 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:47:45,143 WARNING celery.redirected 2016-08-17 20:47:45,143 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:47:45,147 WARNING celery.redirected 2016-08-17 20:47:45,147 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:47:45,147 WARNING celery.redirected 2016-08-17 20:47:45,147 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 47, 45, 144791), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 57, 45, 144791)}
2016-08-17 20:47:45,150 WARNING celery.redirected 2016-08-17 20:47:45,150 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:47:45,151 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:47:45,162 INFO celery.worker.job Task schedule_start_lesson[33f2bb16-5e2e-43f4-886f-fe59fd9bcf7a] succeeded in 0.022662318995571695s: None
2016-08-17 20:47:59,036 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:48:00,137 INFO celery.worker.strategy Received task: schedule_clean_desktops[4308967f-a3d1-4e38-9fc7-e76211281d0e]
2016-08-17 20:48:00,138 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:48:00,140 WARNING celery.redirected 2016-08-17 20:48:00,139 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:48:00,141 WARNING celery.redirected 2016-08-17 20:48:00,141 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:48:00,142 WARNING celery.redirected 2016-08-17 20:48:00,142 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:48:00,146 WARNING celery.redirected 2016-08-17 20:48:00,145 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:48:00,146 WARNING celery.redirected 2016-08-17 20:48:00,146 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 47, 0, 139258), 'desktop_state_2': 'DELETED'}
2016-08-17 20:48:00,148 WARNING celery.redirected 2016-08-17 20:48:00,148 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:48:00,149 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:48:00,160 INFO celery.worker.job Task schedule_clean_desktops[4308967f-a3d1-4e38-9fc7-e76211281d0e] succeeded in 0.021593546000076458s: None
2016-08-17 20:48:14,060 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:48:14,060 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:48:14,067 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:48:14,067 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:48:14,073 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:48:14,074 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:48:14,074 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:48:14,074 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:48:44,069 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:48:44,132 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:48:44,133 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:48:44,135 INFO celery.worker.strategy Received task: schedule_start_lesson[7ec9b881-2896-487b-891c-8e9de11d5d12]
2016-08-17 20:48:44,136 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:48:44,137 INFO celery Scheduling start lesson tasks
2016-08-17 20:48:44,138 WARNING celery.redirected 2016-08-17 20:48:44,138 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:48:44,140 WARNING celery.redirected 2016-08-17 20:48:44,140 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:48:44,141 WARNING celery.redirected 2016-08-17 20:48:44,140 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:48:44,146 WARNING celery.redirected 2016-08-17 20:48:44,146 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:48:44,147 WARNING celery.redirected 2016-08-17 20:48:44,147 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 48, 44, 143187), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 58, 44, 143187)}
2016-08-17 20:48:44,150 WARNING celery.redirected 2016-08-17 20:48:44,150 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:48:44,151 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:48:44,166 INFO celery.worker.job Task schedule_start_lesson[7ec9b881-2896-487b-891c-8e9de11d5d12] succeeded in 0.030172020000463817s: None
2016-08-17 20:48:44,333 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:48:44,334 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:48:44,338 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:48:44,338 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:48:44,338 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:48:44,338 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:48:59,333 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:48:59,449 INFO celery.worker.strategy Received task: schedule_clean_desktops[b7db6033-6640-49bc-9825-fbc6ed26ab48]
2016-08-17 20:48:59,450 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:48:59,452 WARNING celery.redirected 2016-08-17 20:48:59,452 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:48:59,453 WARNING celery.redirected 2016-08-17 20:48:59,453 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:48:59,454 WARNING celery.redirected 2016-08-17 20:48:59,454 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:48:59,459 WARNING celery.redirected 2016-08-17 20:48:59,459 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:48:59,460 WARNING celery.redirected 2016-08-17 20:48:59,460 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 47, 59, 451737), 'desktop_state_2': 'DELETED'}
2016-08-17 20:48:59,465 WARNING celery.redirected 2016-08-17 20:48:59,465 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:48:59,468 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:48:59,477 INFO celery.worker.job Task schedule_clean_desktops[b7db6033-6640-49bc-9825-fbc6ed26ab48] succeeded in 0.02719001000514254s: None
2016-08-17 20:49:14,364 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:49:14,365 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:49:14,367 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:49:14,368 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:49:14,374 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:49:14,375 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:49:14,375 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:49:14,375 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:49:44,367 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:49:44,394 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:49:44,395 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:49:44,397 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:49:44,397 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:49:44,403 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:49:44,403 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:49:44,404 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:49:44,404 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:49:45,228 INFO celery.worker.strategy Received task: schedule_start_lesson[a74575e3-74cf-4e82-acce-3b0ccedc15fe]
2016-08-17 20:49:45,230 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:49:45,230 INFO celery Scheduling start lesson tasks
2016-08-17 20:49:45,231 WARNING celery.redirected 2016-08-17 20:49:45,231 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:49:45,232 WARNING celery.redirected 2016-08-17 20:49:45,232 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:49:45,233 WARNING celery.redirected 2016-08-17 20:49:45,233 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:49:45,237 WARNING celery.redirected 2016-08-17 20:49:45,237 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:49:45,238 WARNING celery.redirected 2016-08-17 20:49:45,238 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 49, 45, 235158), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(20, 59, 45, 235158)}
2016-08-17 20:49:45,240 WARNING celery.redirected 2016-08-17 20:49:45,240 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:49:45,245 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:49:45,256 INFO celery.worker.job Task schedule_start_lesson[a74575e3-74cf-4e82-acce-3b0ccedc15fe] succeeded in 0.026756203005788848s: None
2016-08-17 20:49:59,397 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:50:00,570 INFO celery.worker.strategy Received task: schedule_clean_desktops[d688791e-41a5-4dad-bad6-810a77d1ec07]
2016-08-17 20:50:00,572 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:50:00,574 WARNING celery.redirected 2016-08-17 20:50:00,574 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:50:00,576 WARNING celery.redirected 2016-08-17 20:50:00,575 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:50:00,577 WARNING celery.redirected 2016-08-17 20:50:00,576 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:50:00,580 WARNING celery.redirected 2016-08-17 20:50:00,580 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:50:00,581 WARNING celery.redirected 2016-08-17 20:50:00,581 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 49, 0, 573211), 'desktop_state_2': 'DELETED'}
2016-08-17 20:50:00,585 WARNING celery.redirected 2016-08-17 20:50:00,585 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:50:00,588 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:50:00,599 INFO celery.worker.job Task schedule_clean_desktops[d688791e-41a5-4dad-bad6-810a77d1ec07] succeeded in 0.027540923001652118s: None
2016-08-17 20:50:14,484 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:50:14,484 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:50:14,488 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:50:14,488 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:50:14,496 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:50:14,496 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:50:14,497 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:50:14,497 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:50:44,488 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:50:44,868 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:50:44,869 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:50:44,871 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:50:44,871 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:50:44,877 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:50:44,877 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:50:44,877 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:50:44,878 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:50:45,897 INFO celery.worker.strategy Received task: schedule_start_lesson[ce9c6c16-f5ec-4791-a5d0-20929f4164dc]
2016-08-17 20:50:45,898 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:50:45,899 INFO celery Scheduling start lesson tasks
2016-08-17 20:50:45,900 WARNING celery.redirected 2016-08-17 20:50:45,900 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:50:45,902 WARNING celery.redirected 2016-08-17 20:50:45,902 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:50:45,902 WARNING celery.redirected 2016-08-17 20:50:45,902 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:50:45,908 WARNING celery.redirected 2016-08-17 20:50:45,907 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:50:45,908 WARNING celery.redirected 2016-08-17 20:50:45,908 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 50, 45, 904649), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 0, 45, 904649)}
2016-08-17 20:50:45,911 WARNING celery.redirected 2016-08-17 20:50:45,911 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:50:45,912 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:50:45,921 INFO celery.worker.job Task schedule_start_lesson[ce9c6c16-f5ec-4791-a5d0-20929f4164dc] succeeded in 0.02358130300126504s: None
2016-08-17 20:50:59,870 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:51:00,687 INFO celery.worker.strategy Received task: schedule_clean_desktops[43ffd7dc-9988-477e-a5e8-4471cfd078c4]
2016-08-17 20:51:00,688 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:51:00,690 WARNING celery.redirected 2016-08-17 20:51:00,690 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:51:00,691 WARNING celery.redirected 2016-08-17 20:51:00,691 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:51:00,692 WARNING celery.redirected 2016-08-17 20:51:00,691 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:51:00,695 WARNING celery.redirected 2016-08-17 20:51:00,695 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:51:00,695 WARNING celery.redirected 2016-08-17 20:51:00,695 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 50, 0, 689392)}
2016-08-17 20:51:00,697 WARNING celery.redirected 2016-08-17 20:51:00,697 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:51:00,698 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:51:00,705 INFO celery.worker.job Task schedule_clean_desktops[43ffd7dc-9988-477e-a5e8-4471cfd078c4] succeeded in 0.017196647000673693s: None
2016-08-17 20:51:14,895 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:51:14,895 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:51:14,897 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:51:14,898 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:51:14,903 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:51:14,903 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:51:14,903 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:51:14,903 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:51:44,911 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:51:44,911 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:51:44,912 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:51:44,913 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:51:44,916 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:51:44,941 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:51:44,941 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:51:44,943 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:51:44,943 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:51:44,946 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:51:44,947 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:51:44,947 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:51:44,948 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:51:45,543 INFO celery.worker.strategy Received task: schedule_start_lesson[6477dc51-f4da-4f2a-b0be-efb3940cec39]
2016-08-17 20:51:45,544 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:51:45,545 INFO celery Scheduling start lesson tasks
2016-08-17 20:51:45,547 WARNING celery.redirected 2016-08-17 20:51:45,546 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:51:45,549 WARNING celery.redirected 2016-08-17 20:51:45,548 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:51:45,549 WARNING celery.redirected 2016-08-17 20:51:45,549 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:51:45,554 WARNING celery.redirected 2016-08-17 20:51:45,554 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:51:45,555 WARNING celery.redirected 2016-08-17 20:51:45,555 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 51, 45, 551050), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 1, 45, 551050)}
2016-08-17 20:51:45,559 WARNING celery.redirected 2016-08-17 20:51:45,558 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:51:45,560 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:51:45,576 INFO celery.worker.job Task schedule_start_lesson[6477dc51-f4da-4f2a-b0be-efb3940cec39] succeeded in 0.03227654800139135s: None
2016-08-17 20:52:04,936 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:52:05,705 INFO celery.worker.strategy Received task: schedule_clean_desktops[80e0cba2-c80a-44b6-b353-75839b415be6]
2016-08-17 20:52:05,706 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:52:05,708 WARNING celery.redirected 2016-08-17 20:52:05,708 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:52:05,711 WARNING celery.redirected 2016-08-17 20:52:05,710 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:52:05,711 WARNING celery.redirected 2016-08-17 20:52:05,711 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:52:05,717 WARNING celery.redirected 2016-08-17 20:52:05,717 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:52:05,718 WARNING celery.redirected 2016-08-17 20:52:05,718 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 51, 5, 707783), 'desktop_state_2': 'DELETED'}
2016-08-17 20:52:05,725 WARNING celery.redirected 2016-08-17 20:52:05,725 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:52:05,727 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:52:05,737 INFO celery.worker.job Task schedule_clean_desktops[80e0cba2-c80a-44b6-b353-75839b415be6] succeeded in 0.030887353997968603s: None
2016-08-17 20:52:14,957 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:52:14,958 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:52:14,960 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:52:14,961 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:52:14,966 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:52:14,967 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:52:14,967 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:52:14,967 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:52:49,956 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:52:49,956 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:52:49,957 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:52:49,957 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:52:49,959 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:52:49,983 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:52:49,983 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:52:49,986 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:52:49,986 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:52:49,990 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:52:49,990 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:52:49,990 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:52:49,991 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:52:50,918 INFO celery.worker.strategy Received task: schedule_start_lesson[07eb22e4-5db4-4088-9148-c4b779f3f30b]
2016-08-17 20:52:50,920 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:52:50,921 INFO celery Scheduling start lesson tasks
2016-08-17 20:52:50,923 WARNING celery.redirected 2016-08-17 20:52:50,923 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:52:50,925 WARNING celery.redirected 2016-08-17 20:52:50,925 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:52:50,926 WARNING celery.redirected 2016-08-17 20:52:50,925 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:52:50,935 WARNING celery.redirected 2016-08-17 20:52:50,934 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:52:50,935 WARNING celery.redirected 2016-08-17 20:52:50,935 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 52, 50, 928524), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 2, 50, 928524)}
2016-08-17 20:52:50,937 WARNING celery.redirected 2016-08-17 20:52:50,937 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:52:50,938 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:52:50,945 INFO celery.worker.job Task schedule_start_lesson[07eb22e4-5db4-4088-9148-c4b779f3f30b] succeeded in 0.025194394002028275s: None
2016-08-17 20:53:09,978 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:53:10,985 INFO celery.worker.strategy Received task: schedule_clean_desktops[10463412-1162-4641-954c-7377e0903598]
2016-08-17 20:53:10,987 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:53:10,988 WARNING celery.redirected 2016-08-17 20:53:10,988 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:53:10,991 WARNING celery.redirected 2016-08-17 20:53:10,990 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:53:10,992 WARNING celery.redirected 2016-08-17 20:53:10,991 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:53:10,999 WARNING celery.redirected 2016-08-17 20:53:10,999 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:53:11,000 WARNING celery.redirected 2016-08-17 20:53:11,000 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 52, 10, 987884), 'desktop_state_2': 'DELETED'}
2016-08-17 20:53:11,004 WARNING celery.redirected 2016-08-17 20:53:11,004 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:53:11,005 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:53:11,017 INFO celery.worker.job Task schedule_clean_desktops[10463412-1162-4641-954c-7377e0903598] succeeded in 0.030746196993277408s: None
2016-08-17 20:53:20,004 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:53:20,004 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:53:20,007 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:53:20,007 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:53:20,011 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:53:20,011 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:53:20,012 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:53:20,012 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:53:54,994 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:53:54,994 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:53:54,994 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:53:54,994 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:53:54,996 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:53:55,225 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:53:55,225 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:53:55,228 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:53:55,228 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:53:55,233 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:53:55,233 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:53:55,234 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:53:55,234 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:53:56,271 INFO celery.worker.strategy Received task: schedule_start_lesson[8875e597-07bf-4150-bd3a-0b12d9088fb3]
2016-08-17 20:53:56,273 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:53:56,273 INFO celery Scheduling start lesson tasks
2016-08-17 20:53:56,275 WARNING celery.redirected 2016-08-17 20:53:56,274 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:53:56,276 WARNING celery.redirected 2016-08-17 20:53:56,276 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:53:56,277 WARNING celery.redirected 2016-08-17 20:53:56,276 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:53:56,282 WARNING celery.redirected 2016-08-17 20:53:56,282 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:53:56,283 WARNING celery.redirected 2016-08-17 20:53:56,282 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 53, 56, 278974), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 3, 56, 278974)}
2016-08-17 20:53:56,289 WARNING celery.redirected 2016-08-17 20:53:56,288 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:53:56,290 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:53:56,301 INFO celery.worker.job Task schedule_start_lesson[8875e597-07bf-4150-bd3a-0b12d9088fb3] succeeded in 0.029040399997029454s: None
2016-08-17 20:54:10,225 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:54:11,194 INFO celery.worker.strategy Received task: schedule_clean_desktops[d5dfe236-6919-47e3-9c9d-ef4baee47d63]
2016-08-17 20:54:11,195 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:54:11,196 WARNING celery.redirected 2016-08-17 20:54:11,196 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:54:11,197 WARNING celery.redirected 2016-08-17 20:54:11,197 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:54:11,198 WARNING celery.redirected 2016-08-17 20:54:11,198 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:54:11,201 WARNING celery.redirected 2016-08-17 20:54:11,201 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:54:11,202 WARNING celery.redirected 2016-08-17 20:54:11,202 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 53, 11, 195967), 'desktop_state_2': 'DELETED'}
2016-08-17 20:54:11,205 WARNING celery.redirected 2016-08-17 20:54:11,205 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:54:11,208 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:54:11,223 INFO celery.worker.job Task schedule_clean_desktops[d5dfe236-6919-47e3-9c9d-ef4baee47d63] succeeded in 0.02813536100438796s: None
2016-08-17 20:54:25,245 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:54:25,246 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:54:25,249 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:54:25,249 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:54:25,253 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:54:25,253 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:54:25,254 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:54:25,254 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:54:55,238 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:54:55,263 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:54:55,264 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:54:55,267 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:54:55,268 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:54:55,275 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:54:55,276 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:54:55,276 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:54:55,276 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:54:56,292 INFO celery.worker.strategy Received task: schedule_start_lesson[9edd2fd4-9c9e-4967-8d6b-5b8fd051512d]
2016-08-17 20:54:56,294 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:54:56,294 INFO celery Scheduling start lesson tasks
2016-08-17 20:54:56,295 WARNING celery.redirected 2016-08-17 20:54:56,295 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:54:56,296 WARNING celery.redirected 2016-08-17 20:54:56,296 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:54:56,297 WARNING celery.redirected 2016-08-17 20:54:56,297 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:54:56,302 WARNING celery.redirected 2016-08-17 20:54:56,302 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:54:56,302 WARNING celery.redirected 2016-08-17 20:54:56,302 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 54, 56, 299859), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 4, 56, 299859)}
2016-08-17 20:54:56,304 WARNING celery.redirected 2016-08-17 20:54:56,304 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:54:56,305 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:54:56,318 INFO celery.worker.job Task schedule_start_lesson[9edd2fd4-9c9e-4967-8d6b-5b8fd051512d] succeeded in 0.023976673997822218s: None
2016-08-17 20:55:10,270 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:55:11,331 INFO celery.worker.strategy Received task: schedule_clean_desktops[11c4c6ed-57a5-4ba9-b298-ea47fb769632]
2016-08-17 20:55:11,333 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:55:11,335 WARNING celery.redirected 2016-08-17 20:55:11,335 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:55:11,336 WARNING celery.redirected 2016-08-17 20:55:11,336 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:55:11,337 WARNING celery.redirected 2016-08-17 20:55:11,337 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:55:11,341 WARNING celery.redirected 2016-08-17 20:55:11,341 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:55:11,342 WARNING celery.redirected 2016-08-17 20:55:11,342 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 54, 11, 334599)}
2016-08-17 20:55:11,344 WARNING celery.redirected 2016-08-17 20:55:11,344 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:55:11,345 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:55:11,354 INFO celery.worker.job Task schedule_clean_desktops[11c4c6ed-57a5-4ba9-b298-ea47fb769632] succeeded in 0.02143754100688966s: None
2016-08-17 20:55:25,294 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:55:25,294 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:55:25,297 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:55:25,297 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:55:25,303 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:55:25,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:55:25,303 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:55:25,303 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:55:55,293 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:55:55,432 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:55:55,432 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:55:55,436 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:55:55,437 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:55:55,443 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:55:55,444 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:55:55,444 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:55:55,444 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:55:56,518 INFO celery.worker.strategy Received task: schedule_start_lesson[1c646aca-807c-4f00-8dd2-671580460b82]
2016-08-17 20:55:56,521 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:55:56,522 INFO celery Scheduling start lesson tasks
2016-08-17 20:55:56,524 WARNING celery.redirected 2016-08-17 20:55:56,523 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:55:56,525 WARNING celery.redirected 2016-08-17 20:55:56,525 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:55:56,526 WARNING celery.redirected 2016-08-17 20:55:56,526 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:55:56,532 WARNING celery.redirected 2016-08-17 20:55:56,531 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:55:56,532 WARNING celery.redirected 2016-08-17 20:55:56,532 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 55, 56, 528829), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 5, 56, 528829)}
2016-08-17 20:55:56,534 WARNING celery.redirected 2016-08-17 20:55:56,534 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:55:56,536 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:55:56,551 INFO celery.worker.job Task schedule_start_lesson[1c646aca-807c-4f00-8dd2-671580460b82] succeeded in 0.030388211001991294s: None
2016-08-17 20:56:10,438 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:56:11,475 INFO celery.worker.strategy Received task: schedule_clean_desktops[d265ed00-7fcd-4fdc-9f85-26f2688c4804]
2016-08-17 20:56:11,477 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:56:11,478 WARNING celery.redirected 2016-08-17 20:56:11,478 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:56:11,480 WARNING celery.redirected 2016-08-17 20:56:11,479 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:56:11,480 WARNING celery.redirected 2016-08-17 20:56:11,480 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:56:11,486 WARNING celery.redirected 2016-08-17 20:56:11,485 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:56:11,487 WARNING celery.redirected 2016-08-17 20:56:11,486 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 55, 11, 477951)}
2016-08-17 20:56:11,490 WARNING celery.redirected 2016-08-17 20:56:11,490 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:56:11,491 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:56:11,507 INFO celery.worker.job Task schedule_clean_desktops[d265ed00-7fcd-4fdc-9f85-26f2688c4804] succeeded in 0.030200815002899617s: None
2016-08-17 20:56:25,457 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:56:25,457 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:56:25,460 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:56:25,460 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:56:25,465 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:56:25,465 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:56:25,465 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:56:25,466 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:56:55,452 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:56:55,532 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:56:55,533 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:56:55,539 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:56:55,539 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:56:55,545 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:56:55,546 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:56:55,547 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:56:55,548 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:56:56,618 INFO celery.worker.strategy Received task: schedule_start_lesson[95fc8ebc-5de9-410b-ba75-4d0c5abb8e4f]
2016-08-17 20:56:56,619 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:56:56,620 INFO celery Scheduling start lesson tasks
2016-08-17 20:56:56,624 WARNING celery.redirected 2016-08-17 20:56:56,623 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:56:56,627 WARNING celery.redirected 2016-08-17 20:56:56,627 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:56:56,628 WARNING celery.redirected 2016-08-17 20:56:56,628 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:56:56,635 WARNING celery.redirected 2016-08-17 20:56:56,635 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:56:56,636 WARNING celery.redirected 2016-08-17 20:56:56,636 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 56, 56, 631336), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 6, 56, 631336)}
2016-08-17 20:56:56,639 WARNING celery.redirected 2016-08-17 20:56:56,639 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:56:56,641 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:56:56,652 INFO celery.worker.job Task schedule_start_lesson[95fc8ebc-5de9-410b-ba75-4d0c5abb8e4f] succeeded in 0.032597245000943076s: None
2016-08-17 20:57:10,540 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:57:11,709 INFO celery.worker.strategy Received task: schedule_clean_desktops[97f35344-8364-424c-b12f-38754a78af35]
2016-08-17 20:57:11,712 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:57:11,714 WARNING celery.redirected 2016-08-17 20:57:11,714 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:57:11,716 WARNING celery.redirected 2016-08-17 20:57:11,716 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:57:11,718 WARNING celery.redirected 2016-08-17 20:57:11,717 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:57:11,724 WARNING celery.redirected 2016-08-17 20:57:11,724 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:57:11,725 WARNING celery.redirected 2016-08-17 20:57:11,725 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 56, 11, 713409), 'desktop_state_2': 'DELETED'}
2016-08-17 20:57:11,729 WARNING celery.redirected 2016-08-17 20:57:11,729 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:57:11,731 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:57:11,743 INFO celery.worker.job Task schedule_clean_desktops[97f35344-8364-424c-b12f-38754a78af35] succeeded in 0.03122941200126661s: None
2016-08-17 20:57:25,652 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:57:25,652 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:57:25,655 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:57:25,656 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:57:25,663 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:57:25,664 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:57:25,664 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:57:25,664 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:57:55,651 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:57:55,668 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:57:55,669 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:57:55,674 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:57:55,674 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:57:55,681 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:57:55,682 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:57:55,682 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:57:55,682 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:57:55,796 INFO celery.worker.strategy Received task: schedule_start_lesson[0c167ace-3850-42ce-81a3-8e61623d0b00]
2016-08-17 20:57:55,802 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:57:55,805 INFO celery Scheduling start lesson tasks
2016-08-17 20:57:55,807 WARNING celery.redirected 2016-08-17 20:57:55,806 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:57:55,808 WARNING celery.redirected 2016-08-17 20:57:55,807 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:57:55,808 WARNING celery.redirected 2016-08-17 20:57:55,808 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:57:55,812 WARNING celery.redirected 2016-08-17 20:57:55,812 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:57:55,813 WARNING celery.redirected 2016-08-17 20:57:55,812 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 57, 55, 810025), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 7, 55, 810025)}
2016-08-17 20:57:55,814 WARNING celery.redirected 2016-08-17 20:57:55,814 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:57:55,815 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:57:55,824 INFO celery.worker.job Task schedule_start_lesson[0c167ace-3850-42ce-81a3-8e61623d0b00] succeeded in 0.022225259002880193s: None
2016-08-17 20:58:15,680 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:58:16,143 INFO celery.worker.strategy Received task: schedule_clean_desktops[e8849bc5-ffab-47c3-b37d-80a32114fe86]
2016-08-17 20:58:16,149 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:58:16,154 WARNING celery.redirected 2016-08-17 20:58:16,154 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:58:16,156 WARNING celery.redirected 2016-08-17 20:58:16,155 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:58:16,156 WARNING celery.redirected 2016-08-17 20:58:16,156 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:58:16,160 WARNING celery.redirected 2016-08-17 20:58:16,159 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:58:16,161 WARNING celery.redirected 2016-08-17 20:58:16,160 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 57, 16, 153338)}
2016-08-17 20:58:16,163 WARNING celery.redirected 2016-08-17 20:58:16,162 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:58:16,164 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:58:16,172 INFO celery.worker.job Task schedule_clean_desktops[e8849bc5-ffab-47c3-b37d-80a32114fe86] succeeded in 0.022691887999826577s: None
2016-08-17 20:58:25,707 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:58:25,707 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:58:25,712 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:58:25,713 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:58:25,718 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:58:25,718 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:58:25,718 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:58:25,718 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:59:00,699 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:59:00,699 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:59:00,699 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:59:00,700 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:59:00,701 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 20:59:00,721 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:59:00,722 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:59:00,727 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:59:00,727 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:59:00,731 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:59:00,731 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:59:00,731 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:59:00,732 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:59:01,426 INFO celery.worker.strategy Received task: schedule_start_lesson[6382b193-3035-4f3c-a28f-eb2e0e90dced]
2016-08-17 20:59:01,428 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:59:01,429 INFO celery Scheduling start lesson tasks
2016-08-17 20:59:01,431 WARNING celery.redirected 2016-08-17 20:59:01,431 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:59:01,433 WARNING celery.redirected 2016-08-17 20:59:01,433 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:59:01,434 WARNING celery.redirected 2016-08-17 20:59:01,433 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 20:59:01,441 WARNING celery.redirected 2016-08-17 20:59:01,441 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 20:59:01,442 WARNING celery.redirected 2016-08-17 20:59:01,441 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(20, 59, 1, 436850), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 9, 1, 436850)}
2016-08-17 20:59:01,444 WARNING celery.redirected 2016-08-17 20:59:01,444 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:59:01,447 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:59:01,461 INFO celery.worker.job Task schedule_start_lesson[6382b193-3035-4f3c-a28f-eb2e0e90dced] succeeded in 0.03283705600188114s: None
2016-08-17 20:59:20,723 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 20:59:21,525 INFO celery.worker.strategy Received task: schedule_clean_desktops[99d83425-bf56-48d2-af8d-85420bd29ccf]
2016-08-17 20:59:21,528 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 20:59:21,530 WARNING celery.redirected 2016-08-17 20:59:21,530 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 20:59:21,532 WARNING celery.redirected 2016-08-17 20:59:21,532 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 20:59:21,533 WARNING celery.redirected 2016-08-17 20:59:21,533 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 20:59:21,540 WARNING celery.redirected 2016-08-17 20:59:21,539 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 20:59:21,541 WARNING celery.redirected 2016-08-17 20:59:21,541 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 58, 21, 529006), 'desktop_state_2': 'DELETED'}
2016-08-17 20:59:21,545 WARNING celery.redirected 2016-08-17 20:59:21,544 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 20:59:21,547 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 20:59:21,555 INFO celery.worker.job Task schedule_clean_desktops[99d83425-bf56-48d2-af8d-85420bd29ccf] succeeded in 0.02707256400026381s: None
2016-08-17 20:59:30,748 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:59:30,748 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:59:30,751 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:59:30,751 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 20:59:30,758 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 20:59:30,759 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 20:59:30,759 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 20:59:30,759 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:00:05,741 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:00:05,741 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:00:05,741 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:00:05,741 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:00:05,744 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:00:05,763 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:00:05,763 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:00:05,767 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:00:05,767 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:00:05,775 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:00:05,775 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:00:05,775 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:00:05,776 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:00:06,728 INFO celery.worker.strategy Received task: schedule_start_lesson[088cd83d-313d-427d-af6b-679091301585]
2016-08-17 21:00:06,731 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:00:06,732 INFO celery Scheduling start lesson tasks
2016-08-17 21:00:06,733 WARNING celery.redirected 2016-08-17 21:00:06,733 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:00:06,735 WARNING celery.redirected 2016-08-17 21:00:06,735 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:00:06,736 WARNING celery.redirected 2016-08-17 21:00:06,736 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:00:06,741 WARNING celery.redirected 2016-08-17 21:00:06,741 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:00:06,742 WARNING celery.redirected 2016-08-17 21:00:06,742 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 0, 6, 738422), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 10, 6, 738422)}
2016-08-17 21:00:06,745 WARNING celery.redirected 2016-08-17 21:00:06,745 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:00:06,746 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:00:06,758 INFO celery.worker.job Task schedule_start_lesson[088cd83d-313d-427d-af6b-679091301585] succeeded in 0.02755816200078698s: None
2016-08-17 21:00:25,766 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:00:26,811 INFO celery.worker.strategy Received task: schedule_clean_desktops[e59b8969-008c-4636-b70f-0d295ea6ea3a]
2016-08-17 21:00:26,815 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:00:26,818 WARNING celery.redirected 2016-08-17 21:00:26,817 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:00:26,822 WARNING celery.redirected 2016-08-17 21:00:26,822 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:00:26,823 WARNING celery.redirected 2016-08-17 21:00:26,823 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:00:26,827 WARNING celery.redirected 2016-08-17 21:00:26,827 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:00:26,828 WARNING celery.redirected 2016-08-17 21:00:26,828 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 20, 59, 26, 816642)}
2016-08-17 21:00:26,831 WARNING celery.redirected 2016-08-17 21:00:26,831 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:00:26,832 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:00:26,852 INFO celery.worker.job Task schedule_clean_desktops[e59b8969-008c-4636-b70f-0d295ea6ea3a] succeeded in 0.037629373000527266s: None
2016-08-17 21:00:35,792 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:00:35,792 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:00:35,795 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:00:35,796 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:00:35,802 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:00:35,802 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:00:35,802 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:00:35,802 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:01:10,792 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:01:10,793 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:01:10,794 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:01:10,794 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:01:10,796 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:01:10,821 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:01:10,821 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:01:10,824 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:01:10,824 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:01:10,828 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:01:10,828 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:01:10,829 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:01:10,829 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:01:11,051 INFO celery.worker.strategy Received task: schedule_start_lesson[5c365a62-6c58-42ac-aa74-a8170597040e]
2016-08-17 21:01:11,053 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:01:11,054 INFO celery Scheduling start lesson tasks
2016-08-17 21:01:11,059 WARNING celery.redirected 2016-08-17 21:01:11,059 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:01:11,060 WARNING celery.redirected 2016-08-17 21:01:11,060 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:01:11,061 WARNING celery.redirected 2016-08-17 21:01:11,060 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:01:11,065 WARNING celery.redirected 2016-08-17 21:01:11,065 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:01:11,066 WARNING celery.redirected 2016-08-17 21:01:11,065 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 1, 11, 62319), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 11, 11, 62319)}
2016-08-17 21:01:11,070 WARNING celery.redirected 2016-08-17 21:01:11,070 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:01:11,072 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:01:11,087 INFO celery.worker.job Task schedule_start_lesson[5c365a62-6c58-42ac-aa74-a8170597040e] succeeded in 0.03340869100065902s: None
2016-08-17 21:01:30,828 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:01:31,137 INFO celery.worker.strategy Received task: schedule_clean_desktops[64b332b6-2510-425a-a7d1-0bf1248023af]
2016-08-17 21:01:31,139 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:01:31,144 WARNING celery.redirected 2016-08-17 21:01:31,144 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:01:31,146 WARNING celery.redirected 2016-08-17 21:01:31,146 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:01:31,147 WARNING celery.redirected 2016-08-17 21:01:31,147 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:01:31,151 WARNING celery.redirected 2016-08-17 21:01:31,151 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:01:31,152 WARNING celery.redirected 2016-08-17 21:01:31,152 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 0, 31, 140321), 'desktop_state_2': 'DELETED'}
2016-08-17 21:01:31,154 WARNING celery.redirected 2016-08-17 21:01:31,154 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:01:31,156 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:01:31,168 INFO celery.worker.job Task schedule_clean_desktops[64b332b6-2510-425a-a7d1-0bf1248023af] succeeded in 0.029874136998842005s: None
2016-08-17 21:01:40,852 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:01:40,852 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:01:40,855 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:01:40,855 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:01:40,860 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:01:40,860 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:01:40,860 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:01:40,860 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:02:15,845 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:02:15,846 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:02:15,846 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:02:15,846 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:02:15,849 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:02:15,879 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:02:15,879 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:02:15,882 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:02:15,883 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:02:15,887 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:02:15,887 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:02:15,888 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:02:15,888 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:02:16,945 INFO celery.worker.strategy Received task: schedule_start_lesson[4b4385d0-1e14-41ed-9e04-fad2803a2e5e]
2016-08-17 21:02:16,947 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:02:16,948 INFO celery Scheduling start lesson tasks
2016-08-17 21:02:16,952 WARNING celery.redirected 2016-08-17 21:02:16,952 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:02:16,954 WARNING celery.redirected 2016-08-17 21:02:16,954 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:02:16,955 WARNING celery.redirected 2016-08-17 21:02:16,954 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:02:16,958 WARNING celery.redirected 2016-08-17 21:02:16,958 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:02:16,959 WARNING celery.redirected 2016-08-17 21:02:16,959 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 2, 16, 956475), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 12, 16, 956475)}
2016-08-17 21:02:16,961 WARNING celery.redirected 2016-08-17 21:02:16,960 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:02:16,961 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:02:16,968 INFO celery.worker.job Task schedule_start_lesson[4b4385d0-1e14-41ed-9e04-fad2803a2e5e] succeeded in 0.020918586997140665s: None
2016-08-17 21:02:35,878 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:02:37,076 INFO celery.worker.strategy Received task: schedule_clean_desktops[108b5d3e-cc9f-4f11-be29-5f2f66451639]
2016-08-17 21:02:37,077 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:02:37,081 WARNING celery.redirected 2016-08-17 21:02:37,081 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:02:37,082 WARNING celery.redirected 2016-08-17 21:02:37,082 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:02:37,083 WARNING celery.redirected 2016-08-17 21:02:37,083 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:02:37,086 WARNING celery.redirected 2016-08-17 21:02:37,086 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:02:37,087 WARNING celery.redirected 2016-08-17 21:02:37,087 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 1, 37, 78329), 'desktop_state_2': 'DELETED'}
2016-08-17 21:02:37,089 WARNING celery.redirected 2016-08-17 21:02:37,088 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:02:37,089 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:02:37,100 INFO celery.worker.job Task schedule_clean_desktops[108b5d3e-cc9f-4f11-be29-5f2f66451639] succeeded in 0.02317516900075134s: None
2016-08-17 21:02:46,020 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:02:46,021 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:02:46,024 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:02:46,024 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:02:46,029 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:02:46,029 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:02:46,030 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:02:46,030 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:03:16,013 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:03:16,032 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:03:16,033 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:03:16,036 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:03:16,037 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:03:16,041 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:03:16,041 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:03:16,041 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:03:16,042 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:03:16,427 INFO celery.worker.strategy Received task: schedule_start_lesson[5be7b5cf-5c53-49bb-863a-fade26315108]
2016-08-17 21:03:16,428 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:03:16,429 INFO celery Scheduling start lesson tasks
2016-08-17 21:03:16,430 WARNING celery.redirected 2016-08-17 21:03:16,430 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:03:16,431 WARNING celery.redirected 2016-08-17 21:03:16,431 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:03:16,432 WARNING celery.redirected 2016-08-17 21:03:16,432 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:03:16,437 WARNING celery.redirected 2016-08-17 21:03:16,436 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:03:16,437 WARNING celery.redirected 2016-08-17 21:03:16,437 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 3, 16, 434690), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 13, 16, 434690)}
2016-08-17 21:03:16,439 WARNING celery.redirected 2016-08-17 21:03:16,439 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:03:16,440 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:03:16,449 INFO celery.worker.job Task schedule_start_lesson[5be7b5cf-5c53-49bb-863a-fade26315108] succeeded in 0.020773340998857748s: None
2016-08-17 21:03:36,027 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:03:37,134 INFO celery.worker.strategy Received task: schedule_clean_desktops[751b22af-d4e1-4280-9470-ca51cfdc9662]
2016-08-17 21:03:37,135 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:03:37,137 WARNING celery.redirected 2016-08-17 21:03:37,137 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:03:37,138 WARNING celery.redirected 2016-08-17 21:03:37,138 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:03:37,138 WARNING celery.redirected 2016-08-17 21:03:37,138 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:03:37,142 WARNING celery.redirected 2016-08-17 21:03:37,142 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:03:37,142 WARNING celery.redirected 2016-08-17 21:03:37,142 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 2, 37, 136462)}
2016-08-17 21:03:37,145 WARNING celery.redirected 2016-08-17 21:03:37,145 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:03:37,146 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:03:37,153 INFO celery.worker.job Task schedule_clean_desktops[751b22af-d4e1-4280-9470-ca51cfdc9662] succeeded in 0.017723995995766018s: None
2016-08-17 21:03:46,070 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:03:46,070 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:03:46,073 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:03:46,073 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:03:46,078 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:03:46,078 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:03:46,079 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:03:46,079 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:04:16,061 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:04:16,079 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:04:16,080 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:04:16,083 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:04:16,083 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:04:16,087 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:04:16,087 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:04:16,087 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:04:16,087 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:04:17,104 INFO celery.worker.strategy Received task: schedule_start_lesson[26c3306b-167f-4883-9a54-26f283534167]
2016-08-17 21:04:17,105 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:04:17,106 INFO celery Scheduling start lesson tasks
2016-08-17 21:04:17,107 WARNING celery.redirected 2016-08-17 21:04:17,107 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:04:17,108 WARNING celery.redirected 2016-08-17 21:04:17,108 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:04:17,108 WARNING celery.redirected 2016-08-17 21:04:17,108 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:04:17,112 WARNING celery.redirected 2016-08-17 21:04:17,111 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:04:17,112 WARNING celery.redirected 2016-08-17 21:04:17,112 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 4, 17, 109904), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 14, 17, 109904)}
2016-08-17 21:04:17,115 WARNING celery.redirected 2016-08-17 21:04:17,115 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:04:17,117 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:04:17,123 INFO celery.worker.job Task schedule_start_lesson[26c3306b-167f-4883-9a54-26f283534167] succeeded in 0.01818897399789421s: None
2016-08-17 21:04:36,074 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:04:36,466 INFO celery.worker.strategy Received task: schedule_clean_desktops[797b0e9d-1d30-48a4-b954-72640b770d6b]
2016-08-17 21:04:36,467 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:04:36,469 WARNING celery.redirected 2016-08-17 21:04:36,469 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:04:36,470 WARNING celery.redirected 2016-08-17 21:04:36,470 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:04:36,471 WARNING celery.redirected 2016-08-17 21:04:36,471 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:04:36,476 WARNING celery.redirected 2016-08-17 21:04:36,475 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:04:36,477 WARNING celery.redirected 2016-08-17 21:04:36,476 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 3, 36, 468168)}
2016-08-17 21:04:36,480 WARNING celery.redirected 2016-08-17 21:04:36,480 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:04:36,481 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:04:36,491 INFO celery.worker.job Task schedule_clean_desktops[797b0e9d-1d30-48a4-b954-72640b770d6b] succeeded in 0.024712335005460773s: None
2016-08-17 21:04:46,092 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:04:46,092 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:04:46,097 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:04:46,097 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:04:46,104 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:04:46,104 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:04:46,104 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:04:46,105 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:05:16,088 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:05:16,111 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:05:16,111 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:05:16,114 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:05:16,114 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:05:16,118 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:05:16,118 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:05:16,119 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:05:16,119 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:05:16,624 INFO celery.worker.strategy Received task: schedule_start_lesson[3dd91e5b-db8c-427a-8168-df784ee91cff]
2016-08-17 21:05:16,626 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:05:16,627 INFO celery Scheduling start lesson tasks
2016-08-17 21:05:16,629 WARNING celery.redirected 2016-08-17 21:05:16,629 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:05:16,631 WARNING celery.redirected 2016-08-17 21:05:16,631 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:05:16,632 WARNING celery.redirected 2016-08-17 21:05:16,632 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:05:16,638 WARNING celery.redirected 2016-08-17 21:05:16,637 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:05:16,638 WARNING celery.redirected 2016-08-17 21:05:16,638 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 5, 16, 634625), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 15, 16, 634625)}
2016-08-17 21:05:16,641 WARNING celery.redirected 2016-08-17 21:05:16,641 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:05:16,643 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:05:16,653 INFO celery.worker.job Task schedule_start_lesson[3dd91e5b-db8c-427a-8168-df784ee91cff] succeeded in 0.026551376999123022s: None
2016-08-17 21:05:36,108 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:05:37,307 INFO celery.worker.strategy Received task: schedule_clean_desktops[07bb7ab0-1b75-4d63-9789-0c40440afdfb]
2016-08-17 21:05:37,308 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:05:37,310 WARNING celery.redirected 2016-08-17 21:05:37,309 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:05:37,311 WARNING celery.redirected 2016-08-17 21:05:37,311 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:05:37,312 WARNING celery.redirected 2016-08-17 21:05:37,312 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:05:37,315 WARNING celery.redirected 2016-08-17 21:05:37,315 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:05:37,315 WARNING celery.redirected 2016-08-17 21:05:37,315 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 4, 37, 309235), 'desktop_state_2': 'DELETED'}
2016-08-17 21:05:37,317 WARNING celery.redirected 2016-08-17 21:05:37,317 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:05:37,318 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:05:37,325 INFO celery.worker.job Task schedule_clean_desktops[07bb7ab0-1b75-4d63-9789-0c40440afdfb] succeeded in 0.017161387993837707s: None
2016-08-17 21:05:46,245 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:05:46,245 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:05:46,248 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:05:46,248 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:05:46,253 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:05:46,253 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:05:46,253 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:05:46,253 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:06:16,226 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:06:16,498 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:06:16,499 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:06:16,502 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:06:16,502 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:06:16,505 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:06:16,506 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:06:16,506 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:06:16,506 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:06:17,565 INFO celery.worker.strategy Received task: schedule_start_lesson[afc6a8b4-3f81-4fd3-aacc-b7b5da6c8d39]
2016-08-17 21:06:17,567 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:06:17,567 INFO celery Scheduling start lesson tasks
2016-08-17 21:06:17,568 WARNING celery.redirected 2016-08-17 21:06:17,568 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:06:17,569 WARNING celery.redirected 2016-08-17 21:06:17,569 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:06:17,570 WARNING celery.redirected 2016-08-17 21:06:17,570 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:06:17,574 WARNING celery.redirected 2016-08-17 21:06:17,574 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:06:17,575 WARNING celery.redirected 2016-08-17 21:06:17,575 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 6, 17, 572205), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 16, 17, 572205)}
2016-08-17 21:06:17,578 WARNING celery.redirected 2016-08-17 21:06:17,577 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:06:17,579 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:06:17,591 INFO celery.worker.job Task schedule_start_lesson[afc6a8b4-3f81-4fd3-aacc-b7b5da6c8d39] succeeded in 0.024863614002242684s: None
2016-08-17 21:06:36,494 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:06:36,851 INFO celery.worker.strategy Received task: schedule_clean_desktops[a7ef9f5e-d4a3-43e9-9009-feeaf6c0c72c]
2016-08-17 21:06:36,853 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:06:36,854 WARNING celery.redirected 2016-08-17 21:06:36,854 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:06:36,856 WARNING celery.redirected 2016-08-17 21:06:36,856 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:06:36,856 WARNING celery.redirected 2016-08-17 21:06:36,856 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:06:36,860 WARNING celery.redirected 2016-08-17 21:06:36,859 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:06:36,860 WARNING celery.redirected 2016-08-17 21:06:36,860 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 5, 36, 854013)}
2016-08-17 21:06:36,862 WARNING celery.redirected 2016-08-17 21:06:36,862 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:06:36,863 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:06:36,870 INFO celery.worker.job Task schedule_clean_desktops[a7ef9f5e-d4a3-43e9-9009-feeaf6c0c72c] succeeded in 0.017303749998973217s: None
2016-08-17 21:06:46,508 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:06:46,509 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:06:46,511 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:06:46,511 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:06:46,516 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:06:46,516 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:06:46,516 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:06:46,516 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:07:16,498 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:07:16,517 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:07:16,517 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:07:16,519 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:07:16,519 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:07:16,522 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:07:16,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:07:16,523 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:07:16,523 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:07:16,783 INFO celery.worker.strategy Received task: schedule_start_lesson[6992c92e-b895-41d1-b69a-da3febe81927]
2016-08-17 21:07:16,784 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:07:16,785 INFO celery Scheduling start lesson tasks
2016-08-17 21:07:16,786 WARNING celery.redirected 2016-08-17 21:07:16,786 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:07:16,787 WARNING celery.redirected 2016-08-17 21:07:16,787 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:07:16,788 WARNING celery.redirected 2016-08-17 21:07:16,788 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:07:16,792 WARNING celery.redirected 2016-08-17 21:07:16,792 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:07:16,793 WARNING celery.redirected 2016-08-17 21:07:16,793 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 7, 16, 790495), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 17, 16, 790495)}
2016-08-17 21:07:16,795 WARNING celery.redirected 2016-08-17 21:07:16,795 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:07:16,796 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:07:16,803 INFO celery.worker.job Task schedule_start_lesson[6992c92e-b895-41d1-b69a-da3febe81927] succeeded in 0.01901142200222239s: None
2016-08-17 21:07:36,507 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:07:37,362 INFO celery.worker.strategy Received task: schedule_clean_desktops[4dfb65e3-8ba4-48df-be07-e303bf4ba33c]
2016-08-17 21:07:37,364 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:07:37,366 WARNING celery.redirected 2016-08-17 21:07:37,365 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:07:37,367 WARNING celery.redirected 2016-08-17 21:07:37,367 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:07:37,367 WARNING celery.redirected 2016-08-17 21:07:37,367 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:07:37,371 WARNING celery.redirected 2016-08-17 21:07:37,371 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:07:37,372 WARNING celery.redirected 2016-08-17 21:07:37,371 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 6, 37, 365138), 'desktop_state_2': 'DELETED'}
2016-08-17 21:07:37,375 WARNING celery.redirected 2016-08-17 21:07:37,374 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:07:37,376 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:07:37,383 INFO celery.worker.job Task schedule_clean_desktops[4dfb65e3-8ba4-48df-be07-e303bf4ba33c] succeeded in 0.01982016200054204s: None
2016-08-17 21:07:46,526 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:07:46,526 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:07:46,528 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:07:46,528 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:08:16,510 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:08:16,528 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:08:16,529 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:08:16,531 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:08:16,531 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:08:16,534 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:08:16,534 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:08:16,534 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:08:16,535 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:08:17,415 INFO celery.worker.strategy Received task: schedule_start_lesson[a05b3d00-b21f-4e3e-8744-9646fecc91d7]
2016-08-17 21:08:17,417 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:08:17,418 INFO celery Scheduling start lesson tasks
2016-08-17 21:08:17,419 WARNING celery.redirected 2016-08-17 21:08:17,418 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:08:17,420 WARNING celery.redirected 2016-08-17 21:08:17,420 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:08:17,420 WARNING celery.redirected 2016-08-17 21:08:17,420 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:08:17,424 WARNING celery.redirected 2016-08-17 21:08:17,424 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:08:17,425 WARNING celery.redirected 2016-08-17 21:08:17,425 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 8, 17, 422146), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 18, 17, 422146)}
2016-08-17 21:08:17,427 WARNING celery.redirected 2016-08-17 21:08:17,427 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:08:17,428 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:08:17,435 INFO celery.worker.job Task schedule_start_lesson[a05b3d00-b21f-4e3e-8744-9646fecc91d7] succeeded in 0.01848617399809882s: None
2016-08-17 21:08:41,517 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:08:42,865 INFO celery.worker.strategy Received task: schedule_clean_desktops[00bf650f-ae5e-4644-a574-98792370700f]
2016-08-17 21:08:42,868 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:08:42,870 WARNING celery.redirected 2016-08-17 21:08:42,870 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:08:42,872 WARNING celery.redirected 2016-08-17 21:08:42,871 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:08:42,872 WARNING celery.redirected 2016-08-17 21:08:42,872 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:08:42,876 WARNING celery.redirected 2016-08-17 21:08:42,875 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:08:42,876 WARNING celery.redirected 2016-08-17 21:08:42,876 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 7, 42, 869026)}
2016-08-17 21:08:42,879 WARNING celery.redirected 2016-08-17 21:08:42,879 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:08:42,880 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:08:42,892 INFO celery.worker.job Task schedule_clean_desktops[00bf650f-ae5e-4644-a574-98792370700f] succeeded in 0.024606538994703442s: None
2016-08-17 21:08:46,893 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:08:46,893 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:08:46,896 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:08:46,896 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:08:46,901 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:08:46,901 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:08:46,901 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:08:46,901 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:09:21,872 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:09:21,873 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:09:21,873 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:09:21,873 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:09:21,875 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:09:21,891 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:09:21,891 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:09:21,893 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:09:21,893 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:09:21,896 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:09:21,896 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:09:21,896 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:09:21,897 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:09:22,805 INFO celery.worker.strategy Received task: schedule_start_lesson[019ad43f-0259-4772-96d2-1bf052843398]
2016-08-17 21:09:22,806 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:09:22,807 INFO celery Scheduling start lesson tasks
2016-08-17 21:09:22,808 WARNING celery.redirected 2016-08-17 21:09:22,807 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:09:22,808 WARNING celery.redirected 2016-08-17 21:09:22,808 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:09:22,809 WARNING celery.redirected 2016-08-17 21:09:22,809 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:09:22,813 WARNING celery.redirected 2016-08-17 21:09:22,813 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:09:22,814 WARNING celery.redirected 2016-08-17 21:09:22,814 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 9, 22, 810841), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 19, 22, 810841)}
2016-08-17 21:09:22,817 WARNING celery.redirected 2016-08-17 21:09:22,816 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:09:22,818 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:09:22,825 INFO celery.worker.job Task schedule_start_lesson[019ad43f-0259-4772-96d2-1bf052843398] succeeded in 0.018882681004470214s: None
2016-08-17 21:09:46,878 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:09:47,515 INFO celery.worker.strategy Received task: schedule_clean_desktops[300d2096-d4dc-467c-b041-f2854bd69a87]
2016-08-17 21:09:47,522 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:09:47,525 WARNING celery.redirected 2016-08-17 21:09:47,524 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:09:47,526 WARNING celery.redirected 2016-08-17 21:09:47,526 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:09:47,527 WARNING celery.redirected 2016-08-17 21:09:47,527 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:09:47,532 WARNING celery.redirected 2016-08-17 21:09:47,531 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:09:47,533 WARNING celery.redirected 2016-08-17 21:09:47,533 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 8, 47, 523671), 'desktop_state_2': 'DELETED'}
2016-08-17 21:09:47,536 WARNING celery.redirected 2016-08-17 21:09:47,536 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:09:47,538 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:09:47,550 INFO celery.worker.job Task schedule_clean_desktops[300d2096-d4dc-467c-b041-f2854bd69a87] succeeded in 0.029229981002572458s: None
2016-08-17 21:09:51,898 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:09:51,898 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:09:51,901 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:09:51,901 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:10:26,876 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:10:26,877 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:10:26,877 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:10:26,878 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:10:26,880 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:10:26,899 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:10:26,900 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:10:26,902 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:10:26,902 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:10:26,906 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:10:26,907 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:10:26,907 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:10:26,907 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:10:27,199 INFO celery.worker.strategy Received task: schedule_start_lesson[079841c0-e00b-4500-842b-fc9c04fbed76]
2016-08-17 21:10:27,200 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:10:27,204 INFO celery Scheduling start lesson tasks
2016-08-17 21:10:27,205 WARNING celery.redirected 2016-08-17 21:10:27,205 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:10:27,207 WARNING celery.redirected 2016-08-17 21:10:27,207 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:10:27,207 WARNING celery.redirected 2016-08-17 21:10:27,207 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:10:27,215 WARNING celery.redirected 2016-08-17 21:10:27,213 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:10:27,216 WARNING celery.redirected 2016-08-17 21:10:27,215 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 10, 27, 209755), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 20, 27, 209755)}
2016-08-17 21:10:27,219 WARNING celery.redirected 2016-08-17 21:10:27,218 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:10:27,220 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:10:27,229 INFO celery.worker.job Task schedule_start_lesson[079841c0-e00b-4500-842b-fc9c04fbed76] succeeded in 0.029034961000434123s: None
2016-08-17 21:10:51,889 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:10:52,071 INFO celery.worker.strategy Received task: schedule_clean_desktops[d62dbe34-2b2b-4404-aff4-3ca4f420da8f]
2016-08-17 21:10:52,073 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:10:52,075 WARNING celery.redirected 2016-08-17 21:10:52,075 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:10:52,077 WARNING celery.redirected 2016-08-17 21:10:52,077 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:10:52,078 WARNING celery.redirected 2016-08-17 21:10:52,077 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:10:52,082 WARNING celery.redirected 2016-08-17 21:10:52,082 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:10:52,083 WARNING celery.redirected 2016-08-17 21:10:52,083 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 9, 52, 74679)}
2016-08-17 21:10:52,085 WARNING celery.redirected 2016-08-17 21:10:52,084 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:10:52,085 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:10:52,094 INFO celery.worker.job Task schedule_clean_desktops[d62dbe34-2b2b-4404-aff4-3ca4f420da8f] succeeded in 0.02126004800084047s: None
2016-08-17 21:10:56,915 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:10:56,915 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:10:56,920 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:10:56,920 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:10:56,929 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:10:56,929 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:10:56,930 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:10:56,930 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:11:31,911 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:11:31,912 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:11:31,913 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:11:31,913 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:11:31,915 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:11:31,933 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:11:31,934 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:11:31,936 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:11:31,936 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:11:31,939 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:11:31,940 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:11:31,940 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:11:31,940 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:11:32,670 INFO celery.worker.strategy Received task: schedule_start_lesson[f63bc113-9814-448d-bb29-328817c2b078]
2016-08-17 21:11:32,671 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:11:32,672 INFO celery Scheduling start lesson tasks
2016-08-17 21:11:32,673 WARNING celery.redirected 2016-08-17 21:11:32,673 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:11:32,674 WARNING celery.redirected 2016-08-17 21:11:32,674 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:11:32,675 WARNING celery.redirected 2016-08-17 21:11:32,675 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:11:32,680 WARNING celery.redirected 2016-08-17 21:11:32,680 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:11:32,681 WARNING celery.redirected 2016-08-17 21:11:32,680 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 11, 32, 677302), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 21, 32, 677302)}
2016-08-17 21:11:32,683 WARNING celery.redirected 2016-08-17 21:11:32,683 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:11:32,684 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:11:32,692 INFO celery.worker.job Task schedule_start_lesson[f63bc113-9814-448d-bb29-328817c2b078] succeeded in 0.02137442399543943s: None
2016-08-17 21:11:56,934 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:11:57,655 INFO celery.worker.strategy Received task: schedule_clean_desktops[50280368-17d0-436c-a543-91813a5a6b07]
2016-08-17 21:11:57,657 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:11:57,661 WARNING celery.redirected 2016-08-17 21:11:57,660 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:11:57,663 WARNING celery.redirected 2016-08-17 21:11:57,662 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:11:57,664 WARNING celery.redirected 2016-08-17 21:11:57,664 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:11:57,669 WARNING celery.redirected 2016-08-17 21:11:57,669 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:11:57,670 WARNING celery.redirected 2016-08-17 21:11:57,670 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 10, 57, 658561), 'desktop_state_2': 'DELETED'}
2016-08-17 21:11:57,673 WARNING celery.redirected 2016-08-17 21:11:57,673 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:11:57,674 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:11:57,683 INFO celery.worker.job Task schedule_clean_desktops[50280368-17d0-436c-a543-91813a5a6b07] succeeded in 0.0260097139980644s: None
2016-08-17 21:12:01,950 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:12:01,950 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:12:01,953 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:12:01,953 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:12:01,958 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:12:01,958 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:12:01,959 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:12:01,959 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:12:36,952 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:12:36,953 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:12:36,954 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:12:36,954 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:12:36,956 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:12:36,973 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:12:36,973 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:12:36,975 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:12:36,975 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:12:36,978 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:12:36,978 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:12:36,979 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:12:36,979 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:12:37,592 INFO celery.worker.strategy Received task: schedule_start_lesson[95916ecb-64d9-4e0a-8101-41a508ed8109]
2016-08-17 21:12:37,594 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:12:37,594 INFO celery Scheduling start lesson tasks
2016-08-17 21:12:37,596 WARNING celery.redirected 2016-08-17 21:12:37,595 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:12:37,597 WARNING celery.redirected 2016-08-17 21:12:37,596 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:12:37,597 WARNING celery.redirected 2016-08-17 21:12:37,597 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:12:37,601 WARNING celery.redirected 2016-08-17 21:12:37,601 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:12:37,602 WARNING celery.redirected 2016-08-17 21:12:37,602 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 12, 37, 598956), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 22, 37, 598956)}
2016-08-17 21:12:37,604 WARNING celery.redirected 2016-08-17 21:12:37,604 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:12:37,605 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:12:37,614 INFO celery.worker.job Task schedule_start_lesson[95916ecb-64d9-4e0a-8101-41a508ed8109] succeeded in 0.020022935001179576s: None
2016-08-17 21:13:01,970 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:13:02,090 INFO celery.worker.strategy Received task: schedule_clean_desktops[97540893-186b-439d-9b5d-b4cb264412a4]
2016-08-17 21:13:02,091 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:13:02,094 WARNING celery.redirected 2016-08-17 21:13:02,093 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:13:02,095 WARNING celery.redirected 2016-08-17 21:13:02,094 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:13:02,095 WARNING celery.redirected 2016-08-17 21:13:02,095 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:13:02,098 WARNING celery.redirected 2016-08-17 21:13:02,098 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:13:02,099 WARNING celery.redirected 2016-08-17 21:13:02,099 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 12, 2, 92985), 'desktop_state_2': 'DELETED'}
2016-08-17 21:13:02,101 WARNING celery.redirected 2016-08-17 21:13:02,101 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:13:02,102 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:13:02,110 INFO celery.worker.job Task schedule_clean_desktops[97540893-186b-439d-9b5d-b4cb264412a4] succeeded in 0.018779821002681274s: None
2016-08-17 21:13:06,983 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:13:06,983 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:13:06,986 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:13:06,986 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:13:06,993 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:13:06,994 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:13:06,994 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:13:06,994 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:13:41,971 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:13:41,971 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:13:41,972 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:13:41,972 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:13:41,974 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:13:41,990 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:13:41,991 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:13:41,993 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:13:41,993 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:13:41,996 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:13:41,996 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:13:41,996 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:13:41,997 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:13:42,888 INFO celery.worker.strategy Received task: schedule_start_lesson[1bb86360-2205-487a-becc-8077b81e12bb]
2016-08-17 21:13:42,889 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:13:42,890 INFO celery Scheduling start lesson tasks
2016-08-17 21:13:42,891 WARNING celery.redirected 2016-08-17 21:13:42,891 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:13:42,892 WARNING celery.redirected 2016-08-17 21:13:42,892 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:13:42,893 WARNING celery.redirected 2016-08-17 21:13:42,893 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:13:42,897 WARNING celery.redirected 2016-08-17 21:13:42,896 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:13:42,897 WARNING celery.redirected 2016-08-17 21:13:42,897 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 13, 42, 894697), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 23, 42, 894697)}
2016-08-17 21:13:42,900 WARNING celery.redirected 2016-08-17 21:13:42,900 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:13:42,901 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:13:42,918 INFO celery.worker.job Task schedule_start_lesson[1bb86360-2205-487a-becc-8077b81e12bb] succeeded in 0.029037217995210085s: None
2016-08-17 21:14:06,979 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:14:07,196 INFO celery.worker.strategy Received task: schedule_clean_desktops[edc9ff8f-d902-4fe9-b926-581f28250062]
2016-08-17 21:14:07,198 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:14:07,200 WARNING celery.redirected 2016-08-17 21:14:07,200 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:14:07,201 WARNING celery.redirected 2016-08-17 21:14:07,201 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:14:07,201 WARNING celery.redirected 2016-08-17 21:14:07,201 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:14:07,205 WARNING celery.redirected 2016-08-17 21:14:07,205 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:14:07,206 WARNING celery.redirected 2016-08-17 21:14:07,206 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 13, 7, 199286)}
2016-08-17 21:14:07,208 WARNING celery.redirected 2016-08-17 21:14:07,208 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:14:07,209 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:14:07,216 INFO celery.worker.job Task schedule_clean_desktops[edc9ff8f-d902-4fe9-b926-581f28250062] succeeded in 0.01882517399644712s: None
2016-08-17 21:14:12,000 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:14:12,000 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:14:12,002 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:14:12,002 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:14:46,984 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:14:46,985 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:14:46,986 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:14:46,986 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:14:46,988 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:14:47,130 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:14:47,131 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:14:47,135 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:14:47,135 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:14:47,139 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:14:47,139 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:14:47,140 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:14:47,140 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:14:48,194 INFO celery.worker.strategy Received task: schedule_start_lesson[113c9070-ce4d-4b50-a2f7-2c9af930fe30]
2016-08-17 21:14:48,195 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:14:48,195 INFO celery Scheduling start lesson tasks
2016-08-17 21:14:48,196 WARNING celery.redirected 2016-08-17 21:14:48,196 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:14:48,197 WARNING celery.redirected 2016-08-17 21:14:48,197 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:14:48,198 WARNING celery.redirected 2016-08-17 21:14:48,198 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:14:48,202 WARNING celery.redirected 2016-08-17 21:14:48,201 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:14:48,202 WARNING celery.redirected 2016-08-17 21:14:48,202 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 14, 48, 199612), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 24, 48, 199612)}
2016-08-17 21:14:48,204 WARNING celery.redirected 2016-08-17 21:14:48,204 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:14:48,205 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:14:48,216 INFO celery.worker.job Task schedule_start_lesson[113c9070-ce4d-4b50-a2f7-2c9af930fe30] succeeded in 0.02170192199992016s: None
2016-08-17 21:15:07,124 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:15:07,960 INFO celery.worker.strategy Received task: schedule_clean_desktops[25b51d2f-0be4-4735-96ff-085270fe0fa8]
2016-08-17 21:15:07,962 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:15:07,963 WARNING celery.redirected 2016-08-17 21:15:07,963 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:15:07,964 WARNING celery.redirected 2016-08-17 21:15:07,964 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:15:07,965 WARNING celery.redirected 2016-08-17 21:15:07,965 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:15:07,968 WARNING celery.redirected 2016-08-17 21:15:07,968 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:15:07,969 WARNING celery.redirected 2016-08-17 21:15:07,969 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 14, 7, 963036), 'desktop_state_2': 'DELETED'}
2016-08-17 21:15:07,973 WARNING celery.redirected 2016-08-17 21:15:07,973 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:15:07,975 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:15:07,982 INFO celery.worker.job Task schedule_clean_desktops[25b51d2f-0be4-4735-96ff-085270fe0fa8] succeeded in 0.02026929699786706s: None
2016-08-17 21:15:17,145 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:15:17,145 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:15:17,148 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:15:17,148 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:15:17,155 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:15:17,155 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:15:17,155 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:15:17,155 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:15:47,141 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:15:47,163 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:15:47,163 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:15:47,167 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:15:47,167 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:15:47,173 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:15:47,173 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:15:47,174 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:15:47,174 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:15:47,528 INFO celery.worker.strategy Received task: schedule_start_lesson[5641af96-3f9f-4801-9324-c09452ec21d0]
2016-08-17 21:15:47,529 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:15:47,530 INFO celery Scheduling start lesson tasks
2016-08-17 21:15:47,531 WARNING celery.redirected 2016-08-17 21:15:47,531 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:15:47,532 WARNING celery.redirected 2016-08-17 21:15:47,532 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:15:47,533 WARNING celery.redirected 2016-08-17 21:15:47,533 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:15:47,539 WARNING celery.redirected 2016-08-17 21:15:47,539 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:15:47,540 WARNING celery.redirected 2016-08-17 21:15:47,540 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 15, 47, 536130), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 25, 47, 536130)}
2016-08-17 21:15:47,542 WARNING celery.redirected 2016-08-17 21:15:47,541 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:15:47,542 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:15:47,551 INFO celery.worker.job Task schedule_start_lesson[5641af96-3f9f-4801-9324-c09452ec21d0] succeeded in 0.021350192000682s: None
2016-08-17 21:16:07,161 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:16:08,404 INFO celery.worker.strategy Received task: schedule_clean_desktops[ea366e98-5acd-49da-a03c-6ce150b7f781]
2016-08-17 21:16:08,405 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:16:08,406 WARNING celery.redirected 2016-08-17 21:16:08,406 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:16:08,407 WARNING celery.redirected 2016-08-17 21:16:08,407 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:16:08,408 WARNING celery.redirected 2016-08-17 21:16:08,408 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:16:08,414 WARNING celery.redirected 2016-08-17 21:16:08,414 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:16:08,415 WARNING celery.redirected 2016-08-17 21:16:08,415 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 15, 8, 406056)}
2016-08-17 21:16:08,417 WARNING celery.redirected 2016-08-17 21:16:08,416 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:16:08,418 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:16:08,425 INFO celery.worker.job Task schedule_clean_desktops[ea366e98-5acd-49da-a03c-6ce150b7f781] succeeded in 0.02056694099883316s: None
2016-08-17 21:16:17,335 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:16:17,335 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:16:17,338 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:16:17,338 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:16:17,344 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:16:17,344 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:16:17,344 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:16:17,344 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:16:47,327 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:16:47,346 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:16:47,347 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:16:47,351 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:16:47,351 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:16:47,357 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:16:47,357 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:16:47,357 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:16:47,357 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:16:47,614 INFO celery.worker.strategy Received task: schedule_start_lesson[fe2283ef-b3b2-4d1d-b89f-818df042abed]
2016-08-17 21:16:47,616 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:16:47,619 INFO celery Scheduling start lesson tasks
2016-08-17 21:16:47,621 WARNING celery.redirected 2016-08-17 21:16:47,620 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:16:47,623 WARNING celery.redirected 2016-08-17 21:16:47,623 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:16:47,623 WARNING celery.redirected 2016-08-17 21:16:47,623 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:16:47,629 WARNING celery.redirected 2016-08-17 21:16:47,629 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:16:47,630 WARNING celery.redirected 2016-08-17 21:16:47,630 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 16, 47, 626183), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 26, 47, 626183)}
2016-08-17 21:16:47,633 WARNING celery.redirected 2016-08-17 21:16:47,633 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:16:47,634 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:16:47,647 INFO celery.worker.job Task schedule_start_lesson[fe2283ef-b3b2-4d1d-b89f-818df042abed] succeeded in 0.0307901319974917s: None
2016-08-17 21:17:07,336 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:17:07,478 INFO celery.worker.strategy Received task: schedule_clean_desktops[93bba0f0-896f-4e71-8038-8aba029012a4]
2016-08-17 21:17:07,481 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:17:07,482 WARNING celery.redirected 2016-08-17 21:17:07,482 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:17:07,483 WARNING celery.redirected 2016-08-17 21:17:07,483 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:17:07,484 WARNING celery.redirected 2016-08-17 21:17:07,484 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:17:07,488 WARNING celery.redirected 2016-08-17 21:17:07,488 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:17:07,488 WARNING celery.redirected 2016-08-17 21:17:07,488 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 16, 7, 481743), 'desktop_state_2': 'DELETED'}
2016-08-17 21:17:07,492 WARNING celery.redirected 2016-08-17 21:17:07,492 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:17:07,494 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:17:07,501 INFO celery.worker.job Task schedule_clean_desktops[93bba0f0-896f-4e71-8038-8aba029012a4] succeeded in 0.020196694997139275s: None
2016-08-17 21:17:17,476 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:17:17,476 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:17:17,481 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:17:17,481 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:17:17,486 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:17:17,486 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:17:17,486 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:17:17,487 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:17:47,463 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:17:48,381 INFO celery.worker.strategy Received task: schedule_start_lesson[8d5502cd-e55a-45c3-94d7-ae70c7a9c140]
2016-08-17 21:17:48,382 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:17:48,383 INFO celery Scheduling start lesson tasks
2016-08-17 21:17:48,384 WARNING celery.redirected 2016-08-17 21:17:48,384 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:17:48,385 WARNING celery.redirected 2016-08-17 21:17:48,385 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:17:48,386 WARNING celery.redirected 2016-08-17 21:17:48,386 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:17:48,391 WARNING celery.redirected 2016-08-17 21:17:48,390 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:17:48,392 WARNING celery.redirected 2016-08-17 21:17:48,391 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 17, 48, 388011), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 27, 48, 388011)}
2016-08-17 21:17:48,395 WARNING celery.redirected 2016-08-17 21:17:48,395 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:17:48,397 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:17:48,406 INFO celery.worker.job Task schedule_start_lesson[8d5502cd-e55a-45c3-94d7-ae70c7a9c140] succeeded in 0.024257632001535967s: None
2016-08-17 21:17:52,483 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:17:52,483 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:17:52,486 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:17:52,486 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:17:52,490 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:17:52,490 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:17:52,491 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:17:52,491 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:18:07,479 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:18:08,341 INFO celery.worker.strategy Received task: schedule_clean_desktops[f41f1e57-3135-4632-b256-b26df784e1b4]
2016-08-17 21:18:08,342 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:18:08,344 WARNING celery.redirected 2016-08-17 21:18:08,344 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:18:08,345 WARNING celery.redirected 2016-08-17 21:18:08,345 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:18:08,346 WARNING celery.redirected 2016-08-17 21:18:08,345 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:18:08,349 WARNING celery.redirected 2016-08-17 21:18:08,349 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:18:08,350 WARNING celery.redirected 2016-08-17 21:18:08,349 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 17, 8, 343653), 'desktop_state_2': 'DELETED'}
2016-08-17 21:18:08,353 WARNING celery.redirected 2016-08-17 21:18:08,353 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:18:08,354 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:18:08,364 INFO celery.worker.job Task schedule_clean_desktops[f41f1e57-3135-4632-b256-b26df784e1b4] succeeded in 0.021267335003358312s: None
2016-08-17 21:18:22,503 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:18:22,504 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:18:22,512 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:18:22,513 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:18:47,501 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:18:48,048 INFO celery.worker.strategy Received task: schedule_start_lesson[7714bc5c-1ac8-4147-b63b-63aedf1789dd]
2016-08-17 21:18:48,050 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:18:48,050 INFO celery Scheduling start lesson tasks
2016-08-17 21:18:48,051 WARNING celery.redirected 2016-08-17 21:18:48,051 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:18:48,052 WARNING celery.redirected 2016-08-17 21:18:48,052 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:18:48,053 WARNING celery.redirected 2016-08-17 21:18:48,053 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:18:48,058 WARNING celery.redirected 2016-08-17 21:18:48,058 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:18:48,059 WARNING celery.redirected 2016-08-17 21:18:48,058 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 18, 48, 54823), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 28, 48, 54823)}
2016-08-17 21:18:48,061 WARNING celery.redirected 2016-08-17 21:18:48,061 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:18:48,062 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:18:48,070 INFO celery.worker.job Task schedule_start_lesson[7714bc5c-1ac8-4147-b63b-63aedf1789dd] succeeded in 0.020112317994062323s: None
2016-08-17 21:18:52,521 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:18:52,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:18:52,524 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:18:52,525 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:18:52,531 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:18:52,531 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:18:52,532 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:18:52,532 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:19:07,523 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:19:07,980 INFO celery.worker.strategy Received task: schedule_clean_desktops[fffcf8b0-9688-459d-87e2-309421837fde]
2016-08-17 21:19:07,981 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:19:07,983 WARNING celery.redirected 2016-08-17 21:19:07,982 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:19:07,984 WARNING celery.redirected 2016-08-17 21:19:07,983 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:19:07,984 WARNING celery.redirected 2016-08-17 21:19:07,984 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:19:07,987 WARNING celery.redirected 2016-08-17 21:19:07,987 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:19:07,988 WARNING celery.redirected 2016-08-17 21:19:07,988 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 18, 7, 982245), 'desktop_state_2': 'DELETED'}
2016-08-17 21:19:07,990 WARNING celery.redirected 2016-08-17 21:19:07,990 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:19:07,991 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:19:08,000 INFO celery.worker.job Task schedule_clean_desktops[fffcf8b0-9688-459d-87e2-309421837fde] succeeded in 0.018775011005345732s: None
2016-08-17 21:19:22,540 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:19:22,541 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:19:22,543 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:19:22,543 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:19:22,547 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:19:22,548 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:19:22,548 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:19:22,548 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:19:52,530 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:19:52,698 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:19:52,698 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:19:52,701 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:19:52,701 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:19:52,704 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:19:52,704 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:19:52,705 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:19:52,705 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:19:53,766 INFO celery.worker.strategy Received task: schedule_start_lesson[771b4c76-c78e-41ed-a768-d954cdef23aa]
2016-08-17 21:19:53,768 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:19:53,768 INFO celery Scheduling start lesson tasks
2016-08-17 21:19:53,769 WARNING celery.redirected 2016-08-17 21:19:53,769 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:19:53,771 WARNING celery.redirected 2016-08-17 21:19:53,770 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:19:53,771 WARNING celery.redirected 2016-08-17 21:19:53,771 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:19:53,776 WARNING celery.redirected 2016-08-17 21:19:53,776 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:19:53,777 WARNING celery.redirected 2016-08-17 21:19:53,776 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 19, 53, 772796), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 29, 53, 772796)}
2016-08-17 21:19:53,779 WARNING celery.redirected 2016-08-17 21:19:53,779 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:19:53,781 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:19:53,792 INFO celery.worker.job Task schedule_start_lesson[771b4c76-c78e-41ed-a768-d954cdef23aa] succeeded in 0.024746732000494376s: None
2016-08-17 21:20:12,701 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:20:13,484 INFO celery.worker.strategy Received task: schedule_clean_desktops[482e5c81-ffd8-4d43-aa39-9a536d5f6cb5]
2016-08-17 21:20:13,486 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:20:13,487 WARNING celery.redirected 2016-08-17 21:20:13,487 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:20:13,488 WARNING celery.redirected 2016-08-17 21:20:13,488 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:20:13,489 WARNING celery.redirected 2016-08-17 21:20:13,488 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:20:13,493 WARNING celery.redirected 2016-08-17 21:20:13,493 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:20:13,494 WARNING celery.redirected 2016-08-17 21:20:13,494 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 19, 13, 486637)}
2016-08-17 21:20:13,497 WARNING celery.redirected 2016-08-17 21:20:13,497 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:20:13,498 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:20:13,505 INFO celery.worker.job Task schedule_clean_desktops[482e5c81-ffd8-4d43-aa39-9a536d5f6cb5] succeeded in 0.019785356998909265s: None
2016-08-17 21:20:22,719 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:20:22,719 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:20:22,722 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:20:22,723 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:20:22,728 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:20:22,729 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:20:22,729 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:20:22,729 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:20:57,712 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:20:57,712 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:20:57,712 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:20:57,713 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:20:57,715 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:20:57,734 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:20:57,735 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:20:57,737 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:20:57,737 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:20:57,741 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:20:57,741 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:20:57,741 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:20:57,741 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:20:58,514 INFO celery.worker.strategy Received task: schedule_start_lesson[76ea79f0-87b9-4be8-a2f2-f7b0522d7299]
2016-08-17 21:20:58,515 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:20:58,517 INFO celery Scheduling start lesson tasks
2016-08-17 21:20:58,518 WARNING celery.redirected 2016-08-17 21:20:58,518 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:20:58,519 WARNING celery.redirected 2016-08-17 21:20:58,519 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:20:58,520 WARNING celery.redirected 2016-08-17 21:20:58,519 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:20:58,525 WARNING celery.redirected 2016-08-17 21:20:58,525 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:20:58,526 WARNING celery.redirected 2016-08-17 21:20:58,526 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 20, 58, 521428), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 30, 58, 521428)}
2016-08-17 21:20:58,529 WARNING celery.redirected 2016-08-17 21:20:58,528 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:20:58,530 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:20:58,538 INFO celery.worker.job Task schedule_start_lesson[76ea79f0-87b9-4be8-a2f2-f7b0522d7299] succeeded in 0.022660563001409173s: None
2016-08-17 21:21:17,732 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:21:18,159 INFO celery.worker.strategy Received task: schedule_clean_desktops[3e9bdb30-362f-4d65-9e7c-32774cf1a3c5]
2016-08-17 21:21:18,161 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:21:18,162 WARNING celery.redirected 2016-08-17 21:21:18,162 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:21:18,163 WARNING celery.redirected 2016-08-17 21:21:18,163 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:21:18,164 WARNING celery.redirected 2016-08-17 21:21:18,164 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:21:18,169 WARNING celery.redirected 2016-08-17 21:21:18,169 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:21:18,170 WARNING celery.redirected 2016-08-17 21:21:18,170 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 20, 18, 161975), 'desktop_state_2': 'DELETED'}
2016-08-17 21:21:18,172 WARNING celery.redirected 2016-08-17 21:21:18,172 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:21:18,173 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:21:18,180 INFO celery.worker.job Task schedule_clean_desktops[3e9bdb30-362f-4d65-9e7c-32774cf1a3c5] succeeded in 0.019894615004886873s: None
2016-08-17 21:21:27,755 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:21:27,755 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:21:27,759 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:21:27,760 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:21:27,765 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:21:27,766 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:21:27,766 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:21:27,766 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:22:02,748 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:22:02,748 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:22:02,749 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:22:02,749 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:22:02,751 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:22:02,773 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:22:02,773 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:22:02,776 INFO celery.worker.strategy Received task: schedule_start_lesson[1882620e-577a-48a1-8b2f-27d5cbbf34da]
2016-08-17 21:22:02,776 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:22:02,777 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:22:02,777 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:22:02,778 INFO celery Scheduling start lesson tasks
2016-08-17 21:22:02,780 WARNING celery.redirected 2016-08-17 21:22:02,779 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:22:02,781 WARNING celery.redirected 2016-08-17 21:22:02,781 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:22:02,782 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:22:02,782 WARNING celery.redirected 2016-08-17 21:22:02,782 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:22:02,782 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:22:02,783 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:22:02,783 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:22:02,788 WARNING celery.redirected 2016-08-17 21:22:02,787 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:22:02,789 WARNING celery.redirected 2016-08-17 21:22:02,788 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 22, 2, 784358), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 32, 2, 784358)}
2016-08-17 21:22:02,791 WARNING celery.redirected 2016-08-17 21:22:02,791 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:22:02,793 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:22:02,804 INFO celery.worker.job Task schedule_start_lesson[1882620e-577a-48a1-8b2f-27d5cbbf34da] succeeded in 0.026942896001855843s: None
2016-08-17 21:22:22,771 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:22:23,319 INFO celery.worker.strategy Received task: schedule_clean_desktops[124d509d-1919-4c40-b0fb-1aaf6bac9c57]
2016-08-17 21:22:23,325 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:22:23,330 WARNING celery.redirected 2016-08-17 21:22:23,329 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:22:23,332 WARNING celery.redirected 2016-08-17 21:22:23,331 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:22:23,335 WARNING celery.redirected 2016-08-17 21:22:23,333 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:22:23,345 WARNING celery.redirected 2016-08-17 21:22:23,345 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:22:23,346 WARNING celery.redirected 2016-08-17 21:22:23,346 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 21, 23, 328416)}
2016-08-17 21:22:23,349 WARNING celery.redirected 2016-08-17 21:22:23,349 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:22:23,351 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:22:23,367 INFO celery.worker.job Task schedule_clean_desktops[124d509d-1919-4c40-b0fb-1aaf6bac9c57] succeeded in 0.04315452599985292s: None
2016-08-17 21:22:32,788 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:22:32,788 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:22:32,791 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:22:32,791 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:22:32,798 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:22:32,798 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:22:32,799 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:22:32,799 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:23:07,776 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:23:07,777 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:23:07,778 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:23:07,778 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:23:07,785 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:23:07,826 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:23:07,827 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:23:07,837 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:23:07,837 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:23:07,841 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:23:07,841 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:23:07,842 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:23:07,843 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:23:08,040 INFO celery.worker.strategy Received task: schedule_start_lesson[393ad36c-75a2-4349-ac59-44a83dd89b0f]
2016-08-17 21:23:08,041 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:23:08,043 INFO celery Scheduling start lesson tasks
2016-08-17 21:23:08,044 WARNING celery.redirected 2016-08-17 21:23:08,044 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:23:08,045 WARNING celery.redirected 2016-08-17 21:23:08,045 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:23:08,046 WARNING celery.redirected 2016-08-17 21:23:08,045 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:23:08,049 WARNING celery.redirected 2016-08-17 21:23:08,049 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:23:08,050 WARNING celery.redirected 2016-08-17 21:23:08,049 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 23, 8, 47340), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 33, 8, 47340)}
2016-08-17 21:23:08,052 WARNING celery.redirected 2016-08-17 21:23:08,052 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:23:08,053 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:23:08,061 INFO celery.worker.job Task schedule_start_lesson[393ad36c-75a2-4349-ac59-44a83dd89b0f] succeeded in 0.019777187997533474s: None
2016-08-17 21:23:27,831 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:23:28,823 INFO celery.worker.strategy Received task: schedule_clean_desktops[f3949dd2-0555-4d9f-afc0-2f03029c8e6a]
2016-08-17 21:23:28,825 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:23:28,826 WARNING celery.redirected 2016-08-17 21:23:28,826 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:23:28,828 WARNING celery.redirected 2016-08-17 21:23:28,828 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:23:28,829 WARNING celery.redirected 2016-08-17 21:23:28,829 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:23:28,834 WARNING celery.redirected 2016-08-17 21:23:28,833 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:23:28,834 WARNING celery.redirected 2016-08-17 21:23:28,834 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 22, 28, 825892), 'desktop_state_2': 'DELETED'}
2016-08-17 21:23:28,837 WARNING celery.redirected 2016-08-17 21:23:28,837 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:23:28,838 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:23:28,849 INFO celery.worker.job Task schedule_clean_desktops[f3949dd2-0555-4d9f-afc0-2f03029c8e6a] succeeded in 0.024018267999053933s: None
2016-08-17 21:23:37,845 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:23:37,845 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:23:37,847 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:23:37,847 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:23:37,852 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:23:37,853 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:23:37,853 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:23:37,853 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:24:12,842 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:24:12,843 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:24:12,843 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:24:12,843 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:24:12,850 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:24:12,883 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:24:12,884 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:24:12,890 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:24:12,892 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:24:12,899 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:24:12,900 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:24:12,901 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:24:12,901 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:24:13,343 INFO celery.worker.strategy Received task: schedule_start_lesson[2521058b-c873-4390-b421-0c94263ab46a]
2016-08-17 21:24:13,346 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:24:13,347 INFO celery Scheduling start lesson tasks
2016-08-17 21:24:13,348 WARNING celery.redirected 2016-08-17 21:24:13,348 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:24:13,350 WARNING celery.redirected 2016-08-17 21:24:13,350 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:24:13,353 WARNING celery.redirected 2016-08-17 21:24:13,352 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:24:13,363 WARNING celery.redirected 2016-08-17 21:24:13,363 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:24:13,364 WARNING celery.redirected 2016-08-17 21:24:13,364 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 24, 13, 359480), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 34, 13, 359480)}
2016-08-17 21:24:13,366 WARNING celery.redirected 2016-08-17 21:24:13,366 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:24:13,367 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:24:13,375 INFO celery.worker.job Task schedule_start_lesson[2521058b-c873-4390-b421-0c94263ab46a] succeeded in 0.029559784998127725s: None
2016-08-17 21:24:32,896 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:24:33,924 INFO celery.worker.strategy Received task: schedule_clean_desktops[174bac51-6eda-424a-b5b0-72a9b7ecd0e9]
2016-08-17 21:24:33,926 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:24:33,927 WARNING celery.redirected 2016-08-17 21:24:33,927 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:24:33,928 WARNING celery.redirected 2016-08-17 21:24:33,928 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:24:33,929 WARNING celery.redirected 2016-08-17 21:24:33,928 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:24:33,932 WARNING celery.redirected 2016-08-17 21:24:33,931 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:24:33,932 WARNING celery.redirected 2016-08-17 21:24:33,932 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 23, 33, 926797), 'desktop_state_2': 'DELETED'}
2016-08-17 21:24:33,934 WARNING celery.redirected 2016-08-17 21:24:33,934 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:24:33,935 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:24:33,943 INFO celery.worker.job Task schedule_clean_desktops[174bac51-6eda-424a-b5b0-72a9b7ecd0e9] succeeded in 0.017213110004377086s: None
2016-08-17 21:24:42,925 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:24:42,925 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:24:42,927 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:24:42,927 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:24:42,932 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:24:42,932 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:24:42,933 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:24:42,933 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:25:17,909 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:25:17,909 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:25:17,909 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:25:17,909 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:25:17,911 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:25:18,180 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:25:18,180 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:25:18,182 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:25:18,182 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:25:18,186 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:25:18,186 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:25:18,187 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:25:18,187 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:25:19,218 INFO celery.worker.strategy Received task: schedule_start_lesson[16a9929a-b976-4870-b1c3-b3386bafd42f]
2016-08-17 21:25:19,220 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:25:19,222 INFO celery Scheduling start lesson tasks
2016-08-17 21:25:19,224 WARNING celery.redirected 2016-08-17 21:25:19,224 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:25:19,225 WARNING celery.redirected 2016-08-17 21:25:19,225 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:25:19,226 WARNING celery.redirected 2016-08-17 21:25:19,226 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:25:19,230 WARNING celery.redirected 2016-08-17 21:25:19,229 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:25:19,230 WARNING celery.redirected 2016-08-17 21:25:19,230 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 25, 19, 227916), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 35, 19, 227916)}
2016-08-17 21:25:19,232 WARNING celery.redirected 2016-08-17 21:25:19,232 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:25:19,234 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:25:19,246 INFO celery.worker.job Task schedule_start_lesson[16a9929a-b976-4870-b1c3-b3386bafd42f] succeeded in 0.026643011995474808s: None
2016-08-17 21:25:33,181 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:25:33,950 INFO celery.worker.strategy Received task: schedule_clean_desktops[36bc55e6-8486-4868-8ee6-5f285056d055]
2016-08-17 21:25:33,952 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:25:33,954 WARNING celery.redirected 2016-08-17 21:25:33,954 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:25:33,955 WARNING celery.redirected 2016-08-17 21:25:33,955 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:25:33,955 WARNING celery.redirected 2016-08-17 21:25:33,955 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:25:33,958 WARNING celery.redirected 2016-08-17 21:25:33,958 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:25:33,959 WARNING celery.redirected 2016-08-17 21:25:33,959 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 24, 33, 953531), 'desktop_state_2': 'DELETED'}
2016-08-17 21:25:33,961 WARNING celery.redirected 2016-08-17 21:25:33,961 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:25:33,962 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:25:33,970 INFO celery.worker.job Task schedule_clean_desktops[36bc55e6-8486-4868-8ee6-5f285056d055] succeeded in 0.01763810499687679s: None
2016-08-17 21:25:48,199 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:25:48,199 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:25:48,202 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:25:48,202 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:25:48,209 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:25:48,209 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:25:48,210 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:25:48,210 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:26:18,191 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:26:18,212 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:26:18,212 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:26:18,215 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:26:18,215 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:26:18,219 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:26:18,219 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:26:18,219 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:26:18,220 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:26:18,498 INFO celery.worker.strategy Received task: schedule_start_lesson[699f1636-45d4-4aac-a53c-25f0910a666a]
2016-08-17 21:26:18,501 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:26:18,502 INFO celery Scheduling start lesson tasks
2016-08-17 21:26:18,504 WARNING celery.redirected 2016-08-17 21:26:18,503 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:26:18,505 WARNING celery.redirected 2016-08-17 21:26:18,505 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:26:18,506 WARNING celery.redirected 2016-08-17 21:26:18,506 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:26:18,511 WARNING celery.redirected 2016-08-17 21:26:18,511 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:26:18,512 WARNING celery.redirected 2016-08-17 21:26:18,512 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 26, 18, 508426), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 36, 18, 508426)}
2016-08-17 21:26:18,514 WARNING celery.redirected 2016-08-17 21:26:18,514 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:26:18,515 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:26:18,523 INFO celery.worker.job Task schedule_start_lesson[699f1636-45d4-4aac-a53c-25f0910a666a] succeeded in 0.021439886004372966s: None
2016-08-17 21:26:33,208 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:26:34,322 INFO celery.worker.strategy Received task: schedule_clean_desktops[cbeacfc2-2129-40a6-bed5-1fb0b0ac5fa2]
2016-08-17 21:26:34,323 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:26:34,325 WARNING celery.redirected 2016-08-17 21:26:34,324 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:26:34,326 WARNING celery.redirected 2016-08-17 21:26:34,326 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:26:34,327 WARNING celery.redirected 2016-08-17 21:26:34,327 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:26:34,331 WARNING celery.redirected 2016-08-17 21:26:34,330 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:26:34,332 WARNING celery.redirected 2016-08-17 21:26:34,331 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 25, 34, 324308)}
2016-08-17 21:26:34,334 WARNING celery.redirected 2016-08-17 21:26:34,334 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:26:34,335 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:26:34,343 INFO celery.worker.job Task schedule_clean_desktops[cbeacfc2-2129-40a6-bed5-1fb0b0ac5fa2] succeeded in 0.019866392998665106s: None
2016-08-17 21:26:48,245 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:26:48,245 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:26:48,247 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:26:48,248 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:26:48,254 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:26:48,254 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:26:48,254 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:26:48,255 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:27:18,233 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:27:18,272 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:27:18,272 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:27:18,281 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:27:18,281 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:27:18,287 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:27:18,288 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:27:18,289 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:27:18,290 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:27:18,523 INFO celery.worker.strategy Received task: schedule_start_lesson[c1caba58-50e9-49ca-a4ad-0082e5091742]
2016-08-17 21:27:18,525 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:27:18,526 INFO celery Scheduling start lesson tasks
2016-08-17 21:27:18,527 WARNING celery.redirected 2016-08-17 21:27:18,527 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:27:18,528 WARNING celery.redirected 2016-08-17 21:27:18,528 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:27:18,528 WARNING celery.redirected 2016-08-17 21:27:18,528 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:27:18,532 WARNING celery.redirected 2016-08-17 21:27:18,532 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:27:18,533 WARNING celery.redirected 2016-08-17 21:27:18,533 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 27, 18, 530310), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 37, 18, 530310)}
2016-08-17 21:27:18,535 WARNING celery.redirected 2016-08-17 21:27:18,535 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:27:18,536 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:27:18,542 INFO celery.worker.job Task schedule_start_lesson[c1caba58-50e9-49ca-a4ad-0082e5091742] succeeded in 0.01724882500275271s: None
2016-08-17 21:27:33,290 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:27:33,458 INFO celery.worker.strategy Received task: schedule_clean_desktops[e5fe4ea2-06cc-4a40-8264-cb4835154329]
2016-08-17 21:27:33,459 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:27:33,461 WARNING celery.redirected 2016-08-17 21:27:33,460 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:27:33,462 WARNING celery.redirected 2016-08-17 21:27:33,462 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:27:33,462 WARNING celery.redirected 2016-08-17 21:27:33,462 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:27:33,465 WARNING celery.redirected 2016-08-17 21:27:33,465 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:27:33,466 WARNING celery.redirected 2016-08-17 21:27:33,466 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 26, 33, 460221)}
2016-08-17 21:27:33,468 WARNING celery.redirected 2016-08-17 21:27:33,468 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:27:33,469 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:27:33,476 INFO celery.worker.job Task schedule_clean_desktops[e5fe4ea2-06cc-4a40-8264-cb4835154329] succeeded in 0.01740977499866858s: None
2016-08-17 21:27:48,303 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:27:48,303 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:27:48,306 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:27:48,306 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:27:48,311 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:27:48,311 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:27:48,312 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:27:48,312 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:28:18,294 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:28:18,315 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:28:18,315 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:28:18,318 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:28:18,318 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:28:18,322 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:28:18,322 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:28:18,322 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:28:18,322 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:28:18,407 INFO celery.worker.strategy Received task: schedule_start_lesson[3e763a42-2450-4a8f-b571-ebf4ff188e09]
2016-08-17 21:28:18,409 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:28:18,411 INFO celery Scheduling start lesson tasks
2016-08-17 21:28:18,412 WARNING celery.redirected 2016-08-17 21:28:18,411 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:28:18,413 WARNING celery.redirected 2016-08-17 21:28:18,413 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:28:18,414 WARNING celery.redirected 2016-08-17 21:28:18,413 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:28:18,418 WARNING celery.redirected 2016-08-17 21:28:18,418 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:28:18,419 WARNING celery.redirected 2016-08-17 21:28:18,419 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 28, 18, 415853), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 38, 18, 415853)}
2016-08-17 21:28:18,421 WARNING celery.redirected 2016-08-17 21:28:18,420 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:28:18,422 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:28:18,431 INFO celery.worker.job Task schedule_start_lesson[3e763a42-2450-4a8f-b571-ebf4ff188e09] succeeded in 0.022083552998083178s: None
2016-08-17 21:28:33,314 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:28:34,458 INFO celery.worker.strategy Received task: schedule_clean_desktops[eb898178-9f56-415d-9914-159198156e73]
2016-08-17 21:28:34,460 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:28:34,461 WARNING celery.redirected 2016-08-17 21:28:34,461 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:28:34,463 WARNING celery.redirected 2016-08-17 21:28:34,463 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:28:34,464 WARNING celery.redirected 2016-08-17 21:28:34,463 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:28:34,468 WARNING celery.redirected 2016-08-17 21:28:34,468 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:28:34,469 WARNING celery.redirected 2016-08-17 21:28:34,469 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 27, 34, 461022)}
2016-08-17 21:28:34,471 WARNING celery.redirected 2016-08-17 21:28:34,471 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:28:34,472 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:28:34,484 INFO celery.worker.job Task schedule_clean_desktops[eb898178-9f56-415d-9914-159198156e73] succeeded in 0.023865877999924123s: None
2016-08-17 21:28:48,393 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:28:48,393 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:28:48,398 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:28:48,398 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:28:48,403 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:28:48,403 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:28:48,403 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:28:48,404 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:29:18,388 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:29:18,555 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:29:18,555 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:29:18,558 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:29:18,558 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:29:18,561 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:29:18,562 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:29:18,562 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:29:18,562 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:29:19,625 INFO celery.worker.strategy Received task: schedule_start_lesson[afbc9bd0-46bc-40e2-bbd8-223346380e16]
2016-08-17 21:29:19,627 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:29:19,629 INFO celery Scheduling start lesson tasks
2016-08-17 21:29:19,630 WARNING celery.redirected 2016-08-17 21:29:19,630 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:29:19,631 WARNING celery.redirected 2016-08-17 21:29:19,631 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:29:19,631 WARNING celery.redirected 2016-08-17 21:29:19,631 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:29:19,637 WARNING celery.redirected 2016-08-17 21:29:19,637 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:29:19,638 WARNING celery.redirected 2016-08-17 21:29:19,638 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 29, 19, 633029), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 39, 19, 633029)}
2016-08-17 21:29:19,641 WARNING celery.redirected 2016-08-17 21:29:19,640 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:29:19,642 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:29:19,649 INFO celery.worker.job Task schedule_start_lesson[afbc9bd0-46bc-40e2-bbd8-223346380e16] succeeded in 0.02214626900240546s: None
2016-08-17 21:29:33,551 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:29:34,160 INFO celery.worker.strategy Received task: schedule_clean_desktops[5127bde3-a0e6-458b-abd4-92f144b65dec]
2016-08-17 21:29:34,161 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:29:34,163 WARNING celery.redirected 2016-08-17 21:29:34,163 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:29:34,164 WARNING celery.redirected 2016-08-17 21:29:34,164 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:29:34,164 WARNING celery.redirected 2016-08-17 21:29:34,164 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:29:34,169 WARNING celery.redirected 2016-08-17 21:29:34,169 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:29:34,170 WARNING celery.redirected 2016-08-17 21:29:34,170 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 28, 34, 162259), 'desktop_state_2': 'DELETED'}
2016-08-17 21:29:34,172 WARNING celery.redirected 2016-08-17 21:29:34,172 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:29:34,173 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:29:34,181 INFO celery.worker.job Task schedule_clean_desktops[5127bde3-a0e6-458b-abd4-92f144b65dec] succeeded in 0.0206567700006417s: None
2016-08-17 21:29:48,575 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:29:48,576 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:29:48,586 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:29:48,587 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:30:18,585 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:30:18,585 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:30:18,585 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:30:18,586 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:30:18,587 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:30:18,606 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:30:18,606 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:30:18,608 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:30:18,608 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:30:18,611 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:30:18,611 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:30:18,612 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:30:18,612 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:30:18,707 INFO celery.worker.strategy Received task: schedule_start_lesson[8acac0e6-2665-4e71-a55d-e427095f5362]
2016-08-17 21:30:18,708 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:30:18,709 INFO celery Scheduling start lesson tasks
2016-08-17 21:30:18,710 WARNING celery.redirected 2016-08-17 21:30:18,710 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:30:18,711 WARNING celery.redirected 2016-08-17 21:30:18,711 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:30:18,711 WARNING celery.redirected 2016-08-17 21:30:18,711 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:30:18,715 WARNING celery.redirected 2016-08-17 21:30:18,715 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:30:18,715 WARNING celery.redirected 2016-08-17 21:30:18,715 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 30, 18, 713234), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 40, 18, 713234)}
2016-08-17 21:30:18,717 WARNING celery.redirected 2016-08-17 21:30:18,717 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:30:18,718 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:30:18,727 INFO celery.worker.job Task schedule_start_lesson[8acac0e6-2665-4e71-a55d-e427095f5362] succeeded in 0.019010365998838097s: None
2016-08-17 21:30:38,599 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:30:39,504 INFO celery.worker.strategy Received task: schedule_clean_desktops[bd9c0a6a-2269-44af-baeb-b5a9f9334a35]
2016-08-17 21:30:39,505 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:30:39,507 WARNING celery.redirected 2016-08-17 21:30:39,506 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:30:39,508 WARNING celery.redirected 2016-08-17 21:30:39,507 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:30:39,508 WARNING celery.redirected 2016-08-17 21:30:39,508 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:30:39,511 WARNING celery.redirected 2016-08-17 21:30:39,511 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:30:39,512 WARNING celery.redirected 2016-08-17 21:30:39,511 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 29, 39, 506123)}
2016-08-17 21:30:39,514 WARNING celery.redirected 2016-08-17 21:30:39,513 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:30:39,515 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:30:39,523 INFO celery.worker.job Task schedule_clean_desktops[bd9c0a6a-2269-44af-baeb-b5a9f9334a35] succeeded in 0.01783062200411223s: None
2016-08-17 21:30:48,613 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:30:48,613 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:30:48,616 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:30:48,616 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:30:48,621 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:30:48,622 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:30:48,622 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:30:48,622 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:31:23,600 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:31:23,602 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:31:23,602 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:31:23,603 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:31:23,609 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:31:23,631 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:31:23,631 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:31:23,634 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:31:23,634 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:31:23,638 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:31:23,639 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:31:23,639 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:31:23,639 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:31:23,954 INFO celery.worker.strategy Received task: schedule_start_lesson[bb8f4693-b37b-4d9a-a5da-6c1ad96c1b6a]
2016-08-17 21:31:23,955 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:31:23,956 INFO celery Scheduling start lesson tasks
2016-08-17 21:31:23,957 WARNING celery.redirected 2016-08-17 21:31:23,957 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:31:23,958 WARNING celery.redirected 2016-08-17 21:31:23,958 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:31:23,959 WARNING celery.redirected 2016-08-17 21:31:23,959 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:31:23,962 WARNING celery.redirected 2016-08-17 21:31:23,962 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:31:23,963 WARNING celery.redirected 2016-08-17 21:31:23,963 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 31, 23, 960681), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 41, 23, 960681)}
2016-08-17 21:31:23,965 WARNING celery.redirected 2016-08-17 21:31:23,965 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:31:23,967 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:31:23,975 INFO celery.worker.job Task schedule_start_lesson[bb8f4693-b37b-4d9a-a5da-6c1ad96c1b6a] succeeded in 0.02025087999936659s: None
2016-08-17 21:31:43,629 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:31:44,200 INFO celery.worker.strategy Received task: schedule_clean_desktops[ad2d7f15-92d1-4709-98aa-7773aea2689d]
2016-08-17 21:31:44,202 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:31:44,204 WARNING celery.redirected 2016-08-17 21:31:44,204 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:31:44,205 WARNING celery.redirected 2016-08-17 21:31:44,205 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:31:44,205 WARNING celery.redirected 2016-08-17 21:31:44,205 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:31:44,208 WARNING celery.redirected 2016-08-17 21:31:44,208 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:31:44,209 WARNING celery.redirected 2016-08-17 21:31:44,209 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 30, 44, 203472)}
2016-08-17 21:31:44,211 WARNING celery.redirected 2016-08-17 21:31:44,211 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:31:44,212 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:31:44,221 INFO celery.worker.job Task schedule_clean_desktops[ad2d7f15-92d1-4709-98aa-7773aea2689d] succeeded in 0.01860173900058726s: None
2016-08-17 21:31:53,645 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:31:53,646 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:31:53,648 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:31:53,649 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:31:53,654 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:31:53,654 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:31:53,654 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:31:53,655 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:32:28,637 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:32:28,638 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:32:28,638 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:32:28,638 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:32:28,641 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:32:28,865 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:32:28,866 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:32:28,868 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:32:28,868 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:32:28,872 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:32:28,872 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:32:28,872 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:32:28,872 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:32:29,916 INFO celery.worker.strategy Received task: schedule_start_lesson[f9bf5099-08ea-4d02-a37a-721108b7fc61]
2016-08-17 21:32:29,917 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:32:29,918 INFO celery Scheduling start lesson tasks
2016-08-17 21:32:29,919 WARNING celery.redirected 2016-08-17 21:32:29,919 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:32:29,920 WARNING celery.redirected 2016-08-17 21:32:29,920 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:32:29,920 WARNING celery.redirected 2016-08-17 21:32:29,920 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:32:29,925 WARNING celery.redirected 2016-08-17 21:32:29,925 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:32:29,926 WARNING celery.redirected 2016-08-17 21:32:29,925 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 32, 29, 922278), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 42, 29, 922278)}
2016-08-17 21:32:29,927 WARNING celery.redirected 2016-08-17 21:32:29,927 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:32:29,928 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:32:29,937 INFO celery.worker.job Task schedule_start_lesson[f9bf5099-08ea-4d02-a37a-721108b7fc61] succeeded in 0.019717046001460403s: None
2016-08-17 21:32:48,860 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:32:49,421 INFO celery.worker.strategy Received task: schedule_clean_desktops[334f48b7-c7a8-4071-8da2-966aee4d0df8]
2016-08-17 21:32:49,422 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:32:49,424 WARNING celery.redirected 2016-08-17 21:32:49,424 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:32:49,426 WARNING celery.redirected 2016-08-17 21:32:49,426 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:32:49,426 WARNING celery.redirected 2016-08-17 21:32:49,426 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:32:49,430 WARNING celery.redirected 2016-08-17 21:32:49,429 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:32:49,430 WARNING celery.redirected 2016-08-17 21:32:49,430 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 31, 49, 423574)}
2016-08-17 21:32:49,432 WARNING celery.redirected 2016-08-17 21:32:49,432 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:32:49,433 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:32:49,443 INFO celery.worker.job Task schedule_clean_desktops[334f48b7-c7a8-4071-8da2-966aee4d0df8] succeeded in 0.020542097998259123s: None
2016-08-17 21:32:58,877 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:32:58,877 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:32:58,880 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:32:58,880 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:32:58,884 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:32:58,885 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:32:58,885 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:32:58,885 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:33:33,864 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:33:33,864 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:33:33,864 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:33:33,865 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:33:33,866 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:33:33,883 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:33:33,883 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:33:33,885 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:33:33,885 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:33:33,888 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:33:33,889 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:33:33,889 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:33:33,889 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:33:34,053 INFO celery.worker.strategy Received task: schedule_start_lesson[d8eb73e5-3192-4adf-a4b2-3c050704c164]
2016-08-17 21:33:34,055 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:33:34,056 INFO celery Scheduling start lesson tasks
2016-08-17 21:33:34,057 WARNING celery.redirected 2016-08-17 21:33:34,057 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:33:34,059 WARNING celery.redirected 2016-08-17 21:33:34,058 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:33:34,059 WARNING celery.redirected 2016-08-17 21:33:34,059 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:33:34,063 WARNING celery.redirected 2016-08-17 21:33:34,063 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:33:34,064 WARNING celery.redirected 2016-08-17 21:33:34,063 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 33, 34, 60961), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 43, 34, 60961)}
2016-08-17 21:33:34,066 WARNING celery.redirected 2016-08-17 21:33:34,065 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:33:34,067 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:33:34,074 INFO celery.worker.job Task schedule_start_lesson[d8eb73e5-3192-4adf-a4b2-3c050704c164] succeeded in 0.01956748300290201s: None
2016-08-17 21:33:53,878 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:33:54,699 INFO celery.worker.strategy Received task: schedule_clean_desktops[6fa70f80-2e62-4b77-8fa4-d258b454f38e]
2016-08-17 21:33:54,701 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:33:54,703 WARNING celery.redirected 2016-08-17 21:33:54,703 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:33:54,705 WARNING celery.redirected 2016-08-17 21:33:54,704 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:33:54,705 WARNING celery.redirected 2016-08-17 21:33:54,705 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:33:54,711 WARNING celery.redirected 2016-08-17 21:33:54,710 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:33:54,712 WARNING celery.redirected 2016-08-17 21:33:54,711 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 32, 54, 702610), 'desktop_state_2': 'DELETED'}
2016-08-17 21:33:54,715 WARNING celery.redirected 2016-08-17 21:33:54,715 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:33:54,716 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:33:54,726 INFO celery.worker.job Task schedule_clean_desktops[6fa70f80-2e62-4b77-8fa4-d258b454f38e] succeeded in 0.02519032700365642s: None
2016-08-17 21:34:03,895 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:34:03,895 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:34:03,897 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:34:03,898 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:34:03,902 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:34:03,903 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:34:03,903 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:34:03,903 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:34:38,890 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:34:38,890 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:34:38,890 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:34:38,890 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:34:38,892 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:34:38,912 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:34:38,912 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:34:38,915 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:34:38,915 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:34:38,918 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:34:38,918 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:34:38,918 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:34:38,918 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:34:39,721 INFO celery.worker.strategy Received task: schedule_start_lesson[f38db7d0-bcae-42a8-b16f-c9b66d7c2ba7]
2016-08-17 21:34:39,722 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:34:39,723 INFO celery Scheduling start lesson tasks
2016-08-17 21:34:39,724 WARNING celery.redirected 2016-08-17 21:34:39,724 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:34:39,725 WARNING celery.redirected 2016-08-17 21:34:39,725 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:34:39,725 WARNING celery.redirected 2016-08-17 21:34:39,725 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:34:39,729 WARNING celery.redirected 2016-08-17 21:34:39,729 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:34:39,730 WARNING celery.redirected 2016-08-17 21:34:39,730 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 34, 39, 727565), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 44, 39, 727565)}
2016-08-17 21:34:39,732 WARNING celery.redirected 2016-08-17 21:34:39,732 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:34:39,733 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:34:39,741 INFO celery.worker.job Task schedule_start_lesson[f38db7d0-bcae-42a8-b16f-c9b66d7c2ba7] succeeded in 0.01967593600420514s: None
2016-08-17 21:34:58,906 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:34:59,230 INFO celery.worker.strategy Received task: schedule_clean_desktops[a4377c69-f35e-4118-96c8-8434136dfa93]
2016-08-17 21:34:59,232 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:34:59,233 WARNING celery.redirected 2016-08-17 21:34:59,233 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:34:59,234 WARNING celery.redirected 2016-08-17 21:34:59,234 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:34:59,235 WARNING celery.redirected 2016-08-17 21:34:59,234 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:34:59,238 WARNING celery.redirected 2016-08-17 21:34:59,238 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:34:59,239 WARNING celery.redirected 2016-08-17 21:34:59,239 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 33, 59, 232642), 'desktop_state_2': 'DELETED'}
2016-08-17 21:34:59,242 WARNING celery.redirected 2016-08-17 21:34:59,241 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:34:59,244 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:34:59,252 INFO celery.worker.job Task schedule_clean_desktops[a4377c69-f35e-4118-96c8-8434136dfa93] succeeded in 0.020403533002536278s: None
2016-08-17 21:35:08,958 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:35:08,958 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:35:08,961 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:35:08,961 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:35:08,967 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:35:08,967 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:35:08,967 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:35:08,967 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:35:43,949 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:35:43,950 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:35:43,950 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:35:43,950 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:35:43,952 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:35:43,976 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:35:43,976 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:35:43,978 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:35:43,978 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:35:43,981 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:35:43,982 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:35:43,982 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:35:43,982 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:35:44,856 INFO celery.worker.strategy Received task: schedule_start_lesson[cd468107-160f-4481-a345-25fdf40f3d5a]
2016-08-17 21:35:44,858 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:35:44,859 INFO celery Scheduling start lesson tasks
2016-08-17 21:35:44,861 WARNING celery.redirected 2016-08-17 21:35:44,861 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:35:44,863 WARNING celery.redirected 2016-08-17 21:35:44,862 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:35:44,864 WARNING celery.redirected 2016-08-17 21:35:44,864 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:35:44,870 WARNING celery.redirected 2016-08-17 21:35:44,869 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:35:44,871 WARNING celery.redirected 2016-08-17 21:35:44,870 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 35, 44, 866439), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 45, 44, 866439)}
2016-08-17 21:35:44,873 WARNING celery.redirected 2016-08-17 21:35:44,873 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:35:44,875 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:35:44,883 INFO celery.worker.job Task schedule_start_lesson[cd468107-160f-4481-a345-25fdf40f3d5a] succeeded in 0.024640644005557988s: None
2016-08-17 21:36:03,973 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:36:05,024 INFO celery.worker.strategy Received task: schedule_clean_desktops[3200f656-478c-4a21-9071-ab7b68a1095e]
2016-08-17 21:36:05,026 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:36:05,030 WARNING celery.redirected 2016-08-17 21:36:05,030 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:36:05,032 WARNING celery.redirected 2016-08-17 21:36:05,031 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:36:05,033 WARNING celery.redirected 2016-08-17 21:36:05,032 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:36:05,037 WARNING celery.redirected 2016-08-17 21:36:05,037 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:36:05,038 WARNING celery.redirected 2016-08-17 21:36:05,037 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 35, 5, 28856), 'desktop_state_2': 'DELETED'}
2016-08-17 21:36:05,040 WARNING celery.redirected 2016-08-17 21:36:05,040 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:36:05,041 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:36:05,052 INFO celery.worker.job Task schedule_clean_desktops[3200f656-478c-4a21-9071-ab7b68a1095e] succeeded in 0.02555151800333988s: None
2016-08-17 21:36:13,994 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:36:13,994 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:36:13,997 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:36:13,997 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:36:14,003 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:36:14,003 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:36:14,004 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:36:14,004 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:36:48,992 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:36:48,992 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:36:48,992 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:36:48,993 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:36:48,995 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:36:49,086 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:36:49,086 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:36:49,089 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:36:49,089 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:36:49,092 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:36:49,093 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:36:49,093 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:36:49,093 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:36:50,177 INFO celery.worker.strategy Received task: schedule_start_lesson[5642f83d-383a-4dff-9703-6b9cd293e2b1]
2016-08-17 21:36:50,179 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:36:50,180 INFO celery Scheduling start lesson tasks
2016-08-17 21:36:50,182 WARNING celery.redirected 2016-08-17 21:36:50,181 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:36:50,183 WARNING celery.redirected 2016-08-17 21:36:50,183 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:36:50,184 WARNING celery.redirected 2016-08-17 21:36:50,184 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:36:50,188 WARNING celery.redirected 2016-08-17 21:36:50,188 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:36:50,189 WARNING celery.redirected 2016-08-17 21:36:50,189 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 36, 50, 185918), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 46, 50, 185918)}
2016-08-17 21:36:50,191 WARNING celery.redirected 2016-08-17 21:36:50,191 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:36:50,192 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:36:50,205 INFO celery.worker.job Task schedule_start_lesson[5642f83d-383a-4dff-9703-6b9cd293e2b1] succeeded in 0.025448693995713256s: None
2016-08-17 21:37:04,086 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:37:04,259 INFO celery.worker.strategy Received task: schedule_clean_desktops[ac272216-c9c3-42eb-a5db-5f7785db1338]
2016-08-17 21:37:04,263 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:37:04,267 WARNING celery.redirected 2016-08-17 21:37:04,266 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:37:04,268 WARNING celery.redirected 2016-08-17 21:37:04,268 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:37:04,268 WARNING celery.redirected 2016-08-17 21:37:04,268 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:37:04,274 WARNING celery.redirected 2016-08-17 21:37:04,273 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:37:04,275 WARNING celery.redirected 2016-08-17 21:37:04,275 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 36, 4, 265956)}
2016-08-17 21:37:04,279 WARNING celery.redirected 2016-08-17 21:37:04,279 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:37:04,282 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:37:04,291 INFO celery.worker.job Task schedule_clean_desktops[ac272216-c9c3-42eb-a5db-5f7785db1338] succeeded in 0.027981540995824616s: None
2016-08-17 21:37:19,103 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:37:19,104 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:37:19,108 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:37:19,108 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:37:19,117 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:37:19,118 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:37:19,119 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:37:19,119 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:37:49,098 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:37:49,118 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:37:49,118 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:37:49,120 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:37:49,120 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:37:49,124 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:37:49,124 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:37:49,124 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:37:49,125 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:37:50,102 INFO celery.worker.strategy Received task: schedule_start_lesson[bd9fefae-99fd-4c3c-95c8-11dbbac6300d]
2016-08-17 21:37:50,103 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:37:50,104 INFO celery Scheduling start lesson tasks
2016-08-17 21:37:50,105 WARNING celery.redirected 2016-08-17 21:37:50,105 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:37:50,106 WARNING celery.redirected 2016-08-17 21:37:50,106 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:37:50,107 WARNING celery.redirected 2016-08-17 21:37:50,106 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:37:50,111 WARNING celery.redirected 2016-08-17 21:37:50,110 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:37:50,112 WARNING celery.redirected 2016-08-17 21:37:50,111 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 37, 50, 108445), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 47, 50, 108445)}
2016-08-17 21:37:50,114 WARNING celery.redirected 2016-08-17 21:37:50,113 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:37:50,114 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:37:50,122 INFO celery.worker.job Task schedule_start_lesson[bd9fefae-99fd-4c3c-95c8-11dbbac6300d] succeeded in 0.01825789099530084s: None
2016-08-17 21:38:04,118 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:38:05,130 INFO celery.worker.strategy Received task: schedule_clean_desktops[7f01a4d6-b756-4718-b5dc-0cf433840f32]
2016-08-17 21:38:05,131 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:38:05,133 WARNING celery.redirected 2016-08-17 21:38:05,133 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:38:05,134 WARNING celery.redirected 2016-08-17 21:38:05,133 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:38:05,134 WARNING celery.redirected 2016-08-17 21:38:05,134 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:38:05,138 WARNING celery.redirected 2016-08-17 21:38:05,138 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:38:05,138 WARNING celery.redirected 2016-08-17 21:38:05,138 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 37, 5, 132381), 'desktop_state_2': 'DELETED'}
2016-08-17 21:38:05,140 WARNING celery.redirected 2016-08-17 21:38:05,140 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:38:05,141 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:38:05,149 INFO celery.worker.job Task schedule_clean_desktops[7f01a4d6-b756-4718-b5dc-0cf433840f32] succeeded in 0.018421606997435447s: None
2016-08-17 21:38:19,133 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:38:19,134 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:38:19,136 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:38:19,136 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:38:19,142 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:38:19,142 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:38:19,142 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:38:19,142 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:38:49,123 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:38:49,145 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:38:49,145 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:38:49,148 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:38:49,148 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:38:49,950 INFO celery.worker.strategy Received task: schedule_start_lesson[14af54fc-fd50-4f3a-b0ab-18a1b8e8efec]
2016-08-17 21:38:49,951 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:38:49,952 INFO celery Scheduling start lesson tasks
2016-08-17 21:38:49,953 WARNING celery.redirected 2016-08-17 21:38:49,953 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:38:49,954 WARNING celery.redirected 2016-08-17 21:38:49,954 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:38:49,954 WARNING celery.redirected 2016-08-17 21:38:49,954 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:38:49,958 WARNING celery.redirected 2016-08-17 21:38:49,958 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:38:49,958 WARNING celery.redirected 2016-08-17 21:38:49,958 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 38, 49, 956020), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 48, 49, 956020)}
2016-08-17 21:38:49,961 WARNING celery.redirected 2016-08-17 21:38:49,961 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:38:49,963 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:38:49,971 INFO celery.worker.job Task schedule_start_lesson[14af54fc-fd50-4f3a-b0ab-18a1b8e8efec] succeeded in 0.01959352399717318s: None
2016-08-17 21:39:04,142 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:39:04,376 INFO celery.worker.strategy Received task: schedule_clean_desktops[14347491-01fe-46b5-b2d2-0d5aad99ca21]
2016-08-17 21:39:04,378 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:39:04,379 WARNING celery.redirected 2016-08-17 21:39:04,379 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:39:04,380 WARNING celery.redirected 2016-08-17 21:39:04,380 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:39:04,380 WARNING celery.redirected 2016-08-17 21:39:04,380 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:39:04,384 WARNING celery.redirected 2016-08-17 21:39:04,383 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:39:04,384 WARNING celery.redirected 2016-08-17 21:39:04,384 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 38, 4, 378761), 'desktop_state_2': 'DELETED'}
2016-08-17 21:39:04,386 WARNING celery.redirected 2016-08-17 21:39:04,386 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:39:04,387 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:39:04,394 INFO celery.worker.job Task schedule_clean_desktops[14347491-01fe-46b5-b2d2-0d5aad99ca21] succeeded in 0.01673690300231101s: None
2016-08-17 21:39:19,152 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:39:19,152 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:39:19,155 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:39:19,155 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:39:19,160 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:39:19,160 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:39:19,161 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:39:19,161 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:39:49,143 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:39:49,172 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:39:49,173 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:39:49,175 INFO celery.worker.strategy Received task: schedule_start_lesson[0e0c23ca-b1d7-4d5b-bae7-40395717dc3a]
2016-08-17 21:39:49,176 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:39:49,176 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:39:49,177 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:39:49,178 INFO celery Scheduling start lesson tasks
2016-08-17 21:39:49,179 WARNING celery.redirected 2016-08-17 21:39:49,179 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:39:49,181 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:39:49,181 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:39:49,181 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:39:49,181 WARNING celery.redirected 2016-08-17 21:39:49,181 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:39:49,182 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:39:49,182 WARNING celery.redirected 2016-08-17 21:39:49,182 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:39:49,187 WARNING celery.redirected 2016-08-17 21:39:49,187 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:39:49,188 WARNING celery.redirected 2016-08-17 21:39:49,188 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 39, 49, 184123), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 49, 49, 184123)}
2016-08-17 21:39:49,190 WARNING celery.redirected 2016-08-17 21:39:49,189 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:39:49,190 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:39:49,198 INFO celery.worker.job Task schedule_start_lesson[0e0c23ca-b1d7-4d5b-bae7-40395717dc3a] succeeded in 0.0215047770034289s: None
2016-08-17 21:40:04,173 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:40:04,950 INFO celery.worker.strategy Received task: schedule_clean_desktops[d9272b4f-e7da-467f-b6e3-06d7c59bcf15]
2016-08-17 21:40:04,952 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:40:04,953 WARNING celery.redirected 2016-08-17 21:40:04,953 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:40:04,954 WARNING celery.redirected 2016-08-17 21:40:04,954 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:40:04,955 WARNING celery.redirected 2016-08-17 21:40:04,955 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:40:04,958 WARNING celery.redirected 2016-08-17 21:40:04,958 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:40:04,959 WARNING celery.redirected 2016-08-17 21:40:04,959 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 39, 4, 952880), 'desktop_state_2': 'DELETED'}
2016-08-17 21:40:04,962 WARNING celery.redirected 2016-08-17 21:40:04,962 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:40:04,963 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:40:04,971 INFO celery.worker.job Task schedule_clean_desktops[d9272b4f-e7da-467f-b6e3-06d7c59bcf15] succeeded in 0.019402065998292528s: None
2016-08-17 21:40:19,189 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:40:19,189 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:40:19,192 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:40:19,192 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:40:19,197 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:40:19,198 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:40:19,198 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:40:19,198 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:40:49,173 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:40:49,831 INFO celery.worker.strategy Received task: schedule_start_lesson[faca392a-3fee-41ef-a122-919b524958e1]
2016-08-17 21:40:49,833 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:40:49,833 INFO celery Scheduling start lesson tasks
2016-08-17 21:40:49,834 WARNING celery.redirected 2016-08-17 21:40:49,834 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:40:49,835 WARNING celery.redirected 2016-08-17 21:40:49,835 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:40:49,836 WARNING celery.redirected 2016-08-17 21:40:49,836 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:40:49,840 WARNING celery.redirected 2016-08-17 21:40:49,839 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:40:49,841 WARNING celery.redirected 2016-08-17 21:40:49,840 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 40, 49, 837711), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 50, 49, 837711)}
2016-08-17 21:40:49,844 WARNING celery.redirected 2016-08-17 21:40:49,844 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:40:49,845 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:40:49,853 INFO celery.worker.job Task schedule_start_lesson[faca392a-3fee-41ef-a122-919b524958e1] succeeded in 0.020106763004150707s: None
2016-08-17 21:40:54,193 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:40:54,193 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:40:54,196 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:40:54,196 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:40:54,202 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:40:54,202 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:40:54,202 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:40:54,202 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:41:04,196 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:41:04,339 INFO celery.worker.strategy Received task: schedule_clean_desktops[10c07b1a-9dec-4961-93f2-099187c79341]
2016-08-17 21:41:04,341 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:41:04,342 WARNING celery.redirected 2016-08-17 21:41:04,342 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:41:04,344 WARNING celery.redirected 2016-08-17 21:41:04,344 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:41:04,344 WARNING celery.redirected 2016-08-17 21:41:04,344 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:41:04,347 WARNING celery.redirected 2016-08-17 21:41:04,347 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:41:04,348 WARNING celery.redirected 2016-08-17 21:41:04,348 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 40, 4, 341935)}
2016-08-17 21:41:04,350 WARNING celery.redirected 2016-08-17 21:41:04,350 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:41:04,351 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:41:04,358 INFO celery.worker.job Task schedule_clean_desktops[10c07b1a-9dec-4961-93f2-099187c79341] succeeded in 0.017153109001810662s: None
2016-08-17 21:41:24,208 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:41:24,208 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:41:24,210 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:41:24,210 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:41:24,215 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:41:24,216 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:41:24,216 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:41:24,216 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:41:49,196 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:41:50,312 INFO celery.worker.strategy Received task: schedule_start_lesson[24948b55-db3e-4b42-98f0-88d291da6758]
2016-08-17 21:41:50,313 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:41:50,314 INFO celery Scheduling start lesson tasks
2016-08-17 21:41:50,315 WARNING celery.redirected 2016-08-17 21:41:50,314 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:41:50,316 WARNING celery.redirected 2016-08-17 21:41:50,315 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:41:50,316 WARNING celery.redirected 2016-08-17 21:41:50,316 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:41:50,320 WARNING celery.redirected 2016-08-17 21:41:50,320 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:41:50,320 WARNING celery.redirected 2016-08-17 21:41:50,320 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 41, 50, 318033), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 51, 50, 318033)}
2016-08-17 21:41:50,323 WARNING celery.redirected 2016-08-17 21:41:50,323 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:41:50,324 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:41:50,332 INFO celery.worker.job Task schedule_start_lesson[24948b55-db3e-4b42-98f0-88d291da6758] succeeded in 0.019071256996539887s: None
2016-08-17 21:41:54,236 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:41:54,237 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:41:54,239 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:41:54,239 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:41:54,244 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:41:54,244 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:41:54,244 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:41:54,244 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:42:04,238 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:42:04,773 INFO celery.worker.strategy Received task: schedule_clean_desktops[de079cd7-da49-4ccb-b83f-f906553c252e]
2016-08-17 21:42:04,774 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:42:04,775 WARNING celery.redirected 2016-08-17 21:42:04,775 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:42:04,777 WARNING celery.redirected 2016-08-17 21:42:04,777 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:42:04,778 WARNING celery.redirected 2016-08-17 21:42:04,777 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:42:04,781 WARNING celery.redirected 2016-08-17 21:42:04,780 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:42:04,781 WARNING celery.redirected 2016-08-17 21:42:04,781 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 41, 4, 775137)}
2016-08-17 21:42:04,784 WARNING celery.redirected 2016-08-17 21:42:04,784 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:42:04,786 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:42:04,794 INFO celery.worker.job Task schedule_clean_desktops[de079cd7-da49-4ccb-b83f-f906553c252e] succeeded in 0.01980792400718201s: None
2016-08-17 21:42:24,245 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:42:24,245 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:42:24,247 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:42:24,247 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:42:49,236 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:42:49,665 INFO celery.worker.strategy Received task: schedule_start_lesson[7fc963f7-0caf-4cea-aee5-5cc904e4c0d2]
2016-08-17 21:42:49,667 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:42:49,667 INFO celery Scheduling start lesson tasks
2016-08-17 21:42:49,668 WARNING celery.redirected 2016-08-17 21:42:49,668 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:42:49,670 WARNING celery.redirected 2016-08-17 21:42:49,669 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:42:49,670 WARNING celery.redirected 2016-08-17 21:42:49,670 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:42:49,674 WARNING celery.redirected 2016-08-17 21:42:49,674 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:42:49,674 WARNING celery.redirected 2016-08-17 21:42:49,674 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 42, 49, 671819), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 52, 49, 671819)}
2016-08-17 21:42:49,677 WARNING celery.redirected 2016-08-17 21:42:49,676 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:42:49,678 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:42:49,684 INFO celery.worker.job Task schedule_start_lesson[7fc963f7-0caf-4cea-aee5-5cc904e4c0d2] succeeded in 0.01742730799742276s: None
2016-08-17 21:42:54,257 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:42:54,257 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:42:54,260 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:42:54,260 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:42:54,265 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:42:54,265 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:42:54,266 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:42:54,266 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:43:04,258 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:43:04,300 INFO celery.worker.strategy Received task: schedule_clean_desktops[93dbd031-4b74-4ccd-9d6a-fbf34469d36a]
2016-08-17 21:43:04,301 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:43:04,302 WARNING celery.redirected 2016-08-17 21:43:04,302 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:43:04,304 WARNING celery.redirected 2016-08-17 21:43:04,303 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:43:04,304 WARNING celery.redirected 2016-08-17 21:43:04,304 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:43:04,307 WARNING celery.redirected 2016-08-17 21:43:04,307 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:43:04,308 WARNING celery.redirected 2016-08-17 21:43:04,308 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 42, 4, 301887), 'desktop_state_2': 'DELETED'}
2016-08-17 21:43:04,310 WARNING celery.redirected 2016-08-17 21:43:04,310 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:43:04,311 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:43:04,318 INFO celery.worker.job Task schedule_clean_desktops[93dbd031-4b74-4ccd-9d6a-fbf34469d36a] succeeded in 0.017200738002429716s: None
2016-08-17 21:43:24,288 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:43:24,288 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:43:24,291 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:43:24,291 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:43:24,297 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:43:24,297 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:43:24,298 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:43:24,298 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:43:49,287 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:43:49,307 INFO celery.worker.strategy Received task: schedule_start_lesson[c129e503-26b1-4e18-b215-e68b9f56a337]
2016-08-17 21:43:49,309 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:43:49,310 INFO celery Scheduling start lesson tasks
2016-08-17 21:43:49,311 WARNING celery.redirected 2016-08-17 21:43:49,311 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:43:49,312 WARNING celery.redirected 2016-08-17 21:43:49,312 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:43:49,313 WARNING celery.redirected 2016-08-17 21:43:49,313 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:43:49,318 WARNING celery.redirected 2016-08-17 21:43:49,318 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:43:49,319 WARNING celery.redirected 2016-08-17 21:43:49,319 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 43, 49, 315483), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 53, 49, 315483)}
2016-08-17 21:43:49,321 WARNING celery.redirected 2016-08-17 21:43:49,321 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:43:49,322 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:43:49,332 INFO celery.worker.job Task schedule_start_lesson[c129e503-26b1-4e18-b215-e68b9f56a337] succeeded in 0.023474532994441688s: None
2016-08-17 21:43:54,308 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:43:54,308 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:43:54,311 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:43:54,311 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:43:54,316 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:43:54,316 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:43:54,317 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:43:54,317 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:44:04,309 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:44:05,050 INFO celery.worker.strategy Received task: schedule_clean_desktops[66d4cfe5-1f0f-4c1e-b48f-bd0191f11790]
2016-08-17 21:44:05,052 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:44:05,054 WARNING celery.redirected 2016-08-17 21:44:05,053 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:44:05,055 WARNING celery.redirected 2016-08-17 21:44:05,055 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:44:05,056 WARNING celery.redirected 2016-08-17 21:44:05,056 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:44:05,061 WARNING celery.redirected 2016-08-17 21:44:05,061 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:44:05,062 WARNING celery.redirected 2016-08-17 21:44:05,062 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 43, 5, 52923), 'desktop_state_2': 'DELETED'}
2016-08-17 21:44:05,065 WARNING celery.redirected 2016-08-17 21:44:05,065 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:44:05,066 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:44:05,076 INFO celery.worker.job Task schedule_clean_desktops[66d4cfe5-1f0f-4c1e-b48f-bd0191f11790] succeeded in 0.024047142003837507s: None
2016-08-17 21:44:24,319 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:44:24,319 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:44:24,322 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:44:24,322 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:44:24,328 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:44:24,328 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:44:24,328 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:44:24,329 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:44:49,312 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:44:50,013 INFO celery.worker.strategy Received task: schedule_start_lesson[0c0fd79f-8801-48ba-93c4-126876f32109]
2016-08-17 21:44:50,015 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:44:50,016 INFO celery Scheduling start lesson tasks
2016-08-17 21:44:50,018 WARNING celery.redirected 2016-08-17 21:44:50,018 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:44:50,020 WARNING celery.redirected 2016-08-17 21:44:50,019 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:44:50,021 WARNING celery.redirected 2016-08-17 21:44:50,020 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:44:50,027 WARNING celery.redirected 2016-08-17 21:44:50,026 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:44:50,027 WARNING celery.redirected 2016-08-17 21:44:50,027 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 44, 50, 23243), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 54, 50, 23243)}
2016-08-17 21:44:50,030 WARNING celery.redirected 2016-08-17 21:44:50,030 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:44:50,031 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:44:50,039 INFO celery.worker.job Task schedule_start_lesson[0c0fd79f-8801-48ba-93c4-126876f32109] succeeded in 0.024103817995637655s: None
2016-08-17 21:44:54,332 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:44:54,332 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:44:54,336 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:44:54,336 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:44:54,341 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:44:54,341 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:44:54,341 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:44:54,341 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:45:04,336 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:45:04,463 INFO celery.worker.strategy Received task: schedule_clean_desktops[83f0ede9-e264-445c-a062-0a62e1d5ff5e]
2016-08-17 21:45:04,464 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:45:04,465 WARNING celery.redirected 2016-08-17 21:45:04,465 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:45:04,466 WARNING celery.redirected 2016-08-17 21:45:04,466 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:45:04,467 WARNING celery.redirected 2016-08-17 21:45:04,466 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:45:04,470 WARNING celery.redirected 2016-08-17 21:45:04,470 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:45:04,470 WARNING celery.redirected 2016-08-17 21:45:04,470 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 44, 4, 464932)}
2016-08-17 21:45:04,472 WARNING celery.redirected 2016-08-17 21:45:04,472 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:45:04,474 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:45:04,480 INFO celery.worker.job Task schedule_clean_desktops[83f0ede9-e264-445c-a062-0a62e1d5ff5e] succeeded in 0.01663401399855502s: None
2016-08-17 21:45:24,367 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:45:24,367 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:45:24,375 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:45:24,376 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:45:24,385 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:45:24,386 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:45:24,387 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:45:24,387 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:45:49,370 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:45:50,584 INFO celery.worker.strategy Received task: schedule_start_lesson[d426fca7-74c8-4033-bf53-e970645d6943]
2016-08-17 21:45:50,585 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:45:50,585 INFO celery Scheduling start lesson tasks
2016-08-17 21:45:50,587 WARNING celery.redirected 2016-08-17 21:45:50,586 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:45:50,587 WARNING celery.redirected 2016-08-17 21:45:50,587 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:45:50,588 WARNING celery.redirected 2016-08-17 21:45:50,588 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:45:50,592 WARNING celery.redirected 2016-08-17 21:45:50,592 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:45:50,593 WARNING celery.redirected 2016-08-17 21:45:50,593 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 45, 50, 590125), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 55, 50, 590125)}
2016-08-17 21:45:50,595 WARNING celery.redirected 2016-08-17 21:45:50,595 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:45:50,596 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:45:50,604 INFO celery.worker.job Task schedule_start_lesson[d426fca7-74c8-4033-bf53-e970645d6943] succeeded in 0.019395581999560818s: None
2016-08-17 21:45:54,511 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:45:54,511 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:45:54,514 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:45:54,514 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:45:54,520 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:45:54,520 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:45:54,520 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:45:54,520 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:46:04,514 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:46:05,052 INFO celery.worker.strategy Received task: schedule_clean_desktops[37f64e50-3472-49e5-8491-5502e91a7818]
2016-08-17 21:46:05,053 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:46:05,055 WARNING celery.redirected 2016-08-17 21:46:05,055 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:46:05,056 WARNING celery.redirected 2016-08-17 21:46:05,056 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:46:05,056 WARNING celery.redirected 2016-08-17 21:46:05,056 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:46:05,059 WARNING celery.redirected 2016-08-17 21:46:05,059 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:46:05,060 WARNING celery.redirected 2016-08-17 21:46:05,060 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 45, 5, 54235), 'desktop_state_2': 'DELETED'}
2016-08-17 21:46:05,063 WARNING celery.redirected 2016-08-17 21:46:05,062 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:46:05,064 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:46:05,072 INFO celery.worker.job Task schedule_clean_desktops[37f64e50-3472-49e5-8491-5502e91a7818] succeeded in 0.019510270001774188s: None
2016-08-17 21:46:24,522 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:46:24,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:46:24,524 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:46:24,524 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:46:49,529 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:46:50,762 INFO celery.worker.strategy Received task: schedule_start_lesson[ce8873ce-e366-4c85-a610-12fd41349d24]
2016-08-17 21:46:50,763 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:46:50,764 INFO celery Scheduling start lesson tasks
2016-08-17 21:46:50,765 WARNING celery.redirected 2016-08-17 21:46:50,765 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:46:50,766 WARNING celery.redirected 2016-08-17 21:46:50,766 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:46:50,766 WARNING celery.redirected 2016-08-17 21:46:50,766 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:46:50,770 WARNING celery.redirected 2016-08-17 21:46:50,770 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:46:50,770 WARNING celery.redirected 2016-08-17 21:46:50,770 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 46, 50, 768024), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 56, 50, 768024)}
2016-08-17 21:46:50,773 WARNING celery.redirected 2016-08-17 21:46:50,773 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:46:50,774 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:46:50,784 INFO celery.worker.job Task schedule_start_lesson[ce8873ce-e366-4c85-a610-12fd41349d24] succeeded in 0.020259992001228966s: None
2016-08-17 21:46:54,704 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:46:54,705 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:46:54,707 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:46:54,708 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:46:54,712 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:46:54,712 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:46:54,713 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:46:54,713 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:47:09,706 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:47:10,221 INFO celery.worker.strategy Received task: schedule_clean_desktops[1761da29-a0e6-47a9-9aeb-f0b2e491ee0d]
2016-08-17 21:47:10,222 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:47:10,224 WARNING celery.redirected 2016-08-17 21:47:10,224 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:47:10,225 WARNING celery.redirected 2016-08-17 21:47:10,225 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:47:10,226 WARNING celery.redirected 2016-08-17 21:47:10,225 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:47:10,229 WARNING celery.redirected 2016-08-17 21:47:10,229 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:47:10,230 WARNING celery.redirected 2016-08-17 21:47:10,229 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 46, 10, 223657)}
2016-08-17 21:47:10,236 WARNING celery.redirected 2016-08-17 21:47:10,234 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:47:10,237 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:47:10,244 INFO celery.worker.job Task schedule_clean_desktops[1761da29-a0e6-47a9-9aeb-f0b2e491ee0d] succeeded in 0.021708797001338098s: None
2016-08-17 21:47:24,720 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:47:24,720 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:47:24,722 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:47:24,722 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:47:24,727 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:47:24,727 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:47:24,728 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:47:24,728 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:47:54,714 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:47:54,732 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:47:54,732 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:47:54,734 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:47:54,735 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:47:54,738 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:47:54,738 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:47:54,738 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:47:54,739 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:47:55,220 INFO celery.worker.strategy Received task: schedule_start_lesson[66f59048-be63-4e89-af8d-b4857d2a5844]
2016-08-17 21:47:55,222 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:47:55,223 INFO celery Scheduling start lesson tasks
2016-08-17 21:47:55,224 WARNING celery.redirected 2016-08-17 21:47:55,224 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:47:55,225 WARNING celery.redirected 2016-08-17 21:47:55,225 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:47:55,225 WARNING celery.redirected 2016-08-17 21:47:55,225 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:47:55,229 WARNING celery.redirected 2016-08-17 21:47:55,229 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:47:55,229 WARNING celery.redirected 2016-08-17 21:47:55,229 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 47, 55, 227053), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 57, 55, 227053)}
2016-08-17 21:47:55,231 WARNING celery.redirected 2016-08-17 21:47:55,231 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:47:55,232 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:47:55,240 INFO celery.worker.job Task schedule_start_lesson[66f59048-be63-4e89-af8d-b4857d2a5844] succeeded in 0.0175355169994873s: None
2016-08-17 21:48:14,729 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:48:15,834 INFO celery.worker.strategy Received task: schedule_clean_desktops[f10d0ef2-28a8-4d79-99b8-3ef67fd2dace]
2016-08-17 21:48:15,836 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:48:15,837 WARNING celery.redirected 2016-08-17 21:48:15,837 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:48:15,838 WARNING celery.redirected 2016-08-17 21:48:15,838 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:48:15,839 WARNING celery.redirected 2016-08-17 21:48:15,839 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:48:15,842 WARNING celery.redirected 2016-08-17 21:48:15,842 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:48:15,842 WARNING celery.redirected 2016-08-17 21:48:15,842 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 47, 15, 836845), 'desktop_state_2': 'DELETED'}
2016-08-17 21:48:15,845 WARNING celery.redirected 2016-08-17 21:48:15,845 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:48:15,847 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:48:15,854 INFO celery.worker.job Task schedule_clean_desktops[f10d0ef2-28a8-4d79-99b8-3ef67fd2dace] succeeded in 0.018886883000959642s: None
2016-08-17 21:48:24,765 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:48:24,766 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:48:24,768 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:48:24,768 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:48:24,773 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:48:24,773 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:48:24,773 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:48:24,774 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:48:59,749 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:48:59,750 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:48:59,750 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:48:59,750 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:48:59,752 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:48:59,769 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:48:59,770 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:48:59,771 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:48:59,772 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:48:59,774 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:48:59,775 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:48:59,775 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:48:59,775 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:49:00,678 INFO celery.worker.strategy Received task: schedule_start_lesson[f9b19905-ba3d-4075-b639-87585998485d]
2016-08-17 21:49:00,679 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:49:00,679 INFO celery Scheduling start lesson tasks
2016-08-17 21:49:00,680 WARNING celery.redirected 2016-08-17 21:49:00,680 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:49:00,681 WARNING celery.redirected 2016-08-17 21:49:00,681 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:49:00,682 WARNING celery.redirected 2016-08-17 21:49:00,682 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:49:00,685 WARNING celery.redirected 2016-08-17 21:49:00,685 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:49:00,686 WARNING celery.redirected 2016-08-17 21:49:00,686 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 49, 0, 683439), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(21, 59, 0, 683439)}
2016-08-17 21:49:00,688 WARNING celery.redirected 2016-08-17 21:49:00,688 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:49:00,689 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:49:00,698 INFO celery.worker.job Task schedule_start_lesson[f9b19905-ba3d-4075-b639-87585998485d] succeeded in 0.019202067000151146s: None
2016-08-17 21:49:19,762 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:49:19,965 INFO celery.worker.strategy Received task: schedule_clean_desktops[cbe16296-84c0-4b17-a296-ad1926133d82]
2016-08-17 21:49:19,967 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:49:19,969 WARNING celery.redirected 2016-08-17 21:49:19,969 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:49:19,971 WARNING celery.redirected 2016-08-17 21:49:19,970 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:49:19,971 WARNING celery.redirected 2016-08-17 21:49:19,971 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:49:19,975 WARNING celery.redirected 2016-08-17 21:49:19,975 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:49:19,975 WARNING celery.redirected 2016-08-17 21:49:19,975 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 48, 19, 968317)}
2016-08-17 21:49:19,978 WARNING celery.redirected 2016-08-17 21:49:19,977 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:49:19,979 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:49:19,986 INFO celery.worker.job Task schedule_clean_desktops[cbe16296-84c0-4b17-a296-ad1926133d82] succeeded in 0.019512892999046016s: None
2016-08-17 21:49:29,777 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:49:29,777 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:49:29,779 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:49:29,779 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:49:29,784 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:49:29,784 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:49:29,785 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:49:29,785 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:50:04,772 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:50:04,772 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:50:04,773 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:50:04,773 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:50:04,775 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:50:04,791 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:50:04,792 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:50:04,794 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:50:04,794 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:50:04,797 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:50:04,797 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:50:04,797 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:50:04,798 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:50:05,103 INFO celery.worker.strategy Received task: schedule_start_lesson[b3dea1e6-3891-4205-9d38-7186ce7fa34b]
2016-08-17 21:50:05,104 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:50:05,105 INFO celery Scheduling start lesson tasks
2016-08-17 21:50:05,106 WARNING celery.redirected 2016-08-17 21:50:05,106 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:50:05,107 WARNING celery.redirected 2016-08-17 21:50:05,107 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:50:05,107 WARNING celery.redirected 2016-08-17 21:50:05,107 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:50:05,112 WARNING celery.redirected 2016-08-17 21:50:05,111 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:50:05,112 WARNING celery.redirected 2016-08-17 21:50:05,112 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 50, 5, 109335), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 0, 5, 109335)}
2016-08-17 21:50:05,114 WARNING celery.redirected 2016-08-17 21:50:05,114 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:50:05,115 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:50:05,122 INFO celery.worker.job Task schedule_start_lesson[b3dea1e6-3891-4205-9d38-7186ce7fa34b] succeeded in 0.018344597003306262s: None
2016-08-17 21:50:24,789 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:50:25,819 INFO celery.worker.strategy Received task: schedule_clean_desktops[0b94923b-afda-450b-b664-e82a69dcc19e]
2016-08-17 21:50:25,820 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:50:25,822 WARNING celery.redirected 2016-08-17 21:50:25,822 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:50:25,823 WARNING celery.redirected 2016-08-17 21:50:25,823 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:50:25,823 WARNING celery.redirected 2016-08-17 21:50:25,823 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:50:25,827 WARNING celery.redirected 2016-08-17 21:50:25,827 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:50:25,828 WARNING celery.redirected 2016-08-17 21:50:25,828 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 49, 25, 821557), 'desktop_state_2': 'DELETED'}
2016-08-17 21:50:25,831 WARNING celery.redirected 2016-08-17 21:50:25,830 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:50:25,832 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:50:25,839 INFO celery.worker.job Task schedule_clean_desktops[0b94923b-afda-450b-b664-e82a69dcc19e] succeeded in 0.019131212997308467s: None
2016-08-17 21:50:34,804 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:50:34,804 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:50:34,806 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:50:34,806 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:50:34,812 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:50:34,812 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:50:34,812 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:50:34,812 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:51:09,795 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:51:09,795 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:51:09,796 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:51:09,796 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:51:09,798 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:51:09,934 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:51:09,935 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:51:09,937 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:51:09,937 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:51:09,940 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:51:09,940 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:51:09,941 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:51:09,941 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:51:10,998 INFO celery.worker.strategy Received task: schedule_start_lesson[c1894bba-091b-45e0-940a-789f6c16aa81]
2016-08-17 21:51:10,999 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:51:11,000 INFO celery Scheduling start lesson tasks
2016-08-17 21:51:11,001 WARNING celery.redirected 2016-08-17 21:51:11,001 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:51:11,002 WARNING celery.redirected 2016-08-17 21:51:11,002 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:51:11,003 WARNING celery.redirected 2016-08-17 21:51:11,003 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:51:11,007 WARNING celery.redirected 2016-08-17 21:51:11,007 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:51:11,008 WARNING celery.redirected 2016-08-17 21:51:11,007 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 51, 11, 4768), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 1, 11, 4768)}
2016-08-17 21:51:11,010 WARNING celery.redirected 2016-08-17 21:51:11,010 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:51:11,011 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:51:11,019 INFO celery.worker.job Task schedule_start_lesson[c1894bba-091b-45e0-940a-789f6c16aa81] succeeded in 0.01947183699667221s: None
2016-08-17 21:51:29,929 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:51:30,429 INFO celery.worker.strategy Received task: schedule_clean_desktops[a72694e4-1f4d-4749-be77-067b85ec1ef6]
2016-08-17 21:51:30,430 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:51:30,432 WARNING celery.redirected 2016-08-17 21:51:30,432 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:51:30,433 WARNING celery.redirected 2016-08-17 21:51:30,433 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:51:30,433 WARNING celery.redirected 2016-08-17 21:51:30,433 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:51:30,437 WARNING celery.redirected 2016-08-17 21:51:30,437 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:51:30,437 WARNING celery.redirected 2016-08-17 21:51:30,437 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 50, 30, 431627)}
2016-08-17 21:51:30,439 WARNING celery.redirected 2016-08-17 21:51:30,439 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:51:30,440 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:51:30,449 INFO celery.worker.job Task schedule_clean_desktops[a72694e4-1f4d-4749-be77-067b85ec1ef6] succeeded in 0.018838171003153548s: None
2016-08-17 21:51:39,947 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:51:39,948 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:51:39,950 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:51:39,951 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:51:39,956 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:51:39,956 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:51:39,956 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:51:39,957 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:52:14,932 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:52:14,933 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:52:14,934 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:52:14,934 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:52:14,936 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:52:14,953 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:52:14,953 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:52:14,955 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:52:14,955 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:52:14,958 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:52:14,958 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:52:14,958 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:52:14,959 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:52:15,459 INFO celery.worker.strategy Received task: schedule_start_lesson[dfa396c5-8e6a-4d77-8c0e-e74454437fe1]
2016-08-17 21:52:15,460 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:52:15,461 INFO celery Scheduling start lesson tasks
2016-08-17 21:52:15,462 WARNING celery.redirected 2016-08-17 21:52:15,462 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:52:15,463 WARNING celery.redirected 2016-08-17 21:52:15,463 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:52:15,463 WARNING celery.redirected 2016-08-17 21:52:15,463 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:52:15,467 WARNING celery.redirected 2016-08-17 21:52:15,467 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:52:15,467 WARNING celery.redirected 2016-08-17 21:52:15,467 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 52, 15, 465210), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 2, 15, 465210)}
2016-08-17 21:52:15,470 WARNING celery.redirected 2016-08-17 21:52:15,469 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:52:15,471 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:52:15,480 INFO celery.worker.job Task schedule_start_lesson[dfa396c5-8e6a-4d77-8c0e-e74454437fe1] succeeded in 0.019614483004261274s: None
2016-08-17 21:52:34,945 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:52:36,201 INFO celery.worker.strategy Received task: schedule_clean_desktops[e7fbdf9a-cf8d-4306-95ae-819560cdfdce]
2016-08-17 21:52:36,203 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:52:36,206 WARNING celery.redirected 2016-08-17 21:52:36,206 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:52:36,208 WARNING celery.redirected 2016-08-17 21:52:36,207 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:52:36,209 WARNING celery.redirected 2016-08-17 21:52:36,208 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:52:36,213 WARNING celery.redirected 2016-08-17 21:52:36,213 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:52:36,213 WARNING celery.redirected 2016-08-17 21:52:36,213 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 51, 36, 204831), 'desktop_state_2': 'DELETED'}
2016-08-17 21:52:36,215 WARNING celery.redirected 2016-08-17 21:52:36,215 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:52:36,216 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:52:36,224 INFO celery.worker.job Task schedule_clean_desktops[e7fbdf9a-cf8d-4306-95ae-819560cdfdce] succeeded in 0.02138151600229321s: None
2016-08-17 21:52:45,165 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:52:45,165 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:52:45,168 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:52:45,168 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:52:45,173 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:52:45,173 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:52:45,174 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:52:45,174 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:53:15,156 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:53:15,378 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:53:15,378 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:53:15,380 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:53:15,381 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:53:15,385 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:53:15,385 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:53:15,386 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:53:15,386 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:53:16,419 INFO celery.worker.strategy Received task: schedule_start_lesson[ff292303-24e5-41e8-9f6b-e0ab06a4b340]
2016-08-17 21:53:16,421 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:53:16,421 INFO celery Scheduling start lesson tasks
2016-08-17 21:53:16,422 WARNING celery.redirected 2016-08-17 21:53:16,422 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:53:16,423 WARNING celery.redirected 2016-08-17 21:53:16,423 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:53:16,424 WARNING celery.redirected 2016-08-17 21:53:16,424 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:53:16,428 WARNING celery.redirected 2016-08-17 21:53:16,427 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:53:16,428 WARNING celery.redirected 2016-08-17 21:53:16,428 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 53, 16, 425466), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 3, 16, 425466)}
2016-08-17 21:53:16,431 WARNING celery.redirected 2016-08-17 21:53:16,430 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:53:16,432 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:53:16,439 INFO celery.worker.job Task schedule_start_lesson[ff292303-24e5-41e8-9f6b-e0ab06a4b340] succeeded in 0.01883994699892355s: None
2016-08-17 21:53:35,372 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:53:35,998 INFO celery.worker.strategy Received task: schedule_clean_desktops[3d3b54a8-c5e8-4f05-bd82-53c796b4f3d6]
2016-08-17 21:53:35,999 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:53:36,001 WARNING celery.redirected 2016-08-17 21:53:36,001 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:53:36,002 WARNING celery.redirected 2016-08-17 21:53:36,002 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:53:36,002 WARNING celery.redirected 2016-08-17 21:53:36,002 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:53:36,006 WARNING celery.redirected 2016-08-17 21:53:36,005 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:53:36,006 WARNING celery.redirected 2016-08-17 21:53:36,006 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 52, 36, 403)}
2016-08-17 21:53:36,009 WARNING celery.redirected 2016-08-17 21:53:36,009 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:53:36,010 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:53:36,017 INFO celery.worker.job Task schedule_clean_desktops[3d3b54a8-c5e8-4f05-bd82-53c796b4f3d6] succeeded in 0.01817459600715665s: None
2016-08-17 21:53:45,388 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:53:45,388 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:53:45,390 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:53:45,391 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:53:45,396 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:53:45,396 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:53:45,397 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:53:45,397 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:54:15,383 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:54:15,401 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:54:15,401 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:54:15,405 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:54:15,405 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:54:15,408 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:54:15,409 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:54:15,409 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:54:15,409 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:54:15,587 INFO celery.worker.strategy Received task: schedule_start_lesson[f9b17d6e-237d-47da-9f63-1b3aae9dddb2]
2016-08-17 21:54:15,589 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:54:15,589 INFO celery Scheduling start lesson tasks
2016-08-17 21:54:15,590 WARNING celery.redirected 2016-08-17 21:54:15,590 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:54:15,591 WARNING celery.redirected 2016-08-17 21:54:15,591 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:54:15,592 WARNING celery.redirected 2016-08-17 21:54:15,592 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:54:15,597 WARNING celery.redirected 2016-08-17 21:54:15,596 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:54:15,597 WARNING celery.redirected 2016-08-17 21:54:15,597 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 54, 15, 593959), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 4, 15, 593959)}
2016-08-17 21:54:15,599 WARNING celery.redirected 2016-08-17 21:54:15,599 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:54:15,600 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:54:15,608 INFO celery.worker.job Task schedule_start_lesson[f9b17d6e-237d-47da-9f63-1b3aae9dddb2] succeeded in 0.019758275004278403s: None
2016-08-17 21:54:35,401 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:54:36,383 INFO celery.worker.strategy Received task: schedule_clean_desktops[ee3fbe8d-ccbc-46b3-952b-bfe3782acb9d]
2016-08-17 21:54:36,384 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:54:36,386 WARNING celery.redirected 2016-08-17 21:54:36,386 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:54:36,388 WARNING celery.redirected 2016-08-17 21:54:36,387 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:54:36,388 WARNING celery.redirected 2016-08-17 21:54:36,388 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:54:36,392 WARNING celery.redirected 2016-08-17 21:54:36,392 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:54:36,393 WARNING celery.redirected 2016-08-17 21:54:36,392 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 53, 36, 385270)}
2016-08-17 21:54:36,394 WARNING celery.redirected 2016-08-17 21:54:36,394 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:54:36,396 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:54:36,403 INFO celery.worker.job Task schedule_clean_desktops[ee3fbe8d-ccbc-46b3-952b-bfe3782acb9d] succeeded in 0.019119845994282514s: None
2016-08-17 21:54:45,419 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:54:45,419 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:54:45,422 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:54:45,422 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:54:45,427 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:54:45,428 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:54:45,428 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:54:45,428 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:55:15,413 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:55:15,687 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:55:15,688 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:55:15,691 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:55:15,691 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:55:15,697 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:55:15,697 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:55:15,697 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:55:15,697 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:55:16,725 INFO celery.worker.strategy Received task: schedule_start_lesson[f62a31f9-3896-4564-a608-8c4758e01901]
2016-08-17 21:55:16,727 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:55:16,727 INFO celery Scheduling start lesson tasks
2016-08-17 21:55:16,728 WARNING celery.redirected 2016-08-17 21:55:16,728 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:55:16,729 WARNING celery.redirected 2016-08-17 21:55:16,729 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:55:16,730 WARNING celery.redirected 2016-08-17 21:55:16,730 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:55:16,734 WARNING celery.redirected 2016-08-17 21:55:16,734 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:55:16,734 WARNING celery.redirected 2016-08-17 21:55:16,734 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 55, 16, 731645), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 5, 16, 731645)}
2016-08-17 21:55:16,737 WARNING celery.redirected 2016-08-17 21:55:16,737 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:55:16,739 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:55:16,746 INFO celery.worker.job Task schedule_start_lesson[f62a31f9-3896-4564-a608-8c4758e01901] succeeded in 0.019673752001835965s: None
2016-08-17 21:55:35,689 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:55:36,162 INFO celery.worker.strategy Received task: schedule_clean_desktops[0d76f91c-152a-4b2d-b967-b3a50baa0d86]
2016-08-17 21:55:36,163 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:55:36,165 WARNING celery.redirected 2016-08-17 21:55:36,165 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:55:36,166 WARNING celery.redirected 2016-08-17 21:55:36,166 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:55:36,167 WARNING celery.redirected 2016-08-17 21:55:36,167 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:55:36,170 WARNING celery.redirected 2016-08-17 21:55:36,170 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:55:36,171 WARNING celery.redirected 2016-08-17 21:55:36,170 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 54, 36, 164401), 'desktop_state_2': 'DELETED'}
2016-08-17 21:55:36,173 WARNING celery.redirected 2016-08-17 21:55:36,173 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:55:36,174 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:55:36,181 INFO celery.worker.job Task schedule_clean_desktops[0d76f91c-152a-4b2d-b967-b3a50baa0d86] succeeded in 0.018106376002833713s: None
2016-08-17 21:55:45,713 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:55:45,714 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:55:45,717 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:55:45,717 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:55:45,726 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:55:45,726 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:55:45,726 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:55:45,726 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:56:15,709 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:56:15,888 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:56:15,889 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:56:15,895 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:56:15,895 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:56:15,901 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:56:15,902 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:56:15,903 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:56:15,904 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:56:16,966 INFO celery.worker.strategy Received task: schedule_start_lesson[2dfd0c5e-4590-48df-9a5b-f02454f27196]
2016-08-17 21:56:16,967 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:56:16,967 INFO celery Scheduling start lesson tasks
2016-08-17 21:56:16,968 WARNING celery.redirected 2016-08-17 21:56:16,968 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:56:16,970 WARNING celery.redirected 2016-08-17 21:56:16,969 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:56:16,970 WARNING celery.redirected 2016-08-17 21:56:16,970 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:56:16,974 WARNING celery.redirected 2016-08-17 21:56:16,974 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:56:16,975 WARNING celery.redirected 2016-08-17 21:56:16,975 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 56, 16, 971921), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 6, 16, 971921)}
2016-08-17 21:56:16,978 WARNING celery.redirected 2016-08-17 21:56:16,978 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:56:16,980 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:56:16,996 INFO celery.worker.job Task schedule_start_lesson[2dfd0c5e-4590-48df-9a5b-f02454f27196] succeeded in 0.029005413998675067s: None
2016-08-17 21:56:40,896 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:56:41,497 INFO celery.worker.strategy Received task: schedule_clean_desktops[b5d5268d-3249-4301-977b-2a5c30045eef]
2016-08-17 21:56:41,499 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:56:41,501 WARNING celery.redirected 2016-08-17 21:56:41,501 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:56:41,503 WARNING celery.redirected 2016-08-17 21:56:41,503 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:56:41,503 WARNING celery.redirected 2016-08-17 21:56:41,503 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:56:41,507 WARNING celery.redirected 2016-08-17 21:56:41,507 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:56:41,508 WARNING celery.redirected 2016-08-17 21:56:41,508 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 55, 41, 500821), 'desktop_state_2': 'DELETED'}
2016-08-17 21:56:41,510 WARNING celery.redirected 2016-08-17 21:56:41,510 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:56:41,511 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:56:41,518 INFO celery.worker.job Task schedule_clean_desktops[b5d5268d-3249-4301-977b-2a5c30045eef] succeeded in 0.01907242299785139s: None
2016-08-17 21:56:45,917 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:56:45,918 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:56:45,920 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:56:45,921 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:56:45,925 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:56:45,926 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:56:45,926 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:56:45,927 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:57:20,904 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:57:20,905 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:57:20,905 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:57:20,905 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:57:20,907 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:57:20,925 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:57:20,925 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:57:20,927 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:57:20,927 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:57:20,930 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:57:20,930 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:57:20,931 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:57:20,931 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:57:21,936 INFO celery.worker.strategy Received task: schedule_start_lesson[2d173ebb-e5c2-4921-b3ba-a91a5c402e69]
2016-08-17 21:57:21,937 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:57:21,938 INFO celery Scheduling start lesson tasks
2016-08-17 21:57:21,940 WARNING celery.redirected 2016-08-17 21:57:21,939 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:57:21,941 WARNING celery.redirected 2016-08-17 21:57:21,941 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:57:21,942 WARNING celery.redirected 2016-08-17 21:57:21,942 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:57:21,948 WARNING celery.redirected 2016-08-17 21:57:21,947 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:57:21,949 WARNING celery.redirected 2016-08-17 21:57:21,949 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 57, 21, 944168), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 7, 21, 944168)}
2016-08-17 21:57:21,953 WARNING celery.redirected 2016-08-17 21:57:21,953 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:57:21,955 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:57:21,962 INFO celery.worker.job Task schedule_start_lesson[2d173ebb-e5c2-4921-b3ba-a91a5c402e69] succeeded in 0.025182290002703667s: None
2016-08-17 21:57:45,920 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:57:46,634 INFO celery.worker.strategy Received task: schedule_clean_desktops[4dd2f06d-ea3f-442d-8df7-8f5760e5bab6]
2016-08-17 21:57:46,635 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:57:46,638 WARNING celery.redirected 2016-08-17 21:57:46,638 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:57:46,641 WARNING celery.redirected 2016-08-17 21:57:46,640 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:57:46,645 WARNING celery.redirected 2016-08-17 21:57:46,645 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:57:46,650 WARNING celery.redirected 2016-08-17 21:57:46,650 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:57:46,650 WARNING celery.redirected 2016-08-17 21:57:46,650 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 56, 46, 637029)}
2016-08-17 21:57:46,654 WARNING celery.redirected 2016-08-17 21:57:46,653 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:57:46,656 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:57:46,671 INFO celery.worker.job Task schedule_clean_desktops[4dd2f06d-ea3f-442d-8df7-8f5760e5bab6] succeeded in 0.03564910199929727s: None
2016-08-17 21:57:50,939 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:57:50,939 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:57:50,941 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:57:50,941 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:57:50,946 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:57:50,947 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:57:50,947 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:57:50,947 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:58:25,932 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:58:25,932 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:58:25,933 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:58:25,933 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:58:25,935 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:58:26,107 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:58:26,108 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:58:26,111 INFO celery.worker.strategy Received task: schedule_start_lesson[bc44685b-fa34-4a53-93f3-a770c3d35324]
2016-08-17 21:58:26,114 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:58:26,114 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:58:26,114 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:58:26,115 INFO celery Scheduling start lesson tasks
2016-08-17 21:58:26,116 WARNING celery.redirected 2016-08-17 21:58:26,116 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:58:26,118 WARNING celery.redirected 2016-08-17 21:58:26,118 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:58:26,119 WARNING celery.redirected 2016-08-17 21:58:26,119 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:58:26,120 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:58:26,121 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:58:26,121 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:58:26,121 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:58:26,124 WARNING celery.redirected 2016-08-17 21:58:26,124 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:58:26,125 WARNING celery.redirected 2016-08-17 21:58:26,125 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 58, 26, 122099), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 8, 26, 122099)}
2016-08-17 21:58:26,128 WARNING celery.redirected 2016-08-17 21:58:26,128 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:58:26,130 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:58:26,145 INFO celery.worker.job Task schedule_start_lesson[bc44685b-fa34-4a53-93f3-a770c3d35324] succeeded in 0.031886752003629226s: None
2016-08-17 21:58:46,111 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:58:47,068 INFO celery.worker.strategy Received task: schedule_clean_desktops[400b798d-fce3-49ca-b5a6-84364bbc9ee0]
2016-08-17 21:58:47,070 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:58:47,073 WARNING celery.redirected 2016-08-17 21:58:47,072 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:58:47,074 WARNING celery.redirected 2016-08-17 21:58:47,074 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:58:47,076 WARNING celery.redirected 2016-08-17 21:58:47,075 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:58:47,084 WARNING celery.redirected 2016-08-17 21:58:47,084 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:58:47,085 WARNING celery.redirected 2016-08-17 21:58:47,085 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 57, 47, 71920)}
2016-08-17 21:58:47,089 WARNING celery.redirected 2016-08-17 21:58:47,089 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:58:47,090 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:58:47,107 INFO celery.worker.job Task schedule_clean_desktops[400b798d-fce3-49ca-b5a6-84364bbc9ee0] succeeded in 0.036560913002176676s: None
2016-08-17 21:58:56,133 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:58:56,134 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:58:56,136 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:58:56,136 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:58:56,142 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:58:56,143 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:58:56,143 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:58:56,143 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:59:26,134 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 21:59:26,156 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:59:26,156 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:59:26,158 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:59:26,158 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:59:26,162 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:59:26,162 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:59:26,163 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:59:26,163 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:59:27,005 INFO celery.worker.strategy Received task: schedule_start_lesson[65176b97-c175-4873-bb37-8ed06e752bde]
2016-08-17 21:59:27,007 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:59:27,007 INFO celery Scheduling start lesson tasks
2016-08-17 21:59:27,008 WARNING celery.redirected 2016-08-17 21:59:27,008 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:59:27,009 WARNING celery.redirected 2016-08-17 21:59:27,009 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:59:27,010 WARNING celery.redirected 2016-08-17 21:59:27,010 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 21:59:27,014 WARNING celery.redirected 2016-08-17 21:59:27,014 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 21:59:27,015 WARNING celery.redirected 2016-08-17 21:59:27,014 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(21, 59, 27, 11931), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 9, 27, 11931)}
2016-08-17 21:59:27,016 WARNING celery.redirected 2016-08-17 21:59:27,016 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:59:27,018 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:59:27,029 INFO celery.worker.job Task schedule_start_lesson[65176b97-c175-4873-bb37-8ed06e752bde] succeeded in 0.022984848998021334s: None
2016-08-17 21:59:46,153 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 21:59:46,516 INFO celery.worker.strategy Received task: schedule_clean_desktops[99b72535-c1d1-4fc9-b15d-9ab8666a1364]
2016-08-17 21:59:46,517 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 21:59:46,519 WARNING celery.redirected 2016-08-17 21:59:46,519 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 21:59:46,520 WARNING celery.redirected 2016-08-17 21:59:46,520 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 21:59:46,520 WARNING celery.redirected 2016-08-17 21:59:46,520 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 21:59:46,524 WARNING celery.redirected 2016-08-17 21:59:46,524 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 21:59:46,525 WARNING celery.redirected 2016-08-17 21:59:46,524 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 58, 46, 518306), 'desktop_state_2': 'DELETED'}
2016-08-17 21:59:46,527 WARNING celery.redirected 2016-08-17 21:59:46,527 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 21:59:46,528 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 21:59:46,535 INFO celery.worker.job Task schedule_clean_desktops[99b72535-c1d1-4fc9-b15d-9ab8666a1364] succeeded in 0.018240498000523075s: None
2016-08-17 21:59:56,170 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:59:56,170 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:59:56,174 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:59:56,174 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 21:59:56,184 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 21:59:56,184 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 21:59:56,184 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 21:59:56,184 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:00:26,169 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:00:26,188 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:00:26,188 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:00:26,190 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:00:26,190 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:00:26,194 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:00:26,195 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:00:26,195 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:00:26,195 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:00:26,940 INFO celery.worker.strategy Received task: schedule_start_lesson[4861e781-1c31-47ee-8ed0-ca721a77f2ee]
2016-08-17 22:00:26,941 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:00:26,942 INFO celery Scheduling start lesson tasks
2016-08-17 22:00:26,943 WARNING celery.redirected 2016-08-17 22:00:26,943 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:00:26,944 WARNING celery.redirected 2016-08-17 22:00:26,944 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:00:26,945 WARNING celery.redirected 2016-08-17 22:00:26,945 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:00:26,948 WARNING celery.redirected 2016-08-17 22:00:26,948 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:00:26,949 WARNING celery.redirected 2016-08-17 22:00:26,949 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 0, 26, 946557), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 10, 26, 946557)}
2016-08-17 22:00:26,952 WARNING celery.redirected 2016-08-17 22:00:26,952 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:00:26,953 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:00:26,963 INFO celery.worker.job Task schedule_start_lesson[4861e781-1c31-47ee-8ed0-ca721a77f2ee] succeeded in 0.022022589000698645s: None
2016-08-17 22:00:46,189 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:00:46,377 INFO celery.worker.strategy Received task: schedule_clean_desktops[9067ac46-3391-40de-9918-1f3dac4bb957]
2016-08-17 22:00:46,378 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:00:46,380 WARNING celery.redirected 2016-08-17 22:00:46,380 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:00:46,381 WARNING celery.redirected 2016-08-17 22:00:46,381 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:00:46,381 WARNING celery.redirected 2016-08-17 22:00:46,381 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:00:46,388 WARNING celery.redirected 2016-08-17 22:00:46,388 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:00:46,389 WARNING celery.redirected 2016-08-17 22:00:46,389 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 21, 59, 46, 379447)}
2016-08-17 22:00:46,391 WARNING celery.redirected 2016-08-17 22:00:46,391 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:00:46,392 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:00:46,402 INFO celery.worker.job Task schedule_clean_desktops[9067ac46-3391-40de-9918-1f3dac4bb957] succeeded in 0.02356597300240537s: None
2016-08-17 22:00:56,202 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:00:56,202 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:00:56,205 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:00:56,205 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:00:56,211 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:00:56,211 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:00:56,212 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:00:56,212 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:01:26,195 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:01:26,215 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:01:26,215 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:01:26,218 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:01:26,218 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:01:26,221 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:01:26,221 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:01:26,222 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:01:26,222 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:01:26,639 INFO celery.worker.strategy Received task: schedule_start_lesson[7d6d12bd-4013-4819-b6d0-fdfbb1617beb]
2016-08-17 22:01:26,641 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:01:26,641 INFO celery Scheduling start lesson tasks
2016-08-17 22:01:26,642 WARNING celery.redirected 2016-08-17 22:01:26,642 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:01:26,644 WARNING celery.redirected 2016-08-17 22:01:26,644 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:01:26,644 WARNING celery.redirected 2016-08-17 22:01:26,644 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:01:26,649 WARNING celery.redirected 2016-08-17 22:01:26,648 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:01:26,650 WARNING celery.redirected 2016-08-17 22:01:26,649 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 1, 26, 646335), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 11, 26, 646335)}
2016-08-17 22:01:26,652 WARNING celery.redirected 2016-08-17 22:01:26,652 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:01:26,653 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:01:26,661 INFO celery.worker.job Task schedule_start_lesson[7d6d12bd-4013-4819-b6d0-fdfbb1617beb] succeeded in 0.020502282997767907s: None
2016-08-17 22:01:46,213 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:01:46,423 INFO celery.worker.strategy Received task: schedule_clean_desktops[42993380-df27-4267-9d56-93816c34744d]
2016-08-17 22:01:46,425 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:01:46,426 WARNING celery.redirected 2016-08-17 22:01:46,426 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:01:46,428 WARNING celery.redirected 2016-08-17 22:01:46,427 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:01:46,428 WARNING celery.redirected 2016-08-17 22:01:46,428 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:01:46,432 WARNING celery.redirected 2016-08-17 22:01:46,431 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:01:46,432 WARNING celery.redirected 2016-08-17 22:01:46,432 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 0, 46, 425987)}
2016-08-17 22:01:46,434 WARNING celery.redirected 2016-08-17 22:01:46,434 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:01:46,435 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:01:46,443 INFO celery.worker.job Task schedule_clean_desktops[42993380-df27-4267-9d56-93816c34744d] succeeded in 0.01882393000414595s: None
2016-08-17 22:01:56,353 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:01:56,354 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:01:56,361 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:01:56,362 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:01:56,373 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:01:56,374 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:01:56,374 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:01:56,375 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:02:26,353 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:02:26,373 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:02:26,373 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:02:26,375 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:02:26,375 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:02:26,378 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:02:26,379 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:02:26,379 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:02:26,379 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:02:27,235 INFO celery.worker.strategy Received task: schedule_start_lesson[e24241cc-702e-4f86-b381-a0ec443efd76]
2016-08-17 22:02:27,237 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:02:27,237 INFO celery Scheduling start lesson tasks
2016-08-17 22:02:27,239 WARNING celery.redirected 2016-08-17 22:02:27,238 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:02:27,240 WARNING celery.redirected 2016-08-17 22:02:27,239 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:02:27,240 WARNING celery.redirected 2016-08-17 22:02:27,240 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:02:27,244 WARNING celery.redirected 2016-08-17 22:02:27,244 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:02:27,245 WARNING celery.redirected 2016-08-17 22:02:27,245 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 2, 27, 242000), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 12, 27, 242000)}
2016-08-17 22:02:27,247 WARNING celery.redirected 2016-08-17 22:02:27,247 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:02:27,249 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:02:27,257 INFO celery.worker.job Task schedule_start_lesson[e24241cc-702e-4f86-b381-a0ec443efd76] succeeded in 0.020659367000916973s: None
2016-08-17 22:02:46,368 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:02:46,651 INFO celery.worker.strategy Received task: schedule_clean_desktops[ed4bb841-e902-4286-bf05-4d0eb4124fc0]
2016-08-17 22:02:46,652 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:02:46,654 WARNING celery.redirected 2016-08-17 22:02:46,654 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:02:46,655 WARNING celery.redirected 2016-08-17 22:02:46,655 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:02:46,655 WARNING celery.redirected 2016-08-17 22:02:46,655 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:02:46,659 WARNING celery.redirected 2016-08-17 22:02:46,658 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:02:46,659 WARNING celery.redirected 2016-08-17 22:02:46,659 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 1, 46, 653519)}
2016-08-17 22:02:46,661 WARNING celery.redirected 2016-08-17 22:02:46,661 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:02:46,662 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:02:46,668 INFO celery.worker.job Task schedule_clean_desktops[ed4bb841-e902-4286-bf05-4d0eb4124fc0] succeeded in 0.016244416001427453s: None
2016-08-17 22:02:56,379 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:02:56,380 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:02:56,384 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:02:56,384 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:03:26,365 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:03:26,383 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:03:26,384 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:03:26,386 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:03:26,386 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:03:26,389 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:03:26,389 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:03:26,389 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:03:26,389 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:03:26,711 INFO celery.worker.strategy Received task: schedule_start_lesson[d30c1da4-f048-40e9-b04b-26c4cf63346f]
2016-08-17 22:03:26,712 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:03:26,712 INFO celery Scheduling start lesson tasks
2016-08-17 22:03:26,713 WARNING celery.redirected 2016-08-17 22:03:26,713 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:03:26,715 WARNING celery.redirected 2016-08-17 22:03:26,714 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:03:26,715 WARNING celery.redirected 2016-08-17 22:03:26,715 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:03:26,719 WARNING celery.redirected 2016-08-17 22:03:26,719 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:03:26,720 WARNING celery.redirected 2016-08-17 22:03:26,720 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 3, 26, 716988), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 13, 26, 716988)}
2016-08-17 22:03:26,722 WARNING celery.redirected 2016-08-17 22:03:26,722 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:03:26,723 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:03:26,729 INFO celery.worker.job Task schedule_start_lesson[d30c1da4-f048-40e9-b04b-26c4cf63346f] succeeded in 0.01765398400311824s: None
2016-08-17 22:03:46,379 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:03:47,365 INFO celery.worker.strategy Received task: schedule_clean_desktops[270be07a-a686-4e7d-823d-4c228d51a874]
2016-08-17 22:03:47,367 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:03:47,368 WARNING celery.redirected 2016-08-17 22:03:47,368 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:03:47,369 WARNING celery.redirected 2016-08-17 22:03:47,369 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:03:47,370 WARNING celery.redirected 2016-08-17 22:03:47,370 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:03:47,375 WARNING celery.redirected 2016-08-17 22:03:47,375 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:03:47,375 WARNING celery.redirected 2016-08-17 22:03:47,375 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 2, 47, 367779), 'desktop_state_2': 'DELETED'}
2016-08-17 22:03:47,377 WARNING celery.redirected 2016-08-17 22:03:47,377 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:03:47,379 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:03:47,385 INFO celery.worker.job Task schedule_clean_desktops[270be07a-a686-4e7d-823d-4c228d51a874] succeeded in 0.0188465220053331s: None
2016-08-17 22:03:56,391 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:03:56,391 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:03:56,393 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:03:56,394 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:04:26,374 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:04:26,393 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:04:26,394 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:04:26,396 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:04:26,396 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:04:26,400 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:04:26,400 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:04:26,400 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:04:26,400 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:04:27,427 INFO celery.worker.strategy Received task: schedule_start_lesson[3d513802-3b0e-4d69-9a56-568230c61a1e]
2016-08-17 22:04:27,428 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:04:27,429 INFO celery Scheduling start lesson tasks
2016-08-17 22:04:27,430 WARNING celery.redirected 2016-08-17 22:04:27,430 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:04:27,431 WARNING celery.redirected 2016-08-17 22:04:27,431 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:04:27,432 WARNING celery.redirected 2016-08-17 22:04:27,432 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:04:27,438 WARNING celery.redirected 2016-08-17 22:04:27,437 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:04:27,438 WARNING celery.redirected 2016-08-17 22:04:27,438 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 4, 27, 433883), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 14, 27, 433883)}
2016-08-17 22:04:27,441 WARNING celery.redirected 2016-08-17 22:04:27,441 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:04:27,442 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:04:27,449 INFO celery.worker.job Task schedule_start_lesson[3d513802-3b0e-4d69-9a56-568230c61a1e] succeeded in 0.02122695399884833s: None
2016-08-17 22:04:46,392 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:04:46,829 INFO celery.worker.strategy Received task: schedule_clean_desktops[7f74caca-955b-4998-9637-ae1373c527b6]
2016-08-17 22:04:46,830 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:04:46,832 WARNING celery.redirected 2016-08-17 22:04:46,832 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:04:46,833 WARNING celery.redirected 2016-08-17 22:04:46,833 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:04:46,833 WARNING celery.redirected 2016-08-17 22:04:46,833 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:04:46,837 WARNING celery.redirected 2016-08-17 22:04:46,836 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:04:46,837 WARNING celery.redirected 2016-08-17 22:04:46,837 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 3, 46, 831555), 'desktop_state_2': 'DELETED'}
2016-08-17 22:04:46,839 WARNING celery.redirected 2016-08-17 22:04:46,839 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:04:46,840 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:04:46,847 INFO celery.worker.job Task schedule_clean_desktops[7f74caca-955b-4998-9637-ae1373c527b6] succeeded in 0.016306870995322242s: None
2016-08-17 22:04:56,405 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:04:56,405 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:04:56,407 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:04:56,408 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:04:56,412 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:04:56,413 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:04:56,413 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:04:56,413 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:05:26,395 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:05:26,413 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:05:26,414 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:05:26,416 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:05:26,416 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:05:26,420 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:05:26,420 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:05:26,421 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:05:26,421 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:05:26,868 INFO celery.worker.strategy Received task: schedule_start_lesson[8f95cade-d265-41e2-9146-20cc3b7cf2e2]
2016-08-17 22:05:26,869 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:05:26,870 INFO celery Scheduling start lesson tasks
2016-08-17 22:05:26,871 WARNING celery.redirected 2016-08-17 22:05:26,871 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:05:26,872 WARNING celery.redirected 2016-08-17 22:05:26,872 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:05:26,872 WARNING celery.redirected 2016-08-17 22:05:26,872 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:05:26,876 WARNING celery.redirected 2016-08-17 22:05:26,876 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:05:26,877 WARNING celery.redirected 2016-08-17 22:05:26,877 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 5, 26, 874246), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 15, 26, 874246)}
2016-08-17 22:05:26,879 WARNING celery.redirected 2016-08-17 22:05:26,879 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:05:26,880 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:05:26,887 INFO celery.worker.job Task schedule_start_lesson[8f95cade-d265-41e2-9146-20cc3b7cf2e2] succeeded in 0.01736170799995307s: None
2016-08-17 22:05:46,412 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:05:47,579 INFO celery.worker.strategy Received task: schedule_clean_desktops[e26cafa1-36eb-434e-853e-0558fd97e67a]
2016-08-17 22:05:47,581 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:05:47,583 WARNING celery.redirected 2016-08-17 22:05:47,583 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:05:47,584 WARNING celery.redirected 2016-08-17 22:05:47,584 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:05:47,584 WARNING celery.redirected 2016-08-17 22:05:47,584 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:05:47,588 WARNING celery.redirected 2016-08-17 22:05:47,588 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:05:47,589 WARNING celery.redirected 2016-08-17 22:05:47,589 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 4, 47, 582320), 'desktop_state_2': 'DELETED'}
2016-08-17 22:05:47,591 WARNING celery.redirected 2016-08-17 22:05:47,591 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:05:47,593 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:05:47,600 INFO celery.worker.job Task schedule_clean_desktops[e26cafa1-36eb-434e-853e-0558fd97e67a] succeeded in 0.01868749000277603s: None
2016-08-17 22:05:56,522 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:05:56,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:05:56,525 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:05:56,525 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:05:56,530 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:05:56,530 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:05:56,530 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:05:56,530 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:06:26,512 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:06:26,686 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:06:26,686 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:06:26,690 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:06:26,690 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:06:26,694 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:06:26,695 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:06:26,695 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:06:26,696 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:06:27,740 INFO celery.worker.strategy Received task: schedule_start_lesson[46a9a0c8-4f6c-4f16-9e4d-411a40477748]
2016-08-17 22:06:27,741 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:06:27,742 INFO celery Scheduling start lesson tasks
2016-08-17 22:06:27,743 WARNING celery.redirected 2016-08-17 22:06:27,743 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:06:27,744 WARNING celery.redirected 2016-08-17 22:06:27,744 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:06:27,745 WARNING celery.redirected 2016-08-17 22:06:27,745 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:06:27,749 WARNING celery.redirected 2016-08-17 22:06:27,749 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:06:27,750 WARNING celery.redirected 2016-08-17 22:06:27,749 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 6, 27, 746785), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 16, 27, 746785)}
2016-08-17 22:06:27,751 WARNING celery.redirected 2016-08-17 22:06:27,751 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:06:27,753 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:06:27,761 INFO celery.worker.job Task schedule_start_lesson[46a9a0c8-4f6c-4f16-9e4d-411a40477748] succeeded in 0.020169146999251097s: None
2016-08-17 22:06:46,688 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:06:47,131 INFO celery.worker.strategy Received task: schedule_clean_desktops[3f48272a-96a2-4d3e-a570-7450314fecad]
2016-08-17 22:06:47,132 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:06:47,133 WARNING celery.redirected 2016-08-17 22:06:47,133 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:06:47,134 WARNING celery.redirected 2016-08-17 22:06:47,134 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:06:47,135 WARNING celery.redirected 2016-08-17 22:06:47,135 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:06:47,139 WARNING celery.redirected 2016-08-17 22:06:47,139 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:06:47,140 WARNING celery.redirected 2016-08-17 22:06:47,139 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 5, 47, 132952)}
2016-08-17 22:06:47,142 WARNING celery.redirected 2016-08-17 22:06:47,142 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:06:47,143 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:06:47,151 INFO celery.worker.job Task schedule_clean_desktops[3f48272a-96a2-4d3e-a570-7450314fecad] succeeded in 0.01887860299757449s: None
2016-08-17 22:06:56,709 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:06:56,709 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:06:56,712 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:06:56,712 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:06:56,719 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:06:56,720 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:06:56,721 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:06:56,721 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:07:31,702 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:07:31,702 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:07:31,702 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:07:31,702 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:07:31,704 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:07:31,725 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:07:31,726 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:07:31,728 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:07:31,728 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:07:31,732 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:07:31,732 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:07:31,732 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:07:31,732 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:07:32,345 INFO celery.worker.strategy Received task: schedule_start_lesson[06e0c966-86de-4d8c-8d21-c5d7484a4d87]
2016-08-17 22:07:32,347 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:07:32,347 INFO celery Scheduling start lesson tasks
2016-08-17 22:07:32,348 WARNING celery.redirected 2016-08-17 22:07:32,348 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:07:32,349 WARNING celery.redirected 2016-08-17 22:07:32,349 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:07:32,349 WARNING celery.redirected 2016-08-17 22:07:32,349 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:07:32,353 WARNING celery.redirected 2016-08-17 22:07:32,353 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:07:32,354 WARNING celery.redirected 2016-08-17 22:07:32,353 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 7, 32, 351298), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 17, 32, 351298)}
2016-08-17 22:07:32,356 WARNING celery.redirected 2016-08-17 22:07:32,356 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:07:32,357 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:07:32,364 INFO celery.worker.job Task schedule_start_lesson[06e0c966-86de-4d8c-8d21-c5d7484a4d87] succeeded in 0.017879286999232136s: None
2016-08-17 22:07:51,726 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:07:51,949 INFO celery.worker.strategy Received task: schedule_clean_desktops[c5daec74-3fc8-4b41-a7b7-246663d29516]
2016-08-17 22:07:51,951 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:07:51,953 WARNING celery.redirected 2016-08-17 22:07:51,953 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:07:51,954 WARNING celery.redirected 2016-08-17 22:07:51,954 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:07:51,955 WARNING celery.redirected 2016-08-17 22:07:51,955 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:07:51,959 WARNING celery.redirected 2016-08-17 22:07:51,959 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:07:51,960 WARNING celery.redirected 2016-08-17 22:07:51,959 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 6, 51, 952169)}
2016-08-17 22:07:51,962 WARNING celery.redirected 2016-08-17 22:07:51,962 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:07:51,963 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:07:51,970 INFO celery.worker.job Task schedule_clean_desktops[c5daec74-3fc8-4b41-a7b7-246663d29516] succeeded in 0.019517034001182765s: None
2016-08-17 22:08:01,947 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:08:01,947 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:08:01,949 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:08:01,949 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:08:01,954 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:08:01,954 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:08:01,954 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:08:01,955 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:08:36,934 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:08:36,935 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:08:36,935 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:08:36,935 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:08:36,937 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:08:37,077 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:08:37,077 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:08:37,080 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:08:37,080 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:08:37,084 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:08:37,084 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:08:37,085 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:08:37,085 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:08:38,134 INFO celery.worker.strategy Received task: schedule_start_lesson[630ff42d-ca7b-4191-aa87-952dd7c690ec]
2016-08-17 22:08:38,136 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:08:38,136 INFO celery Scheduling start lesson tasks
2016-08-17 22:08:38,137 WARNING celery.redirected 2016-08-17 22:08:38,137 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:08:38,138 WARNING celery.redirected 2016-08-17 22:08:38,138 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:08:38,139 WARNING celery.redirected 2016-08-17 22:08:38,138 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:08:38,142 WARNING celery.redirected 2016-08-17 22:08:38,142 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:08:38,144 WARNING celery.redirected 2016-08-17 22:08:38,143 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 8, 38, 140304), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 18, 38, 140304)}
2016-08-17 22:08:38,146 WARNING celery.redirected 2016-08-17 22:08:38,146 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:08:38,148 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:08:38,155 INFO celery.worker.job Task schedule_start_lesson[630ff42d-ca7b-4191-aa87-952dd7c690ec] succeeded in 0.019342263003636617s: None
2016-08-17 22:08:52,074 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:08:52,681 INFO celery.worker.strategy Received task: schedule_clean_desktops[bc04e6c9-7681-4283-9d95-c8abbd4fd9fa]
2016-08-17 22:08:52,682 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:08:52,684 WARNING celery.redirected 2016-08-17 22:08:52,684 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:08:52,685 WARNING celery.redirected 2016-08-17 22:08:52,685 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:08:52,685 WARNING celery.redirected 2016-08-17 22:08:52,685 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:08:52,689 WARNING celery.redirected 2016-08-17 22:08:52,689 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:08:52,689 WARNING celery.redirected 2016-08-17 22:08:52,689 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 7, 52, 683580), 'desktop_state_2': 'DELETED'}
2016-08-17 22:08:52,692 WARNING celery.redirected 2016-08-17 22:08:52,692 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:08:52,693 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:08:52,701 INFO celery.worker.job Task schedule_clean_desktops[bc04e6c9-7681-4283-9d95-c8abbd4fd9fa] succeeded in 0.018521117999625858s: None
2016-08-17 22:09:07,086 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:09:07,087 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:09:07,090 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:09:07,090 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:09:07,095 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:09:07,095 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:09:07,096 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:09:07,096 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:09:37,068 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:09:37,749 INFO celery.worker.strategy Received task: schedule_start_lesson[9bd6593d-0ce9-4789-b825-8efa0a961cfa]
2016-08-17 22:09:37,750 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:09:37,751 INFO celery Scheduling start lesson tasks
2016-08-17 22:09:37,752 WARNING celery.redirected 2016-08-17 22:09:37,752 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:09:37,753 WARNING celery.redirected 2016-08-17 22:09:37,753 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:09:37,753 WARNING celery.redirected 2016-08-17 22:09:37,753 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:09:37,757 WARNING celery.redirected 2016-08-17 22:09:37,757 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:09:37,758 WARNING celery.redirected 2016-08-17 22:09:37,758 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 9, 37, 755488), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 19, 37, 755488)}
2016-08-17 22:09:37,760 WARNING celery.redirected 2016-08-17 22:09:37,760 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:09:37,762 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:09:37,770 INFO celery.worker.job Task schedule_start_lesson[9bd6593d-0ce9-4789-b825-8efa0a961cfa] succeeded in 0.019269911004812457s: None
2016-08-17 22:09:42,087 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:09:42,088 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:09:42,090 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:09:42,091 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:09:42,096 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:09:42,096 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:09:42,096 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:09:42,096 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:09:52,091 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:09:52,288 INFO celery.worker.strategy Received task: schedule_clean_desktops[1e3c1083-1b24-4827-9667-93a3ba883379]
2016-08-17 22:09:52,289 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:09:52,291 WARNING celery.redirected 2016-08-17 22:09:52,291 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:09:52,292 WARNING celery.redirected 2016-08-17 22:09:52,292 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:09:52,292 WARNING celery.redirected 2016-08-17 22:09:52,292 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:09:52,297 WARNING celery.redirected 2016-08-17 22:09:52,296 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:09:52,297 WARNING celery.redirected 2016-08-17 22:09:52,297 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 8, 52, 290533), 'desktop_state_2': 'DELETED'}
2016-08-17 22:09:52,300 WARNING celery.redirected 2016-08-17 22:09:52,300 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:09:52,301 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:09:52,308 INFO celery.worker.job Task schedule_clean_desktops[1e3c1083-1b24-4827-9667-93a3ba883379] succeeded in 0.01828995899995789s: None
2016-08-17 22:10:12,099 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:10:12,099 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:10:12,102 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:10:12,103 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:10:12,108 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:10:12,109 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:10:12,109 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:10:12,109 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:10:37,094 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:10:37,650 INFO celery.worker.strategy Received task: schedule_start_lesson[12f0420d-5b66-4d5c-8434-30ce6f8289a7]
2016-08-17 22:10:37,652 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:10:37,652 INFO celery Scheduling start lesson tasks
2016-08-17 22:10:37,653 WARNING celery.redirected 2016-08-17 22:10:37,653 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:10:37,655 WARNING celery.redirected 2016-08-17 22:10:37,655 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:10:37,655 WARNING celery.redirected 2016-08-17 22:10:37,655 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:10:37,659 WARNING celery.redirected 2016-08-17 22:10:37,659 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:10:37,660 WARNING celery.redirected 2016-08-17 22:10:37,660 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 10, 37, 657220), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 20, 37, 657220)}
2016-08-17 22:10:37,662 WARNING celery.redirected 2016-08-17 22:10:37,662 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:10:37,663 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:10:37,670 INFO celery.worker.job Task schedule_start_lesson[12f0420d-5b66-4d5c-8434-30ce6f8289a7] succeeded in 0.018126257993571926s: None
2016-08-17 22:10:42,111 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:10:42,112 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:10:42,114 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:10:42,115 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:10:42,119 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:10:42,120 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:10:42,120 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:10:42,120 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:10:52,117 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:10:52,329 INFO celery.worker.strategy Received task: schedule_clean_desktops[85d92a3b-4e50-43ee-9fe9-82d4ae2025a4]
2016-08-17 22:10:52,330 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:10:52,332 WARNING celery.redirected 2016-08-17 22:10:52,332 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:10:52,333 WARNING celery.redirected 2016-08-17 22:10:52,332 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:10:52,333 WARNING celery.redirected 2016-08-17 22:10:52,333 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:10:52,337 WARNING celery.redirected 2016-08-17 22:10:52,337 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:10:52,337 WARNING celery.redirected 2016-08-17 22:10:52,337 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 9, 52, 331369), 'desktop_state_2': 'DELETED'}
2016-08-17 22:10:52,340 WARNING celery.redirected 2016-08-17 22:10:52,339 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:10:52,341 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:10:52,347 INFO celery.worker.job Task schedule_clean_desktops[85d92a3b-4e50-43ee-9fe9-82d4ae2025a4] succeeded in 0.01730845600104658s: None
2016-08-17 22:11:12,250 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:11:12,250 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:11:12,253 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:11:12,254 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:11:12,259 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:11:12,259 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:11:12,259 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:11:12,260 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:11:37,247 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:11:37,615 INFO celery.worker.strategy Received task: schedule_start_lesson[74a311c1-fe71-4d94-849c-63afec7d495d]
2016-08-17 22:11:37,616 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:11:37,617 INFO celery Scheduling start lesson tasks
2016-08-17 22:11:37,618 WARNING celery.redirected 2016-08-17 22:11:37,618 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:11:37,619 WARNING celery.redirected 2016-08-17 22:11:37,618 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:11:37,619 WARNING celery.redirected 2016-08-17 22:11:37,619 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:11:37,623 WARNING celery.redirected 2016-08-17 22:11:37,623 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:11:37,623 WARNING celery.redirected 2016-08-17 22:11:37,623 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 11, 37, 620834), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 21, 37, 620834)}
2016-08-17 22:11:37,626 WARNING celery.redirected 2016-08-17 22:11:37,625 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:11:37,626 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:11:37,634 INFO celery.worker.job Task schedule_start_lesson[74a311c1-fe71-4d94-849c-63afec7d495d] succeeded in 0.018137389000912663s: None
2016-08-17 22:11:42,263 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:11:42,263 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:11:42,266 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:11:42,266 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:11:42,271 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:11:42,272 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:11:42,272 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:11:42,272 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:11:52,264 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:11:53,273 INFO celery.worker.strategy Received task: schedule_clean_desktops[a8317f16-d1f6-4f73-8ffa-7b020404c0b1]
2016-08-17 22:11:53,274 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:11:53,276 WARNING celery.redirected 2016-08-17 22:11:53,276 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:11:53,277 WARNING celery.redirected 2016-08-17 22:11:53,277 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:11:53,277 WARNING celery.redirected 2016-08-17 22:11:53,277 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:11:53,280 WARNING celery.redirected 2016-08-17 22:11:53,280 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:11:53,281 WARNING celery.redirected 2016-08-17 22:11:53,281 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 10, 53, 275455), 'desktop_state_2': 'DELETED'}
2016-08-17 22:11:53,283 WARNING celery.redirected 2016-08-17 22:11:53,283 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:11:53,284 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:11:53,291 INFO celery.worker.job Task schedule_clean_desktops[a8317f16-d1f6-4f73-8ffa-7b020404c0b1] succeeded in 0.017075880998163484s: None
2016-08-17 22:12:12,275 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:12:12,275 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:12:12,277 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:12:12,277 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:12:37,277 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:12:38,034 INFO celery.worker.strategy Received task: schedule_start_lesson[b0e0bd1d-f981-428a-973a-f2e9461c0996]
2016-08-17 22:12:38,036 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:12:38,036 INFO celery Scheduling start lesson tasks
2016-08-17 22:12:38,037 WARNING celery.redirected 2016-08-17 22:12:38,037 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:12:38,038 WARNING celery.redirected 2016-08-17 22:12:38,038 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:12:38,039 WARNING celery.redirected 2016-08-17 22:12:38,038 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:12:38,042 WARNING celery.redirected 2016-08-17 22:12:38,042 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:12:38,043 WARNING celery.redirected 2016-08-17 22:12:38,043 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 12, 38, 40245), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 22, 38, 40245)}
2016-08-17 22:12:38,045 WARNING celery.redirected 2016-08-17 22:12:38,045 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:12:38,046 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:12:38,053 INFO celery.worker.job Task schedule_start_lesson[b0e0bd1d-f981-428a-973a-f2e9461c0996] succeeded in 0.017845950998889748s: None
2016-08-17 22:12:42,293 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:12:42,293 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:12:42,296 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:12:42,296 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:12:42,301 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:12:42,302 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:12:42,302 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:12:42,302 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:12:52,297 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:12:52,442 INFO celery.worker.strategy Received task: schedule_clean_desktops[225fe7be-ab9b-4990-8dbd-39bccc91ad3a]
2016-08-17 22:12:52,444 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:12:52,445 WARNING celery.redirected 2016-08-17 22:12:52,445 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:12:52,446 WARNING celery.redirected 2016-08-17 22:12:52,446 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:12:52,446 WARNING celery.redirected 2016-08-17 22:12:52,446 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:12:52,450 WARNING celery.redirected 2016-08-17 22:12:52,449 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:12:52,450 WARNING celery.redirected 2016-08-17 22:12:52,450 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 11, 52, 444676), 'desktop_state_2': 'DELETED'}
2016-08-17 22:12:52,453 WARNING celery.redirected 2016-08-17 22:12:52,453 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:12:52,454 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:12:52,462 INFO celery.worker.job Task schedule_clean_desktops[225fe7be-ab9b-4990-8dbd-39bccc91ad3a] succeeded in 0.01860058600141201s: None
2016-08-17 22:13:12,304 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:13:12,305 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:13:12,307 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:13:12,307 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:13:12,312 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:13:12,312 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:13:12,313 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:13:12,313 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:13:37,297 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:13:38,278 INFO celery.worker.strategy Received task: schedule_start_lesson[3042aded-f10f-4328-ae93-b79545e441a4]
2016-08-17 22:13:38,279 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:13:38,280 INFO celery Scheduling start lesson tasks
2016-08-17 22:13:38,281 WARNING celery.redirected 2016-08-17 22:13:38,281 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:13:38,282 WARNING celery.redirected 2016-08-17 22:13:38,282 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:13:38,282 WARNING celery.redirected 2016-08-17 22:13:38,282 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:13:38,286 WARNING celery.redirected 2016-08-17 22:13:38,286 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:13:38,287 WARNING celery.redirected 2016-08-17 22:13:38,287 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 13, 38, 284006), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 23, 38, 284006)}
2016-08-17 22:13:38,290 WARNING celery.redirected 2016-08-17 22:13:38,290 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:13:38,291 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:13:38,299 INFO celery.worker.job Task schedule_start_lesson[3042aded-f10f-4328-ae93-b79545e441a4] succeeded in 0.019723644996702205s: None
2016-08-17 22:13:42,316 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:13:42,317 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:13:42,319 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:13:42,319 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:13:42,324 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:13:42,324 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:13:42,325 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:13:42,325 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:13:52,319 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:13:52,669 INFO celery.worker.strategy Received task: schedule_clean_desktops[f0e2763f-4d60-417c-ad6e-b559be1d4756]
2016-08-17 22:13:52,670 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:13:52,672 WARNING celery.redirected 2016-08-17 22:13:52,672 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:13:52,673 WARNING celery.redirected 2016-08-17 22:13:52,672 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:13:52,673 WARNING celery.redirected 2016-08-17 22:13:52,673 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:13:52,676 WARNING celery.redirected 2016-08-17 22:13:52,676 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:13:52,677 WARNING celery.redirected 2016-08-17 22:13:52,677 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 12, 52, 671423)}
2016-08-17 22:13:52,679 WARNING celery.redirected 2016-08-17 22:13:52,679 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:13:52,680 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:13:52,687 INFO celery.worker.job Task schedule_clean_desktops[f0e2763f-4d60-417c-ad6e-b559be1d4756] succeeded in 0.01668370599509217s: None
2016-08-17 22:14:12,327 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:14:12,328 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:14:12,331 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:14:12,331 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:14:37,313 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:14:38,533 INFO celery.worker.strategy Received task: schedule_start_lesson[3610004d-a830-4f90-aa03-8aafc15218e1]
2016-08-17 22:14:38,534 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:14:38,535 INFO celery Scheduling start lesson tasks
2016-08-17 22:14:38,535 WARNING celery.redirected 2016-08-17 22:14:38,535 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:14:38,536 WARNING celery.redirected 2016-08-17 22:14:38,536 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:14:38,537 WARNING celery.redirected 2016-08-17 22:14:38,537 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:14:38,541 WARNING celery.redirected 2016-08-17 22:14:38,540 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:14:38,541 WARNING celery.redirected 2016-08-17 22:14:38,541 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 14, 38, 538760), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 24, 38, 538760)}
2016-08-17 22:14:38,545 WARNING celery.redirected 2016-08-17 22:14:38,544 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:14:38,546 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:14:38,554 INFO celery.worker.job Task schedule_start_lesson[3610004d-a830-4f90-aa03-8aafc15218e1] succeeded in 0.02004635900084395s: None
2016-08-17 22:14:42,484 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:14:42,485 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:14:42,487 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:14:42,487 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:14:42,492 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:14:42,493 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:14:42,494 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:14:42,494 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:14:52,488 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:14:53,000 INFO celery.worker.strategy Received task: schedule_clean_desktops[400725ca-a073-440f-b4f8-92c8207fdc7c]
2016-08-17 22:14:53,002 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:14:53,003 WARNING celery.redirected 2016-08-17 22:14:53,003 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:14:53,004 WARNING celery.redirected 2016-08-17 22:14:53,004 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:14:53,005 WARNING celery.redirected 2016-08-17 22:14:53,005 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:14:53,008 WARNING celery.redirected 2016-08-17 22:14:53,008 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:14:53,008 WARNING celery.redirected 2016-08-17 22:14:53,008 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 13, 53, 2746)}
2016-08-17 22:14:53,011 WARNING celery.redirected 2016-08-17 22:14:53,011 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:14:53,013 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:14:53,037 INFO celery.worker.job Task schedule_clean_desktops[400725ca-a073-440f-b4f8-92c8207fdc7c] succeeded in 0.03554789800546132s: None
2016-08-17 22:15:12,494 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:15:12,494 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:15:12,496 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:15:12,496 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:15:37,481 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:15:38,362 INFO celery.worker.strategy Received task: schedule_start_lesson[d2757c55-4529-4f98-96f0-c8076dd2f1da]
2016-08-17 22:15:38,363 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:15:38,364 INFO celery Scheduling start lesson tasks
2016-08-17 22:15:38,365 WARNING celery.redirected 2016-08-17 22:15:38,365 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:15:38,366 WARNING celery.redirected 2016-08-17 22:15:38,366 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:15:38,366 WARNING celery.redirected 2016-08-17 22:15:38,366 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:15:38,372 WARNING celery.redirected 2016-08-17 22:15:38,372 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:15:38,372 WARNING celery.redirected 2016-08-17 22:15:38,372 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 15, 38, 368194), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 25, 38, 368194)}
2016-08-17 22:15:38,375 WARNING celery.redirected 2016-08-17 22:15:38,375 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:15:38,376 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:15:38,389 INFO celery.worker.job Task schedule_start_lesson[d2757c55-4529-4f98-96f0-c8076dd2f1da] succeeded in 0.025647613998444285s: None
2016-08-17 22:15:42,501 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:15:42,502 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:15:42,504 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:15:42,504 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:15:42,510 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:15:42,510 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:15:42,510 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:15:42,510 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:15:52,505 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:15:52,984 INFO celery.worker.strategy Received task: schedule_clean_desktops[a35afeb2-bc8e-4ac4-853a-2fd775acb7ce]
2016-08-17 22:15:52,985 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:15:52,987 WARNING celery.redirected 2016-08-17 22:15:52,987 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:15:52,989 WARNING celery.redirected 2016-08-17 22:15:52,989 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:15:52,990 WARNING celery.redirected 2016-08-17 22:15:52,989 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:15:52,993 WARNING celery.redirected 2016-08-17 22:15:52,993 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:15:52,993 WARNING celery.redirected 2016-08-17 22:15:52,993 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 14, 52, 986414), 'desktop_state_2': 'DELETED'}
2016-08-17 22:15:52,996 WARNING celery.redirected 2016-08-17 22:15:52,995 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:15:52,997 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:15:53,003 INFO celery.worker.job Task schedule_clean_desktops[a35afeb2-bc8e-4ac4-853a-2fd775acb7ce] succeeded in 0.01803399399796035s: None
2016-08-17 22:16:12,514 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:16:12,514 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:16:12,516 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:16:12,516 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:16:12,522 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:16:12,522 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:16:12,522 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:16:12,522 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:16:37,510 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:16:38,235 INFO celery.worker.strategy Received task: schedule_start_lesson[0a9f9440-91f7-4271-8a00-060e6285fa38]
2016-08-17 22:16:38,236 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:16:38,237 INFO celery Scheduling start lesson tasks
2016-08-17 22:16:38,238 WARNING celery.redirected 2016-08-17 22:16:38,238 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:16:38,239 WARNING celery.redirected 2016-08-17 22:16:38,239 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:16:38,239 WARNING celery.redirected 2016-08-17 22:16:38,239 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:16:38,246 WARNING celery.redirected 2016-08-17 22:16:38,246 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:16:38,247 WARNING celery.redirected 2016-08-17 22:16:38,247 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 16, 38, 242212), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 26, 38, 242212)}
2016-08-17 22:16:38,249 WARNING celery.redirected 2016-08-17 22:16:38,249 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:16:38,250 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:16:38,257 INFO celery.worker.job Task schedule_start_lesson[0a9f9440-91f7-4271-8a00-060e6285fa38] succeeded in 0.020939359004842117s: None
2016-08-17 22:16:42,528 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:16:42,528 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:16:42,530 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:16:42,531 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:16:42,536 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:16:42,536 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:16:42,537 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:16:42,537 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:16:57,525 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:16:57,659 INFO celery.worker.strategy Received task: schedule_clean_desktops[dddbcceb-ca6b-49c6-a70b-a757d756d1e8]
2016-08-17 22:16:57,660 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:16:57,662 WARNING celery.redirected 2016-08-17 22:16:57,662 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:16:57,663 WARNING celery.redirected 2016-08-17 22:16:57,663 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:16:57,664 WARNING celery.redirected 2016-08-17 22:16:57,664 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:16:57,668 WARNING celery.redirected 2016-08-17 22:16:57,668 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:16:57,668 WARNING celery.redirected 2016-08-17 22:16:57,668 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 15, 57, 661731)}
2016-08-17 22:16:57,670 WARNING celery.redirected 2016-08-17 22:16:57,670 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:16:57,671 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:16:57,678 INFO celery.worker.job Task schedule_clean_desktops[dddbcceb-ca6b-49c6-a70b-a757d756d1e8] succeeded in 0.01807627199741546s: None
2016-08-17 22:17:12,542 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:17:12,542 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:17:12,546 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:17:12,547 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:17:42,535 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:17:42,553 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:17:42,553 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:17:42,556 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:17:42,556 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:17:42,559 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:17:42,559 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:17:42,559 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:17:42,559 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:17:43,042 INFO celery.worker.strategy Received task: schedule_start_lesson[2711fb1a-8c75-482c-8a3e-1d171c137bb1]
2016-08-17 22:17:43,044 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:17:43,045 INFO celery Scheduling start lesson tasks
2016-08-17 22:17:43,046 WARNING celery.redirected 2016-08-17 22:17:43,046 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:17:43,047 WARNING celery.redirected 2016-08-17 22:17:43,047 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:17:43,048 WARNING celery.redirected 2016-08-17 22:17:43,048 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:17:43,052 WARNING celery.redirected 2016-08-17 22:17:43,052 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:17:43,053 WARNING celery.redirected 2016-08-17 22:17:43,053 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 17, 43, 49822), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 27, 43, 49822)}
2016-08-17 22:17:43,055 WARNING celery.redirected 2016-08-17 22:17:43,055 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:17:43,056 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:17:43,064 INFO celery.worker.job Task schedule_start_lesson[2711fb1a-8c75-482c-8a3e-1d171c137bb1] succeeded in 0.01983763399766758s: None
2016-08-17 22:18:02,549 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:18:03,716 INFO celery.worker.strategy Received task: schedule_clean_desktops[9ddd74ac-13aa-4303-84f3-65323cde0b08]
2016-08-17 22:18:03,717 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:18:03,719 WARNING celery.redirected 2016-08-17 22:18:03,718 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:18:03,720 WARNING celery.redirected 2016-08-17 22:18:03,719 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:18:03,720 WARNING celery.redirected 2016-08-17 22:18:03,720 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:18:03,723 WARNING celery.redirected 2016-08-17 22:18:03,723 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:18:03,724 WARNING celery.redirected 2016-08-17 22:18:03,724 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 17, 3, 718032), 'desktop_state_2': 'DELETED'}
2016-08-17 22:18:03,727 WARNING celery.redirected 2016-08-17 22:18:03,726 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:18:03,728 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:18:03,736 INFO celery.worker.job Task schedule_clean_desktops[9ddd74ac-13aa-4303-84f3-65323cde0b08] succeeded in 0.019421744997089263s: None
2016-08-17 22:18:12,652 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:18:12,653 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:18:12,655 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:18:12,655 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:18:12,660 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:18:12,660 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:18:12,660 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:18:12,661 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:18:47,641 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:18:47,641 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:18:47,641 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:18:47,641 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:18:47,643 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:18:47,684 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:18:47,684 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:18:47,686 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:18:47,687 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:18:47,690 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:18:47,691 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:18:47,691 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:18:47,691 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:18:48,753 INFO celery.worker.strategy Received task: schedule_start_lesson[467cb038-cb58-4507-9726-58aefec56ca3]
2016-08-17 22:18:48,754 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:18:48,755 INFO celery Scheduling start lesson tasks
2016-08-17 22:18:48,756 WARNING celery.redirected 2016-08-17 22:18:48,756 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:18:48,757 WARNING celery.redirected 2016-08-17 22:18:48,757 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:18:48,758 WARNING celery.redirected 2016-08-17 22:18:48,758 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:18:48,762 WARNING celery.redirected 2016-08-17 22:18:48,761 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:18:48,763 WARNING celery.redirected 2016-08-17 22:18:48,762 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 18, 48, 759769), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 28, 48, 759769)}
2016-08-17 22:18:48,765 WARNING celery.redirected 2016-08-17 22:18:48,765 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:18:48,767 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:18:48,775 INFO celery.worker.job Task schedule_start_lesson[467cb038-cb58-4507-9726-58aefec56ca3] succeeded in 0.021284059999743477s: None
2016-08-17 22:19:07,682 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:19:08,089 INFO celery.worker.strategy Received task: schedule_clean_desktops[9507b9e7-553c-45c1-98d6-7c9163a3b09b]
2016-08-17 22:19:08,091 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:19:08,093 WARNING celery.redirected 2016-08-17 22:19:08,093 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:19:08,095 WARNING celery.redirected 2016-08-17 22:19:08,095 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:19:08,096 WARNING celery.redirected 2016-08-17 22:19:08,095 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:19:08,100 WARNING celery.redirected 2016-08-17 22:19:08,100 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:19:08,101 WARNING celery.redirected 2016-08-17 22:19:08,101 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 18, 8, 92390)}
2016-08-17 22:19:08,104 WARNING celery.redirected 2016-08-17 22:19:08,103 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:19:08,105 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:19:08,112 INFO celery.worker.job Task schedule_clean_desktops[9507b9e7-553c-45c1-98d6-7c9163a3b09b] succeeded in 0.021348499998566695s: None
2016-08-17 22:19:17,696 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:19:17,697 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:19:17,699 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:19:17,699 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:19:17,704 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:19:17,704 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:19:17,705 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:19:17,705 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:19:52,685 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:19:52,685 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:19:52,685 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:19:52,685 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:19:52,687 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:19:52,705 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:19:52,706 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:19:52,709 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:19:52,709 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:19:52,712 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:19:52,712 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:19:52,713 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:19:52,713 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:19:53,131 INFO celery.worker.strategy Received task: schedule_start_lesson[57800a1a-1230-4a51-9593-7ca8536d3136]
2016-08-17 22:19:53,132 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:19:53,133 INFO celery Scheduling start lesson tasks
2016-08-17 22:19:53,134 WARNING celery.redirected 2016-08-17 22:19:53,134 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:19:53,135 WARNING celery.redirected 2016-08-17 22:19:53,135 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:19:53,136 WARNING celery.redirected 2016-08-17 22:19:53,135 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:19:53,140 WARNING celery.redirected 2016-08-17 22:19:53,140 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:19:53,141 WARNING celery.redirected 2016-08-17 22:19:53,141 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 19, 53, 137463), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 29, 53, 137463)}
2016-08-17 22:19:53,143 WARNING celery.redirected 2016-08-17 22:19:53,143 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:19:53,144 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:19:53,151 INFO celery.worker.job Task schedule_start_lesson[57800a1a-1230-4a51-9593-7ca8536d3136] succeeded in 0.01881377099925885s: None
2016-08-17 22:20:12,704 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:20:13,888 INFO celery.worker.strategy Received task: schedule_clean_desktops[cfbc1997-b723-4210-9cea-72a60edde1c6]
2016-08-17 22:20:13,889 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:20:13,891 WARNING celery.redirected 2016-08-17 22:20:13,890 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:20:13,892 WARNING celery.redirected 2016-08-17 22:20:13,891 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:20:13,892 WARNING celery.redirected 2016-08-17 22:20:13,892 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:20:13,895 WARNING celery.redirected 2016-08-17 22:20:13,895 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:20:13,896 WARNING celery.redirected 2016-08-17 22:20:13,896 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 19, 13, 890176)}
2016-08-17 22:20:13,898 WARNING celery.redirected 2016-08-17 22:20:13,898 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:20:13,900 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:20:13,906 INFO celery.worker.job Task schedule_clean_desktops[cfbc1997-b723-4210-9cea-72a60edde1c6] succeeded in 0.017322171006526332s: None
2016-08-17 22:20:22,837 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:20:22,837 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:20:22,840 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:20:22,841 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:20:22,847 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:20:22,847 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:20:22,847 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:20:22,847 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:20:57,833 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:20:57,833 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:20:57,834 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:20:57,834 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:20:57,836 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:20:57,852 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:20:57,852 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:20:57,855 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:20:57,855 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:20:57,858 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:20:57,858 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:20:57,859 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:20:57,859 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:20:58,659 INFO celery.worker.strategy Received task: schedule_start_lesson[2dd5af81-a559-408e-8a94-a2e55a6a2ba7]
2016-08-17 22:20:58,660 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:20:58,661 INFO celery Scheduling start lesson tasks
2016-08-17 22:20:58,662 WARNING celery.redirected 2016-08-17 22:20:58,661 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:20:58,663 WARNING celery.redirected 2016-08-17 22:20:58,662 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:20:58,663 WARNING celery.redirected 2016-08-17 22:20:58,663 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:20:58,667 WARNING celery.redirected 2016-08-17 22:20:58,667 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:20:58,668 WARNING celery.redirected 2016-08-17 22:20:58,668 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 20, 58, 665206), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 30, 58, 665206)}
2016-08-17 22:20:58,670 WARNING celery.redirected 2016-08-17 22:20:58,670 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:20:58,671 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:20:58,677 INFO celery.worker.job Task schedule_start_lesson[2dd5af81-a559-408e-8a94-a2e55a6a2ba7] succeeded in 0.017293469005380757s: None
2016-08-17 22:21:17,849 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:21:17,933 INFO celery.worker.strategy Received task: schedule_clean_desktops[d5de0cc4-f8ee-4413-82b1-5094b50c4054]
2016-08-17 22:21:17,934 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:21:17,936 WARNING celery.redirected 2016-08-17 22:21:17,936 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:21:17,937 WARNING celery.redirected 2016-08-17 22:21:17,937 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:21:17,938 WARNING celery.redirected 2016-08-17 22:21:17,937 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:21:17,942 WARNING celery.redirected 2016-08-17 22:21:17,942 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:21:17,943 WARNING celery.redirected 2016-08-17 22:21:17,943 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 20, 17, 935467)}
2016-08-17 22:21:17,945 WARNING celery.redirected 2016-08-17 22:21:17,945 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:21:17,946 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:21:17,953 INFO celery.worker.job Task schedule_clean_desktops[d5de0cc4-f8ee-4413-82b1-5094b50c4054] succeeded in 0.018751083000097424s: None
2016-08-17 22:21:27,926 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:21:27,927 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:21:27,929 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:21:27,929 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:21:27,934 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:21:27,935 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:21:27,935 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:21:27,935 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:22:02,907 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:22:02,907 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:22:02,907 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:22:02,908 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:22:02,909 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:22:02,927 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:22:02,928 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:22:02,930 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:22:02,930 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:22:02,935 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:22:02,935 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:22:02,936 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:22:02,936 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:22:03,803 INFO celery.worker.strategy Received task: schedule_start_lesson[0b59bd24-de32-4db1-9835-1fcc2c9f83ef]
2016-08-17 22:22:03,804 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:22:03,804 INFO celery Scheduling start lesson tasks
2016-08-17 22:22:03,805 WARNING celery.redirected 2016-08-17 22:22:03,805 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:22:03,806 WARNING celery.redirected 2016-08-17 22:22:03,806 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:22:03,807 WARNING celery.redirected 2016-08-17 22:22:03,807 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:22:03,810 WARNING celery.redirected 2016-08-17 22:22:03,810 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:22:03,811 WARNING celery.redirected 2016-08-17 22:22:03,810 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 22, 3, 808433), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 32, 3, 808433)}
2016-08-17 22:22:03,813 WARNING celery.redirected 2016-08-17 22:22:03,813 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:22:03,815 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:22:03,825 INFO celery.worker.job Task schedule_start_lesson[0b59bd24-de32-4db1-9835-1fcc2c9f83ef] succeeded in 0.02115326600323897s: None
2016-08-17 22:22:22,927 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:22:23,277 INFO celery.worker.strategy Received task: schedule_clean_desktops[18af8b7d-656b-40a1-ae33-ae99e7174c3e]
2016-08-17 22:22:23,279 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:22:23,280 WARNING celery.redirected 2016-08-17 22:22:23,280 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:22:23,281 WARNING celery.redirected 2016-08-17 22:22:23,281 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:22:23,282 WARNING celery.redirected 2016-08-17 22:22:23,282 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:22:23,285 WARNING celery.redirected 2016-08-17 22:22:23,285 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:22:23,285 WARNING celery.redirected 2016-08-17 22:22:23,285 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 21, 23, 279704)}
2016-08-17 22:22:23,288 WARNING celery.redirected 2016-08-17 22:22:23,288 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:22:23,289 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:22:23,295 INFO celery.worker.job Task schedule_clean_desktops[18af8b7d-656b-40a1-ae33-ae99e7174c3e] succeeded in 0.016933735998463817s: None
2016-08-17 22:22:32,940 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:22:32,941 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:22:32,943 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:22:32,943 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:22:32,948 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:22:32,948 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:22:32,949 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:22:32,949 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:23:07,930 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:23:07,930 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:23:07,931 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:23:07,931 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:23:07,933 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:23:07,949 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:23:07,949 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:23:07,952 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:23:07,952 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:23:07,955 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:23:07,955 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:23:07,955 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:23:07,955 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:23:08,142 INFO celery.worker.strategy Received task: schedule_start_lesson[9656989d-760e-4fdc-9509-56b2f486abe0]
2016-08-17 22:23:08,144 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:23:08,144 INFO celery Scheduling start lesson tasks
2016-08-17 22:23:08,145 WARNING celery.redirected 2016-08-17 22:23:08,145 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:23:08,146 WARNING celery.redirected 2016-08-17 22:23:08,146 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:23:08,146 WARNING celery.redirected 2016-08-17 22:23:08,146 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:23:08,150 WARNING celery.redirected 2016-08-17 22:23:08,150 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:23:08,151 WARNING celery.redirected 2016-08-17 22:23:08,151 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 23, 8, 148268), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 33, 8, 148268)}
2016-08-17 22:23:08,153 WARNING celery.redirected 2016-08-17 22:23:08,153 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:23:08,154 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:23:08,161 INFO celery.worker.job Task schedule_start_lesson[9656989d-760e-4fdc-9509-56b2f486abe0] succeeded in 0.017987949002417736s: None
2016-08-17 22:23:27,944 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:23:28,769 INFO celery.worker.strategy Received task: schedule_clean_desktops[e5c6647e-6123-4be0-bf48-27e9ba6ec560]
2016-08-17 22:23:28,770 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:23:28,772 WARNING celery.redirected 2016-08-17 22:23:28,771 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:23:28,773 WARNING celery.redirected 2016-08-17 22:23:28,773 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:23:28,774 WARNING celery.redirected 2016-08-17 22:23:28,774 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:23:28,777 WARNING celery.redirected 2016-08-17 22:23:28,777 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:23:28,778 WARNING celery.redirected 2016-08-17 22:23:28,778 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 22, 28, 771247)}
2016-08-17 22:23:28,781 WARNING celery.redirected 2016-08-17 22:23:28,781 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:23:28,783 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:23:28,791 INFO celery.worker.job Task schedule_clean_desktops[e5c6647e-6123-4be0-bf48-27e9ba6ec560] succeeded in 0.020838944001297932s: None
2016-08-17 22:23:37,960 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:23:37,961 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:23:37,964 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:23:37,964 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:23:37,969 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:23:37,970 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:23:37,970 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:23:37,970 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:24:12,956 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:24:12,956 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:24:12,956 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:24:12,956 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:24:12,959 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:24:12,975 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:24:12,976 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:24:12,978 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:24:12,978 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:24:12,981 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:24:12,981 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:24:12,981 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:24:12,981 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:24:13,292 INFO celery.worker.strategy Received task: schedule_start_lesson[a698eb5d-79b3-4b14-a480-1bc3d3c41f71]
2016-08-17 22:24:13,293 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:24:13,294 INFO celery Scheduling start lesson tasks
2016-08-17 22:24:13,295 WARNING celery.redirected 2016-08-17 22:24:13,295 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:24:13,296 WARNING celery.redirected 2016-08-17 22:24:13,296 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:24:13,296 WARNING celery.redirected 2016-08-17 22:24:13,296 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:24:13,300 WARNING celery.redirected 2016-08-17 22:24:13,300 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:24:13,301 WARNING celery.redirected 2016-08-17 22:24:13,301 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 24, 13, 298004), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 34, 13, 298004)}
2016-08-17 22:24:13,303 WARNING celery.redirected 2016-08-17 22:24:13,303 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:24:13,304 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:24:13,311 INFO celery.worker.job Task schedule_start_lesson[a698eb5d-79b3-4b14-a480-1bc3d3c41f71] succeeded in 0.01742572499642847s: None
2016-08-17 22:24:32,971 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:24:33,756 INFO celery.worker.strategy Received task: schedule_clean_desktops[9a4efdb7-17b9-41ed-a6a4-aef0f35227de]
2016-08-17 22:24:33,757 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:24:33,759 WARNING celery.redirected 2016-08-17 22:24:33,758 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:24:33,760 WARNING celery.redirected 2016-08-17 22:24:33,759 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:24:33,760 WARNING celery.redirected 2016-08-17 22:24:33,760 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:24:33,763 WARNING celery.redirected 2016-08-17 22:24:33,763 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:24:33,764 WARNING celery.redirected 2016-08-17 22:24:33,764 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 23, 33, 758192), 'desktop_state_2': 'DELETED'}
2016-08-17 22:24:33,767 WARNING celery.redirected 2016-08-17 22:24:33,767 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:24:33,768 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:24:33,777 INFO celery.worker.job Task schedule_clean_desktops[9a4efdb7-17b9-41ed-a6a4-aef0f35227de] succeeded in 0.01995304599404335s: None
2016-08-17 22:24:43,003 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:24:43,003 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:24:43,006 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:24:43,006 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:24:43,011 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:24:43,011 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:24:43,012 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:24:43,012 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:25:17,994 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:25:17,994 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:25:17,994 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:25:17,995 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:25:17,999 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:25:18,051 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:25:18,052 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:25:18,057 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:25:18,058 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:25:18,063 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:25:18,063 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:25:18,064 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:25:18,064 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:25:18,882 INFO celery.worker.strategy Received task: schedule_start_lesson[cc936714-aec2-44ec-89b1-537673c7b3f6]
2016-08-17 22:25:18,884 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:25:18,885 INFO celery Scheduling start lesson tasks
2016-08-17 22:25:18,886 WARNING celery.redirected 2016-08-17 22:25:18,885 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:25:18,887 WARNING celery.redirected 2016-08-17 22:25:18,887 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:25:18,888 WARNING celery.redirected 2016-08-17 22:25:18,888 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:25:18,892 WARNING celery.redirected 2016-08-17 22:25:18,891 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:25:18,892 WARNING celery.redirected 2016-08-17 22:25:18,892 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 25, 18, 889609), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 35, 18, 889609)}
2016-08-17 22:25:18,894 WARNING celery.redirected 2016-08-17 22:25:18,894 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:25:18,895 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:25:18,903 INFO celery.worker.job Task schedule_start_lesson[cc936714-aec2-44ec-89b1-537673c7b3f6] succeeded in 0.019360108002729248s: None
2016-08-17 22:25:33,053 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:25:33,361 INFO celery.worker.strategy Received task: schedule_clean_desktops[61b4a0a1-48bf-467f-95f7-6ac4b302e08f]
2016-08-17 22:25:33,363 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:25:33,364 WARNING celery.redirected 2016-08-17 22:25:33,364 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:25:33,365 WARNING celery.redirected 2016-08-17 22:25:33,365 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:25:33,366 WARNING celery.redirected 2016-08-17 22:25:33,365 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:25:33,370 WARNING celery.redirected 2016-08-17 22:25:33,369 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:25:33,370 WARNING celery.redirected 2016-08-17 22:25:33,370 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 24, 33, 363875), 'desktop_state_2': 'DELETED'}
2016-08-17 22:25:33,372 WARNING celery.redirected 2016-08-17 22:25:33,372 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:25:33,373 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:25:33,382 INFO celery.worker.job Task schedule_clean_desktops[61b4a0a1-48bf-467f-95f7-6ac4b302e08f] succeeded in 0.019015245001355652s: None
2016-08-17 22:25:48,067 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:25:48,067 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:25:48,071 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:25:48,072 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:25:48,077 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:25:48,077 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:25:48,077 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:25:48,077 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:26:18,054 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:26:18,080 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:26:18,081 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:26:18,083 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:26:18,083 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:26:18,256 INFO celery.worker.strategy Received task: schedule_start_lesson[8e67dfa7-18de-40e0-90ae-232dc1b3436d]
2016-08-17 22:26:18,257 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:26:18,259 INFO celery Scheduling start lesson tasks
2016-08-17 22:26:18,260 WARNING celery.redirected 2016-08-17 22:26:18,260 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:26:18,262 WARNING celery.redirected 2016-08-17 22:26:18,262 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:26:18,263 WARNING celery.redirected 2016-08-17 22:26:18,263 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:26:18,270 WARNING celery.redirected 2016-08-17 22:26:18,270 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:26:18,270 WARNING celery.redirected 2016-08-17 22:26:18,270 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 26, 18, 266009), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 36, 18, 266009)}
2016-08-17 22:26:18,272 WARNING celery.redirected 2016-08-17 22:26:18,272 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:26:18,273 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:26:18,283 INFO celery.worker.job Task schedule_start_lesson[8e67dfa7-18de-40e0-90ae-232dc1b3436d] succeeded in 0.026266638000379317s: None
2016-08-17 22:26:33,077 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:26:34,227 INFO celery.worker.strategy Received task: schedule_clean_desktops[86c2ef40-c4dc-4669-8a68-f5af00e25fe1]
2016-08-17 22:26:34,228 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:26:34,230 WARNING celery.redirected 2016-08-17 22:26:34,229 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:26:34,231 WARNING celery.redirected 2016-08-17 22:26:34,231 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:26:34,231 WARNING celery.redirected 2016-08-17 22:26:34,231 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:26:34,234 WARNING celery.redirected 2016-08-17 22:26:34,234 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:26:34,235 WARNING celery.redirected 2016-08-17 22:26:34,235 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 25, 34, 229190)}
2016-08-17 22:26:34,237 WARNING celery.redirected 2016-08-17 22:26:34,237 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:26:34,238 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:26:34,245 INFO celery.worker.job Task schedule_clean_desktops[86c2ef40-c4dc-4669-8a68-f5af00e25fe1] succeeded in 0.017081122001400217s: None
2016-08-17 22:26:48,156 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:26:48,157 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:26:48,159 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:26:48,159 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:26:48,165 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:26:48,166 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:26:48,166 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:26:48,166 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:27:18,149 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:27:18,166 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:27:18,167 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:27:18,169 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:27:18,169 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:27:18,172 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:27:18,172 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:27:18,172 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:27:18,172 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:27:18,251 INFO celery.worker.strategy Received task: schedule_start_lesson[0900ebc8-ab45-481d-88c5-0240b6e181e5]
2016-08-17 22:27:18,253 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:27:18,253 INFO celery Scheduling start lesson tasks
2016-08-17 22:27:18,254 WARNING celery.redirected 2016-08-17 22:27:18,254 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:27:18,255 WARNING celery.redirected 2016-08-17 22:27:18,255 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:27:18,256 WARNING celery.redirected 2016-08-17 22:27:18,256 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:27:18,260 WARNING celery.redirected 2016-08-17 22:27:18,260 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:27:18,262 WARNING celery.redirected 2016-08-17 22:27:18,261 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 27, 18, 258026), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(22, 37, 18, 258026)}
2016-08-17 22:27:18,265 WARNING celery.redirected 2016-08-17 22:27:18,265 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:27:18,267 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:27:18,276 INFO celery.worker.job Task schedule_start_lesson[0900ebc8-ab45-481d-88c5-0240b6e181e5] succeeded in 0.023478064002119936s: None
2016-08-17 22:27:33,162 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:27:34,098 INFO celery.worker.strategy Received task: schedule_clean_desktops[faac4e9c-4a7b-4c14-a8f9-351028190160]
2016-08-17 22:27:34,099 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:27:34,101 WARNING celery.redirected 2016-08-17 22:27:34,101 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:27:34,103 WARNING celery.redirected 2016-08-17 22:27:34,103 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:27:34,104 WARNING celery.redirected 2016-08-17 22:27:34,104 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:27:34,108 WARNING celery.redirected 2016-08-17 22:27:34,108 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:27:34,108 WARNING celery.redirected 2016-08-17 22:27:34,108 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 26, 34, 100390), 'desktop_state_2': 'DELETED'}
2016-08-17 22:27:34,111 WARNING celery.redirected 2016-08-17 22:27:34,110 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:27:34,112 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:27:34,121 INFO celery.worker.job Task schedule_clean_desktops[faac4e9c-4a7b-4c14-a8f9-351028190160] succeeded in 0.022682678994897287s: None
2016-08-17 22:27:48,178 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:27:48,178 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:27:48,180 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:27:48,181 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:27:48,186 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:27:48,186 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:27:48,186 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:27:48,186 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:51:36,564 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:51:36,565 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:51:36,572 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:51:36,572 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:51:36,591 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:51:37,244 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:51:37,245 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:51:37,247 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:51:37,248 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:51:37,248 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:51:37,266 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:51:37,266 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:51:37,269 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:51:37,269 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:51:37,272 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:51:37,272 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:51:37,273 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:51:37,273 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:51:38,236 INFO celery.worker.strategy Received task: schedule_start_lesson[430eb387-43cb-4679-ab7d-7973c491158f]
2016-08-17 22:51:38,245 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:51:38,251 INFO celery Scheduling start lesson tasks
2016-08-17 22:51:38,263 WARNING celery.redirected 2016-08-17 22:51:38,262 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:51:38,266 WARNING celery.redirected 2016-08-17 22:51:38,265 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:51:38,266 WARNING celery.redirected 2016-08-17 22:51:38,266 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:51:38,275 WARNING celery.redirected 2016-08-17 22:51:38,274 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:51:38,275 WARNING celery.redirected 2016-08-17 22:51:38,275 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 51, 38, 269944), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 1, 38, 269944)}
2016-08-17 22:51:38,278 WARNING celery.redirected 2016-08-17 22:51:38,278 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:51:38,280 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:51:38,296 INFO celery.worker.job Task schedule_start_lesson[430eb387-43cb-4679-ab7d-7973c491158f] succeeded in 0.05400029000156792s: None
2016-08-17 22:51:38,322 INFO celery.worker.strategy Received task: schedule_clean_desktops[80a5d55c-56cc-4db1-9ba9-682bb66a9c9a]
2016-08-17 22:51:38,327 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:51:38,344 WARNING celery.redirected 2016-08-17 22:51:38,343 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:51:38,347 WARNING celery.redirected 2016-08-17 22:51:38,346 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:51:38,347 WARNING celery.redirected 2016-08-17 22:51:38,347 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:51:38,353 WARNING celery.redirected 2016-08-17 22:51:38,353 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:51:38,354 WARNING celery.redirected 2016-08-17 22:51:38,354 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 50, 38, 337665)}
2016-08-17 22:51:38,356 WARNING celery.redirected 2016-08-17 22:51:38,356 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:51:38,357 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:51:38,374 INFO celery.worker.job Task schedule_clean_desktops[80a5d55c-56cc-4db1-9ba9-682bb66a9c9a] succeeded in 0.04994433699903311s: None
2016-08-17 22:52:12,248 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:52:12,248 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:52:12,248 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:52:12,248 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:52:12,254 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:52:12,254 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:52:12,254 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:52:12,255 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:52:37,236 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:52:37,320 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:52:38,385 INFO celery.worker.strategy Received task: schedule_start_lesson[b569a65d-60c4-4866-b84c-b42d1b8240f5]
2016-08-17 22:52:38,390 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:52:38,396 INFO celery Scheduling start lesson tasks
2016-08-17 22:52:38,403 WARNING celery.redirected 2016-08-17 22:52:38,403 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:52:38,406 WARNING celery.redirected 2016-08-17 22:52:38,406 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:52:38,407 WARNING celery.redirected 2016-08-17 22:52:38,407 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:52:38,414 WARNING celery.redirected 2016-08-17 22:52:38,414 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:52:38,414 WARNING celery.redirected 2016-08-17 22:52:38,414 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 52, 38, 410329), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 2, 38, 410329)}
2016-08-17 22:52:38,417 WARNING celery.redirected 2016-08-17 22:52:38,416 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:52:38,418 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:52:38,431 INFO celery.worker.job Task schedule_start_lesson[b569a65d-60c4-4866-b84c-b42d1b8240f5] succeeded in 0.04379912200238323s: None
2016-08-17 22:52:38,461 INFO celery.worker.strategy Received task: schedule_clean_desktops[eb282af4-b482-47a1-b5ff-56b9ecfe26f8]
2016-08-17 22:52:38,466 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:52:38,477 WARNING celery.redirected 2016-08-17 22:52:38,477 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:52:38,480 WARNING celery.redirected 2016-08-17 22:52:38,480 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:52:38,481 WARNING celery.redirected 2016-08-17 22:52:38,481 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:52:38,489 WARNING celery.redirected 2016-08-17 22:52:38,488 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:52:38,489 WARNING celery.redirected 2016-08-17 22:52:38,489 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 51, 38, 471327), 'desktop_state_2': 'DELETED'}
2016-08-17 22:52:38,492 WARNING celery.redirected 2016-08-17 22:52:38,491 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:52:38,493 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:52:38,507 INFO celery.worker.job Task schedule_clean_desktops[eb282af4-b482-47a1-b5ff-56b9ecfe26f8] succeeded in 0.044293664999713656s: None
2016-08-17 22:52:42,337 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:52:42,337 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:52:42,339 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:52:42,340 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:52:42,345 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:52:42,345 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:52:42,346 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:52:42,346 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:53:17,329 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:53:17,329 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:53:17,330 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:53:17,330 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:53:17,335 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:53:17,335 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:53:17,336 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:53:17,336 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:53:37,325 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:53:37,343 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:53:38,372 INFO celery.worker.strategy Received task: schedule_start_lesson[321e9d7c-d26e-4f64-9744-578587d7c290]
2016-08-17 22:53:38,375 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:53:38,377 INFO celery Scheduling start lesson tasks
2016-08-17 22:53:38,378 WARNING celery.redirected 2016-08-17 22:53:38,378 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:53:38,379 WARNING celery.redirected 2016-08-17 22:53:38,379 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:53:38,379 WARNING celery.redirected 2016-08-17 22:53:38,379 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:53:38,384 WARNING celery.redirected 2016-08-17 22:53:38,384 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:53:38,384 WARNING celery.redirected 2016-08-17 22:53:38,384 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 53, 38, 380903), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 3, 38, 380903)}
2016-08-17 22:53:38,387 WARNING celery.redirected 2016-08-17 22:53:38,387 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:53:38,388 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:53:38,397 INFO celery.worker.job Task schedule_start_lesson[321e9d7c-d26e-4f64-9744-578587d7c290] succeeded in 0.02217002399993362s: None
2016-08-17 22:53:38,451 INFO celery.worker.strategy Received task: schedule_clean_desktops[49e4e45e-e6e7-4688-bac5-06ec435b82c1]
2016-08-17 22:53:38,453 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:53:38,455 WARNING celery.redirected 2016-08-17 22:53:38,454 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:53:38,457 WARNING celery.redirected 2016-08-17 22:53:38,456 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:53:38,458 WARNING celery.redirected 2016-08-17 22:53:38,458 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:53:38,464 WARNING celery.redirected 2016-08-17 22:53:38,464 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:53:38,465 WARNING celery.redirected 2016-08-17 22:53:38,465 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 52, 38, 453919)}
2016-08-17 22:53:38,468 WARNING celery.redirected 2016-08-17 22:53:38,468 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:53:38,470 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:53:38,479 INFO celery.worker.job Task schedule_clean_desktops[49e4e45e-e6e7-4688-bac5-06ec435b82c1] succeeded in 0.026897320996795315s: None
2016-08-17 22:53:47,354 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:53:47,354 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:53:47,356 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:53:47,356 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:53:47,361 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:53:47,361 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:53:47,361 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:53:47,362 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:54:22,341 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:54:22,341 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:54:22,342 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:54:22,342 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:54:22,350 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:54:22,350 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:54:22,351 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:54:22,351 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:54:37,343 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:54:37,360 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:54:38,252 INFO celery.worker.strategy Received task: schedule_start_lesson[b4249f98-438c-4fcb-bad6-c501069df57f]
2016-08-17 22:54:38,254 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:54:38,254 INFO celery Scheduling start lesson tasks
2016-08-17 22:54:38,255 WARNING celery.redirected 2016-08-17 22:54:38,255 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:54:38,256 WARNING celery.redirected 2016-08-17 22:54:38,256 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:54:38,257 WARNING celery.redirected 2016-08-17 22:54:38,257 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:54:38,261 WARNING celery.redirected 2016-08-17 22:54:38,261 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:54:38,261 WARNING celery.redirected 2016-08-17 22:54:38,261 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 54, 38, 258940), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 4, 38, 258940)}
2016-08-17 22:54:38,263 WARNING celery.redirected 2016-08-17 22:54:38,263 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:54:38,264 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:54:38,274 INFO celery.worker.job Task schedule_start_lesson[b4249f98-438c-4fcb-bad6-c501069df57f] succeeded in 0.02087125400430523s: None
2016-08-17 22:54:38,328 INFO celery.worker.strategy Received task: schedule_clean_desktops[9be4eb79-7055-447a-bd07-ed8191b250a8]
2016-08-17 22:54:38,329 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:54:38,330 WARNING celery.redirected 2016-08-17 22:54:38,330 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:54:38,331 WARNING celery.redirected 2016-08-17 22:54:38,331 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:54:38,332 WARNING celery.redirected 2016-08-17 22:54:38,332 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:54:38,338 WARNING celery.redirected 2016-08-17 22:54:38,337 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:54:38,339 WARNING celery.redirected 2016-08-17 22:54:38,338 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 53, 38, 330124)}
2016-08-17 22:54:38,340 WARNING celery.redirected 2016-08-17 22:54:38,340 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:54:38,341 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:54:38,348 INFO celery.worker.job Task schedule_clean_desktops[9be4eb79-7055-447a-bd07-ed8191b250a8] succeeded in 0.019192009000107646s: None
2016-08-17 22:54:52,370 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:54:52,370 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:54:52,373 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:54:52,373 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:54:52,378 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:54:52,378 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:54:52,378 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:54:52,378 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:55:27,362 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:55:27,362 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:55:27,363 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:55:27,363 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:55:27,368 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:55:27,368 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:55:27,369 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:55:27,369 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:55:37,366 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:55:37,384 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:55:37,968 INFO celery.worker.strategy Received task: schedule_start_lesson[38c58b44-b2e8-4786-9692-5209900c2b27]
2016-08-17 22:55:37,969 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:55:37,969 INFO celery Scheduling start lesson tasks
2016-08-17 22:55:37,971 WARNING celery.redirected 2016-08-17 22:55:37,970 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:55:37,972 WARNING celery.redirected 2016-08-17 22:55:37,972 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:55:37,972 WARNING celery.redirected 2016-08-17 22:55:37,972 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:55:37,976 WARNING celery.redirected 2016-08-17 22:55:37,976 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:55:37,976 WARNING celery.redirected 2016-08-17 22:55:37,976 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 55, 37, 974147), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 5, 37, 974147)}
2016-08-17 22:55:37,979 WARNING celery.redirected 2016-08-17 22:55:37,978 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:55:37,979 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:55:37,987 INFO celery.worker.job Task schedule_start_lesson[38c58b44-b2e8-4786-9692-5209900c2b27] succeeded in 0.018035934001090936s: None
2016-08-17 22:55:38,037 INFO celery.worker.strategy Received task: schedule_clean_desktops[7f448019-20e2-42cf-b682-3d3fcc6151c7]
2016-08-17 22:55:38,039 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:55:38,040 WARNING celery.redirected 2016-08-17 22:55:38,040 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:55:38,041 WARNING celery.redirected 2016-08-17 22:55:38,041 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:55:38,042 WARNING celery.redirected 2016-08-17 22:55:38,042 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:55:38,045 WARNING celery.redirected 2016-08-17 22:55:38,045 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:55:38,046 WARNING celery.redirected 2016-08-17 22:55:38,046 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 54, 38, 40045), 'desktop_state_2': 'DELETED'}
2016-08-17 22:55:38,048 WARNING celery.redirected 2016-08-17 22:55:38,048 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:55:38,049 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:55:38,056 INFO celery.worker.job Task schedule_clean_desktops[7f448019-20e2-42cf-b682-3d3fcc6151c7] succeeded in 0.017830449003668036s: None
2016-08-17 22:55:57,394 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:55:57,395 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:55:57,397 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:55:57,398 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:55:57,402 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:55:57,403 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:55:57,403 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:55:57,403 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:56:32,378 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:56:32,380 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:56:32,380 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:56:32,380 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:56:32,385 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:56:32,386 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:56:32,386 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:56:32,386 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:56:37,383 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:56:37,401 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:56:37,821 INFO celery.worker.strategy Received task: schedule_start_lesson[c100aed6-3e37-4cf1-ab4c-929793122da0]
2016-08-17 22:56:37,823 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:56:37,823 INFO celery Scheduling start lesson tasks
2016-08-17 22:56:37,824 WARNING celery.redirected 2016-08-17 22:56:37,824 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:56:37,825 WARNING celery.redirected 2016-08-17 22:56:37,825 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:56:37,826 WARNING celery.redirected 2016-08-17 22:56:37,826 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:56:37,832 WARNING celery.redirected 2016-08-17 22:56:37,832 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:56:37,832 WARNING celery.redirected 2016-08-17 22:56:37,832 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 56, 37, 827566), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 6, 37, 827566)}
2016-08-17 22:56:37,834 WARNING celery.redirected 2016-08-17 22:56:37,834 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:56:37,835 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:56:37,844 INFO celery.worker.job Task schedule_start_lesson[c100aed6-3e37-4cf1-ab4c-929793122da0] succeeded in 0.02116283800569363s: None
2016-08-17 22:56:37,896 INFO celery.worker.strategy Received task: schedule_clean_desktops[b7dfc041-ad1a-48a2-bcc7-42aa31dc32e6]
2016-08-17 22:56:37,898 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:56:37,900 WARNING celery.redirected 2016-08-17 22:56:37,899 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:56:37,901 WARNING celery.redirected 2016-08-17 22:56:37,900 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:56:37,901 WARNING celery.redirected 2016-08-17 22:56:37,901 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:56:37,905 WARNING celery.redirected 2016-08-17 22:56:37,905 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:56:37,906 WARNING celery.redirected 2016-08-17 22:56:37,906 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 55, 37, 899076), 'desktop_state_2': 'DELETED'}
2016-08-17 22:56:37,908 WARNING celery.redirected 2016-08-17 22:56:37,907 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:56:37,909 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:56:37,916 INFO celery.worker.job Task schedule_clean_desktops[b7dfc041-ad1a-48a2-bcc7-42aa31dc32e6] succeeded in 0.018599465001898352s: None
2016-08-17 22:57:02,400 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:57:02,400 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:57:02,403 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:57:02,403 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:57:02,408 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:57:02,408 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:57:02,408 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:57:02,409 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:57:37,398 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:57:37,398 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:57:37,399 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:57:37,399 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:57:37,401 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:57:37,417 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:57:37,417 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:57:37,420 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:57:37,420 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:57:37,420 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:57:37,435 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:57:37,436 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:57:37,438 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:57:37,438 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:57:37,441 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:57:37,441 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:57:37,441 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:57:37,441 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:57:37,723 INFO celery.worker.strategy Received task: schedule_start_lesson[9083d0b8-1ac4-44e4-8fa4-c148c769e805]
2016-08-17 22:57:37,724 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:57:37,725 INFO celery Scheduling start lesson tasks
2016-08-17 22:57:37,726 WARNING celery.redirected 2016-08-17 22:57:37,725 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:57:37,727 WARNING celery.redirected 2016-08-17 22:57:37,727 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:57:37,727 WARNING celery.redirected 2016-08-17 22:57:37,727 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:57:37,731 WARNING celery.redirected 2016-08-17 22:57:37,731 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:57:37,732 WARNING celery.redirected 2016-08-17 22:57:37,732 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 57, 37, 729087), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 7, 37, 729087)}
2016-08-17 22:57:37,734 WARNING celery.redirected 2016-08-17 22:57:37,733 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:57:37,734 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:57:37,743 INFO celery.worker.job Task schedule_start_lesson[9083d0b8-1ac4-44e4-8fa4-c148c769e805] succeeded in 0.019113839000056032s: None
2016-08-17 22:57:37,798 INFO celery.worker.strategy Received task: schedule_clean_desktops[23d5f55f-bc5a-4e82-949f-b4568217038a]
2016-08-17 22:57:37,799 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:57:37,800 WARNING celery.redirected 2016-08-17 22:57:37,800 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:57:37,801 WARNING celery.redirected 2016-08-17 22:57:37,801 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:57:37,802 WARNING celery.redirected 2016-08-17 22:57:37,801 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:57:37,805 WARNING celery.redirected 2016-08-17 22:57:37,805 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:57:37,805 WARNING celery.redirected 2016-08-17 22:57:37,805 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 56, 37, 799841), 'desktop_state_2': 'DELETED'}
2016-08-17 22:57:37,807 WARNING celery.redirected 2016-08-17 22:57:37,807 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:57:37,808 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:57:37,816 INFO celery.worker.job Task schedule_clean_desktops[23d5f55f-bc5a-4e82-949f-b4568217038a] succeeded in 0.017285955997067504s: None
2016-08-17 22:58:07,452 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:58:07,452 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:58:07,452 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:58:07,452 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:58:07,458 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:58:07,458 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:58:07,459 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:58:07,459 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:58:37,464 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:58:37,465 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:58:37,466 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:58:37,466 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:58:37,469 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:58:37,484 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:58:37,485 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:58:37,487 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:58:37,487 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:58:37,487 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:58:37,506 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:58:37,506 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:58:37,509 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:58:37,509 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:58:37,512 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:58:37,512 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:58:37,512 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:58:37,513 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:58:37,848 INFO celery.worker.strategy Received task: schedule_start_lesson[ef0f68f8-974a-4b3d-a712-14d261081ac9]
2016-08-17 22:58:37,849 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:58:37,850 INFO celery Scheduling start lesson tasks
2016-08-17 22:58:37,851 WARNING celery.redirected 2016-08-17 22:58:37,851 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:58:37,852 WARNING celery.redirected 2016-08-17 22:58:37,852 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:58:37,853 WARNING celery.redirected 2016-08-17 22:58:37,853 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:58:37,857 WARNING celery.redirected 2016-08-17 22:58:37,857 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:58:37,857 WARNING celery.redirected 2016-08-17 22:58:37,857 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 58, 37, 854658), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 8, 37, 854658)}
2016-08-17 22:58:37,860 WARNING celery.redirected 2016-08-17 22:58:37,859 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:58:37,861 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:58:37,868 INFO celery.worker.job Task schedule_start_lesson[ef0f68f8-974a-4b3d-a712-14d261081ac9] succeeded in 0.019285884001874365s: None
2016-08-17 22:58:37,917 INFO celery.worker.strategy Received task: schedule_clean_desktops[ca2f1e96-14bd-47c5-a3de-aa7dbc9ef327]
2016-08-17 22:58:37,919 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:58:37,921 WARNING celery.redirected 2016-08-17 22:58:37,921 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:58:37,922 WARNING celery.redirected 2016-08-17 22:58:37,922 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:58:37,923 WARNING celery.redirected 2016-08-17 22:58:37,922 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:58:37,926 WARNING celery.redirected 2016-08-17 22:58:37,926 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:58:37,926 WARNING celery.redirected 2016-08-17 22:58:37,926 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 57, 37, 920632), 'desktop_state_2': 'DELETED'}
2016-08-17 22:58:37,929 WARNING celery.redirected 2016-08-17 22:58:37,928 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:58:37,930 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:58:37,937 INFO celery.worker.job Task schedule_clean_desktops[ca2f1e96-14bd-47c5-a3de-aa7dbc9ef327] succeeded in 0.01804627899400657s: None
2016-08-17 22:59:07,516 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:59:07,516 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:59:07,517 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:59:07,517 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:59:07,523 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:59:07,523 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:59:07,523 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:59:07,523 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:59:37,529 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:59:37,529 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:59:37,529 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:59:37,529 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:59:37,531 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 22:59:37,547 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:59:37,547 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:59:37,549 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:59:37,550 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:59:37,550 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 22:59:37,567 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:59:37,567 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:59:37,570 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:59:37,570 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:59:37,573 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 22:59:37,573 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 22:59:37,574 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 22:59:37,574 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 22:59:37,726 INFO celery.worker.strategy Received task: schedule_start_lesson[ea0b29e8-93b9-4730-848c-baafab2197b7]
2016-08-17 22:59:37,727 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:59:37,728 INFO celery Scheduling start lesson tasks
2016-08-17 22:59:37,729 WARNING celery.redirected 2016-08-17 22:59:37,729 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:59:37,730 WARNING celery.redirected 2016-08-17 22:59:37,730 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:59:37,730 WARNING celery.redirected 2016-08-17 22:59:37,730 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 22:59:37,734 WARNING celery.redirected 2016-08-17 22:59:37,734 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 22:59:37,735 WARNING celery.redirected 2016-08-17 22:59:37,735 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(22, 59, 37, 732479), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 9, 37, 732479)}
2016-08-17 22:59:37,737 WARNING celery.redirected 2016-08-17 22:59:37,737 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:59:37,738 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:59:37,748 INFO celery.worker.job Task schedule_start_lesson[ea0b29e8-93b9-4730-848c-baafab2197b7] succeeded in 0.02086518899886869s: None
2016-08-17 22:59:37,802 INFO celery.worker.strategy Received task: schedule_clean_desktops[53d57596-7abc-4c0f-897c-4dd30a294532]
2016-08-17 22:59:37,803 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 22:59:37,804 WARNING celery.redirected 2016-08-17 22:59:37,804 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 22:59:37,806 WARNING celery.redirected 2016-08-17 22:59:37,806 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 22:59:37,806 WARNING celery.redirected 2016-08-17 22:59:37,806 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 22:59:37,810 WARNING celery.redirected 2016-08-17 22:59:37,810 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 22:59:37,810 WARNING celery.redirected 2016-08-17 22:59:37,810 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 58, 37, 804077)}
2016-08-17 22:59:37,812 WARNING celery.redirected 2016-08-17 22:59:37,812 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 22:59:37,813 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 22:59:37,820 INFO celery.worker.job Task schedule_clean_desktops[53d57596-7abc-4c0f-897c-4dd30a294532] succeeded in 0.017571113996382337s: None
2016-08-17 23:00:12,562 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:00:12,562 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:00:12,563 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:00:12,563 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:00:12,568 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:00:12,568 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:00:12,568 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:00:12,568 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:00:42,549 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 23:00:42,575 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:00:42,575 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:00:42,577 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:00:42,577 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:00:42,577 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 23:00:42,594 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:00:42,594 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:00:42,596 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:00:42,596 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:00:42,599 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:00:42,599 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:00:42,599 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:00:42,600 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:00:43,511 INFO celery.worker.strategy Received task: schedule_start_lesson[1fab7ea5-fe7f-4317-99a5-8ac3e81a3573]
2016-08-17 23:00:43,513 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 23:00:43,514 INFO celery Scheduling start lesson tasks
2016-08-17 23:00:43,516 WARNING celery.redirected 2016-08-17 23:00:43,516 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 23:00:43,517 WARNING celery.redirected 2016-08-17 23:00:43,517 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 23:00:43,518 WARNING celery.redirected 2016-08-17 23:00:43,518 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 23:00:43,524 WARNING celery.redirected 2016-08-17 23:00:43,524 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 23:00:43,525 WARNING celery.redirected 2016-08-17 23:00:43,524 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(23, 0, 43, 520930), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 10, 43, 520930)}
2016-08-17 23:00:43,527 WARNING celery.redirected 2016-08-17 23:00:43,527 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 23:00:43,529 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:00:43,539 INFO celery.worker.job Task schedule_start_lesson[1fab7ea5-fe7f-4317-99a5-8ac3e81a3573] succeeded in 0.02632952499698149s: None
2016-08-17 23:00:43,589 INFO celery.worker.strategy Received task: schedule_clean_desktops[5fb747f3-84ce-41b5-af8d-616add667191]
2016-08-17 23:00:43,591 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 23:00:43,594 WARNING celery.redirected 2016-08-17 23:00:43,593 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 23:00:43,596 WARNING celery.redirected 2016-08-17 23:00:43,595 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 23:00:43,596 WARNING celery.redirected 2016-08-17 23:00:43,596 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_latency'}
2016-08-17 23:00:43,601 WARNING celery.redirected 2016-08-17 23:00:43,600 INFO sqlalchemy.engine.base.Engine SELECT desktops.id AS desktops_id, desktops.created_at AS desktops_created_at, desktops.updated_at AS desktops_updated_at, desktops.name AS desktops_name, desktops.course_id AS desktops_course_id, desktops.vm_ref AS desktops_vm_ref, desktops.vm_state AS desktops_vm_state, desktops.os_state AS desktops_os_state, desktops.desktop_state AS desktops_desktop_state, desktops.desktop_type AS desktops_desktop_type, desktops.image_ref AS desktops_image_ref, desktops.flavor_ref AS desktops_flavor_ref, desktops.floating_ip AS desktops_floating_ip, desktops.fixed_ip AS desktops_fixed_ip, desktops.owner_id AS desktops_owner_id, desktops.need_floating AS desktops_need_floating, desktops.start_datetime AS desktops_start_datetime, desktops.end_datetime AS desktops_end_datetime 
FROM desktops 
WHERE desktops.end_datetime < %(end_datetime_1)s AND desktops.desktop_state != %(desktop_state_1)s AND desktops.desktop_state != %(desktop_state_2)s
2016-08-17 23:00:43,601 WARNING celery.redirected 2016-08-17 23:00:43,601 INFO sqlalchemy.engine.base.Engine {'desktop_state_1': 'DELETING', 'desktop_state_2': 'DELETED', 'end_datetime_1': datetime.datetime(2016, 8, 17, 22, 59, 43, 592968)}
2016-08-17 23:00:43,603 WARNING celery.redirected 2016-08-17 23:00:43,603 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 23:00:43,604 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:00:43,611 INFO celery.worker.job Task schedule_clean_desktops[5fb747f3-84ce-41b5-af8d-616add667191] succeeded in 0.01986086899705697s: None
2016-08-17 23:01:17,579 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:17,579 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:17,580 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:17,580 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:17,585 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:17,585 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:17,585 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:17,585 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:47,568 INFO celery.beat Scheduler: Sending due task schedule_start_lesson (schedule_start_lesson)
2016-08-17 23:01:47,601 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:47,601 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:47,605 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:47,605 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:47,606 INFO celery.beat Scheduler: Sending due task schedule_clean_desktops (schedule_clean_desktops)
2016-08-17 23:01:47,631 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:47,631 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:47,634 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:47,634 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:47,643 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:47,644 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:47,644 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:47,644 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:48,633 INFO celery.worker.strategy Received task: schedule_start_lesson[f7d8dd80-51dc-47b9-929e-24e1fb62f59e]
2016-08-17 23:01:48,635 WARNING celery.redirected ***** flask app context injected *****
2016-08-17 23:01:48,636 INFO celery Scheduling start lesson tasks
2016-08-17 23:01:48,744 WARNING celery.redirected 2016-08-17 23:01:48,744 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-08-17 23:01:48,746 WARNING celery.redirected 2016-08-17 23:01:48,746 INFO sqlalchemy.engine.base.Engine SELECT parameters.id AS parameters_id, parameters.created_at AS parameters_created_at, parameters.updated_at AS parameters_updated_at, parameters.name AS parameters_name, parameters.value AS parameters_value, parameters.type AS parameters_type, parameters.`group` AS parameters_group, parameters.description AS parameters_description 
FROM parameters 
WHERE parameters.name = %(name_1)s 
 LIMIT %(param_1)s
2016-08-17 23:01:48,746 WARNING celery.redirected 2016-08-17 23:01:48,746 INFO sqlalchemy.engine.base.Engine {'param_1': 1, 'name_1': 'course_schedule_ahead'}
2016-08-17 23:01:48,752 WARNING celery.redirected 2016-08-17 23:01:48,751 INFO sqlalchemy.engine.base.Engine SELECT lessons.start_time AS lessons_start_time, lessons.end_time AS lessons_end_time, lessons.id AS lessons_id, lessons.created_at AS lessons_created_at, lessons.updated_at AS lessons_updated_at, lessons.course_id AS lessons_course_id, lessons.start_date AS lessons_start_date, lessons.start_period_id AS lessons_start_period_id, lessons.end_date AS lessons_end_date, lessons.end_period_id AS lessons_end_period_id, lessons.scheduled AS lessons_scheduled, lessons.scheduled_at AS lessons_scheduled_at, lessons.started AS lessons_started 
FROM lessons 
WHERE lessons.scheduled = false AND (lessons.start_date < %(start_date_1)s OR lessons.start_date = %(start_date_2)s AND lessons.start_time < %(start_time_1)s) AND (lessons.end_date > %(end_date_1)s OR lessons.end_date = %(end_date_2)s AND lessons.end_time > %(end_time_1)s) AND lessons.course_id IS NOT NULL
2016-08-17 23:01:48,752 WARNING celery.redirected 2016-08-17 23:01:48,752 INFO sqlalchemy.engine.base.Engine {'end_date_2': datetime.date(2016, 8, 17), 'end_time_1': datetime.time(23, 1, 48, 748492), 'start_date_2': datetime.date(2016, 8, 17), 'end_date_1': datetime.date(2016, 8, 17), 'start_date_1': datetime.date(2016, 8, 17), 'start_time_1': datetime.time(23, 11, 48, 748492)}
2016-08-17 23:01:48,754 WARNING celery.redirected 2016-08-17 23:01:48,754 INFO sqlalchemy.engine.base.Engine COMMIT
2016-08-17 23:01:48,756 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:01:48,765 INFO celery.worker.job Task schedule_start_lesson[f7d8dd80-51dc-47b9-929e-24e1fb62f59e] succeeded in 0.13031188199965982s: None
2016-08-17 23:01:48,845 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:48,845 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:48,846 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:48,846 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:48,853 WARNING celery.redirected *** Task schedule_start_lesson ***
2016-08-17 23:01:48,853 WARNING celery.redirected *** Task schedule_clean_desktops ***
2016-08-17 23:01:48,854 WARNING celery.redirected *** Task celery.backend_cleanup ***
2016-08-17 23:01:48,854 WARNING celery.redirected *** Find 3 tasks ***
2016-08-17 23:01:48,855 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:01:48,855 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:01:48,878 WARNING celery.redirected ***** teardown request *****
2016-08-17 23:01:48,878 WARNING celery.redirected ***** teardown request *****
2016-08-17 23:01:48,878 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:01:48,878 WARNING celery.redirected ***** teardown appcontext *****
2016-08-17 23:01:50,657 WARNING celery.redirected ***** teardown request *****
2016-08-17 23:01:50,659 WARNING celery.redirected ***** teardown appcontext *****
